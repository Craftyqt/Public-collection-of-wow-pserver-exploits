<?xml version="1.0" encoding="utf-8" ?><HUNTER><Ability><Name>Scatter Trap</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code provided by Xelper
local targetTrapped = UnitDebuffID(&amp;quot;target&amp;quot;, 1499)
local _, FreezingTrapCD = GetSpellCooldown(1499)
if targetTrapped then
	return true
end


if FreezingTrapTimeout ~= nil and FreezingTrapTimeout &amp;gt; GetTime() then
	local targetName = UnitName(&amp;quot;target&amp;quot;)
	if targetName == FreezingTrapTarget and FreezingTrapTarget ~= nil then
		if FreezingTrapCD &amp;gt; 3 then
			return true
		end
	end
else
	FreezingTrapTimeout = nil
	FreezingTrapTarget = nil
end


if IsLeftControlKeyDown() and GetCurrentKeyBoardFocus() == nil then
	local ScatterShot = GetSpellInfo(19503)
	local TrapLauncher = GetSpellInfo(77769)
	local FreezingTrap = GetSpellInfo(1499)
	local ScatterShotCD, ScatterDuration = GetSpellCooldown(19503)
	ScatterShotCD = ScatterShotCD - GetTime() + ScatterDuration
	local TrapLauncherBuff = UnitBuffID(&amp;quot;player&amp;quot;, 77769)
	
	if ScatterShotCD &amp;lt; 3 and FreezingTrapCD &amp;lt; 3 then
		CastSpellByName(ScatterShot, &amp;quot;mouseover&amp;quot;)
		return true
	end


	if ScatterShotCD &amp;gt; 20 and FreezingTrapCD &amp;lt; 3 and TrapLauncherBuff == nil then
		CastSpellByName(TrapLauncher)
		return true
	end


	if ScatterShotCD &amp;gt; 20 and FreezingTrapCD &amp;lt; 3 and TrapLauncherBuff then
		RunMacroText(&amp;quot;/cast &amp;quot;..FreezingTrap)
		if FreezingTrapTimeout == nil or FreezingTrapTarget == nil then
			FreezingTrapTarget = UnitName(&amp;quot;mouseover&amp;quot;)
		end
		FreezingTrapTimeout = GetTime() + 3
		local PQR_TargetName = UnitName(&amp;quot;target&amp;quot;)
		local friendPlates = GetCVar(&amp;quot;nameplateShowFriends&amp;quot;)
		local enemyPlates = GetCVar(&amp;quot;nameplateShowEnemies&amp;quot;)
		SetCVar(&amp;quot;nameplateShowFriends&amp;quot;, 0)
		SetCVar(&amp;quot;nameplateShowEnemies&amp;quot;, 0)
		CameraOrSelectOrMoveStart()
		CameraOrSelectOrMoveStop()
		SetCVar(&amp;quot;nameplateShowFriends&amp;quot;, friendPlates)
		SetCVar(&amp;quot;nameplateShowEnemies&amp;quot;, enemyPlates)
		local PQR_TargetNameNew = UnitName(&amp;quot;target&amp;quot;)
		if PQR_TargetName ~= nil then
			if PQR_TargetName ~= PQR_TargetNameNew then
				TargetLastTarget()
			end
		else
			ClearTarget()
		end
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Aimed Shot!</Name><Default>false</Default><SpellID>0</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, &amp;quot;82926&amp;quot;) 
then RunMacroText(&amp;quot;/cast Aimed Shot!&amp;quot;)
 return true
 end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Arcane Shot</Name><Default>false</Default><SpellID>3044</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if IsRightControlKeyDown() then return false end
local AMoCStart, AMoCDuration = GetSpellCooldown(131894)
local AMoCCD = AMoCStart + AMoCDuration - GetTime()
local CSStart, CSDuration = GetSpellCooldown(53209)
local CSCD = CSStart + CSDuration - GetTime()
local fvr = 60
if IsPlayerSpell(82726)then fvr = 30 end

-- Stop Arcane Shot if Murder of Crows is coming off cooldown.
if IsPlayerSpell(131894)
and not UnitDebuffID(&amp;quot;target&amp;quot;, 131894, &amp;quot;PLAYER&amp;quot;) 
and AMoCCD &amp;lt; 2
and UnitHealth(&amp;quot;target&amp;quot;) &amp;lt; (UnitHealthMax(&amp;quot;player&amp;quot;)*3)
then return false end

-- Stop Arcane Shot if Chimera Shot is off cooldown
if UnitPower(&amp;quot;player&amp;quot;) &amp;lt; 45 
and CSCD &amp;lt; 1
then return false end

-- Arcane Shot with Thrill of the Hunt
if UnitPower(&amp;quot;player&amp;quot;) &amp;gt; 55
and UnitBuffID(&amp;quot;player&amp;quot;, &amp;quot;109306&amp;quot;)
then return true end

-- Arcane Shot usage code.
if UnitPower(&amp;quot;player&amp;quot;) &amp;gt; fvr
then return true end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Chimera Shot</Name><Default>false</Default><SpellID>53209</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>return true</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>FocusBuilder</Name><Default>false</Default><SpellID>0</SpellID><Actions>/cast Rabid</Actions><Lua>if IsLeftShiftKeyDown() then CastSpellByName(GetSpellInfo(56641),nil)
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rapid Fire</Name><Default>false</Default><SpellID>3045</SpellID><Actions>/cast Blood Fury</Actions><Lua>if not UnitBuffID(&amp;quot;player&amp;quot;, 3045)  -- Rapid Fire
and UnitExists(&amp;quot;target&amp;quot;)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>PET AUTOTARGET</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;Target&amp;quot;) == nil 
or ( UnitExists(&amp;quot;Target&amp;quot;) and UnitIsDead(&amp;quot;Target&amp;quot;))
and UnitAffectingCombat(&amp;quot;Player&amp;quot;) 
then TargetUnit(&amp;quot;PetTarget&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Lightwell--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code provided by Xelper
local LightwellName = &amp;quot;Lightwell&amp;quot;
local hp = UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) * 100
local sLightwell = UnitBuffID(&amp;quot;player&amp;quot;, 7001)
local sDeepCorruption = UnitDebuffID(&amp;quot;player&amp;quot;, 108220)
if PQR_LightwellTimeout == nil then
    PQR_LightwellTimeout = 0
end

if hp &amp;lt; 70 and sLightwell == nil then
    if PQR_LightwellTimeout &amp;lt; GetTime() then
        if sDeepCorruption == nil then
            PQR_LightwellTimeout = GetTime() + 1
            InteractUnit(LightwellName)
        end
    end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Steady Focus</Name><Default>false</Default><SpellID>56641</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not UnitBuffID(&amp;quot;player&amp;quot;,53224)
or (select(7,UnitBuffID(&amp;quot;player&amp;quot;,53224)) - GetTime() &amp;lt; 2)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Steady Shot</Name><Default>false</Default><SpellID>56641</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if UnitPower(&amp;quot;player&amp;quot;) &amp;lt; 75
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Kill Shot</Name><Default>false</Default><SpellID>53351</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>return true</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Multi-Shot</Name><Default>false</Default><SpellID>2643</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>-- disable multi-shot if target needs A Murder Of Crows on it
if IsPlayerSpell(131894)
and UnitExists(&amp;quot;focus&amp;quot;)
and select(2,GetSpellCooldown(131894)) == 0
and not UnitDebuffID(&amp;quot;focus&amp;quot;, 131894, &amp;quot;PLAYER&amp;quot;) 
and UnitHealth(&amp;quot;target&amp;quot;) &amp;gt; (UnitHealthMax(&amp;quot;player&amp;quot;)*6) then
return false end

-- disable multi-shot if Barrage is needed
if IsPlayerSpell(120360)
and select(2,GetSpellCooldown(120360)) == 0 
and IsRightControlKeyDown() then 
return false end

if UnitPower(&amp;quot;player&amp;quot;) &amp;gt; 40 
or UnitBuffID(&amp;quot;player&amp;quot;, &amp;quot;109306&amp;quot;) 
then return true end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Serpent Sting</Name><Default>false</Default><SpellID>1978</SpellID><Actions></Actions><Lua>if not UnitDebuffID(&amp;quot;target&amp;quot;, 1978, &amp;quot;PLAYER&amp;quot;)
then return true end</Lua><RecastDelay>1000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tranquilizing Shot</Name><Default>false</Default><SpellID>19801</SpellID><Actions></Actions><Lua>for i = 1, 40 do
	local buff = { UnitBuff(&amp;quot;target&amp;quot;, i) }
	if buff[9] then
		return true
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Aimed Shot</Name><Default>false</Default><SpellID>19434</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>local unitHp = 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
local casttime = select(7, GetSpellInfo(19434))

if unitHp &amp;gt;= 80 
or casttime &amp;lt; 1600 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rapid Fire (pushdown)</Name><Default>false</Default><SpellID>3045</SpellID><Actions>/cast Blood Fury</Actions><Lua>if IsRightShiftKeyDown()
and not UnitBuffID(&amp;quot;player&amp;quot;, 3045)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Dire Beast</Name><Default>false</Default><SpellID>120679</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not IsPlayerSpell(120679) then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>A Murder of Crows</Name><Default>false</Default><SpellID>131894</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not IsPlayerSpell(131894) then return false end

if not UnitDebuffID(&amp;quot;target&amp;quot;, 131894, &amp;quot;PLAYER&amp;quot;) 
and  UnitHealth(&amp;quot;target&amp;quot;) &amp;gt; (UnitHealthMax(&amp;quot;player&amp;quot;)*4) then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Serpent Sting (mouseover)</Name><Default>false</Default><SpellID>1978</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;Mouseover&amp;quot;) 
and IsLeftControlKeyDown() 
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;mouseover&amp;quot;) 
and not UnitDebuffID(&amp;quot;Mouseover&amp;quot;, 1978, &amp;quot;PLAYER&amp;quot;) then
    return true
end</Lua><RecastDelay>1000</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Lynx Rush</Name><Default>false</Default><SpellID>120697</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not IsPlayerSpell(120697)
or not UnitExists(&amp;quot;pet&amp;quot;) 
or UnitIsDead(&amp;quot;pet&amp;quot;) 
or IsSpellInRange(tostring(GetSpellInfo(2649)), &amp;quot;pettarget&amp;quot;) == 0
then return false end

return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Explosive Trap</Name><Default>false</Default><SpellID>13813</SpellID><Actions></Actions><Lua>F_traplaunch()

if IsLeftAltKeyDown()
and not GetCurrentKeyBoardFocus()
then CastSpellByName(tostring(GetSpellInfo(13813)))
if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Freezing Trap</Name><Default>false</Default><SpellID>1499</SpellID><Actions></Actions><Lua>F_traplaunch()

if IsRightAltKeyDown()
and not GetCurrentKeyBoardFocus()
then CastSpellByName(tostring(GetSpellInfo(1499)))
if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Ice Trap</Name><Default>false</Default><SpellID>13809</SpellID><Actions></Actions><Lua>F_traplaunch()

if IsLeftAltKeyDown()
and not GetCurrentKeyBoardFocus()
then CastSpellByName(tostring(GetSpellInfo(13809)))
if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Snake Trap</Name><Default>false</Default><SpellID>34600</SpellID><Actions></Actions><Lua>F_traplaunch()

if IsLeftAltKeyDown()
and not GetCurrentKeyBoardFocus()
then CastSpellByName(tostring(GetSpellInfo(34600)))
if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Mend Pet</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) 
and not UnitIsDead(&amp;quot;pet&amp;quot;) 
and PQR_IsOutOfSight(&amp;quot;pet&amp;quot;) == false 
and (100 * UnitHealth(&amp;quot;pet&amp;quot;) / UnitHealthMax(&amp;quot;pet&amp;quot;)) &amp;lt; 95
and not UnitBuffID(&amp;quot;pet&amp;quot;,136)
then CastSpellByName(GetSpellInfo(136),nil)
return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-- Functions</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>function F_traplaunch()
	if ( IsLeftAltKeyDown() or IsRightAltKeyDown() )
	and not UnitBuffID(&amp;quot;player&amp;quot;, 77769) 
	then CastSpellByID(77769, &amp;quot;player&amp;quot;) end
end

--crossed over
local crossedover = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,116161))
if crossedover and crossedover - GetTime() &amp;lt; 1.5 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Exhilaration</Name><Default>false</Default><SpellID>109304</SpellID><Actions></Actions><Lua>local myhp = UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) * 100
local pethp = UnitHealth(&amp;quot;pet&amp;quot;) / UnitHealthMax(&amp;quot;pet&amp;quot;) * 100

if not IsPlayerSpell(109304) then return false end

if myhp &amp;lt; 50 
or pethp &amp;lt; 20 then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healthstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 40
and GetItemCount(5512,false,false) &amp;gt; 0
and ( select(2, GetItemCooldown(5512)) == 0 )
then UseItemByName(5512)
return true end


--if (100 * (UnitHealth(&amp;quot;player&amp;quot;) + UnitGetIncomingHeals(&amp;quot;player&amp;quot;)) / UnitHealthMax(&amp;quot;player&amp;quot;)) &amp;lt;= 30
--and select(3,GetItemCooldown(5512)) == 1
--then UseItemByName(5512)
--return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Scatter Shot</Name><Default>false</Default><SpellID>19503</SpellID><Actions></Actions><Lua>if IsRightAltKeyDown() and UnitExists(&amp;quot;mouseover&amp;quot;)then return true end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Stampede</Name><Default>false</Default><SpellID>121818</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not IsPlayerSpell(121818) then return false end

if IsRightShiftKeyDown() then return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Glaive Toss</Name><Default>false</Default><SpellID>117050</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>local unitHp = 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)

if not IsPlayerSpell(117050) then return false end

if unitHp &amp;lt;= 90 then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Power Shot</Name><Default>false</Default><SpellID>109259</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not IsPlayerSpell(109259) 
then return false end

if not PQR_IsMoving(0.5) 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Barrage</Name><Default>false</Default><SpellID>120360</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not IsPlayerSpell(120360) then return false end

if IsRightControlKeyDown() then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Serpent Sting (focus)</Name><Default>false</Default><SpellID>1978</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;Focus&amp;quot;)
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;Focus&amp;quot;) 
and not UnitDebuffID(&amp;quot;Focus&amp;quot;, 1978, &amp;quot;PLAYER&amp;quot;) then
    return true
end</Lua><RecastDelay>1000</RecastDelay><Target>Focus</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Camouflage</Name><Default>false</Default><SpellID>51753</SpellID><Actions></Actions><Lua>if not UnitBuffID(&amp;quot;player&amp;quot;,51753) then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-- Raid</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Implement PQR_resumeAttack.. this is used to prevent
--abilities lower in the rotation from being cast.
if PQR_resumeAttack == nil then
	PQR_resumeAttack = 0
elseif PQR_resumeAttack &amp;gt; GetTime() then
	return true
else
	PQR_resumeAttack = 0
end


--IMPORTANT: Change this if you have any cleaves that would do damage to a secondary target
--as part of your single target rotation. Better to be safe than sorry! 
--Used for : Spirit Kings

for i=1,4 do
	local bossCheck = &amp;quot;boss&amp;quot;..i
	if UnitExists(bossCheck) then
		local npcID = tonumber(UnitGUID(bossCheck):sub(6,10), 16)
		local bossCasting,_,_,_,_,castEnd = UnitCastingInfo(bossCheck)
		
		if npcID == 62511 or npcID == 62711 then --Amber-Shaper Un&amp;apos;sok or Amber Monstrosity
			local reshapeLife = UnitDebuffID(&amp;quot;vehicle&amp;quot;, 122370)
			local reshapeLife2 = UnitDebuffID(&amp;quot;player&amp;quot;, 122370)
			if reshapeLife or reshapeLife2 then
				local playerCasting = UnitCastingInfo(&amp;quot;vehicle&amp;quot;)
				--grab spell names for abilities:
				local amberExplosion = GetSpellInfo(122402)
				
				--interrupt the target if casting amber explosion
				if bossCasting == amberExplosion then
					TargetUnit(bossCheck)
					--Press the 1st button (Amber Strike)
					RunMacroText(&amp;quot;/click OverrideActionBarButton1&amp;quot;)
				end
				
				--interrupt self if casting amber explosion
				if playerCasting == amberExplosion then
					--Press the 2nd button (Struggle for Control)
					RunMacroText(&amp;quot;/click OverrideActionBarButton2&amp;quot;)
				end
				
				return true --prevent the rotation from executing while reshaped

			end
			
		elseif npcID == 60709 then --Spirit Kings: Qiang. (Impervious Shield)
			--Stop all attacks until 0.2 seconds after cast time ends and until buff (Impervious Shield) is gone.
			
			--only continue checking if we are targetting the boss or have no target.
			if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) then
				local impName = GetSpellInfo(117961)
				local impShieldBuff = UnitBuffID(bossCheck, 117961)
				
				if (bossCasting and bossCasting == impName) then
					StopAttack()
					SpellStopCasting()
					local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
					PQR_resumeAttack = GetTime() + delayAdd + 0.2
					return true
				end
				
				if impShieldBuff then
					StopAttack()
					SpellStopCasting()
					return true
				end
			end
			
		elseif npcID == 60710 then --Spirit Kings: Subetai. (Sleight of Hand)
			--Stop all attacks when casting Sleight of Hand, and until 0.2 seconds after cast time ends.
			--Also stop attacks if not stunned.
			
			--only continue checking if we are targetting the boss or have no target.
			if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or then
				local sleightName = GetSpellInfo(118162)
				local sleightBuff = UnitBuffID(bossCheck, 118162)
				--				  HoJ,   FoJ,  Kidney  
				local stunList = { 853, 105593, 408 }
				local isStunned = nil
				for _,v in ipairs(stunList) do
					local debuffCheck = UnitDebuffID(bossCheck, v)
					if debuffCheck then
						isStunned = true
					end
				end
				
				if (bossCasting and bossCasting == sleightName) then
					StopAttack()
					SpellStopCasting()
					local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
					PQR_resumeAttack = GetTime() + delayAdd + 0.2
					return true
				end
				
				if sleightBuff and not isStunned then
					StopAttack()
					SpellStopCasting()
					return true
				end
			end

		elseif npcID == 60701 then --Spirit Kings: Zian. (Shield of Darkness)
			--Stop all attacks until 0.5 seconds after cast time ends and until buff (Shield of Darkness) is gone.
						
			if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or then
				local sodName = GetSpellInfo(117697)
				local sodBuff = UnitBuffID(bossCheck, 117697)
				
				if (bossCasting and bossCasting == sodName) then
					StopAttack()
					SpellStopCasting()
					local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
					PQR_resumeAttack = GetTime() + delayAdd + 0.5 --0.5 to account for lag... REALLY do not want to set this off.
					return true
				end
				
				if sodBuff then
					StopAttack()
					SpellStopCasting()
					return true
				end
			end
		end
	end
end

--click button to leave.
--Gara&amp;apos;jal isn&amp;apos;t a boss while in the Spirit Realm.
local returnSoul = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,116161))
if returnSoul and returnSoul - GetTime() &amp;lt; 2 then 
	RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Fervor</Name><Default>false</Default><SpellID>82726</SpellID><Actions></Actions><Lua>if not IsPlayerSpell(82726) then return false end

if UnitPower(&amp;quot;player&amp;quot;) &amp;lt;= 45
and UnitPower(&amp;quot;pet&amp;quot;) &amp;lt;= 45 then 
return true end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Concussive Shot</Name><Default>false</Default><SpellID>5116</SpellID><Actions></Actions><Lua>return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>A Murder of Crows (focus)</Name><Default>false</Default><SpellID>131894</SpellID><Actions>/cast Rabid|/cast Blood Fury</Actions><Lua>if not IsPlayerSpell(131894) then return false end

if not UnitDebuffID(&amp;quot;focus&amp;quot;, 131894, &amp;quot;PLAYER&amp;quot;) 
and  UnitHealth(&amp;quot;focus&amp;quot;) &amp;gt; (UnitHealthMax(&amp;quot;player&amp;quot;)*4) then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Focus</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Binding Shot</Name><Default>false</Default><SpellID>109248</SpellID><Actions></Actions><Lua>if not IsPlayerSpell(109248) then return false end

if IsLeftShiftKeyDown()
and not GetCurrentKeyBoardFocus()
then CastSpellByName(tostring(GetSpellInfo(109248)))
if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Misdirection</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitIsPlayer(&amp;quot;target&amp;quot;) == 1 then return false end

local InParty = GetNumGroupMembers()
if InParty == 0 
and UnitExists(&amp;quot;pet&amp;quot;) 
and UnitThreatSituation(&amp;quot;pet&amp;quot;,&amp;quot;target&amp;quot;) ~= 3 
then CastSpellByName(GetSpellInfo(34477),&amp;quot;pet&amp;quot;) else
    local groupType = IsInRaid() 
    and &amp;quot;raid&amp;quot; 
    or &amp;quot;party&amp;quot; 
    for i=1, InParty do
        local member = groupType..i
        if UnitGroupRolesAssigned(member) == &amp;quot;TANK&amp;quot; 
        and UnitThreatSituation(member,&amp;quot;target&amp;quot;) ~= 3 then
            CastSpellByName(GetSpellInfo(34477),member)
        end
    end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Pause--</Name><Default>false</Default><SpellID>0</SpellID><Actions>/stopattack</Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,5384) 
or IsMounted() then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Intimidation</Name><Default>false</Default><SpellID>19577</SpellID><Actions></Actions><Lua>if not IsPlayerSpell(19577) then return false end

if IsLeftShiftKeyDown() then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Wyvern Sting</Name><Default>false</Default><SpellID>19386</SpellID><Actions></Actions><Lua>if not IsPlayerSpell(19386) then return false end

if UnitExists(&amp;quot;Mouseover&amp;quot;)
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;Mouseover&amp;quot;) 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></HUNTER>