<?xml version="1.0" encoding="utf-8" ?><DEATHKNIGHT><Ability><Name>[ MISC ] Pause</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- This profile would never be done without:
-- team_Nova (Mentally, Crystal_Tech and bu_ba_911)
-- D1sc1pl1n3
-- Kinkeh
-- cpowroks
-- Gabbz
-- googlebee
-- Xelper
-- imdasandman
-- kuukuu
-- Ninjaderp
-- Diesall
if PQI:IsHotkeys(PQI_RubimGeneralDeathKnight_Pause1_key)
or PQI:IsHotkeys(PQI_RubimGeneralDeathKnight_Pause2_key)
or IsMounted()
or not PlayerCombat
or UnitInVehicle(&amp;quot;player&amp;quot;)
or UnitIsDeadOrGhost(&amp;quot;player&amp;quot;)
 then
 	return true
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>0 - Auto Cast</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not spellSucced then
	spellSucced = CreateFrame(&amp;quot;Frame&amp;quot;) 
	spellSucced:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
	spellSucced:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if select(7,...)==CheckSpell and select(3,...)==&amp;quot;player&amp;quot; then SpellSucess=true end end)
end

if SpellSucess == true then
	print(&amp;quot;|cff00ffffCast: |r&amp;quot; .. CheckSpell)
	PQR_SendText(&amp;quot;Casted&amp;quot;,CheckSpell)
	CheckSpell = 0
	CastText = nil
	SpellSucess = false
end

if CheckSpell ~= 0
and PQR_SpellAvailable(CheckSpell)
then
	CastSpell(CheckSpell)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Auto Buff</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if CombatTimer == nil
then
	CombatTimer = GetTime()
end

if not PlayerCombat
and not IsMounted()
then
	CombatTimer = GetTime()
	if PQR_SpellAvailable(HornofWinter)
	and HornofWinterBuff == false
	then
		CastSpellByName(GetSpellInfo(HornofWinter))
		return true
	end
	
	
	-- UNHOLY
	if Spec == &amp;quot;Unholy&amp;quot;
	then
		if not PQI_RubimUnholy_UnholyPresence_enable then return false end
			if GetShapeshiftForm() ~= 3
			then CastShapeshiftForm(3)
		end

		if PQR_SpellAvailable(RaiseDead)
		and not UnitExists(&amp;quot;pet&amp;quot;)
		then
			CastSpell(RaiseDead)
		end
	end
	
	-- BLOOD
	if Spec == &amp;quot;Blood&amp;quot;
	then
		if not PQI_RubimBlood_BloodPresence_enable then return false end
			if GetShapeshiftForm() ~= 1
			then CastShapeshiftForm(1)
		end
	end
	
	-- FROST
	if Spec == &amp;quot;Frost&amp;quot;
	then
		if not PQI_RubimFrost_FrostPresence_enable then return false end
			if GetShapeshiftForm() ~= 2
			then CastShapeshiftForm(2)
		end
	end
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Spell List</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- This profile would never be done without:
-- team_Nova (Mentally, Crystal_Tech and bu_ba_911)
-- D1sc1pl1n3
-- Kinkeh
-- cpowroks
-- Gabbz
-- googlebee
-- Xelper
-- imdasandman
-- kuukuu
-- Ninjaderp
-- Diesall
AntiMagicShell = 48707
ArmyoftheDead = 42650
BloodBoil = 48721
BloodPresence = 48263
BloodStrike = 45902
BloodTap = 45529
ChainsofIce = 45524
ControlUndead = 111673
DarkSimulacrum = 77606
DeathCoil = 47541
DeathGrip = 49576
DeathStrike = 49998
DeathandDecay = 43265
EmpowerRuneWeapon = 47568
FrostPresence = 48266
IceboundFortitude = 48792
IcyTouch = 45477
Lichborne = 49039
MindFreeze = 47528
Outbreak = 77575
PathofFrost = 3714
Pestilence = 50842
PlagueStrike = 45462
PlagueLeech = 123693
RaiseAlly = 61999
RaiseDead = 46584
RunicEmpowerment = 81229
Strangulate = 47476
UnholyBlight = 115989
UnholyPresence = 48265
WildMushroom = 113516
BoneShield = 49222
DancingRuneWeapon = 49028
DarkCommand = 56222

--BLOOD
HeartStrike = 55050
RuneStrike = 56815
RuneTap = 48982
SoulReaperBlood = 114866
VampiricBlood = 55233

--FROST
FrostStrike = 49143
HornofWinter = 57330
HowlingBlast = 49184
Obliterate = 49020
PillarofFrost = 51271
SoulReaperFrost = 130735

--UNHOLY
DarkTransformation = 63560
FesteringStrike = 85948
ScourgeStrike = 55090
SoulReaperUnholy = 130736
SummonGargoyle = 49206
UnholyFrenzy = 49016

--TALENT
DeathSiphon = 108196
DeathPact = 48743

Claw = 47468
GargoyleStrike = 51963
Gnaw = 47481
Huddle = 47484
Leap = 47482

--SPECIAL
if UnitBuffID(&amp;quot;player&amp;quot;,HornofWinter) ~= nil
then
	HornofWinterBuff = UnitBuffID(&amp;quot;player&amp;quot;,HornofWinter)
else
	HornofWinterBuff = false
end

-----------------
-- PROCS/BUFFS --
-----------------
LichborneBuff = UnitBuffID(&amp;quot;player&amp;quot;,49039)
VampiricBloodBuff = UnitBuffID(&amp;quot;player&amp;quot;,55233)
Rime = UnitBuffID(&amp;quot;player&amp;quot;,59052)
KillingMachine = UnitBuffID(&amp;quot;player&amp;quot;,51124)
ShadowInfusionBuff,_,_,ShadowInfusionCount = UnitBuffID(&amp;quot;player&amp;quot;, 91342)
CrimsonScourge = UnitBuffID(&amp;quot;player&amp;quot;, 81141)
if not ShadowInfusionBuff
then
	ShadowInfusionCount = 0
end

SuddenDoomBuff = UnitBuffID(&amp;quot;player&amp;quot;,81340)

DarkTransformationBuff,_,_,_,_,_,DarkTransformationTimer = UnitBuffID(&amp;quot;pet&amp;quot;,63560)
if not DarkTransformationBuff
then
	DarkTransformationTimer = 0
else
	DarkTransformationTimer = DarkTransformationTimer - GetTime()
end

BC,_,_,BCCount = UnitBuffID(&amp;quot;player&amp;quot;,114851)

if not BC
then
	BCCount = 0
end


-------------
-- DEBUFFS --
-------------
FF,_,_,_,_,_,FFtimer = UnitDebuffID(&amp;quot;target&amp;quot;,55095,&amp;quot;player&amp;quot;)
BP,_,_,_,_,_,BPtimer = UnitDebuffID(&amp;quot;target&amp;quot;,55078,&amp;quot;player&amp;quot;)


if not BP
then
	BPtimer = 0
else
	BPtimer = BPtimer - GetTime()
end

if not FF
then
	FFtimer = 0
else
	FFtimer = FFtimer - GetTime()
end

function GetID(string)
if &amp;quot;DancingRuneWeapon&amp;quot; == string
	then
		rcastspell = DancingRuneWeapon
	end
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Unholy_Frame: Death Siphon</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimUnholy_DeathSiphon_enable ~= true then return false end
local HealthFrame = tonumber(PQI_RubimUnholy_DeathSiphon_value)

if TargetValidation(&amp;quot;target&amp;quot;,DeathSiphon)
and PlayerHP &amp;lt;= HealthFrame
then
	PQR_DebugP(&amp;quot;Healing with Death Siphon (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(DeathSiphon)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>General_Frame: Trinkets/Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if (PQI_RubimGeneralDeathKnight_Trinket01_enable ~= true
and PQI_RubimGeneralDeathKnight_Trinket02_enable ~= true
and PQI_RubimGeneralDeathKnight_Gloves_enable ~= true)
or not MeeleRange() then return false end

----------------
-- TRINKET 01 --
----------------
if PQI_RubimGeneralDeathKnight_Trinket01_enable == true
and GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13) == 0
and BossCheck()
then
	UseInventoryItem(13)
end

----------------
-- TRINKET 02 --
----------------

if PQI_RubimGeneralDeathKnight_Trinket02_enable == true
and GetInventoryItemCooldown(&amp;quot;player&amp;quot;,14) == 0
and BossCheck()
then
	UseInventoryItem(14)
end

------------
-- GLOVES --
------------
if PQI_RubimGeneralDeathKnight_Gloves_enable == true
and GetInventoryItemCooldown(&amp;quot;player&amp;quot;,10) == 0
and BossCheck()
then
	UseInventoryItem(10)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Unholy_Frame: Dark Succor</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimUnholy_DarkSuccor_enable ~= true then return false end
local HealthFrame = tonumber(PQI_RubimUnholy_DarkSuccor_value)
if BPtimer &amp;gt; 0
and FFtimer &amp;gt; 0
and TargetValidation(&amp;quot;target&amp;quot;,DeathStrike)
and UnitBuffID(&amp;quot;player&amp;quot;,101568)
and PlayerHP &amp;lt;= HealthFrame then
	PQR_DebugP(&amp;quot;Healing with Death Strike (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(DeathStrike)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Unholy - Single Target</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == true then return false end
if PQI_RubimUnholy_Festerblight_enable == true then return false end

-- COMBAT BUFFS
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

if PQR_SpellAvailable(RaiseDead)
and not UnitExists(&amp;quot;pet&amp;quot;)
then
	CastSpell(RaiseDead)
end
		
--COMBAT
if not PlayerCombat then return false end

if not DiseasesSpell then
	DiseasesSpell = CreateFrame(&amp;quot;Frame&amp;quot;) 
	DiseasesSpell:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
	DiseasesSpell:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if (select(7,...)==Outbreak or select(7,...)==PlagueStrike) and select(3,...)==&amp;quot;player&amp;quot; then Dotted=true end end)
end

if Dotted ~= nil
and BPtimer &amp;gt; 0
then
	DotDmg=ActualDotDmg()
	Dotted = nil
end

--actions=auto_attack
--actions+=/blood_fury|beserking,if=time&amp;gt;=2
if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
end

--actions+=/outbreak,if=stat.attack_power&amp;gt;(dot.blood_plague.attack_power+5000)&amp;time&amp;gt;15&amp;!(cooldown.unholy_blight.remains&amp;gt;49)
if BPtimer &amp;gt; 0
and (ActualDotDmg()+10000) &amp;gt; DotDmg
and TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
then
	CastSpell(Outbreak)
end

--actions+=/plague_strike,if=stat.attack_power&amp;gt;(dot.blood_plague.attack_power+5000)&amp;time&amp;gt;15&amp;!(cooldown.unholy_blight.remains&amp;gt;49)
if BPtimer &amp;gt; 0
and (ActualDotDmg()+10000) &amp;gt; DotDmg
and TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
then
	CastSpell(PlagueStrike)
end

--actions+=/mogu_power_potion,if=buff.dark_transformation.up&amp;target.time_to_die&amp;lt;=35
--actions+=/unholy_frenzy,if=time&amp;gt;=4
--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;=32
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 10
and PlayerRP &amp;gt;= 32
then
	CastSpell(BloodTap)
end

---actions+=/unholy_blight,if=talent.unholy_blight.enabled&amp;(dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(UnholyBlight)
end

--actions+=/outbreak,if=dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(Outbreak)
end

--actions+=/soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperUnholy)
then
	CastSpell(SoulReaperUnholy)
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35&amp;cooldown.soul_reaper.remains=0)
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and CdCheck(SoulReaperUnholy) &amp;lt; 1
then
	CastSpell(BloodTap)
end

--actions+=/plague_strike,if=!dot.blood_plague.ticking|!dot.frost_fever.ticking
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
then
	CastSpell(PlagueStrike)
end

--actions+=/summon_gargoyle
if TargetValidation(&amp;quot;target&amp;quot;,SummonGargoyle)
and BossCheck()
then
	CastSpell(SummonGargoyle)
end

--actions+=/dark_transformation
if PQR_SpellAvailable(DarkTransformation)
then
	CastSpell(DarkTransformation)
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.shadow_infusion.stack=5
if PQR_SpellAvailable(BloodTap)
and ShadowInfusionCount == 5
and BCCount &amp;gt;= 5
then
	CastSpell(BloodTap)
end

--actions+=/death_coil,if=runic_power&amp;gt;90
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and PlayerRP &amp;gt; 90
then
	CastSpell(DeathCoil)
end

--actions+=/deathand_decay,if=unholy=2
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(DeathandDecay)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;unholy=2&amp;cooldown.death_and_decay.remains=0
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
and CdCheck(DeathandDecay) &amp;lt; 1
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpell(BloodTap)
end

--actions+=/scourge_strike,if=unholy=2
if TargetValidation(&amp;quot;target&amp;quot;,ScourgeStrike)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
then
	CastSpell(ScourgeStrike)
end

--actions+=/festering_strike,if=blood=2&amp;frost=2
if TargetValidation(&amp;quot;target&amp;quot;,FesteringStrike)
and RuneCheck(&amp;quot;Blood&amp;quot;) == 2
and RuneCheck(&amp;quot;Frost&amp;quot;) == 2
then
	CastSpell(FesteringStrike)
end

--actions+=/death_and_decay
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(DeathandDecay)
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;cooldown.death_and_decay.remains=0
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and (RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;gt;= 1
or RuneCheck(&amp;quot;Death&amp;quot;) &amp;gt;= 1)
and CdCheck(DeathandDecay) &amp;lt; 1
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpell(BloodTap)
end

--actions+=/death_coil,if=buff.sudden_doom.react|(buff.dark_transformation.down&amp;rune.unholy&amp;lt;=1)
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and (SuddenDoomBuff
or (ShadowInfusionCount ~= 5
and RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;lt;= 1
and (CdCheck(SummonGargoyle) &amp;gt; 3 or not BossCheck())))
then
	CastSpell(DeathCoil)
end

--actions+=/scourge_strike
if TargetValidation(&amp;quot;target&amp;quot;,ScourgeStrike)
then
	CastSpell(ScourgeStrike)
end

--actions+=/plague_leech,if=talent.plague_leech.enabled&amp;cooldown.outbreak.remains&amp;lt;1

--actions+=/festering_strike
if TargetValidation(&amp;quot;target&amp;quot;,FesteringStrike)
then
	CastSpell(FesteringStrike)
end

--actions+=/horn_of_winter
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

--actions+=/death_coil,if=buff.dark_transformation.down|(cooldown.summon_gargoyle.remains&amp;gt;8&amp;buff.dark_transformation.remains&amp;gt;8)
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and (ShadowInfusionCount &amp;lt;= 4
or (CdCheck(SummonGargoyle) &amp;gt; 8
and DarkTransformationTimer &amp;gt; 8))
then
	CastSpell(DeathCoil)
end


--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;=8
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt;= 8
then
	CastSpell(BloodTap)
end

--actions+=/empower_rune_weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and MeeleRange()
and BossCheck()
and CdCheck(FesteringStrike) &amp;gt; 1.2
and CdCheck(ScourgeStrike) &amp;gt; 1.2
and PlayerRP &amp;lt; 32
then
	CastSpell(EmpowerRuneWeapon)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Blood_Frame: Death Siphon</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimUnholy_DeathSiphon_enable ~= true then return false end
local HealthFrame = tonumber(PQI_RubimBlood_DeathSiphon_value)

if TargetValidation(&amp;quot;target&amp;quot;,DeathSiphon)
and PlayerHP &amp;lt;= HealthFrame
then
	PQR_DebugP(&amp;quot;Healing with Death Siphon (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(DeathSiphon)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Unholy - Area of Effect</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == false then return false end

-- COMBAT BUFFS
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

if PQR_SpellAvailable(RaiseDead)
and not UnitExists(&amp;quot;pet&amp;quot;)
then
	CastSpell(RaiseDead)
end
		
--COMBAT
if not PlayerCombat then return false end

if not DiseasesSpell then
	DiseasesSpell = CreateFrame(&amp;quot;Frame&amp;quot;) 
	DiseasesSpell:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
	DiseasesSpell:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if (select(7,...)==Outbreak or select(7,...)==PlagueStrike) and select(3,...)==&amp;quot;player&amp;quot; then Dotted=true end end)
end

if Dotted ~= nil
and BPtimer &amp;gt; 0
then
	DotDmg=ActualDotDmg()
	Dotted = nil
end

--actions=auto_attack
--actions+=/blood_fury|beserking,if=time&amp;gt;=2
if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
end

--actions+=/outbreak,if=stat.attack_power&amp;gt;(dot.blood_plague.attack_power+5000)&amp;time&amp;gt;15&amp;!(cooldown.unholy_blight.remains&amp;gt;49)
if BPtimer &amp;gt; 0
and ActualDotDmg() &amp;gt; DotDmg
and TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
then
	CastSpell(Outbreak)
end

--actions+=/plague_strike,if=stat.attack_power&amp;gt;(dot.blood_plague.attack_power+5000)&amp;time&amp;gt;15&amp;!(cooldown.unholy_blight.remains&amp;gt;49)
if BPtimer &amp;gt; 0
and ActualDotDmg() &amp;gt; DotDmg
and TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
then
	CastSpell(PlagueStrike)
end

--actions+=/mogu_power_potion,if=buff.dark_transformation.up&amp;target.time_to_die&amp;lt;=35
--actions+=/unholy_frenzy,if=time&amp;gt;=4
--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;=32
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 10
and PlayerRP &amp;gt;= 32
then
	CastSpell(BloodTap)
end

---actions+=/unholy_blight,if=talent.unholy_blight.enabled&amp;(dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(UnholyBlight)
end

--actions+=/outbreak,if=dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(Outbreak)
end

--actions+=/soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperUnholy)
then
	CastSpell(SoulReaperUnholy)
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35&amp;cooldown.soul_reaper.remains=0)
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and CdCheck(SoulReaperUnholy) &amp;lt; 1
then
	CastSpell(BloodTap)
end

--actions+=/plague_strike,if=!dot.blood_plague.ticking|!dot.frost_fever.ticking
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
then
	CastSpell(PlagueStrike)
end

--actions+=/summon_gargoyle
if TargetValidation(&amp;quot;target&amp;quot;,SummonGargoyle)
and BossCheck()
then
	CastSpell(SummonGargoyle)
end

--actions+=/dark_transformation
if PQR_SpellAvailable(DarkTransformation)
then
	CastSpell(DarkTransformation)
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.shadow_infusion.stack=5
if PQR_SpellAvailable(BloodTap)
and ShadowInfusionCount == 5
and BCCount &amp;gt;= 5
then
	CastSpell(BloodTap)
end

--actions+=/death_coil,if=runic_power&amp;gt;90
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and PlayerRP &amp;gt; 90
then
	CastSpell(DeathCoil)
end

--actions+=/deathand_decay
if PQR_SpellAvailable(DeathandDecay)
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/festering_strike,if=blood&amp;gt;=1|frost&amp;gt;=1
if TargetValidation(&amp;quot;target&amp;quot;,FesteringStrike)
and (RuneCheck(&amp;quot;Blood&amp;quot;) &amp;gt;= 1
or RuneCheck(&amp;quot;Frost&amp;quot;) &amp;gt;= 1)
then
	CastSpell(FesteringStrike)
end

--actions+=/blood_boil
if PQR_SpellAvailable(BloodBoil)
and MeeleRange()
then
	CastSpell(BloodBoil)
end

--actions+=/deathand_decay,if=unholy=2
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(DeathandDecay)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;unholy=2&amp;cooldown.death_and_decay.remains=0
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
and CdCheck(DeathandDecay) &amp;lt; 1
then
	CastSpell(BloodTap)
end

--actions+=/scourge_strike,if=unholy=2
if TargetValidation(&amp;quot;target&amp;quot;,ScourgeStrike)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
then
	CastSpell(ScourgeStrike)
end

--actions+=/festering_strike,if=blood=2&amp;frost=2
if TargetValidation(&amp;quot;target&amp;quot;,FesteringStrike)
and RuneCheck(&amp;quot;Blood&amp;quot;) == 2
and RuneCheck(&amp;quot;Frost&amp;quot;) == 2
then
	CastSpell(FesteringStrike)
end

--actions+=/death_and_decay
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(DeathandDecay)
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;cooldown.death_and_decay.remains=0
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and (RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;gt;= 1
or RuneCheck(&amp;quot;Death&amp;quot;) &amp;gt;= 1)
and CdCheck(DeathandDecay) &amp;lt; 1
then
	CastSpell(BloodTap)
end

--actions+=/death_coil,if=buff.sudden_doom.react|(buff.dark_transformation.down&amp;rune.unholy&amp;lt;=1)
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and (SuddenDoomBuff
or (ShadowInfusionCount ~= 5
and RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;lt;= 1
and (CdCheck(SummonGargoyle) &amp;gt; 3 or not BossCheck())))
then
	CastSpell(DeathCoil)
end

--actions+=/scourge_strike
if TargetValidation(&amp;quot;target&amp;quot;,ScourgeStrike)
then
	CastSpell(ScourgeStrike)
end

--actions+=/plague_leech,if=talent.plague_leech.enabled&amp;cooldown.outbreak.remains&amp;lt;1

--actions+=/festering_strike
if TargetValidation(&amp;quot;target&amp;quot;,FesteringStrike)
then
	CastSpell(FesteringStrike)
end

--actions+=/horn_of_winter
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

--actions+=/death_coil,if=buff.dark_transformation.down|(cooldown.summon_gargoyle.remains&amp;gt;8&amp;buff.dark_transformation.remains&amp;gt;8)
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and (ShadowInfusionCount &amp;lt;= 4
or (CdCheck(SummonGargoyle) &amp;gt; 8
and DarkTransformationTimer &amp;gt; 8))
then
	CastSpell(DeathCoil)
end


--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;=8
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt;= 8
then
	CastSpell(BloodTap)
end

--actions+=/empower_rune_weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and MeeleRange()
and BossCheck()
and CdCheck(FesteringStrike) &amp;gt; 1.2
and CdCheck(ScourgeStrike) &amp;gt; 1.2
and PlayerRP &amp;lt; 32
then
	CastSpell(EmpowerRuneWeapon)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Blood_Frame: Death Pact</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimBlood_DeathPactCombo_enable ~= true then return false end
local HealthFrame = tonumber(PQI_RubimBlood_DeathPactCombo_value)

if PQR_SpellAvailable(DeathPact)
and PQR_SpellAvailable(RaiseDead)
and PlayerHP &amp;lt;= HealthFrame then
	PQR_DebugP(&amp;quot;Casting Raise Dead (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(RaiseDead)
	return true
end

if CdCheck(RaiseDead) &amp;gt;= 60
and PQR_SpellAvailable(DeathPact)
and PlayerHP &amp;lt;= HealthFrame then
	PQR_DebugP(&amp;quot;Casting Death Pact (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(DeathPact)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>General_Frame: Boss Mechanics</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimGeneralDeathKnight_BossMechanics_enable ~= true then return false end

--Implement PQR_resumeAttack.. this is used to prevent
--abilities lower in the rotation from being cast.
if PQR_resumeAttack == nil then
    PQR_resumeAttack = 0
elseif PQR_resumeAttack &amp;gt; GetTime() then
    return true
else
    PQR_resumeAttack = 0
end


--IMPORTANT: Change this if you have any cleaves that would do damage to a secondary target
--as part of your single target rotation. Better to be safe than sorry! 
--Used for : Spirit Kings
local cleaveClass = true
local isAOE = strmatch(strupper(PQR_RotationName), &amp;quot;AOE&amp;quot;) --checks if we are in AOE mode.

for i=1,4 do
    local bossCheck = &amp;quot;boss&amp;quot;..i

    if UnitExists(bossCheck) then
        
        local npcID = tonumber(UnitGUID(bossCheck):sub(6,10), 16)
        local bossCasting,_,_,_,_,castEnd = UnitCastingInfo(bossCheck)
        
        if npcID == 62511 or npcID == 62711 then --Amber-Shaper Un&amp;apos;sok or Amber Monstrosity
            local reshapeName = GetSpellInfo(122370)
            local reshapeLife = UnitDebuff(&amp;quot;player&amp;quot;, reshapeName)
            
            if reshapeLife ~= nil then
                local playerCasting = UnitCastingInfo(&amp;quot;vehicle&amp;quot;)
                local playerCasting2 = UnitCastingInfo(&amp;quot;player&amp;quot;)
                --grab spell names for abilities:
                local amberExplosion = GetSpellInfo(122402)
                
                --interrupt self if casting amber explosion
                if playerCasting == amberExplosion then
                    --Press the 2nd button (Struggle for Control)
                    RunMacroText(&amp;quot;/click OverrideActionBarButton2&amp;quot;)
                    return true
                end
                
                --interrupt self if casting amber explosion
                if playerCasting2 == amberExplosion then
                    --Press the 2nd button (Struggle for Control)
                    RunMacroText(&amp;quot;/click OverrideActionBarButton2&amp;quot;)
                    return true
                end
                
                --interrupt the target if casting amber explosion
                if bossCasting and bossCasting == amberExplosion then
                    TargetUnit(bossCheck)
                    --Press the 1st button (Amber Strike)
                    RunMacroText(&amp;quot;/click OverrideActionBarButton1&amp;quot;)
                    return true
                end
                
                if UnitExists(&amp;quot;boss2&amp;quot;) then
                    if bossCheck == &amp;quot;boss2&amp;quot; then 
                        return true --prevent the rotation from executing while reshaped
                    end
                else
                    return true
                end

            end
            
        elseif npcID == 60709 then --Spirit Kings: Qiang. (Impervious Shield)
            --Stop all attacks until 0.2 seconds after cast time ends and until buff (Impervious Shield) is gone.
            
            --only continue checking if we are targetting the boss or have no target.
            if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or (cleaveClass or isAOE) then
                local impName = GetSpellInfo(117961)
                local impShieldBuff = UnitBuffID(bossCheck, 117961)
                
                if (bossCasting and bossCasting == impName) then
                    StopAttack()
                    SpellStopCasting()
                    local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
                    PQR_resumeAttack = GetTime() + delayAdd + 0.2
                    return true
                end
                
                if impShieldBuff then
                    StopAttack()
                    SpellStopCasting()
                    return true
                end
            end
            
        elseif npcID == 60710 then --Spirit Kings: Subetai. (Sleight of Hand)
            --Stop all attacks when casting Sleight of Hand, and until 0.2 seconds after cast time ends.
            --Also stop attacks if not stunned.
            
            --only continue checking if we are targetting the boss or have no target.
            if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or (cleaveClass or isAOE) then
                local sleightName = GetSpellInfo(118162)
                local sleightBuff = UnitBuffID(bossCheck, 118162)
                --                  HoJ,   FoJ,  Kidney  
                local stunList = { 853, 105593, 408 }
                local isStunned = nil
                for _,v in ipairs(stunList) do
                    local debuffCheck = UnitDebuffID(bossCheck, v)
                    if debuffCheck then
                        isStunned = true
                    end
                end
                
                if (bossCasting and bossCasting == sleightName) then
                    StopAttack()
                    SpellStopCasting()
                    local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
                    PQR_resumeAttack = GetTime() + delayAdd + 0.2
                    return true
                end
                
                if sleightBuff and not isStunned then
                    StopAttack()
                    SpellStopCasting()
                    return true
                end
            end

        elseif npcID == 60701 then --Spirit Kings: Zian. (Shield of Darkness)
            --Stop all attacks until 0.5 seconds after cast time ends and until buff (Shield of Darkness) is gone.
                        
            if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or (cleaveClass or isAOE) then
                local sodName = GetSpellInfo(117697)
                local sodBuff = UnitBuffID(bossCheck, 117697)
                
                if (bossCasting and bossCasting == sodName) then
                    StopAttack()
                    SpellStopCasting()
                    local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
                    PQR_resumeAttack = GetTime() + delayAdd + 0.5 --0.5 to account for lag... REALLY do not want to set this off.
                    return true
                end
                
                if sodBuff then
                    StopAttack()
                    SpellStopCasting()
                    return true
                end
            end
        end
    end
end

--click button to leave.
--Gara&amp;apos;jal isn&amp;apos;t a boss while in the Spirit Realm.
local returnSoul = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,116161))
if returnSoul and returnSoul - GetTime() &amp;lt; 2 then 
    RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) 
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Functions (Unholy)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- This profile would never be done without:
-- team_Nova (Mentally, Crystal_Tech and bu_ba_911)
-- D1sc1pl1n3
-- Kinkeh
-- cpowroks
-- Gabbz
-- googlebee
-- Xelper
-- imdasandman
-- kuukuu
-- Ninjaderp
-- Diesall


-----------------
-- DUMB CHECKS --
-----------------
if  (select(2, UnitClass(&amp;quot;player&amp;quot;)) ~= &amp;quot;DEATHKNIGHT&amp;quot;)
then
	print(&amp;quot;Error: Wrong Class - Expecting Death Knight&amp;quot;)
	PQR_StopRotation()
elseif UnitLevel(&amp;quot;player&amp;quot;) ~= 90
then
	print(&amp;quot;Error: Wrong Level - Expecting LvL 90&amp;quot;)
	PQR_StopRotation()
elseif GetSpecialization() == nil
then
	print(&amp;quot;Error: Wrong Spec - None selected!&amp;quot;)
	PQR_StopRotation()
end

----------------
-- SPEC CHECK --
----------------
if GetSpecialization() == 1 then
	Spec = &amp;quot;Blood&amp;quot;
	PQR_SwapRotation(&amp;quot;Blood (Rubim)&amp;quot;) 
elseif GetSpecialization() == 2 then
	Spec = &amp;quot;Frost&amp;quot;
	if PQI_RubimFrost_FrostDW_enable == false then
		PQR_SwapRotation(&amp;quot;Frost 2H (Rubim)&amp;quot;)
	elseif PQI_RubimFrost_FrostDW_enable == true then
		PQR_SwapRotation(&amp;quot;Frost DW (Rubim)&amp;quot;)
	end
elseif GetSpecialization() == 3 then
	Spec = &amp;quot;Unholy&amp;quot;
	PQR_SwapRotation(&amp;quot;Unholy (Rubim)&amp;quot;)
end

---------------
-- PQI_TEXT --
--------------
function PQR_SendText(CHOICE,SPELL)
	if CHOICE == &amp;quot;Standby&amp;quot;
	then
		PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Standby: &amp;quot; .. RotationMode, nil, &amp;quot;ffffff&amp;quot;)
	end
	
	if CHOICE ~= &amp;quot;Standby&amp;quot;
	and SPELL ~= 0
	then
		local nskill = GetSpellInfo(SPELL)		
		
		if CHOICE == &amp;quot;Queue&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Queue Skill: &amp;quot; .. nskill, nil, &amp;quot;14DCB4&amp;quot;)
		end
		
		if CHOICE == &amp;quot;Casted&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Casted: &amp;quot; .. nskill, nil, &amp;quot;ffffff&amp;quot;)
		end
	end
end

---------------------------------
-- NOVA_DATA.LUA / by TeamNova --
---------------------------------
-- Target Validation Function.
TargetValidation = nil
function TargetValidation(unit, spell)
	if UnitExists(unit)
	 and IsPlayerSpell(spell)
	 and UnitCanAttack(&amp;quot;player&amp;quot;, unit) == 1 
	 and not UnitIsDeadOrGhost(unit) 
	 and not PQR_IsOutOfSight(unit, 1) then
	 	if IsSpellKnown(spell) then  -- Redundent Check to see if Morphed Spell or not
	 		if PQR_SpellAvailable(spell) then
		 		if IsSpellInRange(GetSpellInfo(spell), unit) == 1 then
		 			return true
		 		else
		 			return false
		 		end
		 	else
		 		return false
		 	end
	 	else -- If spell is a morphed spell, return true without Range Check
	 		if select(2, GetSpellCooldown(spell)) == 0 then
	 			return true
	 		end
	 	end
	end
end


--RESOURCES
Nova_UnitInfo = nil
function Nova_UnitInfo(t)
	-- Takes an input of UnitID (player, target, pet, mouseover, etc) and gives you their most useful info
		local TManaActual = UnitPower(t)
		local TMaxMana = UnitPowerMax(t)
		if TMaxMana == 0 then TMaxMana = 1 end			
		local TMana = 100 * UnitPower(t) / TMaxMana
		local THealthActual = UnitHealth(t)
		local THealth = 100 * UnitHealth(t) / UnitHealthMax(t) 
		local myClassPower = 0 
		local PQ_Class = select(2, UnitClass(t)) 
		local PQ_UnitLevel = UnitLevel(t)
		local PQ_CombatCheck = UnitAffectingCombat(t) 
		if PQ_Class == &amp;quot;PALADIN&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 9)
			if UnitBuffID(&amp;quot;player&amp;quot;, 90174) then
				myClassPower = myClassPower + 3
			end
		elseif PQ_Class == &amp;quot;PRIEST&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 13)
		elseif PQ_Class == &amp;quot;WARLOCK&amp;quot; then
			if PQR_Spec == 3 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 14) -- Destruction: Burning Embers
			elseif PQR_Spec == 2 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 15) -- Demonology: Demonic Fury
			elseif PQR_Spec == 1 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 7) -- Affliction: Soul Shards
			end
		elseif PQ_Class == &amp;quot;DRUID&amp;quot; and PQ_Class == 2 then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 8)
		elseif PQ_Class == &amp;quot;MONK&amp;quot;  then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 12)
		elseif PQ_Class == &amp;quot;ROGUE&amp;quot; and t ~= &amp;quot;player&amp;quot; then
			myClassPower = GetComboPoints(&amp;quot;player&amp;quot;, t)
		end
		--       1            2          3         4           5             6          7               8
		return THealth, THealthActual, TMana, TManaActual, myClassPower, PQ_Class, PQ_UnitLevel, PQ_CombatCheck
end

--BOSSCHECK
PQ_BossUnits = {
	-- Cataclysm Dungeons --
	-- Abyssal Maw: Throne of the Tides
	40586,		-- Lady Naz&amp;apos;jar
	40765,		-- Commander Ulthok
	40825,		-- Erunak Stonespeaker
	40788,		-- Mindbender Ghur&amp;apos;sha
	42172,		-- Ozumat
	-- Blackrock Caverns
	39665,		-- Rom&amp;apos;ogg Bonecrusher
	39679,		-- Corla, Herald of Twilight
	39698,		-- Karsh Steelbender
	39700,		-- Beauty
	39705,		-- Ascendant Lord Obsidius
	-- The Stonecore
	43438,		-- Corborus
	43214,		-- Slabhide
	42188,		-- Ozruk
	42333,		-- High Priestess Azil
	-- The Vortex Pinnacle
	43878,		-- Grand Vizier Ertan
	43873,		-- Altairus
	43875,		-- Asaad
	-- Grim Batol
	39625,		-- General Umbriss
	40177,		-- Forgemaster Throngus
	40319,		-- Drahga Shadowburner
	40484,		-- Erudax
	-- Halls of Origination
	39425,		-- Temple Guardian Anhuur
	39428,		-- Earthrager Ptah
	39788,		-- Anraphet
	39587,		-- Isiset
	39731,		-- Ammunae
	39732,		-- Setesh
	39378,		-- Rajh
	-- Lost City of the Tol&amp;apos;vir
	44577,		-- General Husam
	43612,		-- High Prophet Barim
	43614,		-- Lockmaw
	49045,		-- Augh
	44819,		-- Siamat
	-- Zul&amp;apos;Aman
	23574,		-- Akil&amp;apos;zon
	23576,		-- Nalorakk
	23578,		-- Jan&amp;apos;alai
	23577,		-- Halazzi
	24239,		-- Hex Lord Malacrass
	23863,		-- Daakara
	-- Zul&amp;apos;Gurub
	52155,		-- High Priest Venoxis
	52151,		-- Bloodlord Mandokir
	52271,		-- Edge of Madness
	52059,		-- High Priestess Kilnara
	52053,		-- Zanzil
	52148,		-- Jin&amp;apos;do the Godbreaker
	-- End Time
	54431,		-- Echo of Baine
	54445,		-- Echo of Jaina
	54123,		-- Echo of Sylvanas
	54544,		-- Echo of Tyrande
	54432,		-- Murozond
	-- Hour of Twilight
	54590,		-- Arcurion
	54968,		-- Asira Dawnslayer
	54938,		-- Archbishop Benedictus
	-- Well of Eternity
	55085,		-- Peroth&amp;apos;arn
	54853,		-- Queen Azshara
	54969,		-- Mannoroth
	55419,		-- Captain Varo&amp;apos;then
	
	-- Mists of Pandaria Dungeons --
	-- Scarlet Halls
	59303,		-- Houndmaster Braun
	58632,		-- Armsmaster Harlan
	59150,		-- Flameweaver Koegler
	-- Scarlet Monastery
	59789,		-- Thalnos the Soulrender
	59223,		-- Brother Korloff
	3977,		-- High Inquisitor Whitemane
	60040,		-- Commander Durand
	-- Scholomance
	58633,		-- Instructor Chillheart
	59184,		-- Jandice Barov
	59153,		-- Rattlegore
	58722,		-- Lilian Voss
	58791,		-- Lilian&amp;apos;s Soul
	59080,		-- Darkmaster Gandling
	-- Stormstout Brewery
	56637,		-- Ook-Ook
	56717,		-- Hoptallus
	59479,		-- Yan-Zhu the Uncasked
	-- Tempe of the Jade Serpent
	56448,		-- Wise Mari
	56843,		-- Lorewalker Stonestep
	59051,		-- Strife
	59726,		-- Peril
	58826,		-- Zao Sunseeker
	56732,		-- Liu Flameheart
	56762,		-- Yu&amp;apos;lon
	56439,		-- Sha of Doubt
	-- Mogu&amp;apos;shan Palace
	61444,		-- Ming the Cunning
	61442,		-- Kuai the Brute
	61445,		-- Haiyan the Unstoppable
	61243,		-- Gekkan
	61398,		-- Xin the Weaponmaster
	-- Shado-Pan Monastery
	56747,		-- Gu Cloudstrike
	56541,		-- Master Snowdrift
	56719,		-- Sha of Violence
	56884,		-- Taran Zhu
	-- Gate of the Setting Sun
	56906,		-- Saboteur Kip&amp;apos;tilak
	56589,		-- Striker Ga&amp;apos;dok
	56636,		-- Commander Ri&amp;apos;mok
	56877,		-- Raigonn
	-- Siege of Niuzao Temple
	61567,		-- Vizier Jin&amp;apos;bak
	61634,		-- Commander Vo&amp;apos;jak
	61485,		-- General Pa&amp;apos;valak
	62205,		-- Wing Leader Ner&amp;apos;onok

	-- Training Dummies --
	46647,		-- Level 85 Training Dummy
	67127,		-- Level 90 Training Dummy
	
	-- Pandaria Raid Adds --
	63346,		-- Tsulong: The Dark of Night
	62969,		-- Tsulong: Embodied Terror
	62977,		-- Tsulong: Frightspawn
	62919,		-- Tsulong: Unstable Sha
	61034,		-- Sha of Fear: Terror Spawn
	61003		-- Sha of Fear: Dread Spawn
}

SpecialUnit = nil
function SpecialUnit()
	local PQ_BossUnits = PQ_BossUnits
	
	if UnitExists(&amp;quot;target&amp;quot;) then
		local npcID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
		
		-- Dungeons &amp; Raids
		if UnitLevel(&amp;quot;target&amp;quot;) == -1 then return true else
			for i=1,#PQ_BossUnits do
				if PQ_BossUnits[i] == npcID then return true end
			end
			return false
		end
	else return false end
end

---------------
-- VAR SETUP --
---------------
if PQ_DKUHRubim == nil then
	PQ_DKUHRubim = true
	CheckSpell = 0
	SpellSucess = false
	
	-- AOE CHECKS	
	AoERotation = false
	RotationMode = &amp;quot;Single Target&amp;quot;
	
	-- SENDTEXT
	PQR_SendText(&amp;quot;Standby&amp;quot;)
	
	EquippedSet = nil
end

------------------
-- INIT MESSAGE --
------------------
function initMessage()
	PQR_WriteToChat(&amp;quot;|cff91e782Rubim&amp;apos;s Unholy |cff82cee7Loaded!|cffffffff&amp;quot;)
	if PQI_RubimGeneralDeathKnight_UnholySET_enable == true
	then
		UseEquipmentSet(PQI_RubimGeneralDeathKnight_UnholySET_value)
	end
end

-------------------
-- DEBUG OPTIONS --
-------------------
PQR_Rubim_Debug = 0

-------------
-- RACIAL --
------------
function RacialDetection()
	Racial = 0
	local _,Race = UnitRace(&amp;quot;player&amp;quot;)
	if Race == &amp;quot;Orc&amp;quot;
	then
		local Orc_Racial = {
		20572,
		33697,
		33702,
		82836
		}
	
		for i=1, #Orc_Racial do
			if IsSpellKnown(Orc_Racial[i]) then
				Racial = Orc_Racial[i]
			end
		end
	end
end

if Race == &amp;quot;Troll&amp;quot;
then
	Racial = 26297
end

------------------
-- Meele Range --
-----------------
function MeeleRange()
	if IsSpellInRange(GetSpellInfo(45462), &amp;quot;target&amp;quot;) == 1
	then return true else return false
	end
end

----------------
-- CAST SPELL --
----------------
function CastSpell(spell)
	CastSpellByName(GetSpellInfo(spell),nil)
end

if UnitAffectingCombat(&amp;quot;player&amp;quot;)
and PQR_Rubim_Debug ~= 0 then
	if not castspellsucced then
		castspellsucced = CreateFrame(&amp;quot;Frame&amp;quot;) 
		castspellsucced:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
		castspellsucced:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if select(7,...)~= 0 and select(3,...)==&amp;quot;player&amp;quot; then DebugSpell = 1 LastSpell = GetSpellInfo(select(7,...)) end end)
	end
	
	if DebugSpell ~= 0
	then
		PQR_WriteToChat(&amp;quot;Casted: |cffffcc00&amp;quot; .. LastSpell)
		DebugSpell = 0
	end
end

--------------
-- CD Check --
--------------
function CdCheck(spellid)
	Sstart, Sduration, Senabled = GetSpellCooldown(spellid)
	Scooldown = (Sstart + Sduration - GetTime())
	if Sstart == 0
	then
		Scooldown = 0
	end
	return Scooldown
end

-------------
-- PRE POT --
-------------
function PrePot()
	if UnitBuffID(&amp;quot;player&amp;quot;,105706)
	then return true else return false end
end

-- Variables
PQR_ResetMovementTime = 0.3
PQR_SpellAvailableTime = ((select(3,GetNetStats()) + select(4,GetNetStats())) / 1000)

--Player Info
PlayerRP	= select(3, Nova_UnitInfo(&amp;quot;player&amp;quot;))
PlayerHP			= Nova_UnitInfo(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
	
--PQR Functions
isMoving			= PQR_IsMoving()

--Target Info
TargetHP				= select(1, Nova_UnitInfo(&amp;quot;target&amp;quot;))
EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
		
-----------------
-- Time to die --
-----------------
TimeToDie = 999999
if UnitExists(&amp;quot;target&amp;quot;)
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) == 1
and PlayerCombat then
	if (guid ~= UnitGUID(&amp;quot;target&amp;quot;)) or (guid == UnitGUID(&amp;quot;target&amp;quot;) and UnitHealth(&amp;quot;target&amp;quot;) == _firstLifeMax) then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealthMax(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end             
_currentLife = UnitHealth(&amp;quot;target&amp;quot;)
_currentTime = GetTime()
timeDiff = _currentTime - _firstTime
hpDiff = _firstLife - _currentLife
	if hpDiff &amp;gt; 0 then
		fullTime = timeDiff*_firstLifeMax/hpDiff
		pastFirstTime = (_firstLifeMax - _firstLife)*timeDiff/hpDiff
		calcTime = _firstTime - pastFirstTime + fullTime - _currentTime
		if calcTime &amp;lt; 1 then
			calcTime = 1
		end
   	TimeToDie = calcTime
	end
	if hpDiff &amp;lt;= 0 then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealth(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end

-- dummy
	if UnitHealthMax(&amp;quot;target&amp;quot;) == 1 then
		TimeToDie = 99
	end
end

--------------
-- AOE SWAP --
--------------
if Timer == nil then
	Timer = 0
end

if PQI:IsHotkeys(PQI_RubimGeneralDeathKnight_AreaofEffect_key)
and GetTime() - Timer &amp;gt; 0.5
then
	Timer = GetTime()
	if AoERotation == false
	then
		AoERotation = true
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0EArea of Effect|R&amp;quot;)
		RotationMode = &amp;quot;Area of Effect&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	elseif AoERotation == true
	then
		AoERotation = false
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0ESingle Target|R&amp;quot;)
		RotationMode = &amp;quot;Single Target&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	end
end

------------------
-- CONSOLE CAST --
------------------
SLASH_rcast1 = &amp;quot;/rcast&amp;quot;
function SlashCmdList.rcast(rcast, editbox)
	if rcast ~= &amp;quot;All&amp;quot; then
		rcast = tonumber(rcast)
		
		if CheckSpell == 0
		or rcast ~= LastCheckSpell
		then
			CheckSpell = rcast
			LastCheckSpell = rcast
		else
			CheckSpell = 0 end
	
	elseif rcast == &amp;quot;All&amp;quot; then
		CheckSpell = 0
		LastCheckSpell = 0
	else argument = &amp;quot; |CFFFF0303(No arguments)|R&amp;quot;
	end
	if CheckSpell ~= 0 then
		print(&amp;quot;|cff00ffffQueue: |r&amp;quot; .. GetSpellInfo(CheckSpell).. &amp;quot;(&amp;quot; .. CheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Queue&amp;quot;,CheckSpell)
	elseif LastCheckSpell ~= 0 then
		 print(&amp;quot;|cff00ffffRemoved: |r&amp;quot; .. GetSpellInfo(LastCheckSpell).. &amp;quot;(&amp;quot; .. LastCheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Standby&amp;quot;) end
end

if PQR_RotationStarted == true
then
	initMessage()
	RacialDetection()
	RunMacroText(&amp;quot;/rcast All&amp;quot;)
	PQR_RotationStarted = false
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Functions (Blood)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- This profile would never be done without:
-- team_Nova (Mentally, Crystal_Tech and bu_ba_911)
-- D1sc1pl1n3
-- Kinkeh
-- cpowroks
-- Gabbz
-- googlebee
-- Xelper
-- imdasandman
-- kuukuu
-- Ninjaderp
-- Diesall


-----------------
-- DUMB CHECKS --
-----------------
if  (select(2, UnitClass(&amp;quot;player&amp;quot;)) ~= &amp;quot;DEATHKNIGHT&amp;quot;)
then
	print(&amp;quot;Error: Wrong Class - Expecting Death Knight&amp;quot;)
	PQR_StopRotation()
elseif UnitLevel(&amp;quot;player&amp;quot;) ~= 90
then
	print(&amp;quot;Error: Wrong Level - Expecting LvL 90&amp;quot;)
	PQR_StopRotation()
elseif GetSpecialization() == nil
then
	print(&amp;quot;Error: Wrong Spec - None selected!&amp;quot;)
	PQR_StopRotation()
end

----------------
-- SPEC CHECK --
----------------
if GetSpecialization() == 1 then
	Spec = &amp;quot;Blood&amp;quot;
	PQR_SwapRotation(&amp;quot;Blood (Rubim)&amp;quot;) 
elseif GetSpecialization() == 2 then
	Spec = &amp;quot;Frost&amp;quot;
	if PQI_RubimFrost_FrostDW_enable == false then
		PQR_SwapRotation(&amp;quot;Frost 2H (Rubim)&amp;quot;)
	elseif PQI_RubimFrost_FrostDW_enable == true then
		PQR_SwapRotation(&amp;quot;Frost DW (Rubim)&amp;quot;)
	end
elseif GetSpecialization() == 3 then
	Spec = &amp;quot;Unholy&amp;quot;
	PQR_SwapRotation(&amp;quot;Unholy (Rubim)&amp;quot;)
end

---------------
-- PQI_TEXT --
--------------
function PQR_SendText(CHOICE,SPELL)
	if CHOICE == &amp;quot;Standby&amp;quot;
	then
		PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Standby: &amp;quot; .. RotationMode, nil, &amp;quot;ffffff&amp;quot;)
	end
	
	if CHOICE ~= &amp;quot;Standby&amp;quot;
	and SPELL ~= 0
	then
		local nskill = GetSpellInfo(SPELL)		
		
		if CHOICE == &amp;quot;Queue&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Queue Skill: &amp;quot; .. nskill, nil, &amp;quot;14DCB4&amp;quot;)
		end
		
		if CHOICE == &amp;quot;Casted&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Casted: &amp;quot; .. nskill, nil, &amp;quot;ffffff&amp;quot;)
		end
	end
end

---------------------------------
-- NOVA_DATA.LUA / by TeamNova --
---------------------------------
-- Target Validation Function.
TargetValidation = nil
function TargetValidation(unit, spell)
	if UnitExists(unit)
	 and IsPlayerSpell(spell)
	 and UnitCanAttack(&amp;quot;player&amp;quot;, unit) == 1 
	 and not UnitIsDeadOrGhost(unit) 
	 and not PQR_IsOutOfSight(unit, 1) then
	 	if IsSpellKnown(spell) then  -- Redundent Check to see if Morphed Spell or not
	 		if PQR_SpellAvailable(spell) then
		 		if IsSpellInRange(GetSpellInfo(spell), unit) == 1 then
		 			return true
		 		else
		 			return false
		 		end
		 	else
		 		return false
		 	end
	 	else -- If spell is a morphed spell, return true without Range Check
	 		if select(2, GetSpellCooldown(spell)) == 0 then
	 			return true
	 		end
	 	end
	end
end


--RESOURCES
Nova_UnitInfo = nil
function Nova_UnitInfo(t)
	-- Takes an input of UnitID (player, target, pet, mouseover, etc) and gives you their most useful info
		local TManaActual = UnitPower(t)
		local TMaxMana = UnitPowerMax(t)
		if TMaxMana == 0 then TMaxMana = 1 end			
		local TMana = 100 * UnitPower(t) / TMaxMana
		local THealthActual = UnitHealth(t)
		local THealth = 100 * UnitHealth(t) / UnitHealthMax(t) 
		local myClassPower = 0 
		local PQ_Class = select(2, UnitClass(t)) 
		local PQ_UnitLevel = UnitLevel(t)
		local PQ_CombatCheck = UnitAffectingCombat(t) 
		if PQ_Class == &amp;quot;PALADIN&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 9)
			if UnitBuffID(&amp;quot;player&amp;quot;, 90174) then
				myClassPower = myClassPower + 3
			end
		elseif PQ_Class == &amp;quot;PRIEST&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 13)
		elseif PQ_Class == &amp;quot;WARLOCK&amp;quot; then
			if PQR_Spec == 3 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 14) -- Destruction: Burning Embers
			elseif PQR_Spec == 2 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 15) -- Demonology: Demonic Fury
			elseif PQR_Spec == 1 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 7) -- Affliction: Soul Shards
			end
		elseif PQ_Class == &amp;quot;DRUID&amp;quot; and PQ_Class == 2 then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 8)
		elseif PQ_Class == &amp;quot;MONK&amp;quot;  then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 12)
		elseif PQ_Class == &amp;quot;ROGUE&amp;quot; and t ~= &amp;quot;player&amp;quot; then
			myClassPower = GetComboPoints(&amp;quot;player&amp;quot;, t)
		end
		--       1            2          3         4           5             6          7               8
		return THealth, THealthActual, TMana, TManaActual, myClassPower, PQ_Class, PQ_UnitLevel, PQ_CombatCheck
end

--BOSSCHECK
PQ_BossUnits = {
	-- Cataclysm Dungeons --
	-- Abyssal Maw: Throne of the Tides
	40586,		-- Lady Naz&amp;apos;jar
	40765,		-- Commander Ulthok
	40825,		-- Erunak Stonespeaker
	40788,		-- Mindbender Ghur&amp;apos;sha
	42172,		-- Ozumat
	-- Blackrock Caverns
	39665,		-- Rom&amp;apos;ogg Bonecrusher
	39679,		-- Corla, Herald of Twilight
	39698,		-- Karsh Steelbender
	39700,		-- Beauty
	39705,		-- Ascendant Lord Obsidius
	-- The Stonecore
	43438,		-- Corborus
	43214,		-- Slabhide
	42188,		-- Ozruk
	42333,		-- High Priestess Azil
	-- The Vortex Pinnacle
	43878,		-- Grand Vizier Ertan
	43873,		-- Altairus
	43875,		-- Asaad
	-- Grim Batol
	39625,		-- General Umbriss
	40177,		-- Forgemaster Throngus
	40319,		-- Drahga Shadowburner
	40484,		-- Erudax
	-- Halls of Origination
	39425,		-- Temple Guardian Anhuur
	39428,		-- Earthrager Ptah
	39788,		-- Anraphet
	39587,		-- Isiset
	39731,		-- Ammunae
	39732,		-- Setesh
	39378,		-- Rajh
	-- Lost City of the Tol&amp;apos;vir
	44577,		-- General Husam
	43612,		-- High Prophet Barim
	43614,		-- Lockmaw
	49045,		-- Augh
	44819,		-- Siamat
	-- Zul&amp;apos;Aman
	23574,		-- Akil&amp;apos;zon
	23576,		-- Nalorakk
	23578,		-- Jan&amp;apos;alai
	23577,		-- Halazzi
	24239,		-- Hex Lord Malacrass
	23863,		-- Daakara
	-- Zul&amp;apos;Gurub
	52155,		-- High Priest Venoxis
	52151,		-- Bloodlord Mandokir
	52271,		-- Edge of Madness
	52059,		-- High Priestess Kilnara
	52053,		-- Zanzil
	52148,		-- Jin&amp;apos;do the Godbreaker
	-- End Time
	54431,		-- Echo of Baine
	54445,		-- Echo of Jaina
	54123,		-- Echo of Sylvanas
	54544,		-- Echo of Tyrande
	54432,		-- Murozond
	-- Hour of Twilight
	54590,		-- Arcurion
	54968,		-- Asira Dawnslayer
	54938,		-- Archbishop Benedictus
	-- Well of Eternity
	55085,		-- Peroth&amp;apos;arn
	54853,		-- Queen Azshara
	54969,		-- Mannoroth
	55419,		-- Captain Varo&amp;apos;then
	
	-- Mists of Pandaria Dungeons --
	-- Scarlet Halls
	59303,		-- Houndmaster Braun
	58632,		-- Armsmaster Harlan
	59150,		-- Flameweaver Koegler
	-- Scarlet Monastery
	59789,		-- Thalnos the Soulrender
	59223,		-- Brother Korloff
	3977,		-- High Inquisitor Whitemane
	60040,		-- Commander Durand
	-- Scholomance
	58633,		-- Instructor Chillheart
	59184,		-- Jandice Barov
	59153,		-- Rattlegore
	58722,		-- Lilian Voss
	58791,		-- Lilian&amp;apos;s Soul
	59080,		-- Darkmaster Gandling
	-- Stormstout Brewery
	56637,		-- Ook-Ook
	56717,		-- Hoptallus
	59479,		-- Yan-Zhu the Uncasked
	-- Tempe of the Jade Serpent
	56448,		-- Wise Mari
	56843,		-- Lorewalker Stonestep
	59051,		-- Strife
	59726,		-- Peril
	58826,		-- Zao Sunseeker
	56732,		-- Liu Flameheart
	56762,		-- Yu&amp;apos;lon
	56439,		-- Sha of Doubt
	-- Mogu&amp;apos;shan Palace
	61444,		-- Ming the Cunning
	61442,		-- Kuai the Brute
	61445,		-- Haiyan the Unstoppable
	61243,		-- Gekkan
	61398,		-- Xin the Weaponmaster
	-- Shado-Pan Monastery
	56747,		-- Gu Cloudstrike
	56541,		-- Master Snowdrift
	56719,		-- Sha of Violence
	56884,		-- Taran Zhu
	-- Gate of the Setting Sun
	56906,		-- Saboteur Kip&amp;apos;tilak
	56589,		-- Striker Ga&amp;apos;dok
	56636,		-- Commander Ri&amp;apos;mok
	56877,		-- Raigonn
	-- Siege of Niuzao Temple
	61567,		-- Vizier Jin&amp;apos;bak
	61634,		-- Commander Vo&amp;apos;jak
	61485,		-- General Pa&amp;apos;valak
	62205,		-- Wing Leader Ner&amp;apos;onok

	-- Training Dummies --
	46647,		-- Level 85 Training Dummy
	67127,		-- Level 90 Training Dummy
	
	-- Pandaria Raid Adds --
	63346,		-- Tsulong: The Dark of Night
	62969,		-- Tsulong: Embodied Terror
	62977,		-- Tsulong: Frightspawn
	62919,		-- Tsulong: Unstable Sha
	61034,		-- Sha of Fear: Terror Spawn
	61003		-- Sha of Fear: Dread Spawn
}

SpecialUnit = nil
function SpecialUnit()
	local PQ_BossUnits = PQ_BossUnits
	
	if UnitExists(&amp;quot;target&amp;quot;) then
		local npcID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
		
		-- Dungeons &amp; Raids
		if UnitLevel(&amp;quot;target&amp;quot;) == -1 then return true else
			for i=1,#PQ_BossUnits do
				if PQ_BossUnits[i] == npcID then return true end
			end
			return false
		end
	else return false end
end

---------------
-- VAR SETUP --
---------------
if PQ_DKUHRubim == nil then
	PQ_DKUHRubim = true
	CheckSpell = 0
	SpellSucess = false
	
	-- AOE CHECKS	
	AoERotation = false
	RotationMode = &amp;quot;Single Target&amp;quot;
	
	-- SENDTEXT
	PQR_SendText(&amp;quot;Standby&amp;quot;)
end

------------------
-- INIT MESSAGE --
------------------
function initMessage()
	PQR_WriteToChat(&amp;quot;|cff91e782Rubim&amp;apos;s Blood |cff82cee7Loaded!|cffffffff&amp;quot;)
	if PQI_RubimGeneralDeathKnight_BloodSET_enable == true
	then
		UseEquipmentSet(PQI_RubimGeneralDeathKnight_BloodSET_value)
	end
end

-------------------
-- DEBUG OPTIONS --
-------------------
PQR_Rubim_Debug = 0

-------------
-- RACIAL --
------------
function RacialDetection()
	Racial = 0
	local _,Race = UnitRace(&amp;quot;player&amp;quot;)
	if Race == &amp;quot;Orc&amp;quot;
	then
		local Orc_Racial = {
		20572,
		33697,
		33702,
		82836
		}
	
		for i=1, #Orc_Racial do
			if IsSpellKnown(Orc_Racial[i]) then
				Racial = Orc_Racial[i]
			end
		end
	end
end

if Race == &amp;quot;Troll&amp;quot;
then
	Racial = 26297
end

------------------
-- Meele Range --
-----------------
function MeeleRange()
	if IsSpellInRange(GetSpellInfo(45462), &amp;quot;target&amp;quot;) == 1
	then return true else return false
	end
end

----------------
-- CAST SPELL --
----------------
function CastSpell(spell)
	CastSpellByName(GetSpellInfo(spell),nil)
end

if UnitAffectingCombat(&amp;quot;player&amp;quot;)
and PQR_Rubim_Debug ~= 0 then
	if not castspellsucced then
		castspellsucced = CreateFrame(&amp;quot;Frame&amp;quot;) 
		castspellsucced:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
		castspellsucced:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if select(7,...)~= 0 and select(3,...)==&amp;quot;player&amp;quot; then DebugSpell = 1 LastSpell = GetSpellInfo(select(7,...)) end end)
	end
	
	if DebugSpell ~= 0
	then
		PQR_WriteToChat(&amp;quot;Casted: |cffffcc00&amp;quot; .. LastSpell)
		DebugSpell = 0
	end
end

--------------
-- CD Check --
--------------
function CdCheck(spellid)
	Sstart, Sduration, Senabled = GetSpellCooldown(spellid)
	Scooldown = (Sstart + Sduration - GetTime())
	if Sstart == 0
	then
		Scooldown = 0
	end
	return Scooldown
end

-------------
-- PRE POT --
-------------
function PrePot()
	if UnitBuffID(&amp;quot;player&amp;quot;,105706)
	then return true else return false end
end

-- Variables
PQR_ResetMovementTime = 0.3
PQR_SpellAvailableTime = ((select(3,GetNetStats()) + select(4,GetNetStats())) / 1000)

--Player Info
PlayerRP	= select(3, Nova_UnitInfo(&amp;quot;player&amp;quot;))
PlayerHP			= Nova_UnitInfo(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
	
--PQR Functions
isMoving			= PQR_IsMoving()

--Target Info
TargetHP				= select(1, Nova_UnitInfo(&amp;quot;target&amp;quot;))
EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
		
-----------------
-- Time to die --
-----------------
TimeToDie = 999999
if UnitExists(&amp;quot;target&amp;quot;)
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) == 1
and PlayerCombat then
	if (guid ~= UnitGUID(&amp;quot;target&amp;quot;)) or (guid == UnitGUID(&amp;quot;target&amp;quot;) and UnitHealth(&amp;quot;target&amp;quot;) == _firstLifeMax) then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealthMax(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end             
_currentLife = UnitHealth(&amp;quot;target&amp;quot;)
_currentTime = GetTime()
timeDiff = _currentTime - _firstTime
hpDiff = _firstLife - _currentLife
	if hpDiff &amp;gt; 0 then
		fullTime = timeDiff*_firstLifeMax/hpDiff
		pastFirstTime = (_firstLifeMax - _firstLife)*timeDiff/hpDiff
		calcTime = _firstTime - pastFirstTime + fullTime - _currentTime
		if calcTime &amp;lt; 1 then
			calcTime = 1
		end
   	TimeToDie = calcTime
	end
	if hpDiff &amp;lt;= 0 then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealth(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end

-- dummy
	if UnitHealthMax(&amp;quot;target&amp;quot;) == 1 then
		TimeToDie = 99
	end
end

--------------
-- AOE SWAP --
--------------
if Timer == nil then
	Timer = 0
end

if PQI:IsHotkeys(PQI_RubimGeneralDeathKnight_AreaofEffect_key)
and GetTime() - Timer &amp;gt; 0.5
then
	Timer = GetTime()
	if AoERotation == false
	then
		AoERotation = true
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0EArea of Effect|R&amp;quot;)
		RotationMode = &amp;quot;Area of Effect&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	elseif AoERotation == true
	then
		AoERotation = false
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0ESingle Target|R&amp;quot;)
		RotationMode = &amp;quot;Single Target&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	end
end

------------------
-- CONSOLE CAST --
------------------
SLASH_rcast1 = &amp;quot;/rcast&amp;quot;
function SlashCmdList.rcast(rcast, editbox)
	if rcast ~= &amp;quot;All&amp;quot; then
		rcast = tonumber(rcast)
		
		if CheckSpell == 0
		or rcast ~= LastCheckSpell
		then
			CheckSpell = rcast
			LastCheckSpell = rcast
		else
			CheckSpell = 0 end
	
	elseif rcast == &amp;quot;All&amp;quot; then
		CheckSpell = 0
		LastCheckSpell = 0
	else argument = &amp;quot; |CFFFF0303(No arguments)|R&amp;quot;
	end
	if CheckSpell ~= 0 then
		print(&amp;quot;|cff00ffffQueue: |r&amp;quot; .. GetSpellInfo(CheckSpell).. &amp;quot;(&amp;quot; .. CheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Queue&amp;quot;,CheckSpell)
	elseif LastCheckSpell ~= 0 then
		 print(&amp;quot;|cff00ffffRemoved: |r&amp;quot; .. GetSpellInfo(LastCheckSpell).. &amp;quot;(&amp;quot; .. LastCheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Standby&amp;quot;) end
end

if PQR_RotationStarted == true
then
	initMessage()
	RacialDetection()
	RunMacroText(&amp;quot;/rcast All&amp;quot;)
	PQR_RotationStarted = false
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Blood - Single Target</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == true then return false end

--3	0.00	horn_of_winter
if not HornofWinterBuff
then
	CastSpell(HornofWinter)
end


--COMBAT
if not PlayerCombat then return false end

--A	6.88	pillar_of_frost
--B	1.00	mogu_power_potion,if=target.time_to_die&amp;lt;=30|(target.time_to_die&amp;lt;=60&amp;buff.pillar_of_frost.up)
--C	3.31	raise_dead

if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
end

-- Bone Shield
if PQR_SpellAvailable(BoneShield)
and not BoneShieldBuff
then
	CastSpell(BoneShield)
end

-- Outbreak
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(Outbreak)
end

-- Icy Touch
if TargetValidation(&amp;quot;target&amp;quot;,IcyTouch)
and FFtimer == 0
then
	CastSpell(IcyTouch)
end

-- Plague Strike
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
then
	CastSpell(PlagueStrike)
end

-- DeathStrike
if TargetValidation(&amp;quot;target&amp;quot;,DeathStrike)
then
	CastSpell(DeathStrike)
end

-- Rune Strike
if TargetValidation(&amp;quot;target&amp;quot;,RuneStrike)
and (ResourceSave(RuneStrike) or CdCheck(DancingRuneWeapon) &amp;gt; 1)
and (RuneCheck(&amp;quot;Blood&amp;quot;) &amp;lt; 2
or RuneCheck(&amp;quot;Death&amp;quot;) &amp;lt; 2
or RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;lt; 2)
then
	CastSpell(RuneStrike)
	return true
end

-- Blood Boil (Proc)
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(BloodBoil)
and CrimsonScourge
and MeeleRange()
and PlayerRP &amp;lt;= 80
then
	CastSpell(BloodBoil)
end

-- Soul Reaper
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperBlood)
then
	CastSpell(SoulReaperBlood)
end

-- Hearth Strike
if TargetValidation(&amp;quot;target&amp;quot;,HeartStrike)
and RuneCheck(&amp;quot;Blood&amp;quot;) &amp;gt; 0
then
	CastSpell(HeartStrike)
end

-- Empower Rune Weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and RuneCheck(&amp;quot;Blood&amp;quot;) == 0
and CdCheck(DeathStrike) &amp;gt; 1.2
then
	CastSpell(EmpowerRuneWeapon)
end

-- Horn
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Blood - Area of Effect</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == false then return false end

--3	0.00	horn_of_winter
if not HornofWinterBuff
then
	CastSpell(HornofWinter)
end


--COMBAT
if not PlayerCombat then return false end

--A	6.88	pillar_of_frost
--B	1.00	mogu_power_potion,if=target.time_to_die&amp;lt;=30|(target.time_to_die&amp;lt;=60&amp;buff.pillar_of_frost.up)
--C	3.31	raise_dead

if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
end

-- Bone Shield
if PQR_SpellAvailable(BoneShield)
and not BoneShieldBuff
then
	CastSpell(BoneShield)
end

-- Outbreak
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(Outbreak)
end

-- Icy Touch
if TargetValidation(&amp;quot;target&amp;quot;,IcyTouch)
and FFtimer == 0
then
	CastSpell(IcyTouch)
end

-- Plague Strike
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
then
	CastSpell(PlagueStrike)
end

-- DeathStrike
if TargetValidation(&amp;quot;target&amp;quot;,DeathStrike)
then
	CastSpell(DeathStrike)
end

-- Rune Strike
if TargetValidation(&amp;quot;target&amp;quot;,RuneStrike)
and (CheckSpell ~= DancingRuneWeapon or CdCheck(DancingRuneWeapon) &amp;gt; 1)
and (RuneCheck(&amp;quot;Blood&amp;quot;) &amp;lt; 2
or RuneCheck(&amp;quot;Death&amp;quot;) &amp;lt; 2
or RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;lt; 2)
then
	CastSpell(RuneStrike)
	return true
end

-- DND
if PQR_SpellAvailable(DeathandDecay)
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

-- Blood Boil (Proc)
if PQR_SpellAvailable(BloodBoil)
and MeeleRange()
and (RuneCheck(&amp;quot;Blood&amp;quot;) &amp;gt; 0
or RuneCheck(&amp;quot;Death&amp;quot;) &amp;gt; 2)
and PlayerRP &amp;lt;= 80
then
	CastSpell(BloodBoil)
end

-- Soul Reaper
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperBlood)
then
	CastSpell(SoulReaperBlood)
end

-- Empower Rune Weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and RuneCheck(&amp;quot;Blood&amp;quot;) == 0
and CdCheck(DeathStrike) &amp;gt; 1.2
then
	CastSpell(EmpowerRuneWeapon)
end

-- Horn
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Death_Knight Stats</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if DKStatsVar ~= nil
then
	DotDmg 				  = 0
	BloodPlagueDMG			= 0
	mastery, crit, ap, pmod   = 0, 0, 0, 0
	cinderglacier             = false
	me, class, spec           = 0, 0, 0
	timer, throttle           = 0, 0.1
	DKStatsVar = true
end

function ActualDotDmg()
	local Mastery 			= GetMastery()
	local CriticalChance	= GetCritChance()
	local Power				= select(7,UnitDamage(&amp;quot;player&amp;quot;))
	local AttackPower		= select(1,UnitAttackPower(&amp;quot;player&amp;quot;)) + select(2,UnitAttackPower(&amp;quot;player&amp;quot;)) + select(3,UnitAttackPower(&amp;quot;player&amp;quot;))
	
	local DotTicks, DotTicksSecond, DotTicksDamage, DotDuration, DotDamage, DotDPS
	
	--Blood Plague
	local DotTicks = 10
	local DotTicksSecond = 3
	local DotTicksDamage = 172 + 0.138 * AttackPower
	local DotDuration = DotTicks * DotTicksSecond
	
	if Spec == &amp;quot;Unholy&amp;quot;
	then
		DotDamage = (DotTicksDamage * DotTicks) * (1 + CriticalChance / 100) * (1 + (2.5 * Mastery) / 100) * Power
		return DotDamage
	end	
	
	if Spec == &amp;quot;Blood&amp;quot; or Spec == &amp;quot;Frost&amp;quot;
	then
		DotDamage = (DotTicksDamage * DotTicks) * (1 + CriticalChance / 100) * Power
		return DotDamage
	end	
end

-------------
-- BOSS CD --
-------------
function BossCheck()
	if PQI_RubimGeneralDeathKnight_CDBossOnly_enable == false
	and PQI_RubimGeneralDeathKnight_CDDisable_enable == false
	then return true
	end
	
	if PQI_RubimGeneralDeathKnight_CDBossOnly_enable == true
	and PQI_RubimGeneralDeathKnight_CDDisable_enable == false
	and SpecialUnit()
		then return true	
	end
	return false
end

-- Variables
PQR_ResetMovementTime = 0.3
PQR_SpellAvailableTime = ((select(3,GetNetStats()) + select(4,GetNetStats())) / 1000)

--Player Info
PlayerRP	= select(3, Nova_UnitInfo(&amp;quot;player&amp;quot;))
PlayerHP			= Nova_UnitInfo(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
	
--PQR Functions
isMoving			= PQR_IsMoving()

--Target Info
TargetHP				= select(1, Nova_UnitInfo(&amp;quot;target&amp;quot;))
EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)

RuneCheck = nil
function RuneCheck(Rune)
	FrostRune = 0
	UnholyRune = 0
	BloodRune = 0
	DeathRune = 0
	for i=1, 6 do
		if GetRuneType(i) == 1 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; 0 then 
		   BloodRune = BloodRune + 1
		end
		if GetRuneType(i) == 2 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; 0 then 
		   UnholyRune = UnholyRune + 1
		end
		if GetRuneType(i) == 3 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; 0 then 
		   FrostRune = FrostRune + 1
		end
		if GetRuneType(i) == 4 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; 0 then 
		   DeathRune = DeathRune + 1
		end
	end
	
	if Rune == nil
	then	
		return BloodRune, UnholyRune, FrostRune, DeathRune
	end
	
	if Rune == &amp;quot;Unholy&amp;quot;
	then
		return UnholyRune
	end
	
	if Rune == &amp;quot;Blood&amp;quot;
	then
		return BloodRune
	end
	
	if Rune == &amp;quot;Frost&amp;quot;
	then
		return FrostRune
	end
	
	if Rune == &amp;quot;Death&amp;quot;
	then
		return DeathRune
	end
end

RuneHalfCD = nil
function RuneHalfCD()
	FrostRuneHalf = 0
	UnholyRuneHalf = 0
	BloodRuneHalf = 0
	DeathRuneHalf = 0
	for i=1, 6 do
		if GetRuneType(i) == 1 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; ((select(2,GetRuneCooldown(i)) * 15) / 100) then 
		   BloodRuneHalf = BloodRuneHalf + 1
		end
		if GetRuneType(i) == 2 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; ((select(2,GetRuneCooldown(i)) * 15) / 100) then 
		   UnholyRuneHalf = UnholyRuneHalf + 1
		end
		if GetRuneType(i) == 3 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; ((select(2,GetRuneCooldown(i)) * 15) / 100) then 
		   FrostRuneHalf = FrostRuneHalf + 1
		end
		if GetRuneType(i) == 4 and select(1,GetRuneCooldown(i)) + select(2,GetRuneCooldown(i)) - GetTime() &amp;lt; ((select(2,GetRuneCooldown(i)) * 15) / 100) then 
		   DeathRuneHalf = DeathRuneHalf + 1
		end
	end
	return BloodRuneHalf, UnholyRuneHalf, FrostRuneHalf, DeathRuneHalf
end

function ResourceSave(Spell)
	if CheckSpell == 0
	then
		return true
	end

	if CheckSpell == ArmyoftheDead
	then
		if Spell == Obliterate
		or Spell == PlagueStriek
		or Spell == IcyTouch
		or Spell == HowlingBlast
		or Spell == DeathandDecay
		then
			return false
		else
			return true
		end
	end
	
	if CheckSpell == DancingRuneWeapon
	then
		if Spell == RuneStrike
		or Spell == FrostStrike
		then
			return false
		else
			return true
		end
	end
	
	if CheckSpell == IceboundFortitude
	then
		if Spell == FrostStrike
		or Spell == RuneStrike
		then
			return false
		else
			return true
		end
	end
	
	if CheckSpell ~= 0
	then
		return true
	end
	
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Diesell_Frame</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if RUBIM_GENERALDK
and RUBIM_BLOOD
and RUBIM_UNHOLY
and RUBIM_FROST then return false end

local config = {
	name	= &amp;apos;General Death Knight&amp;apos;,
	author	= &amp;apos;Rubim&amp;apos;,
	abilities = {
		{ 	name = &amp;quot;Disable Cleave&amp;quot;,
			enable = false,
		},
		{ 	name = &amp;quot;Healthstone&amp;quot;,			newSection = true,
			enable = true,
			widget = { type = &amp;apos;numBox&amp;apos;,
				value = 20,
				step = 5,
			},
		},
		{ 	name = &amp;quot;Blood SET&amp;quot;,			newSection = true,
			enable = true,
			widget = { type = &amp;apos;txtBox&amp;apos;,
				value = &amp;apos;BloodSET&amp;apos;,
				tooltip = &amp;quot;Name of your Blood according to your EQUIPMENT manager&amp;quot;
			},
		},		
		{ 	name = &amp;quot;Frost SET&amp;quot;,
			enable = true,
			widget = { type = &amp;apos;txtBox&amp;apos;,
				value = &amp;apos;FrostSET&amp;apos;,
				tooltip = &amp;quot;Name of your Frost according to your EQUIPMENT manager&amp;quot;
			},
		},		
		{ 	name = &amp;quot;Unholy SET&amp;quot;,
			enable = true,
			widget = { type = &amp;apos;txtBox&amp;apos;,
				value = &amp;apos;UnholySET&amp;apos;,
				tooltip = &amp;quot;Name of your Blood according to your EQUIPMENT manager&amp;quot;
			},
		},		
		{ 	name = &amp;quot;Trinket 01&amp;quot;,			newSection = true,
			enable = false,
		},
		{ 	name = &amp;quot;Trinket 02&amp;quot;,			newSection = false,
			enable = false,
		},
		{ 	name = &amp;quot;Gloves&amp;quot;,				newSection = false,
			enable = false,
		},
		
		{ 	name = &amp;quot;Auto Dispell&amp;quot;,			newSection = true,
			enable = false,
		},
		{ 	name = &amp;quot;Boss Mechanics&amp;quot;,		newSection = false,
			enable = false,
		},
		{ 	name = &amp;quot;CD Boss Only&amp;quot;,			newSection = false,
			enable = true,
		},
		{ 	name = &amp;quot;CD Disable&amp;quot;,			newSection = false,
			enable = false,
		},
		
	},
	hotkeys = {
		{	name = &amp;quot;Area of Effect&amp;quot;,	enable = true,	hotkeys = {	&amp;apos;rs&amp;apos; },	},
		{	name = &amp;quot;Pause 1&amp;quot;,			enable = true,	hotkeys = {	&amp;apos;ls&amp;apos;	},	},
		{	name = &amp;quot;Pause 2&amp;quot;,			enable = true,	hotkeys = {	 &amp;apos;lc&amp;apos;	},	}, 
	},
}
RUBIM_GENERALDK = PQI:AddRotation(config)

-------------------
-- DIESELL FRAME --
-------------------

local config = {
	name	= &amp;apos;Blood&amp;apos;,
	author	= &amp;apos;Rubim&amp;apos;,
	abilities = {
		{	name = &amp;quot;Blood Presence&amp;quot;,
			enable = true,
		},
		{ 	name = &amp;quot;Death Siphon&amp;quot;, 			newSection = true,
			enable = false,
			widget = { type = &amp;apos;numBox&amp;apos;,
				value = 50,
				step = 5,
				tooltip = &amp;quot;You need to have the apropriate talent to use this&amp;quot;,
			},
		},
		{ 	name = &amp;quot;Death Pact Combo&amp;quot;,
			enable = false,
			widget = { type = &amp;apos;numBox&amp;apos;,
				value = 15,
				step = 5,
				tooltip = &amp;quot;You need the Death Pact talent for this&amp;quot;,
			},
		},
		{	name = &amp;quot;Rune Tap&amp;quot;,
			enable = true,
		},
	},
	hotkeys = {
	},
}
RUBIM_BLOOD = PQI:AddRotation(config)

-------------------
-- DIESELL FRAME --
-------------------
local config = {
	name	= &amp;apos;Frost&amp;apos;,
	author	= &amp;apos;Rubim&amp;apos;,
	abilities = {
		{	name = &amp;quot;Frost Presence&amp;quot;,
			enable = true,
		},
		{	name = &amp;quot;Frost DW&amp;quot;,
			enable = false,
		},
		{ 	name = &amp;quot;Dark Succor&amp;quot;, 			newSection = true,
			enable = true,
			widget = { type = &amp;apos;numBox&amp;apos;,
				value = 90,
				step = 5,
				tooltip = &amp;quot;Only works if you have Dark succor Glyphed&amp;quot;,
			},
		},
		{ 	name = &amp;quot;Death Siphon&amp;quot;,
			enable = false,
			widget = { type = &amp;apos;numBox&amp;apos;,
				value = 50,
				step = 5,
				tooltip = &amp;quot;You need to have the apropriate talent to use this&amp;quot;,
			},
		},
	},
	hotkeys = {
	},
}
RUBIM_FROST = PQI:AddRotation(config)

-------------------
-- DIESELL FRAME --
-------------------
local config = {
	name	= &amp;apos;Unholy&amp;apos;,
	author	= &amp;apos;Rubim&amp;apos;,
	abilities = {
		{	name = &amp;quot;Unholy Presence&amp;quot;,
			enable = true,
		},
		{	name = &amp;quot;Festerblight&amp;quot;,
			enable = true,
		},
		{ 	name = &amp;quot;Dark Succor&amp;quot;, 			newSection = true,
			enable = true,
			widget = { type = &amp;apos;numBox&amp;apos;,
				value = 90,
				step = 5,
				tooltip = &amp;quot;Only works if you have Dark succor Glyphed&amp;quot;,
			},
		},
		{ 	name = &amp;quot;Death Siphon&amp;quot;,
			enable = false,
			widget = { type = &amp;apos;numBox&amp;apos;,
				value = 50,
				step = 5,
				tooltip = &amp;quot;You need to have the apropriate talent to use this&amp;quot;,
			},
		},
	},
	hotkeys = {
	},
}
RUBIM_UNHOLY = PQI:AddRotation(config)</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Genera_Frame: Auto Dispell</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Thanks to Cpoworks / Kaylo

--if GlyphCheck(43546) == false then return false end
if PQI_RubimGeneralDeathKnight_AutoDispell_enable ~= true or not UnitExists(&amp;quot;target&amp;quot;) then return false end

--DISPELL
local DispellList = {
117283, -- Corrupted water (Protectors)
122149, -- Quickening (Wind Lord)
117697 -- Shield of Darkness (Spirit Kings)
}

for i=1, #DispellList do
	if UnitBuffID(&amp;quot;target&amp;quot;, DispellList[i]) ~= nil
	then
		DispellName = GetSpellInfo(DispellList[i])
		IcyDispell = 1
	end
end

if IcyDispell ~= 1 then return false end

if IcyDispell ~= nil
and TargetValidation(&amp;quot;target&amp;quot;,IcyTouch)
then
	PQR_DebugP(&amp;quot;Dispelling : &amp;quot; .. DispellName .. &amp;quot; on &amp;quot; .. UnitName(&amp;quot;target&amp;quot;))
	CastSpell(IcyTouch)
	IcyDispell = nil
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>General_Frame: Healthstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimGeneralDeathKnight_Healthstone_enable ~= true then return false end
local HealthFrame = tonumber(PQI_RubimGeneralDeathKnight_Healthstone_value)

if GetItemCount(5512,false,true) &amp;gt; 0
	and PlayerHP &amp;lt;= HealthFrame
	and PQR_SpellAvailable(5512)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and GetItemCooldown(5512) == 0
then
	PQR_DebugP(&amp;quot;Healing with Healthstone (Current HP: &amp;quot; .. PlayerHP)
	UseItemByName(5512)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Blood_Frame: Rune Tap</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimBlood_RuneTap_enable ~= true then return false end

if PQR_SpellAvailable(RuneTap)
and VampiricBloodBuff then
	PQR_DebugP(&amp;quot;Healing with Rune Tap (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(RuneTap)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Frost2H - Single Target</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == true then return false end

if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false then
	IcyBlast = HowlingBlast
elseif PQI_RubimGeneralDeathKnight_DisableCleave_enable == true then
	IcyBlast = IcyTouch
end

--3	0.00	horn_of_winter
if not HornofWinterBuff
then
	CastSpell(HornofWinter)
end

--COMBAT
if not PlayerCombat then return false end


--A	6.88	pillar_of_frost
--B	1.00	mogu_power_potion,if=target.time_to_die&amp;lt;=30|(target.time_to_die&amp;lt;=60&amp;buff.pillar_of_frost.up)
--C	3.31	raise_dead

if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
	
	if PQR_SpellAvailable(PillarofFrost)
	then
		CastSpell(PillarofFrost)
	end
	
	if PQR_SpellAvailable(RaiseDead)
	and BossCheck()
	then
		CastSpell(RaiseDead)
	end
end

--D	1.42	plague_leech,if=talent.plague_leech.enabled&amp;(dot.blood_plague.remains&amp;lt;1|dot.frost_fever.remains&amp;lt;1)
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and (BPtimer &amp;gt; 0 and BPtimer &amp;lt; 1
or FFtimer &amp;gt; 0 and FFtimer &amp;lt; 1)
and MeeleRange()
then
	CastSpell(PlagueLeech)
end

--E	6.36	outbreak,if=!dot.frost_fever.ticking|!dot.blood_plague.ticking
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(Outbreak)
end

--F	0.00	unholy_blight,if=talent.unholy_blight.enabled&amp;(!dot.frost_fever.ticking|!dot.blood_plague.ticking)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(UnholyBlight)
end

--G	23.17	soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperFrost)
then
	CastSpell(SoulReaperFrost)
end

--H	0.00	blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35&amp;cooldown.soul_reaper.remains=0)

--I	10.78	howling_blast,if=!dot.frost_fever.ticking
if TargetValidation(&amp;quot;target&amp;quot;,IcyBlast)
and FFtimer == 0
then
	CastSpell(IcyBlast)
end

--J	10.26	plague_strike,if=!dot.blood_plague.ticking
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
then
	CastSpell(PlagueStrike)
end

--K	44.51	howling_blast,if=buff.rime.react
if TargetValidation(&amp;quot;target&amp;quot;,IcyBlast)
and Rime
then
	CastSpell(IcyBlast)
end

--L	19.99	obliterate,if=buff.killing_machine.react
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and KillingMachine
then
	CastSpell(Obliterate)
end

--M	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.killing_machine.react
--N	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;76

--O	21.54	frost_strike,if=runic_power&amp;gt;76
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and PlayerRP &amp;gt; 76
and MeeleRange()
then
	CastSpell(FrostStrike)
end

if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and (RuneCheck(&amp;quot;Blood&amp;quot;) == 2
or RuneCheck(&amp;quot;Frost&amp;quot;) == 2
or RuneCheck(&amp;quot;Unholy&amp;quot;) == 2)
then
	CastSpell(Obliterate)
end

--Q	6.00	plague_leech,if=talent.plague_leech.enabled&amp;(dot.blood_plague.remains&amp;lt;3|dot.frost_fever.remains&amp;lt;3)
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and (BPtimer &amp;gt; 0 and BPtimer &amp;lt; 3
or FFtimer &amp;gt; 0 and FFtimer &amp;lt; 3)
and MeeleRange()
then
	CastSpell(PlagueLeech)
end

--R	0.09	outbreak,if=dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(Outbreak)
end

--S	0.00	unholy_blight,if=talent.unholy_blight.enabled&amp;(dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(UnholyBlight)
end

--T	131.71	frost_strike,if=talent.runic_empowerment.enabled&amp;frost=0
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and IsSpellKnown(RunicEmpowerment)
and RuneCheck(&amp;quot;Frost&amp;quot;) == 0
and MeeleRange()
then
	CastSpell(FrostStrike)
end

--U	0.00	frost_strike,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;lt;=10

--V	19.05	horn_of_winter
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

--W	0.00	frost_strike,if=talent.runic_corruption.enabled&amp;buff.runic_corruption.down

--X	53.81	obliterate
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
then
	CastSpell(Obliterate)
end

--Y	0.00	empower_rune_weapon,if=target.time_to_die&amp;lt;=60&amp;(buff.mogu_power_potion.up|buff.golemblood_potion.up)
--CLEAN

--Z	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;=20

--a	12.39	frost_strike
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and MeeleRange()
then
	CastSpell(FrostStrike)
end

--b	7.91	plague_leech,if=talent.plague_leech.enabled
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and FFtimer &amp;gt; 0
and BPtimer &amp;gt; 0
and MeeleRange()
then
	CastSpell(PlagueLeech)
end


--c	1.82	empower_rune_weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and MeeleRange()
and BossCheck()
and CdCheck(Obliterate) &amp;gt; 2
and CdCheck(HowlingBlast) &amp;gt; 2
and PlayerRP &amp;lt; 20
then
	CastSpell(EmpowerRuneWeapon)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Frost2H - Area of Effect</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == false then return false end
IcyBlast = HowlingBlast

--3	0.00	horn_of_winter
if not HornofWinterBuff
then
	CastSpell(HornofWinter)
end

--COMBAT
if not PlayerCombat then return false end


--A	6.88	pillar_of_frost
--B	1.00	mogu_power_potion,if=target.time_to_die&amp;lt;=30|(target.time_to_die&amp;lt;=60&amp;buff.pillar_of_frost.up)
--C	3.31	raise_dead

if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
	
	if PQR_SpellAvailable(PillarofFrost)
	then
		CastSpell(PillarofFrost)
	end
	
	if PQR_SpellAvailable(RaiseDead)
	and BossCheck()
	then
		CastSpell(RaiseDead)
	end
end

--D	1.42	plague_leech,if=talent.plague_leech.enabled&amp;(dot.blood_plague.remains&amp;lt;1|dot.frost_fever.remains&amp;lt;1)
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and (BPtimer &amp;gt; 0 and BPtimer &amp;lt; 1
or FFtimer &amp;gt; 0 and FFtimer &amp;lt; 1)
and MeeleRange()
then
	CastSpell(PlagueLeech)
end

--E	6.36	outbreak,if=!dot.frost_fever.ticking|!dot.blood_plague.ticking
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(Outbreak)
end

--F	0.00	unholy_blight,if=talent.unholy_blight.enabled&amp;(!dot.frost_fever.ticking|!dot.blood_plague.ticking)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(UnholyBlight)
end

--G	23.17	soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperFrost)
then
	CastSpell(SoulReaperFrost)
end

--H	0.00	blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35&amp;cooldown.soul_reaper.remains=0)

--I	10.78	howling_blast,if=!dot.frost_fever.ticking
if TargetValidation(&amp;quot;target&amp;quot;,IcyBlast)
and FFtimer == 0
then
	CastSpell(IcyBlast)
end

--J	10.26	plague_strike,if=!dot.blood_plague.ticking
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
then
	CastSpell(PlagueStrike)
end

--K	44.51	howling_blast,if=buff.rime.react
if TargetValidation(&amp;quot;target&amp;quot;,IcyBlast)
and Rime
then
	CastSpell(IcyBlast)
end

--L	19.99	obliterate,if=buff.killing_machine.react
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and KillingMachine
then
	CastSpell(Obliterate)
end

--M	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.killing_machine.react
--N	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;76

--O	21.54	frost_strike,if=runic_power&amp;gt;76
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and PlayerRP &amp;gt; 76
and MeeleRange()
then
	CastSpell(FrostStrike)
end

if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and (RuneCheck(&amp;quot;Blood&amp;quot;) == 2
or RuneCheck(&amp;quot;Frost&amp;quot;) == 2
or RuneCheck(&amp;quot;Unholy&amp;quot;) == 2)
then
	CastSpell(Obliterate)
end

--Q	6.00	plague_leech,if=talent.plague_leech.enabled&amp;(dot.blood_plague.remains&amp;lt;3|dot.frost_fever.remains&amp;lt;3)
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and (BPtimer &amp;gt; 0 and BPtimer &amp;lt; 3
or FFtimer &amp;gt; 0 and FFtimer &amp;lt; 3)
and MeeleRange()
then
	CastSpell(PlagueLeech)
end

--R	0.09	outbreak,if=dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(Outbreak)
end

--S	0.00	unholy_blight,if=talent.unholy_blight.enabled&amp;(dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(UnholyBlight)
end

--T	131.71	frost_strike,if=talent.runic_empowerment.enabled&amp;frost=0
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and IsSpellKnown(RunicEmpowerment)
and RuneCheck(&amp;quot;Frost&amp;quot;) == 0
and MeeleRange()
then
	CastSpell(FrostStrike)
end

--U	0.00	frost_strike,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;lt;=10

--V	19.05	horn_of_winter
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

--W	0.00	frost_strike,if=talent.runic_corruption.enabled&amp;buff.runic_corruption.down

--X	53.81	obliterate
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
then
	CastSpell(Obliterate)
end

--Y	0.00	empower_rune_weapon,if=target.time_to_die&amp;lt;=60&amp;(buff.mogu_power_potion.up|buff.golemblood_potion.up)
--CLEAN

--Z	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;=20

--a	12.39	frost_strike
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and MeeleRange()
then
	CastSpell(FrostStrike)
end

--b	7.91	plague_leech,if=talent.plague_leech.enabled
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and FFtimer &amp;gt; 0
and BPtimer &amp;gt; 0
and MeeleRange()
then
	CastSpell(PlagueLeech)
end


--c	1.82	empower_rune_weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and MeeleRange()
and BossCheck()
and CdCheck(Obliterate) &amp;gt; 2
and CdCheck(HowlingBlast) &amp;gt; 2
and PlayerRP &amp;lt; 20
then
	CastSpell(EmpowerRuneWeapon)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>FrostDW - Single Target</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == true then return false end

if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false then
	IcyBlast = HowlingBlast
elseif PQI_RubimGeneralDeathKnight_DisableCleave_enable == true then
	IcyBlast = IcyTouch
end

--3	0.00	horn_of_winter
if not HornofWinterBuff
then
	CastSpell(HornofWinter)
end

--COMBAT
if not PlayerCombat then return false end


--A	6.88	pillar_of_frost
--B	1.00	mogu_power_potion,if=target.time_to_die&amp;lt;=30|(target.time_to_die&amp;lt;=60&amp;buff.pillar_of_frost.up)
--C	3.31	raise_dead

if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
	
	if PQR_SpellAvailable(PillarofFrost)
	then
		CastSpell(PillarofFrost)
	end
	
	if PQR_SpellAvailable(RaiseDead)
	and BossCheck()
	then
		CastSpell(RaiseDead)
	end
end

--E	5.22	blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;(runic_power&amp;gt;76|(runic_power&amp;gt;=20&amp;buff.killing_machine.react))

--F	80.05	frost_strike,if=buff.killing_machine.react|runic_power&amp;gt;88
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and KillingMachine
then
	CastSpell(FrostStrike)
end

--G	14.13	plague_leech,if=talent.plague_leech.enabled&amp;(dot.blood_plague.remains&amp;lt;3|dot.frost_fever.remains&amp;lt;3|cooldown.outbreak.remains&amp;lt;1)
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and (BPtimer &amp;gt; 0 and BPtimer &amp;lt; 3
or FFtimer &amp;gt; 0 and FFtimer &amp;lt; 3)
and CdCheck(Outbreak) &amp;lt; 1
then
	CastSpell(PlagueLeech)
end

--H	7.86	outbreak,if=dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(Outbreak)
end

--I	0.00	unholy_blight,if=talent.unholy_blight.enabled&amp;(dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(UnholyBlight)
end

--J	23.90	soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperFrost)
then
	CastSpell(SoulReaperFrost)
end

--K	11.85	blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35&amp;cooldown.soul_reaper.remains=0)

--L	7.24	howling_blast,if=!dot.frost_fever.ticking
if TargetValidation(&amp;quot;target&amp;quot;,HowlingBlast)
and FFtimer &amp;lt; 1
then
	CastSpell(HowlingBlast)
end

--M	7.35	plague_strike,if=!dot.blood_plague.ticking
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer &amp;lt; 1
then
	CastSpell(PlagueStrike)
end

--N	18.04	howling_blast,if=buff.rime.react
if TargetValidation(&amp;quot;target&amp;quot;,HowlingBlast)
and Rime
then
	CastSpell(HowlingBlast)
end

--O	24.89	frost_strike,if=runic_power&amp;gt;76
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and PlayerRP &amp;gt; 76
then
	CastSpell(FrostStrike)
end

--P	4.14	obliterate,if=unholy&amp;gt;1
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;gt; 1
then
	CastSpell(Obliterate)
end

--Q	8.14	howling_blast,if=death&amp;gt;1|frost&amp;gt;1
if TargetValidation(&amp;quot;target&amp;quot;,HowlingBlast)
and (RuneCheck&amp;quot;Death&amp;quot; &amp;gt; 1
or RuneCheck(&amp;quot;Frost&amp;quot;) &amp;gt; 1)
then
	CastSpell(HowlingBlast)
end

--R	20.53	horn_of_winter
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

--S	38.77	obliterate,if=unholy&amp;gt;0
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;gt; 0
then
	CastSpell(Obliterate)
end

--T	94.32	howling_blast
if TargetValidation(&amp;quot;target&amp;quot;,HowlingBlast)
then
	CastSpell(HowlingBlast)
end

--U	0.00	frost_strike,if=talent.runic_empowerment.enabled&amp;(frost=0|blood=0)
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and IsSpellKnown(RunicEmpowerment)
and (RuneCheck(&amp;quot;Frost&amp;quot;) == 0 or RuneCheck(&amp;quot;Blood&amp;quot;) == 0)
then
	CastSpell(FrostStrike)
end

--V	45.37	blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;gt;35|buff.blood_charge.stack&amp;gt;=8)

--W	0.00	frost_strike,if=talent.runic_corruption.enabled&amp;buff.runic_corruption.down

--X	6.73	death_and_decay
if PQR_SpellAvailable(DeathandDecay)
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
		CastSpellByName(GetSpellInfo(43265))
		if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--Y	54.25	frost_strike,if=runic_power&amp;gt;=40
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and PlayerRP &amp;gt;= 40
then
	CastSpell(FrostStrike)
end

--Z	1.78	empower_rune_weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and MeeleRange()
and BossCheck()
and CdCheck(Obliterate) &amp;gt; 2
and CdCheck(HowlingBlast) &amp;gt; 2
and PlayerRP &amp;lt; 20
then
	CastSpell(EmpowerRuneWeapon)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>FrostDW - Area of Effect</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == false then return false end
IcyBlast = HowlingBlast

--3	0.00	horn_of_winter
if not HornofWinterBuff
then
	CastSpell(HornofWinter)
end

--COMBAT
if not PlayerCombat then return false end


--A	6.88	pillar_of_frost
--B	1.00	mogu_power_potion,if=target.time_to_die&amp;lt;=30|(target.time_to_die&amp;lt;=60&amp;buff.pillar_of_frost.up)
--C	3.31	raise_dead

if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
	
	if PQR_SpellAvailable(PillarofFrost)
	then
		CastSpell(PillarofFrost)
	end
	
	if PQR_SpellAvailable(RaiseDead)
	and BossCheck()
	then
		CastSpell(RaiseDead)
	end
end

--D	1.42	plague_leech,if=talent.plague_leech.enabled&amp;(dot.blood_plague.remains&amp;lt;1|dot.frost_fever.remains&amp;lt;1)
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and (BPtimer &amp;gt; 0 and BPtimer &amp;lt; 1
or FFtimer &amp;gt; 0 and FFtimer &amp;lt; 1)
and MeeleRange()
then
	CastSpell(PlagueLeech)
end

--E	6.36	outbreak,if=!dot.frost_fever.ticking|!dot.blood_plague.ticking
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(Outbreak)
end

--F	0.00	unholy_blight,if=talent.unholy_blight.enabled&amp;(!dot.frost_fever.ticking|!dot.blood_plague.ticking)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer == 0
or FFtimer == 0)
then
	CastSpell(UnholyBlight)
end

--G	23.17	soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaper)
then
	CastSpell(SoulReaper)
end

--H	0.00	blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35&amp;cooldown.soul_reaper.remains=0)
--PESTILENCE
if PestilenceTimer == nil then PestilenceTimer = 0 end
if TargetValidation(&amp;quot;target&amp;quot;,Pestilence)
and FFtimer &amp;gt; 1
and BPtimer &amp;gt; 1
and GetTime() - PestilenceTimer &amp;gt; 30
then
	PestilenceTimer = GetTime()
	CastSpell(Pestilence)
end

--I	10.78	howling_blast,if=!dot.frost_fever.ticking
if TargetValidation(&amp;quot;target&amp;quot;,IcyBlast)
and FFtimer == 0
then
	CastSpell(IcyBlast)
end

--J	10.26	plague_strike,if=!dot.blood_plague.ticking
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
then
	CastSpell(PlagueStrike)
end

--K	44.51	howling_blast,if=buff.rime.react
if TargetValidation(&amp;quot;target&amp;quot;,IcyBlast)
--and Rime
then
	CastSpell(IcyBlast)
end

--AOE RUBIM
if PQR_SpellAvailable(DeathandDecay)
and UnitExists(&amp;quot;mouseover&amp;quot;)
and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
then
		CastSpellByName(GetSpellInfo(43265))
		if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--L	19.99	obliterate,if=buff.killing_machine.react
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and KillingMachine
then
	CastSpell(Obliterate)
end

--M	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.killing_machine.react
--N	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;76

--O	21.54	frost_strike,if=runic_power&amp;gt;76
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and PlayerRP &amp;gt; 76
and MeeleRange()
then
	CastSpell(FrostStrike)
end

if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
and (RuneCheck(&amp;quot;Blood&amp;quot;) == 2
or RuneCheck(&amp;quot;Frost&amp;quot;) == 2
or RuneCheck(&amp;quot;Unholy&amp;quot;) == 2)
then
	CastSpell(Obliterate)
end

--Q	6.00	plague_leech,if=talent.plague_leech.enabled&amp;(dot.blood_plague.remains&amp;lt;3|dot.frost_fever.remains&amp;lt;3)
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and (BPtimer &amp;gt; 0 and BPtimer &amp;lt; 3
or FFtimer &amp;gt; 0 and FFtimer &amp;lt; 3)
and MeeleRange()
then
	CastSpell(PlagueLeech)
end

--R	0.09	outbreak,if=dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(Outbreak)
end

--S	0.00	unholy_blight,if=talent.unholy_blight.enabled&amp;(dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3)
if PQR_SpellAvailable(UnholyBlight)
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(UnholyBlight)
end

--T	131.71	frost_strike,if=talent.runic_empowerment.enabled&amp;frost=0
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and IsSpellKnown(RunicEmpowerment)
and RuneCheck(&amp;quot;Frost&amp;quot;) == 0
and MeeleRange()
then
	CastSpell(FrostStrike)
end

--U	0.00	frost_strike,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;lt;=10

--V	19.05	horn_of_winter
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

--W	0.00	frost_strike,if=talent.runic_corruption.enabled&amp;buff.runic_corruption.down

--X	53.81	obliterate
if TargetValidation(&amp;quot;target&amp;quot;,Obliterate)
then
	CastSpell(Obliterate)
end

--Y	0.00	empower_rune_weapon,if=target.time_to_die&amp;lt;=60&amp;(buff.mogu_power_potion.up|buff.golemblood_potion.up)
if PQR_SpellAvailable(EmpowerRuneWeapon)
and TimeToDie &amp;lt;= 60
and PrePot()
and MeeleRange()
and BossCheck()
then
	CastSpell(EmpowerRuneWeapon)
end

--Z	0.00	blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;=20

--a	12.39	frost_strike
if TargetValidation(&amp;quot;target&amp;quot;,FrostStrike)
and SaveRP ~= 1
and MeeleRange()
then
	CastSpell(FrostStrike)
end

--b	7.91	plague_leech,if=talent.plague_leech.enabled
if TargetValidation(&amp;quot;target&amp;quot;,PlagueLeech)
and FFtimer &amp;gt; 0
and BPtimer &amp;gt; 0
and MeeleRange()
then
	CastSpell(PlagueLeech)
end

--c	1.82	empower_rune_weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and MeeleRange()
and BossCheck()
and CdCheck(Obliterate) &amp;gt; 2
and CdCheck(HowlingBlast) &amp;gt; 2
and PlayerRP &amp;lt; 20
then
	CastSpell(EmpowerRuneWeapon)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Functions (Frost 2H)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- This profile would never be done without:
-- team_Nova (Mentally, Crystal_Tech and bu_ba_911)
-- D1sc1pl1n3
-- Kinkeh
-- cpowroks
-- Gabbz
-- googlebee
-- Xelper
-- imdasandman
-- kuukuu
-- Ninjaderp
-- Diesall


-----------------
-- DUMB CHECKS --
-----------------
if  (select(2, UnitClass(&amp;quot;player&amp;quot;)) ~= &amp;quot;DEATHKNIGHT&amp;quot;)
then
	print(&amp;quot;Error: Wrong Class - Expecting Death Knight&amp;quot;)
	PQR_StopRotation()
elseif UnitLevel(&amp;quot;player&amp;quot;) ~= 90
then
	print(&amp;quot;Error: Wrong Level - Expecting LvL 90&amp;quot;)
	PQR_StopRotation()
elseif GetSpecialization() == nil
then
	print(&amp;quot;Error: Wrong Spec - None selected!&amp;quot;)
	PQR_StopRotation()
end

----------------
-- SPEC CHECK --
----------------
if GetSpecialization() == 1 then
	Spec = &amp;quot;Blood&amp;quot;
	PQR_SwapRotation(&amp;quot;Blood (Rubim)&amp;quot;) 
elseif GetSpecialization() == 2 then
	Spec = &amp;quot;Frost&amp;quot;
	if PQI_RubimFrost_FrostDW_enable == false then
		PQR_SwapRotation(&amp;quot;Frost 2H (Rubim)&amp;quot;)
	elseif PQI_RubimFrost_FrostDW_enable == true then
		PQR_SwapRotation(&amp;quot;Frost DW (Rubim)&amp;quot;)
	end
elseif GetSpecialization() == 3 then
	Spec = &amp;quot;Unholy&amp;quot;
	PQR_SwapRotation(&amp;quot;Unholy (Rubim)&amp;quot;)
end

---------------
-- PQI_TEXT --
--------------
function PQR_SendText(CHOICE,SPELL)
	if CHOICE == &amp;quot;Standby&amp;quot;
	then
		PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Standby: &amp;quot; .. RotationMode, nil, &amp;quot;ffffff&amp;quot;)
	end
	
	if CHOICE ~= &amp;quot;Standby&amp;quot;
	and SPELL ~= 0
	then
		local nskill = GetSpellInfo(SPELL)		
		
		if CHOICE == &amp;quot;Queue&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Queue Skill: &amp;quot; .. nskill, nil, &amp;quot;14DCB4&amp;quot;)
		end
		
		if CHOICE == &amp;quot;Casted&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Casted: &amp;quot; .. nskill, nil, &amp;quot;ffffff&amp;quot;)
		end
	end
end

---------------------------------
-- NOVA_DATA.LUA / by TeamNova --
---------------------------------
-- Target Validation Function.
TargetValidation = nil
function TargetValidation(unit, spell)
	if UnitExists(unit)
	 and IsPlayerSpell(spell)
	 and UnitCanAttack(&amp;quot;player&amp;quot;, unit) == 1 
	 and not UnitIsDeadOrGhost(unit) 
	 and not PQR_IsOutOfSight(unit, 1) then
	 	if IsSpellKnown(spell) then  -- Redundent Check to see if Morphed Spell or not
	 		if PQR_SpellAvailable(spell) then
		 		if IsSpellInRange(GetSpellInfo(spell), unit) == 1 then
		 			return true
		 		else
		 			return false
		 		end
		 	else
		 		return false
		 	end
	 	else -- If spell is a morphed spell, return true without Range Check
	 		if select(2, GetSpellCooldown(spell)) == 0 then
	 			return true
	 		end
	 	end
	end
end


--RESOURCES
Nova_UnitInfo = nil
function Nova_UnitInfo(t)
	-- Takes an input of UnitID (player, target, pet, mouseover, etc) and gives you their most useful info
		local TManaActual = UnitPower(t)
		local TMaxMana = UnitPowerMax(t)
		if TMaxMana == 0 then TMaxMana = 1 end			
		local TMana = 100 * UnitPower(t) / TMaxMana
		local THealthActual = UnitHealth(t)
		local THealth = 100 * UnitHealth(t) / UnitHealthMax(t) 
		local myClassPower = 0 
		local PQ_Class = select(2, UnitClass(t)) 
		local PQ_UnitLevel = UnitLevel(t)
		local PQ_CombatCheck = UnitAffectingCombat(t) 
		if PQ_Class == &amp;quot;PALADIN&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 9)
			if UnitBuffID(&amp;quot;player&amp;quot;, 90174) then
				myClassPower = myClassPower + 3
			end
		elseif PQ_Class == &amp;quot;PRIEST&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 13)
		elseif PQ_Class == &amp;quot;WARLOCK&amp;quot; then
			if PQR_Spec == 3 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 14) -- Destruction: Burning Embers
			elseif PQR_Spec == 2 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 15) -- Demonology: Demonic Fury
			elseif PQR_Spec == 1 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 7) -- Affliction: Soul Shards
			end
		elseif PQ_Class == &amp;quot;DRUID&amp;quot; and PQ_Class == 2 then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 8)
		elseif PQ_Class == &amp;quot;MONK&amp;quot;  then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 12)
		elseif PQ_Class == &amp;quot;ROGUE&amp;quot; and t ~= &amp;quot;player&amp;quot; then
			myClassPower = GetComboPoints(&amp;quot;player&amp;quot;, t)
		end
		--       1            2          3         4           5             6          7               8
		return THealth, THealthActual, TMana, TManaActual, myClassPower, PQ_Class, PQ_UnitLevel, PQ_CombatCheck
end

--BOSSCHECK
PQ_BossUnits = {
	-- Cataclysm Dungeons --
	-- Abyssal Maw: Throne of the Tides
	40586,		-- Lady Naz&amp;apos;jar
	40765,		-- Commander Ulthok
	40825,		-- Erunak Stonespeaker
	40788,		-- Mindbender Ghur&amp;apos;sha
	42172,		-- Ozumat
	-- Blackrock Caverns
	39665,		-- Rom&amp;apos;ogg Bonecrusher
	39679,		-- Corla, Herald of Twilight
	39698,		-- Karsh Steelbender
	39700,		-- Beauty
	39705,		-- Ascendant Lord Obsidius
	-- The Stonecore
	43438,		-- Corborus
	43214,		-- Slabhide
	42188,		-- Ozruk
	42333,		-- High Priestess Azil
	-- The Vortex Pinnacle
	43878,		-- Grand Vizier Ertan
	43873,		-- Altairus
	43875,		-- Asaad
	-- Grim Batol
	39625,		-- General Umbriss
	40177,		-- Forgemaster Throngus
	40319,		-- Drahga Shadowburner
	40484,		-- Erudax
	-- Halls of Origination
	39425,		-- Temple Guardian Anhuur
	39428,		-- Earthrager Ptah
	39788,		-- Anraphet
	39587,		-- Isiset
	39731,		-- Ammunae
	39732,		-- Setesh
	39378,		-- Rajh
	-- Lost City of the Tol&amp;apos;vir
	44577,		-- General Husam
	43612,		-- High Prophet Barim
	43614,		-- Lockmaw
	49045,		-- Augh
	44819,		-- Siamat
	-- Zul&amp;apos;Aman
	23574,		-- Akil&amp;apos;zon
	23576,		-- Nalorakk
	23578,		-- Jan&amp;apos;alai
	23577,		-- Halazzi
	24239,		-- Hex Lord Malacrass
	23863,		-- Daakara
	-- Zul&amp;apos;Gurub
	52155,		-- High Priest Venoxis
	52151,		-- Bloodlord Mandokir
	52271,		-- Edge of Madness
	52059,		-- High Priestess Kilnara
	52053,		-- Zanzil
	52148,		-- Jin&amp;apos;do the Godbreaker
	-- End Time
	54431,		-- Echo of Baine
	54445,		-- Echo of Jaina
	54123,		-- Echo of Sylvanas
	54544,		-- Echo of Tyrande
	54432,		-- Murozond
	-- Hour of Twilight
	54590,		-- Arcurion
	54968,		-- Asira Dawnslayer
	54938,		-- Archbishop Benedictus
	-- Well of Eternity
	55085,		-- Peroth&amp;apos;arn
	54853,		-- Queen Azshara
	54969,		-- Mannoroth
	55419,		-- Captain Varo&amp;apos;then
	
	-- Mists of Pandaria Dungeons --
	-- Scarlet Halls
	59303,		-- Houndmaster Braun
	58632,		-- Armsmaster Harlan
	59150,		-- Flameweaver Koegler
	-- Scarlet Monastery
	59789,		-- Thalnos the Soulrender
	59223,		-- Brother Korloff
	3977,		-- High Inquisitor Whitemane
	60040,		-- Commander Durand
	-- Scholomance
	58633,		-- Instructor Chillheart
	59184,		-- Jandice Barov
	59153,		-- Rattlegore
	58722,		-- Lilian Voss
	58791,		-- Lilian&amp;apos;s Soul
	59080,		-- Darkmaster Gandling
	-- Stormstout Brewery
	56637,		-- Ook-Ook
	56717,		-- Hoptallus
	59479,		-- Yan-Zhu the Uncasked
	-- Tempe of the Jade Serpent
	56448,		-- Wise Mari
	56843,		-- Lorewalker Stonestep
	59051,		-- Strife
	59726,		-- Peril
	58826,		-- Zao Sunseeker
	56732,		-- Liu Flameheart
	56762,		-- Yu&amp;apos;lon
	56439,		-- Sha of Doubt
	-- Mogu&amp;apos;shan Palace
	61444,		-- Ming the Cunning
	61442,		-- Kuai the Brute
	61445,		-- Haiyan the Unstoppable
	61243,		-- Gekkan
	61398,		-- Xin the Weaponmaster
	-- Shado-Pan Monastery
	56747,		-- Gu Cloudstrike
	56541,		-- Master Snowdrift
	56719,		-- Sha of Violence
	56884,		-- Taran Zhu
	-- Gate of the Setting Sun
	56906,		-- Saboteur Kip&amp;apos;tilak
	56589,		-- Striker Ga&amp;apos;dok
	56636,		-- Commander Ri&amp;apos;mok
	56877,		-- Raigonn
	-- Siege of Niuzao Temple
	61567,		-- Vizier Jin&amp;apos;bak
	61634,		-- Commander Vo&amp;apos;jak
	61485,		-- General Pa&amp;apos;valak
	62205,		-- Wing Leader Ner&amp;apos;onok

	-- Training Dummies --
	46647,		-- Level 85 Training Dummy
	67127,		-- Level 90 Training Dummy
	
	-- Pandaria Raid Adds --
	63346,		-- Tsulong: The Dark of Night
	62969,		-- Tsulong: Embodied Terror
	62977,		-- Tsulong: Frightspawn
	62919,		-- Tsulong: Unstable Sha
	61034,		-- Sha of Fear: Terror Spawn
	61003		-- Sha of Fear: Dread Spawn
}

SpecialUnit = nil
function SpecialUnit()
	local PQ_BossUnits = PQ_BossUnits
	
	if UnitExists(&amp;quot;target&amp;quot;) then
		local npcID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
		
		-- Dungeons &amp; Raids
		if UnitLevel(&amp;quot;target&amp;quot;) == -1 then return true else
			for i=1,#PQ_BossUnits do
				if PQ_BossUnits[i] == npcID then return true end
			end
			return false
		end
	else return false end
end

---------------
-- VAR SETUP --
---------------
if PQ_DKUHRubim == nil then
	PQ_DKUHRubim = true
	CheckSpell = 0
	SpellSucess = false
	
	-- AOE CHECKS	
	AoERotation = false
	RotationMode = &amp;quot;Single Target&amp;quot;
	
	-- SENDTEXT
	PQR_SendText(&amp;quot;Standby&amp;quot;)
end

------------------
-- INIT MESSAGE --
------------------
function initMessage()
	PQR_WriteToChat(&amp;quot;|cff91e782Rubim&amp;apos;s Frost 2H |cff82cee7Loaded!|cffffffff&amp;quot;)
	if PQI_RubimGeneralDeathKnight_FrostSET_enable == true
	then
		UseEquipmentSet(PQI_RubimGeneralDeathKnight_FrostSET_value)
	end
end

-------------------
-- DEBUG OPTIONS --
-------------------
PQR_Rubim_Debug = 0

-------------
-- RACIAL --
------------
function RacialDetection()
	Racial = 0
	local _,Race = UnitRace(&amp;quot;player&amp;quot;)
	if Race == &amp;quot;Orc&amp;quot;
	then
		local Orc_Racial = {
		20572,
		33697,
		33702,
		82836
		}
	
		for i=1, #Orc_Racial do
			if IsSpellKnown(Orc_Racial[i]) then
				Racial = Orc_Racial[i]
			end
		end
	end
end

if Race == &amp;quot;Troll&amp;quot;
then
	Racial = 26297
end

------------------
-- Meele Range --
-----------------
function MeeleRange()
	if IsSpellInRange(GetSpellInfo(45462), &amp;quot;target&amp;quot;) == 1
	then return true else return false
	end
end

----------------
-- CAST SPELL --
----------------
function CastSpell(spell)
	CastSpellByName(GetSpellInfo(spell),nil)
end

if UnitAffectingCombat(&amp;quot;player&amp;quot;)
and PQR_Rubim_Debug ~= 0 then
	if not castspellsucced then
		castspellsucced = CreateFrame(&amp;quot;Frame&amp;quot;) 
		castspellsucced:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
		castspellsucced:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if select(7,...)~= 0 and select(3,...)==&amp;quot;player&amp;quot; then DebugSpell = 1 LastSpell = GetSpellInfo(select(7,...)) end end)
	end
	
	if DebugSpell ~= 0
	then
		PQR_WriteToChat(&amp;quot;Casted: |cffffcc00&amp;quot; .. LastSpell)
		DebugSpell = 0
	end
end

--------------
-- CD Check --
--------------
function CdCheck(spellid)
	Sstart, Sduration, Senabled = GetSpellCooldown(spellid)
	Scooldown = (Sstart + Sduration - GetTime())
	if Sstart == 0
	then
		Scooldown = 0
	end
	return Scooldown
end

-------------
-- PRE POT --
-------------
function PrePot()
	if UnitBuffID(&amp;quot;player&amp;quot;,105706)
	then return true else return false end
end

-- Variables
PQR_ResetMovementTime = 0.3
PQR_SpellAvailableTime = ((select(3,GetNetStats()) + select(4,GetNetStats())) / 1000)

--Player Info
PlayerRP	= select(3, Nova_UnitInfo(&amp;quot;player&amp;quot;))
PlayerHP			= Nova_UnitInfo(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
	
--PQR Functions
isMoving			= PQR_IsMoving()

--Target Info
TargetHP				= select(1, Nova_UnitInfo(&amp;quot;target&amp;quot;))
EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
		
-----------------
-- Time to die --
-----------------
TimeToDie = 999999
if UnitExists(&amp;quot;target&amp;quot;)
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) == 1
and PlayerCombat then
	if (guid ~= UnitGUID(&amp;quot;target&amp;quot;)) or (guid == UnitGUID(&amp;quot;target&amp;quot;) and UnitHealth(&amp;quot;target&amp;quot;) == _firstLifeMax) then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealthMax(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end             
_currentLife = UnitHealth(&amp;quot;target&amp;quot;)
_currentTime = GetTime()
timeDiff = _currentTime - _firstTime
hpDiff = _firstLife - _currentLife
	if hpDiff &amp;gt; 0 then
		fullTime = timeDiff*_firstLifeMax/hpDiff
		pastFirstTime = (_firstLifeMax - _firstLife)*timeDiff/hpDiff
		calcTime = _firstTime - pastFirstTime + fullTime - _currentTime
		if calcTime &amp;lt; 1 then
			calcTime = 1
		end
   	TimeToDie = calcTime
	end
	if hpDiff &amp;lt;= 0 then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealth(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end

-- dummy
	if UnitHealthMax(&amp;quot;target&amp;quot;) == 1 then
		TimeToDie = 99
	end
end

--------------
-- AOE SWAP --
--------------
if Timer == nil then
	Timer = 0
end

if PQI:IsHotkeys(PQI_RubimGeneralDeathKnight_AreaofEffect_key)
and GetTime() - Timer &amp;gt; 0.5
then
	Timer = GetTime()
	if AoERotation == false
	then
		AoERotation = true
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0EArea of Effect|R&amp;quot;)
		RotationMode = &amp;quot;Area of Effect&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	elseif AoERotation == true
	then
		AoERotation = false
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0ESingle Target|R&amp;quot;)
		RotationMode = &amp;quot;Single Target&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	end
end

------------------
-- CONSOLE CAST --
------------------
SLASH_rcast1 = &amp;quot;/rcast&amp;quot;
function SlashCmdList.rcast(rcast, editbox)
	if rcast ~= &amp;quot;All&amp;quot; then
		rcast = tonumber(rcast)
		
		if CheckSpell == 0
		or rcast ~= LastCheckSpell
		then
			CheckSpell = rcast
			LastCheckSpell = rcast
		else
			CheckSpell = 0 end
	
	elseif rcast == &amp;quot;All&amp;quot; then
		CheckSpell = 0
		LastCheckSpell = 0
	else argument = &amp;quot; |CFFFF0303(No arguments)|R&amp;quot;
	end
	if CheckSpell ~= 0 then
		print(&amp;quot;|cff00ffffQueue: |r&amp;quot; .. GetSpellInfo(CheckSpell).. &amp;quot;(&amp;quot; .. CheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Queue&amp;quot;,CheckSpell)
	elseif LastCheckSpell ~= 0 then
		 print(&amp;quot;|cff00ffffRemoved: |r&amp;quot; .. GetSpellInfo(LastCheckSpell).. &amp;quot;(&amp;quot; .. LastCheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Standby&amp;quot;) end
end

if PQR_RotationStarted == true
then
	initMessage()
	RacialDetection()
	RunMacroText(&amp;quot;/rcast All&amp;quot;)
	PQR_RotationStarted = false
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Functions (Frost DW)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- This profile would never be done without:
-- team_Nova (Mentally, Crystal_Tech and bu_ba_911)
-- D1sc1pl1n3
-- Kinkeh
-- cpowroks
-- Gabbz
-- googlebee
-- Xelper
-- imdasandman
-- kuukuu
-- Ninjaderp
-- Diesall


-----------------
-- DUMB CHECKS --
-----------------
if  (select(2, UnitClass(&amp;quot;player&amp;quot;)) ~= &amp;quot;DEATHKNIGHT&amp;quot;)
then
	print(&amp;quot;Error: Wrong Class - Expecting Death Knight&amp;quot;)
	PQR_StopRotation()
elseif UnitLevel(&amp;quot;player&amp;quot;) ~= 90
then
	print(&amp;quot;Error: Wrong Level - Expecting LvL 90&amp;quot;)
	PQR_StopRotation()
elseif GetSpecialization() == nil
then
	print(&amp;quot;Error: Wrong Spec - None selected!&amp;quot;)
	PQR_StopRotation()
end

----------------
-- SPEC CHECK --
----------------
if GetSpecialization() == 1 then
	Spec = &amp;quot;Blood&amp;quot;
	PQR_SwapRotation(&amp;quot;Blood (Rubim)&amp;quot;) 
elseif GetSpecialization() == 2 then
	Spec = &amp;quot;Frost&amp;quot;
	if PQI_RubimFrost_FrostDW_enable == false then
		PQR_SwapRotation(&amp;quot;Frost 2H (Rubim)&amp;quot;)
	elseif PQI_RubimFrost_FrostDW_enable == true then
		PQR_SwapRotation(&amp;quot;Frost DW (Rubim)&amp;quot;)
	end
elseif GetSpecialization() == 3 then
	Spec = &amp;quot;Unholy&amp;quot;
	PQR_SwapRotation(&amp;quot;Unholy (Rubim)&amp;quot;)
end

---------------
-- PQI_TEXT --
--------------
function PQR_SendText(CHOICE,SPELL)
	if CHOICE == &amp;quot;Standby&amp;quot;
	then
		PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Standby: &amp;quot; .. RotationMode, nil, &amp;quot;ffffff&amp;quot;)
	end
	
	if CHOICE ~= &amp;quot;Standby&amp;quot;
	and SPELL ~= 0
	then
		local nskill = GetSpellInfo(SPELL)		
		
		if CHOICE == &amp;quot;Queue&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Queue Skill: &amp;quot; .. nskill, nil, &amp;quot;14DCB4&amp;quot;)
		end
		
		if CHOICE == &amp;quot;Casted&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Casted: &amp;quot; .. nskill, nil, &amp;quot;ffffff&amp;quot;)
		end
	end
end

---------------------------------
-- NOVA_DATA.LUA / by TeamNova --
---------------------------------
-- Target Validation Function.
TargetValidation = nil
function TargetValidation(unit, spell)
	if UnitExists(unit)
	 and IsPlayerSpell(spell)
	 and UnitCanAttack(&amp;quot;player&amp;quot;, unit) == 1 
	 and not UnitIsDeadOrGhost(unit) 
	 and not PQR_IsOutOfSight(unit, 1) then
	 	if IsSpellKnown(spell) then  -- Redundent Check to see if Morphed Spell or not
	 		if PQR_SpellAvailable(spell) then
		 		if IsSpellInRange(GetSpellInfo(spell), unit) == 1 then
		 			return true
		 		else
		 			return false
		 		end
		 	else
		 		return false
		 	end
	 	else -- If spell is a morphed spell, return true without Range Check
	 		if select(2, GetSpellCooldown(spell)) == 0 then
	 			return true
	 		end
	 	end
	end
end


--RESOURCES
Nova_UnitInfo = nil
function Nova_UnitInfo(t)
	-- Takes an input of UnitID (player, target, pet, mouseover, etc) and gives you their most useful info
		local TManaActual = UnitPower(t)
		local TMaxMana = UnitPowerMax(t)
		if TMaxMana == 0 then TMaxMana = 1 end			
		local TMana = 100 * UnitPower(t) / TMaxMana
		local THealthActual = UnitHealth(t)
		local THealth = 100 * UnitHealth(t) / UnitHealthMax(t) 
		local myClassPower = 0 
		local PQ_Class = select(2, UnitClass(t)) 
		local PQ_UnitLevel = UnitLevel(t)
		local PQ_CombatCheck = UnitAffectingCombat(t) 
		if PQ_Class == &amp;quot;PALADIN&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 9)
			if UnitBuffID(&amp;quot;player&amp;quot;, 90174) then
				myClassPower = myClassPower + 3
			end
		elseif PQ_Class == &amp;quot;PRIEST&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 13)
		elseif PQ_Class == &amp;quot;WARLOCK&amp;quot; then
			if PQR_Spec == 3 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 14) -- Destruction: Burning Embers
			elseif PQR_Spec == 2 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 15) -- Demonology: Demonic Fury
			elseif PQR_Spec == 1 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 7) -- Affliction: Soul Shards
			end
		elseif PQ_Class == &amp;quot;DRUID&amp;quot; and PQ_Class == 2 then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 8)
		elseif PQ_Class == &amp;quot;MONK&amp;quot;  then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 12)
		elseif PQ_Class == &amp;quot;ROGUE&amp;quot; and t ~= &amp;quot;player&amp;quot; then
			myClassPower = GetComboPoints(&amp;quot;player&amp;quot;, t)
		end
		--       1            2          3         4           5             6          7               8
		return THealth, THealthActual, TMana, TManaActual, myClassPower, PQ_Class, PQ_UnitLevel, PQ_CombatCheck
end

--BOSSCHECK
PQ_BossUnits = {
	-- Cataclysm Dungeons --
	-- Abyssal Maw: Throne of the Tides
	40586,		-- Lady Naz&amp;apos;jar
	40765,		-- Commander Ulthok
	40825,		-- Erunak Stonespeaker
	40788,		-- Mindbender Ghur&amp;apos;sha
	42172,		-- Ozumat
	-- Blackrock Caverns
	39665,		-- Rom&amp;apos;ogg Bonecrusher
	39679,		-- Corla, Herald of Twilight
	39698,		-- Karsh Steelbender
	39700,		-- Beauty
	39705,		-- Ascendant Lord Obsidius
	-- The Stonecore
	43438,		-- Corborus
	43214,		-- Slabhide
	42188,		-- Ozruk
	42333,		-- High Priestess Azil
	-- The Vortex Pinnacle
	43878,		-- Grand Vizier Ertan
	43873,		-- Altairus
	43875,		-- Asaad
	-- Grim Batol
	39625,		-- General Umbriss
	40177,		-- Forgemaster Throngus
	40319,		-- Drahga Shadowburner
	40484,		-- Erudax
	-- Halls of Origination
	39425,		-- Temple Guardian Anhuur
	39428,		-- Earthrager Ptah
	39788,		-- Anraphet
	39587,		-- Isiset
	39731,		-- Ammunae
	39732,		-- Setesh
	39378,		-- Rajh
	-- Lost City of the Tol&amp;apos;vir
	44577,		-- General Husam
	43612,		-- High Prophet Barim
	43614,		-- Lockmaw
	49045,		-- Augh
	44819,		-- Siamat
	-- Zul&amp;apos;Aman
	23574,		-- Akil&amp;apos;zon
	23576,		-- Nalorakk
	23578,		-- Jan&amp;apos;alai
	23577,		-- Halazzi
	24239,		-- Hex Lord Malacrass
	23863,		-- Daakara
	-- Zul&amp;apos;Gurub
	52155,		-- High Priest Venoxis
	52151,		-- Bloodlord Mandokir
	52271,		-- Edge of Madness
	52059,		-- High Priestess Kilnara
	52053,		-- Zanzil
	52148,		-- Jin&amp;apos;do the Godbreaker
	-- End Time
	54431,		-- Echo of Baine
	54445,		-- Echo of Jaina
	54123,		-- Echo of Sylvanas
	54544,		-- Echo of Tyrande
	54432,		-- Murozond
	-- Hour of Twilight
	54590,		-- Arcurion
	54968,		-- Asira Dawnslayer
	54938,		-- Archbishop Benedictus
	-- Well of Eternity
	55085,		-- Peroth&amp;apos;arn
	54853,		-- Queen Azshara
	54969,		-- Mannoroth
	55419,		-- Captain Varo&amp;apos;then
	
	-- Mists of Pandaria Dungeons --
	-- Scarlet Halls
	59303,		-- Houndmaster Braun
	58632,		-- Armsmaster Harlan
	59150,		-- Flameweaver Koegler
	-- Scarlet Monastery
	59789,		-- Thalnos the Soulrender
	59223,		-- Brother Korloff
	3977,		-- High Inquisitor Whitemane
	60040,		-- Commander Durand
	-- Scholomance
	58633,		-- Instructor Chillheart
	59184,		-- Jandice Barov
	59153,		-- Rattlegore
	58722,		-- Lilian Voss
	58791,		-- Lilian&amp;apos;s Soul
	59080,		-- Darkmaster Gandling
	-- Stormstout Brewery
	56637,		-- Ook-Ook
	56717,		-- Hoptallus
	59479,		-- Yan-Zhu the Uncasked
	-- Tempe of the Jade Serpent
	56448,		-- Wise Mari
	56843,		-- Lorewalker Stonestep
	59051,		-- Strife
	59726,		-- Peril
	58826,		-- Zao Sunseeker
	56732,		-- Liu Flameheart
	56762,		-- Yu&amp;apos;lon
	56439,		-- Sha of Doubt
	-- Mogu&amp;apos;shan Palace
	61444,		-- Ming the Cunning
	61442,		-- Kuai the Brute
	61445,		-- Haiyan the Unstoppable
	61243,		-- Gekkan
	61398,		-- Xin the Weaponmaster
	-- Shado-Pan Monastery
	56747,		-- Gu Cloudstrike
	56541,		-- Master Snowdrift
	56719,		-- Sha of Violence
	56884,		-- Taran Zhu
	-- Gate of the Setting Sun
	56906,		-- Saboteur Kip&amp;apos;tilak
	56589,		-- Striker Ga&amp;apos;dok
	56636,		-- Commander Ri&amp;apos;mok
	56877,		-- Raigonn
	-- Siege of Niuzao Temple
	61567,		-- Vizier Jin&amp;apos;bak
	61634,		-- Commander Vo&amp;apos;jak
	61485,		-- General Pa&amp;apos;valak
	62205,		-- Wing Leader Ner&amp;apos;onok

	-- Training Dummies --
	46647,		-- Level 85 Training Dummy
	67127,		-- Level 90 Training Dummy
	
	-- Pandaria Raid Adds --
	63346,		-- Tsulong: The Dark of Night
	62969,		-- Tsulong: Embodied Terror
	62977,		-- Tsulong: Frightspawn
	62919,		-- Tsulong: Unstable Sha
	61034,		-- Sha of Fear: Terror Spawn
	61003		-- Sha of Fear: Dread Spawn
}

SpecialUnit = nil
function SpecialUnit()
	local PQ_BossUnits = PQ_BossUnits
	
	if UnitExists(&amp;quot;target&amp;quot;) then
		local npcID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
		
		-- Dungeons &amp; Raids
		if UnitLevel(&amp;quot;target&amp;quot;) == -1 then return true else
			for i=1,#PQ_BossUnits do
				if PQ_BossUnits[i] == npcID then return true end
			end
			return false
		end
	else return false end
end

---------------
-- VAR SETUP --
---------------
if PQ_DKUHRubim == nil then
	PQ_DKUHRubim = true
	CheckSpell = 0
	SpellSucess = false
	
	-- AOE CHECKS	
	AoERotation = false
	RotationMode = &amp;quot;Single Target&amp;quot;
	
	-- SENDTEXT
	PQR_SendText(&amp;quot;Standby&amp;quot;)
end

------------------
-- INIT MESSAGE --
------------------
function initMessage()
	PQR_WriteToChat(&amp;quot;|cff91e782Rubim&amp;apos;s Frost DW |cff82cee7Loaded!|cffffffff&amp;quot;)
	if PQI_RubimGeneralDeathKnight_FrostSET_enable == true
	then
		UseEquipmentSet(PQI_RubimGeneralDeathKnight_FrostSET_value)
	end
end

-------------------
-- DEBUG OPTIONS --
-------------------
PQR_Rubim_Debug = 0

-------------
-- RACIAL --
------------
function RacialDetection()
	Racial = 0
	local _,Race = UnitRace(&amp;quot;player&amp;quot;)
	if Race == &amp;quot;Orc&amp;quot;
	then
		local Orc_Racial = {
		20572,
		33697,
		33702,
		82836
		}
	
		for i=1, #Orc_Racial do
			if IsSpellKnown(Orc_Racial[i]) then
				Racial = Orc_Racial[i]
			end
		end
	end
end

if Race == &amp;quot;Troll&amp;quot;
then
	Racial = 26297
end

------------------
-- Meele Range --
-----------------
function MeeleRange()
	if IsSpellInRange(GetSpellInfo(45462), &amp;quot;target&amp;quot;) == 1
	then return true else return false
	end
end

----------------
-- CAST SPELL --
----------------
function CastSpell(spell)
	CastSpellByName(GetSpellInfo(spell),nil)
end

if UnitAffectingCombat(&amp;quot;player&amp;quot;)
and PQR_Rubim_Debug ~= 0 then
	if not castspellsucced then
		castspellsucced = CreateFrame(&amp;quot;Frame&amp;quot;) 
		castspellsucced:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
		castspellsucced:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if select(7,...)~= 0 and select(3,...)==&amp;quot;player&amp;quot; then DebugSpell = 1 LastSpell = GetSpellInfo(select(7,...)) end end)
	end
	
	if DebugSpell ~= 0
	then
		PQR_WriteToChat(&amp;quot;Casted: |cffffcc00&amp;quot; .. LastSpell)
		DebugSpell = 0
	end
end

--------------
-- CD Check --
--------------
function CdCheck(spellid)
	Sstart, Sduration, Senabled = GetSpellCooldown(spellid)
	Scooldown = (Sstart + Sduration - GetTime())
	if Sstart == 0
	then
		Scooldown = 0
	end
	return Scooldown
end

-------------
-- PRE POT --
-------------
function PrePot()
	if UnitBuffID(&amp;quot;player&amp;quot;,105706)
	then return true else return false end
end

-- Variables
PQR_ResetMovementTime = 0.3
PQR_SpellAvailableTime = ((select(3,GetNetStats()) + select(4,GetNetStats())) / 1000)

--Player Info
PlayerRP	= select(3, Nova_UnitInfo(&amp;quot;player&amp;quot;))
PlayerHP			= Nova_UnitInfo(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
	
--PQR Functions
isMoving			= PQR_IsMoving()

--Target Info
TargetHP				= select(1, Nova_UnitInfo(&amp;quot;target&amp;quot;))
EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
		
-----------------
-- Time to die --
-----------------
TimeToDie = 999999
if UnitExists(&amp;quot;target&amp;quot;)
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) == 1
and PlayerCombat then
	if (guid ~= UnitGUID(&amp;quot;target&amp;quot;)) or (guid == UnitGUID(&amp;quot;target&amp;quot;) and UnitHealth(&amp;quot;target&amp;quot;) == _firstLifeMax) then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealthMax(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end             
_currentLife = UnitHealth(&amp;quot;target&amp;quot;)
_currentTime = GetTime()
timeDiff = _currentTime - _firstTime
hpDiff = _firstLife - _currentLife
	if hpDiff &amp;gt; 0 then
		fullTime = timeDiff*_firstLifeMax/hpDiff
		pastFirstTime = (_firstLifeMax - _firstLife)*timeDiff/hpDiff
		calcTime = _firstTime - pastFirstTime + fullTime - _currentTime
		if calcTime &amp;lt; 1 then
			calcTime = 1
		end
   	TimeToDie = calcTime
	end
	if hpDiff &amp;lt;= 0 then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealth(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end

-- dummy
	if UnitHealthMax(&amp;quot;target&amp;quot;) == 1 then
		TimeToDie = 99
	end
end

--------------
-- AOE SWAP --
--------------
if Timer == nil then
	Timer = 0
end

if PQI:IsHotkeys(PQI_RubimGeneralDeathKnight_AreaofEffect_key)
and GetTime() - Timer &amp;gt; 0.5
then
	Timer = GetTime()
	if AoERotation == false
	then
		AoERotation = true
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0EArea of Effect|R&amp;quot;)
		RotationMode = &amp;quot;Area of Effect&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	elseif AoERotation == true
	then
		AoERotation = false
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0ESingle Target|R&amp;quot;)
		RotationMode = &amp;quot;Single Target&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	end
end


------------------
-- CONSOLE CAST --
------------------
SLASH_rcast1 = &amp;quot;/rcast&amp;quot;
function SlashCmdList.rcast(rcast, editbox)
	if rcast ~= &amp;quot;All&amp;quot; then
		rcast = tonumber(rcast)
		
		if CheckSpell == 0
		or rcast ~= LastCheckSpell
		then
			CheckSpell = rcast
			LastCheckSpell = rcast
		else
			CheckSpell = 0 end
	
	elseif rcast == &amp;quot;All&amp;quot; then
		CheckSpell = 0
		LastCheckSpell = 0
	else argument = &amp;quot; |CFFFF0303(No arguments)|R&amp;quot;
	end
	if CheckSpell ~= 0 then
		print(&amp;quot;|cff00ffffQueue: |r&amp;quot; .. GetSpellInfo(CheckSpell).. &amp;quot;(&amp;quot; .. CheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Queue&amp;quot;,CheckSpell)
	elseif LastCheckSpell ~= 0 then
		 print(&amp;quot;|cff00ffffRemoved: |r&amp;quot; .. GetSpellInfo(LastCheckSpell).. &amp;quot;(&amp;quot; .. LastCheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Standby&amp;quot;) end
end

if PQR_RotationStarted == true
then
	initMessage()
	RacialDetection()
	RunMacroText(&amp;quot;/rcast All&amp;quot;)
	PQR_RotationStarted = false
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Frost_Frame: Dark Succor</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimFrost_DarkSuccor_enable ~= true then return false end
local HealthFrame = tonumber(PQI_RubimFrost_DarkSuccor_value)
if BPtimer &amp;gt; 0
and FFtimer &amp;gt; 0
and TargetValidation(&amp;quot;target&amp;quot;,DeathStrike)
and UnitBuffID(&amp;quot;player&amp;quot;,101568)
and PlayerHP &amp;lt;= HealthFrame then
	PQR_DebugP(&amp;quot;Healing with Death Strike (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(DeathStrike)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Frost_Frame: Death Siphon</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RubimFrost_DeathSiphon_enable ~= true then return false end
local HealthFrame = tonumber(PQI_RubimFrost_DeathSiphon_value)

if TargetValidation(&amp;quot;target&amp;quot;,DeathSiphon)
and PlayerHP &amp;lt;= HealthFrame
then
	PQR_DebugP(&amp;quot;Healing with Death Siphon (Current HP: &amp;quot; .. PlayerHP)
	CastSpell(DeathSiphon)
	return true
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Unholy - Single Target Festerblight</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AoERotation == true then return false end
if PQI_RubimUnholy_Festerblight_enable == false then return false end

-- COMBAT BUFFS
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

if PQR_SpellAvailable(RaiseDead)
and not UnitExists(&amp;quot;pet&amp;quot;)
then
	CastSpell(RaiseDead)
end
		
--COMBAT
if not PlayerCombat then return false end

if not DiseasesSpell then
	DiseasesSpell = CreateFrame(&amp;quot;Frame&amp;quot;) 
	DiseasesSpell:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
	DiseasesSpell:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if (select(7,...)==Outbreak or select(7,...)==PlagueStrike) and select(3,...)==&amp;quot;player&amp;quot; then Dotted=true end end)
end

if Dotted ~= nil
and BPtimer &amp;gt; 0
then
	DotDmg=ActualDotDmg()
	Dotted = nil
end

--actions=auto_attack
--actions+=/blood_fury|beserking,if=time&amp;gt;=2
if MeeleRange()
then
	if Racial ~= 0 and PQR_SpellAvailable(Racial)
	and BossCheck()
	then
		CastSpell(Racial)
	end
end

--actions+=/outbreak,if=stat.attack_power&amp;gt;(dot.blood_plague.attack_power+5000)&amp;time&amp;gt;15&amp;!(cooldown.unholy_blight.remains&amp;gt;49)
if BPtimer &amp;gt; 0
and ActualDotDmg() &amp;gt; DotDmg
and TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (GetTime() - CombatTimer) &amp;gt; 4
then
	CastSpell(Outbreak)
end

--actions+=/plague_strike,if=stat.attack_power&amp;gt;(dot.blood_plague.attack_power+5000)&amp;time&amp;gt;15&amp;!(cooldown.unholy_blight.remains&amp;gt;49)
if BPtimer &amp;gt; 0
and ActualDotDmg() &amp;gt; DotDmg
and TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and (GetTime() - CombatTimer) &amp;gt; 4
then
	CastSpell(PlagueStrike)
end

--actions+=/mogu_power_potion,if=buff.dark_transformation.up&amp;target.time_to_die&amp;lt;=35
--actions+=/unholy_frenzy,if=time&amp;gt;=4
--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;10&amp;runic_power&amp;gt;=32
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 10
and PlayerRP &amp;gt;= 32
then
	CastSpell(BloodTap)
end

---actions+=/unholy_blight,if=talent.unholy_blight.enabled&amp;(dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3)
if PQR_SpellAvailable(UnholyBlight)
and (GetTime() - CombatTimer) &amp;gt; 4
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(UnholyBlight)
end

--actions+=/outbreak,if=dot.frost_fever.remains&amp;lt;3|dot.blood_plague.remains&amp;lt;3
if TargetValidation(&amp;quot;target&amp;quot;,Outbreak)
and (GetTime() - CombatTimer) &amp;gt; 4
and (BPtimer &amp;lt; 3
or FFtimer &amp;lt; 3)
then
	CastSpell(Outbreak)
end

--actions+=/soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=45&amp;unholy=1
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperUnholy)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 1
then
	CastSpell(SoulReaperUnholy)
end

--actions+=/soul_reaper,if=target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=45&amp;(dot.frost_fever.remains&amp;gt;(target.time_to _die%2)|dot.blood_plague.remains&amp;gt;(target.time_to_die%2))
if TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and (FFtimer &amp;gt; (TimeToDie/2) or BPtimer &amp;gt; (TimeToDie/2))
and TargetValidation(&amp;quot;target&amp;quot;,SoulReaperUnholy)
then
	CastSpell(SoulReaperUnholy)
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;(target.health.pct-3*(target.health.pct%target.time_to_die)&amp;lt;=35&amp;cooldown.soul_reaper.remains=0)
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and TargetHP - 3 * (TargetHP/TimeToDie) &amp;lt;= 35
and CdCheck(SoulReaperUnholy) &amp;lt; 1
then
	CastSpell(BloodTap)
end

--actions+=/plague_strike,if=!dot.blood_plague.ticking|!dot.frost_fever.ticking
if TargetValidation(&amp;quot;target&amp;quot;,PlagueStrike)
and BPtimer == 0
and (GetTime() - CombatTimer) &amp;gt; 4
then
	CastSpell(PlagueStrike)
end

--actions+=/summon_gargoyle
if TargetValidation(&amp;quot;target&amp;quot;,SummonGargoyle)
and BossCheck()
then
	CastSpell(SummonGargoyle)
end

--actions+=/dark_transformation
if PQR_SpellAvailable(DarkTransformation)
then
	CastSpell(DarkTransformation)
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.shadow_infusion.stack=5
if PQR_SpellAvailable(BloodTap)
and ShadowInfusionCount == 5
and BCCount &amp;gt;= 5
then
	CastSpell(BloodTap)
end

--actions+=/death_coil,if=runic_power&amp;gt;90
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and PlayerRP &amp;gt; 90
then
	CastSpell(DeathCoil)
end

--actions+=/deathand_decay,if=unholy=2
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(DeathandDecay)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
and UnitExists(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;unholy=2&amp;cooldown.death_and_decay.remains=0
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
and CdCheck(DeathandDecay) &amp;lt; 1
then
	CastSpell(BloodTap)
end

--actions+=/scourge_strike,if=unholy=2
if TargetValidation(&amp;quot;target&amp;quot;,ScourgeStrike)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 2
then
	CastSpell(ScourgeStrike)
end

--actions+=/festering_strike,if=blood=2&amp;frost=2
if TargetValidation(&amp;quot;target&amp;quot;,FesteringStrike)
and RuneCheck(&amp;quot;Blood&amp;quot;) == 2
and RuneCheck(&amp;quot;Frost&amp;quot;) == 2
then
	CastSpell(FesteringStrike)
end

--actions+=/death_and_decay,if=unholy=1
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(DeathandDecay)
and UnitExists(&amp;quot;mouseover&amp;quot;)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 1
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/death_and_decay,if=dot.frost_fever.remains&amp;gt;(target.time_to_die%2)|dot.blood_plague.re mains&amp;gt;(target.time_to_die%2)
if PQI_RubimGeneralDeathKnight_DisableCleave_enable == false
and PQR_SpellAvailable(DeathandDecay)
and (FFtimer &amp;gt; (TimeToDie/2) or BPtimer &amp;gt; (TimeToDie/2))
and UnitExists(&amp;quot;mouseover&amp;quot;)
then
	CastSpellByName(GetSpellInfo(43265))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;cooldown.death_and_decay.remains=0
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt; 5
and (RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;gt;= 1
or RuneCheck(&amp;quot;Death&amp;quot;) &amp;gt;= 1)
and CdCheck(DeathandDecay) &amp;lt; 1
then
	CastSpell(BloodTap)
end

--actions+=/death_coil,if=buff.sudden_doom.react|(buff.dark_transformation.down&amp;rune.unholy&amp;lt;=1)
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and (SuddenDoomBuff
or (ShadowInfusionCount ~= 5
and RuneCheck(&amp;quot;Unholy&amp;quot;) &amp;lt;= 1
and (CdCheck(SummonGargoyle) &amp;gt; 3 or not BossCheck())))
then
	CastSpell(DeathCoil)
end

--actions+=/scourge_strike,if=unholy=1
if TargetValidation(&amp;quot;target&amp;quot;,ScourgeStrike)
and RuneCheck(&amp;quot;Unholy&amp;quot;) == 1
then
	CastSpell(ScourgeStrike)
end

--actions+=/scourge_strike,if=dot.frost_fever.remains&amp;gt;(target.time_to_die%2)|dot.blood_plague.rem ains&amp;gt;(target.time_to_die%2)
if TargetValidation(&amp;quot;target&amp;quot;,ScourgeStrike)
and (FFtimer &amp;gt; (TimeToDie/2) or BPtimer &amp;gt; (TimeToDie/2))
then
	CastSpell(ScourgeStrike)
end

--actions+=/plague_leech,if=talent.plague_leech.enabled&amp;cooldown.outbreak.remains&amp;lt;1

--actions+=/festering_strike
if TargetValidation(&amp;quot;target&amp;quot;,FesteringStrike)
then
	CastSpell(FesteringStrike)
end

--actions+=/horn_of_winter
if PQR_SpellAvailable(HornofWinter)
then
	CastSpell(HornofWinter)
end

--actions+=/death_coil,if=buff.dark_transformation.down|(cooldown.summon_gargoyle.remains&amp;gt;8&amp;buff.dark_transformation.remains&amp;gt;8)
if TargetValidation(&amp;quot;target&amp;quot;,DeathCoil)
and (ShadowInfusionCount &amp;lt;= 4
or (CdCheck(SummonGargoyle) &amp;gt; 8
and DarkTransformationTimer &amp;gt; 8))
then
	CastSpell(DeathCoil)
end

--actions+=/blood_tap,if=talent.blood_tap.enabled&amp;buff.blood_charge.stack&amp;gt;=8
if PQR_SpellAvailable(BloodTap)
and BCCount &amp;gt;= 8
then
	CastSpell(BloodTap)
end

--actions+=/empower_rune_weapon
if PQR_SpellAvailable(EmpowerRuneWeapon)
and MeeleRange()
and BossCheck()
and CdCheck(FesteringStrike) &amp;gt; 1.2
and CdCheck(ScourgeStrike) &amp;gt; 1.2
and PlayerRP &amp;lt; 32
then
	CastSpell(EmpowerRuneWeapon)
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[ MISC ] Functions (General)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- This profile would never be done without:
-- team_Nova (Mentally, Crystal_Tech and bu_ba_911)
-- D1sc1pl1n3
-- Kinkeh
-- cpowroks
-- Gabbz
-- googlebee
-- Xelper
-- imdasandman
-- kuukuu
-- Ninjaderp
-- Diesall


-----------------
-- DUMB CHECKS --
-----------------
if  (select(2, UnitClass(&amp;quot;player&amp;quot;)) ~= &amp;quot;DEATHKNIGHT&amp;quot;)
then
	print(&amp;quot;Error: Wrong Class - Expecting Death Knight&amp;quot;)
	PQR_StopRotation()
elseif UnitLevel(&amp;quot;player&amp;quot;) ~= 90
then
	print(&amp;quot;Error: Wrong Level - Expecting LvL 90&amp;quot;)
	PQR_StopRotation()
elseif GetSpecialization() == nil
then
	print(&amp;quot;Error: Wrong Spec - None selected!&amp;quot;)
	PQR_StopRotation()
end

----------------
-- SPEC CHECK --
----------------
if GetSpecialization() == 1 then
	Spec = &amp;quot;Blood&amp;quot;
	PQR_SwapRotation(&amp;quot;Blood (Rubim)&amp;quot;) 
elseif GetSpecialization() == 2 then
	Spec = &amp;quot;Frost&amp;quot;
	if PQI_RubimFrost_FrostDW_enable == false then
		PQR_SwapRotation(&amp;quot;Frost 2H (Rubim)&amp;quot;)
	elseif PQI_RubimFrost_FrostDW_enable == true then
		PQR_SwapRotation(&amp;quot;Frost DW (Rubim)&amp;quot;)
	end
elseif GetSpecialization() == 3 then
	Spec = &amp;quot;Unholy&amp;quot;
	PQR_SwapRotation(&amp;quot;Unholy (Rubim)&amp;quot;)
end

---------------
-- PQI_TEXT --
--------------
function PQR_SendText(CHOICE,SPELL)
	if CHOICE == &amp;quot;Standby&amp;quot;
	then
		PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Standby: &amp;quot; .. RotationMode, nil, &amp;quot;ffffff&amp;quot;)
	end
	
	if CHOICE ~= &amp;quot;Standby&amp;quot;
	and SPELL ~= 0
	then
		local nskill = GetSpellInfo(SPELL)		
		
		if CHOICE == &amp;quot;Queue&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Queue Skill: &amp;quot; .. nskill, nil, &amp;quot;14DCB4&amp;quot;)
		end
		
		if CHOICE == &amp;quot;Casted&amp;quot;
		then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;, &amp;quot;Casted: &amp;quot; .. nskill, nil, &amp;quot;ffffff&amp;quot;)
		end
	end
end

---------------------------------
-- NOVA_DATA.LUA / by TeamNova --
---------------------------------
-- Target Validation Function.
TargetValidation = nil
function TargetValidation(unit, spell)
	if UnitExists(unit)
	 and IsPlayerSpell(spell)
	 and UnitCanAttack(&amp;quot;player&amp;quot;, unit) == 1 
	 and not UnitIsDeadOrGhost(unit) 
	 and not PQR_IsOutOfSight(unit, 1) then
	 	if IsSpellKnown(spell) then  -- Redundent Check to see if Morphed Spell or not
	 		if PQR_SpellAvailable(spell) then
		 		if IsSpellInRange(GetSpellInfo(spell), unit) == 1 then
		 			return true
		 		else
		 			return false
		 		end
		 	else
		 		return false
		 	end
	 	else -- If spell is a morphed spell, return true without Range Check
	 		if select(2, GetSpellCooldown(spell)) == 0 then
	 			return true
	 		end
	 	end
	end
end


--RESOURCES
Nova_UnitInfo = nil
function Nova_UnitInfo(t)
	-- Takes an input of UnitID (player, target, pet, mouseover, etc) and gives you their most useful info
		local TManaActual = UnitPower(t)
		local TMaxMana = UnitPowerMax(t)
		if TMaxMana == 0 then TMaxMana = 1 end			
		local TMana = 100 * UnitPower(t) / TMaxMana
		local THealthActual = UnitHealth(t)
		local THealth = 100 * UnitHealth(t) / UnitHealthMax(t) 
		local myClassPower = 0 
		local PQ_Class = select(2, UnitClass(t)) 
		local PQ_UnitLevel = UnitLevel(t)
		local PQ_CombatCheck = UnitAffectingCombat(t) 
		if PQ_Class == &amp;quot;PALADIN&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 9)
			if UnitBuffID(&amp;quot;player&amp;quot;, 90174) then
				myClassPower = myClassPower + 3
			end
		elseif PQ_Class == &amp;quot;PRIEST&amp;quot; then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 13)
		elseif PQ_Class == &amp;quot;WARLOCK&amp;quot; then
			if PQR_Spec == 3 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 14) -- Destruction: Burning Embers
			elseif PQR_Spec == 2 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 15) -- Demonology: Demonic Fury
			elseif PQR_Spec == 1 then
				myClassPower = UnitPower(&amp;quot;player&amp;quot;, 7) -- Affliction: Soul Shards
			end
		elseif PQ_Class == &amp;quot;DRUID&amp;quot; and PQ_Class == 2 then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 8)
		elseif PQ_Class == &amp;quot;MONK&amp;quot;  then
			myClassPower = UnitPower(&amp;quot;player&amp;quot;, 12)
		elseif PQ_Class == &amp;quot;ROGUE&amp;quot; and t ~= &amp;quot;player&amp;quot; then
			myClassPower = GetComboPoints(&amp;quot;player&amp;quot;, t)
		end
		--       1            2          3         4           5             6          7               8
		return THealth, THealthActual, TMana, TManaActual, myClassPower, PQ_Class, PQ_UnitLevel, PQ_CombatCheck
end

--BOSSCHECK
PQ_BossUnits = {
	-- Cataclysm Dungeons --
	-- Abyssal Maw: Throne of the Tides
	40586,		-- Lady Naz&amp;apos;jar
	40765,		-- Commander Ulthok
	40825,		-- Erunak Stonespeaker
	40788,		-- Mindbender Ghur&amp;apos;sha
	42172,		-- Ozumat
	-- Blackrock Caverns
	39665,		-- Rom&amp;apos;ogg Bonecrusher
	39679,		-- Corla, Herald of Twilight
	39698,		-- Karsh Steelbender
	39700,		-- Beauty
	39705,		-- Ascendant Lord Obsidius
	-- The Stonecore
	43438,		-- Corborus
	43214,		-- Slabhide
	42188,		-- Ozruk
	42333,		-- High Priestess Azil
	-- The Vortex Pinnacle
	43878,		-- Grand Vizier Ertan
	43873,		-- Altairus
	43875,		-- Asaad
	-- Grim Batol
	39625,		-- General Umbriss
	40177,		-- Forgemaster Throngus
	40319,		-- Drahga Shadowburner
	40484,		-- Erudax
	-- Halls of Origination
	39425,		-- Temple Guardian Anhuur
	39428,		-- Earthrager Ptah
	39788,		-- Anraphet
	39587,		-- Isiset
	39731,		-- Ammunae
	39732,		-- Setesh
	39378,		-- Rajh
	-- Lost City of the Tol&amp;apos;vir
	44577,		-- General Husam
	43612,		-- High Prophet Barim
	43614,		-- Lockmaw
	49045,		-- Augh
	44819,		-- Siamat
	-- Zul&amp;apos;Aman
	23574,		-- Akil&amp;apos;zon
	23576,		-- Nalorakk
	23578,		-- Jan&amp;apos;alai
	23577,		-- Halazzi
	24239,		-- Hex Lord Malacrass
	23863,		-- Daakara
	-- Zul&amp;apos;Gurub
	52155,		-- High Priest Venoxis
	52151,		-- Bloodlord Mandokir
	52271,		-- Edge of Madness
	52059,		-- High Priestess Kilnara
	52053,		-- Zanzil
	52148,		-- Jin&amp;apos;do the Godbreaker
	-- End Time
	54431,		-- Echo of Baine
	54445,		-- Echo of Jaina
	54123,		-- Echo of Sylvanas
	54544,		-- Echo of Tyrande
	54432,		-- Murozond
	-- Hour of Twilight
	54590,		-- Arcurion
	54968,		-- Asira Dawnslayer
	54938,		-- Archbishop Benedictus
	-- Well of Eternity
	55085,		-- Peroth&amp;apos;arn
	54853,		-- Queen Azshara
	54969,		-- Mannoroth
	55419,		-- Captain Varo&amp;apos;then
	
	-- Mists of Pandaria Dungeons --
	-- Scarlet Halls
	59303,		-- Houndmaster Braun
	58632,		-- Armsmaster Harlan
	59150,		-- Flameweaver Koegler
	-- Scarlet Monastery
	59789,		-- Thalnos the Soulrender
	59223,		-- Brother Korloff
	3977,		-- High Inquisitor Whitemane
	60040,		-- Commander Durand
	-- Scholomance
	58633,		-- Instructor Chillheart
	59184,		-- Jandice Barov
	59153,		-- Rattlegore
	58722,		-- Lilian Voss
	58791,		-- Lilian&amp;apos;s Soul
	59080,		-- Darkmaster Gandling
	-- Stormstout Brewery
	56637,		-- Ook-Ook
	56717,		-- Hoptallus
	59479,		-- Yan-Zhu the Uncasked
	-- Tempe of the Jade Serpent
	56448,		-- Wise Mari
	56843,		-- Lorewalker Stonestep
	59051,		-- Strife
	59726,		-- Peril
	58826,		-- Zao Sunseeker
	56732,		-- Liu Flameheart
	56762,		-- Yu&amp;apos;lon
	56439,		-- Sha of Doubt
	-- Mogu&amp;apos;shan Palace
	61444,		-- Ming the Cunning
	61442,		-- Kuai the Brute
	61445,		-- Haiyan the Unstoppable
	61243,		-- Gekkan
	61398,		-- Xin the Weaponmaster
	-- Shado-Pan Monastery
	56747,		-- Gu Cloudstrike
	56541,		-- Master Snowdrift
	56719,		-- Sha of Violence
	56884,		-- Taran Zhu
	-- Gate of the Setting Sun
	56906,		-- Saboteur Kip&amp;apos;tilak
	56589,		-- Striker Ga&amp;apos;dok
	56636,		-- Commander Ri&amp;apos;mok
	56877,		-- Raigonn
	-- Siege of Niuzao Temple
	61567,		-- Vizier Jin&amp;apos;bak
	61634,		-- Commander Vo&amp;apos;jak
	61485,		-- General Pa&amp;apos;valak
	62205,		-- Wing Leader Ner&amp;apos;onok

	-- Training Dummies --
	46647,		-- Level 85 Training Dummy
	67127,		-- Level 90 Training Dummy
	
	-- Pandaria Raid Adds --
	63346,		-- Tsulong: The Dark of Night
	62969,		-- Tsulong: Embodied Terror
	62977,		-- Tsulong: Frightspawn
	62919,		-- Tsulong: Unstable Sha
	61034,		-- Sha of Fear: Terror Spawn
	61003		-- Sha of Fear: Dread Spawn
}

SpecialUnit = nil
function SpecialUnit()
	local PQ_BossUnits = PQ_BossUnits
	
	if UnitExists(&amp;quot;target&amp;quot;) then
		local npcID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
		
		-- Dungeons &amp; Raids
		if UnitLevel(&amp;quot;target&amp;quot;) == -1 then return true else
			for i=1,#PQ_BossUnits do
				if PQ_BossUnits[i] == npcID then return true end
			end
			return false
		end
	else return false end
end

---------------
-- VAR SETUP --
---------------
if PQ_DKUHRubim == nil then
	PQ_DKUHRubim = true
	CheckSpell = 0
	SpellSucess = false
	
	-- AOE CHECKS	
	AoERotation = false
	RotationMode = &amp;quot;Single Target&amp;quot;
	
	-- SENDTEXT
	PQR_SendText(&amp;quot;Standby&amp;quot;)
end

------------------
-- INIT MESSAGE --
------------------
function initMessage()
	PQR_WriteToChat(&amp;quot;|cff91e782Rubim&amp;apos;s Blood |cff82cee7Loaded!|cffffffff&amp;quot;)
	if PQI_RubimGeneralDeathKnight_BloodSET_enable == true
	then
		UseEquipmentSet(PQI_RubimGeneralDeathKnight_BloodSET_value)
	end
end

-------------------
-- DEBUG OPTIONS --
-------------------
PQR_Rubim_Debug = 0

-------------
-- RACIAL --
------------
function RacialDetection()
	Racial = 0
	local _,Race = UnitRace(&amp;quot;player&amp;quot;)
	if Race == &amp;quot;Orc&amp;quot;
	then
		local Orc_Racial = {
		20572,
		33697,
		33702,
		82836
		}
	
		for i=1, #Orc_Racial do
			if IsSpellKnown(Orc_Racial[i]) then
				Racial = Orc_Racial[i]
			end
		end
	end
end

if Race == &amp;quot;Troll&amp;quot;
then
	Racial = 26297
end

------------------
-- Meele Range --
-----------------
function MeeleRange()
	if IsSpellInRange(GetSpellInfo(45462), &amp;quot;target&amp;quot;) == 1
	then return true else return false
	end
end

----------------
-- CAST SPELL --
----------------
function CastSpell(spell)
	CastSpellByName(GetSpellInfo(spell),nil)
end

if UnitAffectingCombat(&amp;quot;player&amp;quot;)
and PQR_Rubim_Debug ~= 0 then
	if not castspellsucced then
		castspellsucced = CreateFrame(&amp;quot;Frame&amp;quot;) 
		castspellsucced:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
		castspellsucced:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if select(7,...)~= 0 and select(3,...)==&amp;quot;player&amp;quot; then DebugSpell = 1 LastSpell = GetSpellInfo(select(7,...)) end end)
	end
	
	if DebugSpell ~= 0
	then
		PQR_WriteToChat(&amp;quot;Casted: |cffffcc00&amp;quot; .. LastSpell)
		DebugSpell = 0
	end
end

--------------
-- CD Check --
--------------
function CdCheck(spellid)
	Sstart, Sduration, Senabled = GetSpellCooldown(spellid)
	Scooldown = (Sstart + Sduration - GetTime())
	if Sstart == 0
	then
		Scooldown = 0
	end
	return Scooldown
end

------------------
-- SPELL SUCESS --
------------------
if not spellSucced then
		spellSucced = CreateFrame(&amp;quot;Frame&amp;quot;) 
		spellSucced:RegisterEvent(&amp;quot;UNIT_SPELLCAST_SUCCEEDED&amp;quot;) 
		spellSucced:SetScript(&amp;quot;OnEvent&amp;quot;,function(...) if select(7,...)==CheckSpell then SpellSucess=true end end)
end

-------------
-- PRE POT --
-------------
function PrePot()
	if UnitBuffID(&amp;quot;player&amp;quot;,105706)
	then return true else return false end
end

-- Variables
PQR_ResetMovementTime = 0.3
PQR_SpellAvailableTime = ((select(3,GetNetStats()) + select(4,GetNetStats())) / 1000)

--Player Info
PlayerRP	= select(3, Nova_UnitInfo(&amp;quot;player&amp;quot;))
PlayerHP			= Nova_UnitInfo(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
	
--PQR Functions
isMoving			= PQR_IsMoving()

--Target Info
TargetHP				= select(1, Nova_UnitInfo(&amp;quot;target&amp;quot;))
EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
		
-----------------
-- Time to die --
-----------------
TimeToDie = 999999
if UnitExists(&amp;quot;target&amp;quot;)
and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) == 1
and PlayerCombat then
	if (guid ~= UnitGUID(&amp;quot;target&amp;quot;)) or (guid == UnitGUID(&amp;quot;target&amp;quot;) and UnitHealth(&amp;quot;target&amp;quot;) == _firstLifeMax) then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealthMax(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end             
_currentLife = UnitHealth(&amp;quot;target&amp;quot;)
_currentTime = GetTime()
timeDiff = _currentTime - _firstTime
hpDiff = _firstLife - _currentLife
	if hpDiff &amp;gt; 0 then
		fullTime = timeDiff*_firstLifeMax/hpDiff
		pastFirstTime = (_firstLifeMax - _firstLife)*timeDiff/hpDiff
		calcTime = _firstTime - pastFirstTime + fullTime - _currentTime
		if calcTime &amp;lt; 1 then
			calcTime = 1
		end
   	TimeToDie = calcTime
	end
	if hpDiff &amp;lt;= 0 then
		guid = UnitGUID(&amp;quot;target&amp;quot;)
		_firstLife = UnitHealth(&amp;quot;target&amp;quot;)
		_firstLifeMax = UnitHealth(&amp;quot;target&amp;quot;)
		_firstTime = GetTime()
	end

-- dummy
	if UnitHealthMax(&amp;quot;target&amp;quot;) == 1 then
		TimeToDie = 99
	end
end

--------------
-- AOE SWAP --
--------------
if Timer == nil then
	Timer = 0
end

if PQI:IsHotkeys(PQI_RubimGeneralDeathKnight_AreaofEffect_key)
and GetTime() - Timer &amp;gt; 0.5
then
	Timer = GetTime()
	if AoERotation == false
	then
		AoERotation = true
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0EArea of Effect|R&amp;quot;)
		RotationMode = &amp;quot;Area of Effect&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	elseif AoERotation == true
	then
		AoERotation = false
		print(&amp;quot;|CFF1CB619Rotation|R: |CFFFE8A0ESingle Target|R&amp;quot;)
		RotationMode = &amp;quot;Single Target&amp;quot;
		PQR_SendText(&amp;quot;Standby&amp;quot;)
		PlaySound(&amp;quot;SPELLBOOKCHANGEPAGE &amp;quot;, &amp;quot;master&amp;quot;)
	end
end

------------------
-- CONSOLE CAST --
------------------
SLASH_rcast1 = &amp;quot;/rcast&amp;quot;
function SlashCmdList.rcast(rcast, editbox)
	if rcast ~= &amp;quot;All&amp;quot; then
		rcast = tonumber(rcast)
		
		if CheckSpell == 0
		or rcast ~= LastCheckSpell
		then
			CheckSpell = rcast
			LastCheckSpell = rcast
		else
			CheckSpell = 0 end
	
	elseif rcast == &amp;quot;All&amp;quot; then
		CheckSpell = 0
		LastCheckSpell = 0
	else argument = &amp;quot; |CFFFF0303(No arguments)|R&amp;quot;
	end
	if CheckSpell ~= 0 then
		print(&amp;quot;|cff00ffffQueue: |r&amp;quot; .. GetSpellInfo(CheckSpell).. &amp;quot;(&amp;quot; .. CheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Queue&amp;quot;,CheckSpell)
	elseif LastCheckSpell ~= 0 then
		 print(&amp;quot;|cff00ffffRemoved: |r&amp;quot; .. GetSpellInfo(LastCheckSpell).. &amp;quot;(&amp;quot; .. LastCheckSpell .. &amp;quot;)&amp;quot;)
		PQR_SendText(&amp;quot;Standby&amp;quot;) end
end

if PQR_RotationStarted == true
then
	initMessage()
	RacialDetection()
	RunMacroText(&amp;quot;/rcast All&amp;quot;)
	PQR_RotationStarted = false
end</Lua><RecastDelay>250</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></DEATHKNIGHT>