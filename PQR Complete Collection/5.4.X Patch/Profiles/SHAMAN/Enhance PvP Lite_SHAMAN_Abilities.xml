<?xml version="1.0" encoding="utf-8" ?><SHAMAN><Ability><Name>-- Start Fight --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PauseKey
or IsMounted()
or SpellIsTargeting()
or UnitBuffID(&amp;quot;player&amp;quot;,5384)
or UnitInVehicle(&amp;quot;player&amp;quot;)
or UnitIsDead(&amp;quot;target&amp;quot;) 
or UnitIsDead(&amp;quot;player&amp;quot;)
or UnitBuffID(&amp;quot;player&amp;quot;, 77769)
or not UnitAffectingCombat(&amp;quot;player&amp;quot;)
or not UnitExists(&amp;quot;target&amp;quot;) then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Searing Totem</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local arg1, totemName, startTime, duration = GetTotemInfo( 1 )
local est_dur = startTime+duration-GetTime() 

local FireEle = GetSpellInfo(2894)

if totemName == FireEle then 
	return false
end

if est_dur &amp;lt; 1 then
	_castSpell(3599)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Stormstrike</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Ascendance = UnitBuffID(&amp;quot;player&amp;quot;, 114050)
local SBAvil = PQR_SpellAvailable(115356)
local SSAvil = PQR_SpellAvailable(17364)

if SBAvil
and Ascendance then  
	CastSpellByName(tostring(GetSpellInfo(115356))) 
end

if SSAvil
and not Ascendance then 
	_castSpell(17364) 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>False</SkipUnknown></Ability><Ability><Name>Enh : Lava Lash</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>_castSpell(60103, &amp;quot;target&amp;quot;)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Flame Shock</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Flameshock = select(7,UnitDebuffID(&amp;quot;target&amp;quot;,8050,&amp;quot;PLAYER&amp;quot;)) 

if not Flameshock 
or Flameshock - GetTime() &amp;lt; 7 then
	_castSpell(8050, &amp;quot;Target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Unleash Elements</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>_castSpell(73680)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Earth Shock</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Flameshock = select(7,UnitDebuffID(&amp;quot;target&amp;quot;,8050,&amp;quot;PLAYER&amp;quot;)) 

if Flameshock ~= nil
and Flameshock - GetTime() &amp;lt; 7 then
	return false 
else 
	_castSpell(8042, &amp;quot;Target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healing : Healing Rain</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if HealingRainKey then
  _castSpell(73920)
  if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Lightning Shield</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitBuffID( &amp;quot;player&amp;quot;, 324 ) == nil then
	_castSpell(324)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Ghost Wolf</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not inMelee() then
	_castSpell(2645)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Main Hand</Name><Default>false</Default><SpellID>8232</SpellID><Actions></Actions><Lua>local arg1= GetWeaponEnchantInfo()

if arg1 == nil then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Off Hand</Name><Default>false</Default><SpellID>8033</SpellID><Actions></Actions><Lua>local arg1, arg2, arg3, arg4 = GetWeaponEnchantInfo()

if arg4 == nil then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Stormlash Totem</Name><Default>false</Default><SpellID>120668</SpellID><Actions></Actions><Lua>if UseCD then
	_castSpell(120668)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-- Options --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Keybinds
ShiftKey		 	= IsLeftShiftKeyDown()	
ShamKey				= IsLeftControlKeyDown()
--					= IsRightAltKeyDown()
--					= IsRightShiftKeyDown()
--					= IsRightControlKeyDown()
pauseKey			= IsLeftAltKeyDown()
burstKey			= IsMouseButtonDown(3)  --When you push down the scroll button on mouse(usually)
HealingRainKey		= IsMouseButtonDown(4)  --MouseButton4 depends on mouse
HexKey				= IsMouseButtonDown(5)  --MouseButton5 depends on mouse

--List of UsableKey Variables.
-- ShiftKey
-- ShamKey
-- pauseKey
-- burstKey
-- HealingRainKey
-- HexKey


-- OPTIONS -- 

--Healing Surge
hsHp = 60

--Healing Stream
hstHp = 80

AutoStormlash = false</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Cooldowns</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Ascendance = UnitBuffID(&amp;quot;player&amp;quot;, 114050)
local AscendanceAvil = PQR_SpellAvailable(114049)

if burstKey then

	-- Gloves
	if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,10) == 0 then 
			UseInventoryItem(10)
	end
	
	--Trinkets
	if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13) == 0 then 
			UseInventoryItem(13)
	end
	
	--Orc
	if PQR_SpellAvailable(33697) then
		_castSpell(33697)
	end
	
	--Troll
	if PQR_SpellAvailable(26297) then
		_castSpell(26297)
	end
	
	--Elem Mastery
	if PQR_SpellAvailable(16166) then 
		_castSpell(16166)
	end
	
	--AS
	if PQR_SpellAvailable(16188)  then 
		_castSpell(16188)
	end
	
	--Ascendance
	if not Ascendance 
	and AscendanceAvil then
		_castSpell(114049)
	end	
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--- Init ---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Load LUA data files.
if PQR_RotationStarted then
	PQR_RotationStarted = false 
	
	-- Load required data files
	if PQR_LoadLua ~= nil then
		if PQR_LoadLua(&amp;quot;PQR_ShamanPvPLite.lua&amp;quot;) == false then
			PQR_WriteToChat(&amp;quot;|cffb73737You&amp;apos;re missing PQR_ShamanPvPLite.lua - Make sure it&amp;apos;s in your Data folder! The Rotation has been halted.|cffffffff&amp;quot;, &amp;quot;Error&amp;quot;)
			PQR_StopRotation()
			return true
		end
	end
end

 

GroupInfo() 


--Pause
if PauseKey 
or IsMounted() 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Wolves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if burstKey then
	_castSpell(51533)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Fire Ele</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if burstKey then
	_castSpell(2894)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Healthstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local PlayerHP = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)

if PlayerHP &amp;lt; 35
and GetItemCount(5512,false,false) &amp;gt; 0 
and ( select(2, GetItemCooldown(5512)) == 0 ) then
    UseItemByName(5512)
    return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healing : Healing Tide</Name><Default>false</Default><SpellID>108280</SpellID><Actions></Actions><Lua>local PlayerHP = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)

local Party1HP = 100 * UnitHealth(&amp;quot;party1&amp;quot;) / UnitHealthMax(&amp;quot;party1&amp;quot;)

local Party2HP = 100 * UnitHealth(&amp;quot;party2&amp;quot;) / UnitHealthMax(&amp;quot;party2&amp;quot;)

if PQR_SpellAvailable(108280) == false then
return false
end

if (PlayerHP &amp;lt; 70 and Party1HP &amp;lt; 70) or (PlayerHP &amp;lt; 70 and Party2HP &amp;lt; 70) or (Party1HP &amp;lt; 70 and Party2HP &amp;lt; 70)  then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healing : Decurse</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if ValidDispel(&amp;quot;player&amp;quot;) then
    CastSpellByName(GetSpellInfo(51886), &amp;quot;player&amp;quot;)
end

if PQR_SpellAvailable(51886) then
	for i=1, #members do
		if ValidDispel(members[i].Unit)
		and PQR_IsOutOfSight(members[i].Unit) == false then
			_castSpell(51886, members[i].Unit)
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Defensives</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if ShiftKey then	
  CastSpellByName(tostring(GetSpellInfo(108271))) 
end


if ShamKey then	
  CastSpellByName(tostring(GetSpellInfo(30823))) 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Grounding Totem</Name><Default>false</Default><SpellID>8177</SpellID><Actions></Actions><Lua>for i = 1, #custTars do
	if UseGrounding(custTars[i]) then
		_castSpell(8177)
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Lightning Bolt</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local MS, _, _, Stack = UnitBuffID( &amp;quot;player&amp;quot;, 53817 )

if MS ~= nil then
	if Stack == 5 then	
		_castSpell(403, &amp;quot;target&amp;quot;)
	end	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healing : Healing Stream</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(5394) then
	for i=1, #members do
		if members[i].HP &amp;lt; hstHp 
		and PQR_IsOutOfSight(members[i].Unit) == false 
		and IsSpellInRange(GetSpellInfo(8004), members[i].Unit) == 1 
		and not UnitIsEnemy(members[i].Unit, &amp;quot;player&amp;quot;) then
			_castSpell(5394)
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Purge Important</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local PlayerHP = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) 

local purgeThis1 = {

1044,   -- Hand of Freedom

6940,   -- Hand of Sacrifice

69369,   -- Predatory Swiftness 

1022,   -- Hand of Protection

110909	--Alter time
}

if PQR_SpellAvailable(370) 
and PlayerHP &amp;gt; 50 then
	for i = 1, #custTars do
		if UnitExists(custTars[i]) then
			for j = 1, #purgeThis1 do
				if UnitBuffID(custTars[i], purgeThis1[j]) ~= nil
				and PQR_IsOutOfSight(custTars[i], 0.1) == false then
					_castSpell(370, custTars[i])
				end
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Frost Shock</Name><Default>false</Default><SpellID>8056</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;) 
and UnitIsEnemy(&amp;quot;target&amp;quot;, &amp;quot;player&amp;quot;) 
and immuneToSlow(&amp;quot;target&amp;quot;) == nil then
	_castSpell(8056, &amp;quot;target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healing : Healing Surge</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local myHp = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)
local _, _, _, msStack = UnitBuffID( &amp;quot;player&amp;quot;, 53817 )


if myHp &amp;lt; hsHp 
and msStack == 5 then
	   _castSpell(8004, &amp;quot;player&amp;quot;)
end

if PQR_SpellAvailable(8004) then
	for i=1, #members do
		if members[i].HP &amp;lt; hsHp 
		and PQR_IsOutOfSight(members[i].Unit) == false  
		and msStack == 5 then
			_castSpell(8004, members[i].Unit)
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Hex</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local HexCD = select(2,GetSpellCooldown(51514))

if HexKey
and HexCD &amp;lt; 2 then
	if UnitExists(&amp;quot;focus&amp;quot;)
	and UnitIsEnemy(&amp;quot;focus&amp;quot;, &amp;quot;player&amp;quot;)
	and PQR_IsOutOfSight(&amp;quot;focus&amp;quot;, 0.1) == false
	and IsSpellInRange(&amp;quot;Hex&amp;quot;, &amp;quot;focus&amp;quot;) == 1 then
		_castSpell(51514, &amp;quot;focus&amp;quot;)
	end
	
	if UnitExists(&amp;quot;target&amp;quot;)
	and UnitIsEnemy(&amp;quot;target&amp;quot;, &amp;quot;player&amp;quot;)
	and PQR_IsOutOfSight(&amp;quot;target&amp;quot;, 0.1) == false
	and IsSpellInRange(&amp;quot;Hex&amp;quot;, &amp;quot;target&amp;quot;) == 1 then
		_castSpell(51514, &amp;quot;target&amp;quot;)
	end	
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Purge</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local PlayerHP = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)

local PlayerMana = 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;)

local purgeThis2 = {

1044,   -- Hand of Freedom

6940,   -- Hand of Sacrifice

69369,   -- Predatory Swiftness

12472,  -- Icy Veins

1022,   -- Hand of Protection

11426,   -- Ice Barrier

20925,  -- Sacred Shield

114250,   -- Selfless Healer

17    -- Power Word: Shield

}

if PQR_SpellAvailable(370)  
and PlayerMana &amp;gt; 50 then
	for i = 1, #custTars do
		if UnitExists(custTars[i]) then
			for j = 1, #purgeThis2 do
				if UnitBuffID(custTars[i], purgeThis2[j]) ~= nil
				and UnitCanAttack(&amp;quot;player&amp;quot;,custTars[i]) ~= nil
				and PQR_IsOutOfSight(custTars[i], 0.1) == false then
					_castSpell(370, custTars[i])
				end
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Tremor Totem</Name><Default>false</Default><SpellID>8143</SpellID><Actions></Actions><Lua>local _, talent = GetTalentRowSelectionInfo(4)
local fears = {
111397,  -- Blood Fear
5484,  -- Howl
8122,  -- scream
5782,   -- Fear
5246, -- Intimidating Shout
113004  -- Intimidating Shout (druid symbio) 
}

if PQR_SpellAvailable(8143) then
	for i = 1, #members do
		for f = 1, #fears do
			local isFeared, _, _, _, _, Dur = UnitDebuffID(members[i].Unit, fears[f])
			
			if isFeared
			and Dur &amp;gt;= 6  --Most full fears are 6 or 8 seconds
			and IsSpellInRange(GetSpellInfo(8004), members[i].Unit) == 1 then
				_castSpell(8143)
				
				if talent == 8 then
					RunMacroText(&amp;quot;/click TotemFrameTotem1 RightButton&amp;quot;)
				end
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Enh : Fire Nova</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local FlameShock = UnitDebuffID(&amp;quot;target&amp;quot;,8050,&amp;quot;PLAYER&amp;quot;)

if FlameShock ~= nil then
	_castSpell(1535)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></SHAMAN>