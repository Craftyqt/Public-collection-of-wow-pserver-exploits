<?xml version="1.0" encoding="utf-8" ?><SHAMAN><Ability><Name>-Elemental- Elemental Blast</Name><Default>false</Default><SpellID>117014</SpellID><Actions></Actions><Lua>if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) then return false end
if Nova_AOE == 1 then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Stone Bulwark Totem</Name><Default>false</Default><SpellID>108270</SpellID><Actions></Actions><Lua>if Nova_Bulwark ~= 1 then return false end

	return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Thunderstorm</Name><Default>false</Default><SpellID>51490</SpellID><Actions></Actions><Lua>if Nova_Storm ~= 1 then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Ascendance</Name><Default>false</Default><SpellID>0</SpellID><Actions>/use 10</Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxElementalOffensiveSettings_Ascendance_enable then return false end
if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end
if Ascendance then return false end

if IsPlayerSpell(117014) then
	if PQR_SpellAvailable(117014) then
	return false
	end
end

if FlameShock then
	if FlameShocktimer - GetTime() &amp;lt; 16 then 
	return false
	end
else
return false
end
if IsPlayerSpell(117012) then
	if PQR_SpellAvailable(1535) then
	return false
	end
end
if GetSpellCD(51505) &amp;lt; 1 then return false end
if PQR_SpellAvailable(51505) and Nova_AOE ~= 1 then return false end
if not PQR_SpellAvailable(114049) then return false end

if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465 then
	local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
		if not Fluidity then
		return false
		end				
	end	
end


CastSpellByName(GetSpellInfo(114049))</Lua><RecastDelay>60000</RecastDelay><Target>Player</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Elemental Mastery</Name><Default>false</Default><SpellID>16166</SpellID><Actions></Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxEnhancementOffensiveSettings_ElementalMastery_enable then return false end
if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end
---if (Berserking or Bloodlust) and cTime &amp;gt; 10 then 
---return false end
if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				if ElementalGlyph == false
				or PQR_SpellAvailable(2894)
				or FCD &amp;gt; 70 then
				return true
				end
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					if ElementalGlyph == false
					or PQR_SpellAvailable(2894)
					or FCD &amp;gt; 70 then
					return true
					end
				elseif Feed then
					if ElementalGlyph == false
					or PQR_SpellAvailable(2894)
					or FCD &amp;gt; 70 then
					return true
					end
				end
			end
		end
	elseif ElementalGlyph == false
	or PQR_SpellAvailable(2894)
	or FCD &amp;gt; 50 then
	return true
	end
elseif ElementalGlyph == false
or PQR_SpellAvailable(2894)
or FCD &amp;gt; 70 then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Lightning Bolt</Name><Default>false</Default><SpellID>403</SpellID><Actions></Actions><Lua>if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) and not UnitBuffID(&amp;quot;player&amp;quot;,77756) then return true end
if Nova_AOE == 1 then return false end

if FlameShock then
	if GetSpellCD(51505) &amp;lt; 1 and (not PQR_IsMoving(0.3) or not UnitBuffID(&amp;quot;player&amp;quot;, 79206) and not UnitBuffID(&amp;quot;player&amp;quot;,77756)) then
	return false 
	end
end
return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Healthstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalDefensiveSettings_Healthstone_enable then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementDefensiveSettings_Healthstone_enable then return false end

if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then v=PQI_SoapboxElementalDefensiveSettings_Healthstone_value
elseif GetSpecialization(&amp;quot;player&amp;quot;) == 2 then v=PQI_SoapboxEnhancementDefensiveSettings_Healthstone_value end


if GetItemCount(5512,false,true) &amp;gt; 0
	and Playerhealth &amp;lt;= v
	and PQR_SpellAvailable(5512)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and GetItemCooldown(5512) == 0
then
	UseItemByName(5512)
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Lava Burst</Name><Default>false</Default><SpellID>51505</SpellID><Actions></Actions><Lua>local Lava = select(7,GetSpellInfo(51505))/1000

if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) and not UnitBuffID(&amp;quot;player&amp;quot;,77756) then return false end

if FlameShock then
	if LavaSurge then
	return true
	elseif Nova_AOE ~= 1 then
		if FlameShocktimer - GetTime() &amp;gt; Lava then
		return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---Range---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if	UnitExists(&amp;quot;Target&amp;quot;) ~= nil
and UnitAffectingCombat(&amp;quot;Player&amp;quot;) ~= nil then
	if x1 == nil then x1 = 0 end
	if x2 == nil then x2 = 0 end
	if y1 == nil then y1 = 0 end
	if y2 == nil then y2 = 0 end
	if playerTargetDistance == nil then playerTargetDistance = 0 end
	if readyTimer == nil then readyTimer = 0 end
		-- Store our Position if in combat and have valid target. 
	if readyTimer == 0 then 
		if UnitExists(&amp;quot;Target&amp;quot;) and UnitCanAttack(&amp;quot;Player&amp;quot;,&amp;quot;Target&amp;quot;) and UnitAffectingCombat(&amp;quot;Player&amp;quot;) then 
		x1, y1 = PQR_UnitInfo(&amp;quot;target&amp;quot;) 
		playerTargetDistance = PQR_UnitDistance(&amp;quot;Player&amp;quot;,&amp;quot;Target&amp;quot;) 
		w = 100000 
		h = 100000 
		totemDistance = sqrt(min(x1 - x2, w - (x1 - x2))^2 + min(y1 - y2, h - (y1-y2))^2) 
		--print(&amp;quot;Distance form Totem to target: &amp;quot;..floor(totemDistance)..&amp;quot; // Distance to Target: &amp;quot;..floor(playerTargetDistance))
		readyTimer = GetTime() 
		end 
	end 		
		-- This part is delaying the script to check only once every seconds. 
	if readyTimer ~= 0 then 
	    timerCheck = GetTime() - readyTimer 
	end 
	if timerCheck &amp;gt; 1 then 
	    readyTimer = 0 
	end	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Healing Tide Totem</Name><Default>false</Default><SpellID>108280</SpellID><Actions></Actions><Lua>if Nova_Tide ~= 1 then return false end
return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Capacitor Totem</Name><Default>false</Default><SpellID>108269</SpellID><Actions></Actions><Lua>if Nova_Capacitor ~= 1 then return false end


return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Astral Shift</Name><Default>false</Default><SpellID>108271</SpellID><Actions></Actions><Lua>if Nova_Shift ~= 1 then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Initialize--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- PQInterface
if not IsAddOnLoaded(&amp;quot;PQInterface&amp;quot;) then
		PQR_WriteToChat(&amp;quot;|cff9482C9The AddOn PQInterface is not loaded or installed!|cffffffff&amp;quot;,&amp;quot;Warning&amp;quot;)
		PQR_WriteToChat(&amp;quot;|cff9482C9Version 2.22+ is required to run the profile.|cffffffff&amp;quot;,&amp;quot;Warning&amp;quot;)
		PQR_WriteToChat(&amp;quot;&amp;quot;)
		PQR_WriteToChat(&amp;quot;|cff9482C9You can get the latest version at this location:|cffffffff&amp;quot;,&amp;quot;Notice&amp;quot;)
		PQR_WriteToChat(&amp;quot;|cff9482C9http://pqrotation.wikia.com/wiki/PQInterface|cffffffff&amp;quot;,&amp;quot;Notice&amp;quot;)
		PQR_StopRotation()
		return true
else
	local PQIver = tonumber(GetAddOnMetadata(&amp;quot;PQInterface&amp;quot;,&amp;quot;Version&amp;quot;))
	if PQIver &amp;lt; 2.22 then
		PQR_WriteToChat(&amp;quot;|cff9482C9Your PQInterface version is outdated!|cffffffff&amp;quot;,&amp;quot;Warning&amp;quot;)
		PQR_WriteToChat(&amp;quot;|cff9482C9Version 2.22+ is required to run the profile, you have version &amp;quot;..PQIver..&amp;quot;!|cffffffff&amp;quot;,&amp;quot;Warning&amp;quot;)
		PQR_WriteToChat(&amp;quot;&amp;quot;)
		PQR_WriteToChat(&amp;quot;|cff9482C9You can get the latest version at this location:|cffffffff&amp;quot;,&amp;quot;Notice&amp;quot;)
		PQR_WriteToChat(&amp;quot;|cff9482C9http://pqrotation.wikia.com/wiki/PQInterface|cffffffff&amp;quot;,&amp;quot;Notice&amp;quot;)
		PQR_StopRotation()
		return true
	end
end

if PQR_RotationStarted then
	-- Load Data Files
	if PQR_LoadLua ~= nil then
		if PQR_LoadLua(&amp;quot;PQR_PQI.lua&amp;quot;) == false then
			PQR_WriteToChat(&amp;quot;|cffb73737PQR_PQI.lua failed to load. Make sure it&amp;apos;s in your Data folder!|cffffffff&amp;quot;, &amp;quot;Error&amp;quot;)
			PQR_StopRotation()
			return true
		end
	end
	
	if PQI_SoapboxEnhancementOffensiveSettings_SoapboxTips_enable then
		if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then
			if itemCheck(Assurance) == 1 and not IsPlayerSpell(117013) then
			PQR_WriteToChat(&amp;quot;|cffb73737Primal Elementalist talent is reccomended with Assurance of Consequence Trinket|cffffffff&amp;quot;, &amp;quot;SoapboxTip(To disale these messages, uncheck the box in the PQI Frame)&amp;quot;)
			end
		end	
	end
	 
	 ---Chat Overlay---
	local function onUpdate(self,elapsed) 
	  if self.time &amp;lt; GetTime() - 2.8 then
	    if self:GetAlpha() == 0 then self:Hide() else self:SetAlpha(self:GetAlpha() - .05) end
	  end
	end
	xrn = CreateFrame(&amp;quot;Frame&amp;quot;,nil,ChatFrame1) 
	xrn:SetSize(ChatFrame1:GetWidth(),30)
	xrn:Hide()
	xrn:SetScript(&amp;quot;OnUpdate&amp;quot;,onUpdate)
	xrn:SetPoint(&amp;quot;TOP&amp;quot;,0,0)
	xrn.text = xrn:CreateFontString(nil,&amp;quot;OVERLAY&amp;quot;,&amp;quot;MovieSubtitleFont&amp;quot;)
	xrn.text:SetAllPoints()
	xrn.texture = xrn:CreateTexture()
	xrn.texture:SetAllPoints()
	xrn.texture:SetTexture(0,0,0,.50) 
	xrn.time = 0
	function xrn:message(message) 
	  self.text:SetText(message)
	  self:SetAlpha(1)
	  self.time = GetTime() 
	  self:Show() 
	end
	
	Nova_CustomT = { }
	
	
	
	
		-- Nova Notification Frame
	-- Update Debug Frame
	Nova_NotifyFrame = nil
	function Nova_NotifyFrame_OnUpdate()
		if (Nova_NotifyFrameTime &amp;lt; GetTime() - 0.2) then
			local alpha = Nova_NotifyFrame:GetAlpha()
			if (alpha ~= 0) then Nova_NotifyFrame:SetAlpha(alpha - .5) end
			if (aplha == 0) then Nova_NotifyFrame:Hide() end
		end
	end
	-- Debug messages.
	function Nova_Notify(message)
		Nova_NotifyFrame.text:SetText(message)
		Nova_NotifyFrame:SetAlpha(1)
		Nova_NotifyFrame:Show()
		Nova_NotifyFrameTime = GetTime()
	end
	-- Debug Notification Frame
	Nova_NotifyFrame = CreateFrame(&amp;apos;Frame&amp;apos;)
	Nova_NotifyFrame:ClearAllPoints()
	Nova_NotifyFrame:SetHeight(300)
	Nova_NotifyFrame:SetWidth(300)
	Nova_NotifyFrame:SetScript(&amp;apos;OnUpdate&amp;apos;, Nova_NotifyFrame_OnUpdate)
	Nova_NotifyFrame:Hide()
	Nova_NotifyFrame.text = Nova_NotifyFrame:CreateFontString(nil, &amp;apos;BACKGROUND&amp;apos;, &amp;apos;PVPInfoTextFont&amp;apos;)
	Nova_NotifyFrame.text:SetAllPoints()
	Nova_NotifyFrame:SetPoint(&amp;apos;LEFT&amp;apos;, 40, - 75)
	Nova_NotifyFrameTime = 0
	
	function CastClick()
		if IsMouseButtonDown(1) 
	  	  and MainMenuBar:IsShown() then
	  		local mousefocus = GetMouseFocus()
			if mousefocus 
			  and mousefocus.feedback_action then 
		  		SpellCancelQueuedSpell() 
		  		PQR_DelayRotation(1) 
		  	end
		end 	
	end	
	
	  ----------------
  --Nova  Checks--
  ----------------
  if Nova_Cooldowns == 1 then
  PQR_WriteToChat(&amp;quot;Cooldowns: \124cFF15E615Active&amp;quot;) end
  if (Nova_AOE == nil or Nova_AOE == 0) then
  PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Single Target&amp;quot;,nil,&amp;quot;FFFFFF&amp;quot;) end
  if Nova_AOE == 1 then			
  PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AOE&amp;quot;,nil,&amp;quot;0698FF&amp;quot;) end
  if Nova_Cleave == 1 then	
  PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cleave&amp;quot;,nil,&amp;quot;0fffff&amp;quot;) end
  PQR_RotationStarted = false



  
  MacroGhost = false
  BuffedFlame = false
  Healing = false
  FlameOpen = nil
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Channeling--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitChannelInfo(&amp;quot;player&amp;quot;) then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---Loaded---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Position and range query set values to 0 on load to avoid nil errors. 
if not timerLoaded then 
    x1, y1 = 0,0 
    x2, y2 = 0,0 
    playerTargetDistance = 0 
    readyTimer = 0      
    timerLoaded = true 
end

if x1 == nil then x1 = 0 end
if x2 == nil then x2 = 0 end
if y1 == nil then y1 = 0 end
if y2 == nil then y2 = 0 end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---Functions---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>---Credits to Bu_ba for the line of code!---
if not IsLineOfSight then
 LoSTable = { }
 function IsLineOfSight(targetCheck, time)
  local time=time or 5
  targetGUID = UnitGUID(targetCheck) or 0 

   for i=1, #LoSTable do
    if time &amp;lt; (GetTime() - LoSTable[i].time) then
     table.remove(LoSTable, i)
     break
    end
  end

   function LoSCheck(self, event, ...)
    local targetGUID = targetGUID
    local Log = {...}
    local AlreadyTabled = false
    if Log[2] and Log[2] == &amp;quot;SPELL_CAST_FAILED&amp;quot; and targetGUID then
     if Log[4] and Log[4]==UnitGUID(&amp;quot;player&amp;quot;) then
      if Log[15] and Log[15]==SPELL_FAILED_LINE_OF_SIGHT then
       for j=1, #LoSTable do
        if targetGUID == LoSTable[j].unit then
         AlreadyTabled = true
         break
        end
       end
       if not AlreadyTabled then
        table.insert(LoSTable, { unit=targetGUID, time=GetTime() } )
        targetGUID = nil
        _G.NovaLineOfSight:UnregisterAllEvents()
       end
      end
     end
    end
    
   end

  if not NovaLineOfSight then
    frameLOS = CreateFrame(&amp;quot;frame&amp;quot;, &amp;quot;NovaLineOfSight&amp;quot;)
    frameLOS:SetScript(&amp;quot;OnEvent&amp;quot;, LoSCheck)
  end
  
   for k=1, #LoSTable do
     if targetGUID and targetGUID == LoSTable[k].unit then
     return false
    end
  end
  
  
  _G.NovaLineOfSight:RegisterEvent(&amp;quot;COMBAT_LOG_EVENT_UNFILTERED&amp;quot;)
  return true

 end
end

	-- GetSpellCD will return actual Timer before we can use the ability, 0 if the ability is ready.
	GetSpellCD = nil
	function GetSpellCD(MySpell)
		if GetSpellCooldown(GetSpellInfo(MySpell)) == nil then
			return 0
		else
			local Start ,CD = GetSpellCooldown(MySpell)
			local MyCD = Start + CD - GetTime()
			return MyCD
		end
	end
	
	
if sTimer == nil then
  sTimer = 0
 end
 if cTime == nil then
  cTime = 0
 end
 if UnitAffectingCombat(&amp;quot;player&amp;quot;) and sTimer == 0 then
   sTimer = GetTime()
 end
 if sTimer &amp;gt; 0 then
   cTime = (GetTime() - sTimer)
 end
 if not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not UnitExists(&amp;quot;target&amp;quot;) then
  sTimer = 0
  cTime = 0
 end
 
 T2D = nil
function T2D(unit)
	-- If no target is given, return false.
	if unit == nil then return false end
	
	if UnitExists(unit) then
		-- Target present; Set initial values.
		if (guid ~= UnitGUID(unit)) or (guid == UnitGUID(unit) and UnitHealth(unit) == _firstLifeMax) then
			guid = UnitGUID(unit)
			_firstLife = UnitHealth(unit)
			_firstLifeMax = UnitHealthMax(unit)
			_firstTime = GetTime()
		end
		
		-- Fetch current values.
		_currentLife = UnitHealth(unit)
		_currentTime = GetTime()
		timeDiff = _currentTime - _firstTime
		hpDiff = _firstLife - _currentLife
		
		-- Calculate time to die.
		if hpDiff &amp;gt; 0 then
			fullTime = timeDiff*_firstLifeMax/hpDiff
			pastFirstTime = (_firstLifeMax - _firstLife)*timeDiff/hpDiff
			calcTime = _firstTime - pastFirstTime + fullTime - _currentTime
			if calcTime &amp;lt; 1 then calcTime = 1 end
			timeToDie = calcTime
		end
		
		-- New target; reset settings.
		if hpDiff &amp;lt;= 0 then
			guid = UnitGUID(unit)
			_firstLife = UnitHealth(unit)
			_firstLifeMax = UnitHealth(unit)
			_firstTime = GetTime()
		end
	            
		-- Training Dummy&amp;apos;s are bad
		if UnitHealthMax(unit) == 1 then timeToDie = 99 end
		
		-- Initialize
		if not timeToDie then timeToDie = 100 end
		
		return timeToDie
	end
end


-- DoT Mind Control Function
MindControlled = nil
function MindControlled(unit)
	if UnitDebuffID(unit, 145832) 
	or UnitDebuffID(unit, 145171) 
	or UnitDebuffID(unit, 145065) 
	or UnitDebuffID(unit, 145071) then
	return true
	else
	return false
	end
end

-- Returns the number of items currently equipped from the given table.
itemCheck = nil
function itemCheck(tbl)
	local itemCount = 0
	for i=1,#tbl do
		if IsEquippedItem(tbl[i]) then itemCount = itemCount + 1 end
	end
	return itemCount
end

Assurance = { 104725 }
EnhancementT16 = {
	99101,99615,99347,98992,	-- Tier 16: Chest
	99102,99340,99616,98993, -- Tier 16: Gloves
	99103,99341,99649,98983,	-- Tier 16: Helmet
	99104,99342,99650,98984, -- Tier 16: Legs
	99105,99343,99663,98977 -- Tier 16: Shoulders
}


EnhancementT15 = {
	95315,96689,95945, 	-- Tier 15: Chest
	95316,96690,95946,	-- Tier 15: Gloves
	95317,96691,95947,	-- Tier 15: Helmet
	95318,96692,95948,  -- Tier 15: Legs
	95319,96693,95949   -- Tier 15: Shoulders
}

-- Target Validation Function
TargetValidation = nil
function TargetValidation(unit, spell)
	if UnitExists(unit)
		and IsPlayerSpell(spell)
		and UnitCanAttack(&amp;quot;player&amp;quot;, unit) == 1
		and not UnitIsDeadOrGhost(unit)
		and IsLineOfSight(unit, 5) then
			if IsSpellKnown(spell) then
				if PQR_SpellAvailable(spell) then
					if IsSpellInRange(GetSpellInfo(spell), unit) == 1 then return true else return false end
				else
					if spell == 8092 or spell == 32379 then
						local spellCD = select(2,GetSpellCooldown(spell)) + GetSpellCooldown(spell) - GetTime()
						if spellCD &amp;lt;= 0 then spellCD = 0 end
						if spellCD &amp;lt;= 0.5 then return true end
					end
					return false
				end
			else
				if select(2, GetSpellCooldown(spell)) == 0 then return true end
			end
	end
end


---No Time to Die---
if UnitExists(&amp;quot;target&amp;quot;) then 
local targetGUID = tonumber((UnitGUID(&amp;quot;target&amp;quot;)):sub(-12, -9), 16)

NOT2D = false

Target = { 70235, 70247, 70212, 63053 }

for i=1, #Target do
   if targetGUID == Target[i] then NOT2D = true
   end
end
end

QuickKill = nil
function QuickKill()
	local Quickness = Quickness
	if UnitExists(&amp;quot;target&amp;quot;) then
		local npcID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
		-- Dungeons &amp; Raids
		for i=1,#Quickness do
			if Quickness[i] == npcID then 
			return true
			end
		end
		return false
	else return false end
end




Quickness = {
---71606, --Deactivated Missile Turrets
---71751, --Deactivated Laser Turrets - 
---71694, --Deactivated Electromagnets - 
74009, --Crawler Mines
---71790, --Disassembled Crawler Mines - 
72172, --Reflections - 
71946, --Manifestation of Pride - 
71603, --Sha Puddles - 
71642, --Congealed Sha - 
71977, --Manifestation of Corruption - 
71976, --Essences of Corruption - 
72263, --Unleashed Essences of Corruption - 
72353, --Dragonmaw Flameslingers - 
72352, --Dragonmaw Ebon Stalkers - 
71825, --Foul Slimes - 
71519, --Kor&amp;apos;kron Warshamans - 
71517, --Kor&amp;apos;kron Arcweavers - 
71518, --Kor&amp;apos;kron Assassins - 
71433, --Sparks of Life - 
71378, --Quilen Guardians - 
71383, --Kor&amp;apos;thik Warcallers - 
71385, --Sri&amp;apos;thik Bombardiers - 
71397, --Zar&amp;apos;thik Amber Priests - 
71405, --Set&amp;apos;thik Wind Wielders - 
71427, --Ancient Brewmaster Spirits - 
71428, --Wise Mistweaver Spirits - 
71430, --Nameless Windwalker Spirits - 
71658, --Kor&amp;apos;kron Jailer - 
71425, --Mature Kunchongs - 
71420, --Hungry Kunchongs - 
71407, --Amber - 
71979, --Kor&amp;apos;kron Warbringer - 
71984, --Siege Engineers - 
72237, --Embodied Fears - 
72238, --Embodied Doubts - 
72236, --Embodied Despairs - 
72272  --Minions of Y&amp;apos;Shaarj - 
}


-- Boss Unit Function
SpecialUnit = nil
function SpecialUnit()
	local PQ_BossUnits = PQ_BossUnits
	
	if UnitExists(&amp;quot;target&amp;quot;) then
		local npcID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)

		-- Dungeons &amp; Raids
		if UnitLevel(&amp;quot;target&amp;quot;) == -1 or (UnitIsPlayer(&amp;quot;target&amp;quot;) and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) 
		and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)) then return true else
			for i=1,#PQ_BossUnits do
				if PQ_BossUnits[i] == npcID then return true end
			end
			return false
		end
	else return false end
end
-- Complete boss unit table (Dungeons/Heroics/Raids)
PQ_BossUnits = {
	-- Cataclysm Dungeons --
	-- Abyssal Maw: Throne of the Tides
	40586,		-- Lady Naz&amp;apos;jar
	40765,		-- Commander Ulthok
	40825,		-- Erunak Stonespeaker
	40788,		-- Mindbender Ghur&amp;apos;sha
	42172,		-- Ozumat
	-- Blackrock Caverns
	39665,		-- Rom&amp;apos;ogg Bonecrusher
	39679,		-- Corla, Herald of Twilight
	39698,		-- Karsh Steelbender
	39700,		-- Beauty
	39705,		-- Ascendant Lord Obsidius
	-- The Stonecore
	43438,		-- Corborus
	43214,		-- Slabhide
	42188,		-- Ozruk
	42333,		-- High Priestess Azil
	-- The Vortex Pinnacle
	43878,		-- Grand Vizier Ertan
	43873,		-- Altairus
	43875,		-- Asaad
	-- Grim Batol
	39625,		-- General Umbriss
	40177,		-- Forgemaster Throngus
	40319,		-- Drahga Shadowburner
	40484,		-- Erudax
	-- Halls of Origination
	39425,		-- Temple Guardian Anhuur
	39428,		-- Earthrager Ptah
	39788,		-- Anraphet
	39587,		-- Isiset
	39731,		-- Ammunae
	39732,		-- Setesh
	39378,		-- Rajh
	-- Lost City of the Tol&amp;apos;vir
	44577,		-- General Husam
	43612,		-- High Prophet Barim
	43614,		-- Lockmaw
	49045,		-- Augh
	44819,		-- Siamat
	-- Zul&amp;apos;Aman
	23574,		-- Akil&amp;apos;zon
	23576,		-- Nalorakk
	23578,		-- Jan&amp;apos;alai
	23577,		-- Halazzi
	24239,		-- Hex Lord Malacrass
	23863,		-- Daakara
	-- Zul&amp;apos;Gurub
	52155,		-- High Priest Venoxis
	52151,		-- Bloodlord Mandokir
	52271,		-- Edge of Madness
	52059,		-- High Priestess Kilnara
	52053,		-- Zanzil
	52148,		-- Jin&amp;apos;do the Godbreaker
	-- End Time
	54431,		-- Echo of Baine
	54445,		-- Echo of Jaina
	54123,		-- Echo of Sylvanas
	54544,		-- Echo of Tyrande
	54432,		-- Murozond
	-- Hour of Twilight
	54590,		-- Arcurion
	54968,		-- Asira Dawnslayer
	54938,		-- Archbishop Benedictus
	-- Well of Eternity
	55085,		-- Peroth&amp;apos;arn
	54853,		-- Queen Azshara
	54969,		-- Mannoroth
	55419,		-- Captain Varo&amp;apos;then
	
	-- Mists of Pandaria Dungeons --
	-- Scarlet Halls
	59303,		-- Houndmaster Braun
	58632,		-- Armsmaster Harlan
	59150,		-- Flameweaver Koegler
	-- Scarlet Monastery
	59789,		-- Thalnos the Soulrender
	59223,		-- Brother Korloff
	3977,		-- High Inquisitor Whitemane
	60040,		-- Commander Durand
	-- Scholomance
	58633,		-- Instructor Chillheart
	59184,		-- Jandice Barov
	59153,		-- Rattlegore
	58722,		-- Lilian Voss
	58791,		-- Lilian&amp;apos;s Soul
	59080,		-- Darkmaster Gandling
	-- Stormstout Brewery
	56637,		-- Ook-Ook
	56717,		-- Hoptallus
	59479,		-- Yan-Zhu the Uncasked
	-- Tempe of the Jade Serpent
	56448,		-- Wise Mari
	56843,		-- Lorewalker Stonestep
	59051,		-- Strife
	59726,		-- Peril
	58826,		-- Zao Sunseeker
	56732,		-- Liu Flameheart
	56762,		-- Yu&amp;apos;lon
	56439,		-- Sha of Doubt
	-- Mogu&amp;apos;shan Palace
	61444,		-- Ming the Cunning
	61442,		-- Kuai the Brute
	61445,		-- Haiyan the Unstoppable
	61243,		-- Gekkan
	61398,		-- Xin the Weaponmaster
	-- Shado-Pan Monastery
	56747,		-- Gu Cloudstrike
	56541,		-- Master Snowdrift
	56719,		-- Sha of Violence
	56884,		-- Taran Zhu
	-- Gate of the Setting Sun
	56906,		-- Saboteur Kip&amp;apos;tilak
	56589,		-- Striker Ga&amp;apos;dok
	56636,		-- Commander Ri&amp;apos;mok
	56877,		-- Raigonn
	-- Siege of Niuzao Temple
	61567,		-- Vizier Jin&amp;apos;bak
	61634,		-- Commander Vo&amp;apos;jak
	61485,		-- General Pa&amp;apos;valak
	62205,		-- Wing Leader Ner&amp;apos;onok
	
	-- Mists of Pandaria Heroic Scenarios --
	-- A Brewing Storm
	58739,		-- Borokhula the Destroyer
	-- Battle on the High Seas
	71303,		-- Whale Shark &amp;lt;Son of Whale Shark&amp;gt;
	71327,		-- Admiral Hodgson
	67426,		-- Admiral Hagman
	70893,		-- Lieutenant Blasthammer
	71329,		-- Lieutenant Boltblaster
	-- Blood in the Snow
	70468,		-- Bonechiller Barafu
	70474,		-- Farastu &amp;lt;The Living Ice&amp;gt;
	70544,		-- Hekima the Wise &amp;lt;Herald of Rastakhan&amp;gt;
	-- Crypt of the Forgotten Kings
	61707,		-- Abomination of Anger
	71492,		-- Maragor &amp;lt;Guardian of the Golden Doors&amp;gt;
	67081,		-- Forgotten King
	-- Dark Heart of Pandaria
	71123,		-- Echo of Y&amp;apos;Shaarj
	-- The Secrets of Ragefire
	70683,		-- Dark Shaman Xorenth
	71030,		-- Overseer Elaglo
	70665,		-- Kor&amp;apos;kron Dire Soldier

	-- Training Dummies --
	46647,		-- Level 85 Training Dummy
	67127,		-- Level 90 Training Dummy
	
	-- Pandaria Raid Adds --
	63346,		-- Tsulong: The Dark of Night
	62969,		-- Tsulong: Embodied Terror
	62977,		-- Tsulong: Frightspawn
	62919,		-- Tsulong: Unstable Sha
	61034,		-- Sha of Fear: Terror Spawn
	61003		-- Sha of Fear: Dread Spawn
}</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---Globals---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>---Ascendance CD---
local AStart, ADuration = GetSpellCooldown(114049)
ACD = AStart + ADuration - GetTime()

---Spiritwalker&amp;apos;s Grace CD---
local SGStart, SGDuration = GetSpellCooldown(79206)
SGCD = SGStart + SGDuration - GetTime()

---Fire Elemental CD---
local FStart, FDuration = GetSpellCooldown(2894)
FCD = FStart + FDuration - GetTime()

---Primal Strike CD---
local PSStart, PSDuration = GetSpellCooldown(73899)
PSCD = PSStart + PSDuration - GetTime()

---Unleash Elements CD---
local UEStart, UEDuration = GetSpellCooldown(73680)
UECD = UEStart + UEDuration - GetTime()

---Lava Lash CD---
local LLStart, LLDuration = GetSpellCooldown(60103)
LLCD = LLStart + LLDuration - GetTime()

---Shock CD---
local EStart, EDuration = GetSpellCooldown(8042)
ECD = EStart + EDuration - GetTime()

---Elemental Blast CD---
local EBStart, EBDuration = GetSpellCooldown(117014)
EBCD = EBStart + EBDuration - GetTime()

---Lava Burst CD---
local LBStart, LBDuration = GetSpellCooldown(51505)
LBCD = LBStart + LBDuration - GetTime()

FlameShock,_,_,_,_,_,FlameShocktimer = UnitDebuffID(&amp;quot;target&amp;quot;,8050,&amp;quot;PLAYER&amp;quot;)
Ascendance,_,_,_,_,_,Ascendancetimer = UnitBuffID(&amp;quot;player&amp;quot;,114049)
Berserking,_,_,_,_,_,Berserkingtimer = UnitBuffID(&amp;quot;player&amp;quot;,26297)
LavaSurge,_,_,_,_,_,LavaSurgetimer = UnitBuffID(&amp;quot;player&amp;quot;,77756)
Spirit,_,_,_,_,_,Spirittimer = UnitBuffID(&amp;quot;player&amp;quot;,79206)


---Bloodlust Check---
Bloodlust = UnitBuffID(&amp;quot;player&amp;quot;, 2825)  
or UnitBuffID(&amp;quot;player&amp;quot;, 32182) 
or UnitBuffID(&amp;quot;player&amp;quot;, 80353) 
or UnitBuffID(&amp;quot;player&amp;quot;, 90355)

Playermana = 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;)
Playerhealth = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)
Targethealth = 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
Pethealth = 100 * UnitHealth(&amp;quot;pet&amp;quot;) / UnitHealthMax(&amp;quot;pet&amp;quot;)

ElementalGlyph = false

local enabled, glyphType, glyphTooltipIndex, glyphSpellID, icon = GetGlyphSocketInfo(2)
if glyphSpellID == 55455 then ElementalGlyph = true end
local enabled, glyphType, glyphTooltipIndex, glyphSpellID, icon = GetGlyphSocketInfo(4)
if glyphSpellID == 55455 then ElementalGlyph = true end
local enabled, glyphType, glyphTooltipIndex, glyphSpellID, icon = GetGlyphSocketInfo(6)
if glyphSpellID == 55455 then ElementalGlyph = true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Combat Pause--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then
	if Nova_Open == 1 and cTime &amp;lt; 10 then
	return true
	end
end

if (UnitBuffID(&amp;quot;player&amp;quot;,2645) and MacroGhost == true)
or UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
or UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) == nil
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Potions</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local srTimer, SearingTotem = GetTotemInfo(1)
local T2D = T2D
if not IsInRaid() then return false end 
if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalOffensiveSettings_Potions_enable then
return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementOffensiveSettings_Potions_enable then
return false end

if GetItemCount(76093) &amp;lt; 1 then return false end
if GetItemCooldown(76093) ~= 0 then return false end
if not SpecialUnit() then return false end

if cTime &amp;lt; 60 then return false end

if T2D(&amp;quot;target&amp;quot;) &amp;gt; 60 then
	if SearingTotem ~= tostring(GetSpellInfo(2894)) then return false 
	end
end
UseItemByName(76093)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Racials</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Ascendance,_,_,_,_,_,Ascendancetimer = UnitBuffID(&amp;quot;player&amp;quot;,114049)

local SpecialUnit = SpecialUnit

if Nova_Cooldowns ~= 1 then return false end

if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalOffensiveSettings_Racials_enable then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementOffensiveSettings_Racials_enable then return false end

-- Draenei: Gift of the Naaru
if IsPlayerSpell(59544) and PQR_SpellAvailable(59544) and Playerhealth &amp;lt; 60 then
	CastSpellByName(GetSpellInfo(59544),&amp;quot;player&amp;quot;)
	return true
end


if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end


-- Blood Elf: Arcane Torrent
if IsPlayerSpell(28730) then
	if PQR_SpellAvailable(28730) and Playermana &amp;lt; 92
	and UnitExists(&amp;quot;target&amp;quot;) then
	SpellCancelQueuedSpell()
	CastSpellByName(GetSpellInfo(28730),&amp;quot;player&amp;quot;)
	return true
	end
end

-- Orc: Blood Fury
if IsPlayerSpell(33697) then
	if PQR_SpellAvailable(33697) then
		if Ascendance or Bloodlust then
			if UnitExists(&amp;quot;target&amp;quot;) then
			SpellCancelQueuedSpell()
			CastSpellByName(GetSpellInfo(33697),&amp;quot;player&amp;quot;)
			return true
			end
		end
	end
end

-- Troll: Berserking
if IsPlayerSpell(26297) then
	if PQR_SpellAvailable(26297) then
		if UnitExists(&amp;quot;target&amp;quot;) then
		SpellCancelQueuedSpell()
		CastSpellByName(GetSpellInfo(26297),&amp;quot;player&amp;quot;)
		return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Elemental Mastery</Name><Default>false</Default><SpellID>16166</SpellID><Actions></Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxElementalOffensiveSettings_ElementalMastery_enable then return false end
if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end

if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
					if not Bloodlust and cTime &amp;lt; 120 then
					return true
					end
					if not Bloodlust and not Berserking and Ascendance then 
					return true
					end
					if cTime &amp;gt;= 200 and ACD &amp;gt; 30 then
					return true
					end
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
						if not Bloodlust and cTime &amp;lt; 120 then
						return true
						end
						if not Bloodlust and not Berserking and Ascendance then 
						return true
						end
						if cTime &amp;gt;= 200 and ACD &amp;gt; 30 then
						return true
						end
				elseif Feed then
						if not Bloodlust and cTime &amp;lt; 120 then
						return true
						end
						if not Bloodlust and not Berserking and Ascendance then 
						return true
						end
						if cTime &amp;gt;= 200 and ACD &amp;gt; 30 then
						return true
						end
				end
			end
		end
	elseif not Bloodlust and cTime &amp;lt; 120 then
	return true
	end
	if not Bloodlust and not Berserking and Ascendance then 
	return true
	end
	if cTime &amp;gt;= 200 and ACD &amp;gt; 30 then
	return true
	end
elseif not Bloodlust and cTime &amp;lt; 120 then
	return true
	end
	if not Bloodlust and not Berserking and Ascendance then 
	return true
	end
	if cTime &amp;gt;= 200 and ACD &amp;gt; 30 then
	return true
	end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---3a. Macro Table---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-------------------------------------------------------------------
--------------------------Macros Table-----------------------------
-------------------------------------------------------------------

  PQR_InterruptDelay =  0

	--------------------
	-- Register CVars --
	--------------------
	Nova_ValueCheck = {
		{	Var1 = nil,	Text = &amp;quot;Toggles&amp;quot;,				Var2 = nil		},
		{	Var1 = 0,	Text = &amp;quot;Cooldowns&amp;quot;,				Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Cleave&amp;quot;,				Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Bulwark&amp;quot;,				Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;AOE&amp;quot;,					Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Shift&amp;quot;,					Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Tide&amp;quot;, 					Var2 = 1		},	
		{	Var1 = 0,	Text = &amp;quot;Guidance&amp;quot;,				Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Capacitor&amp;quot;,				Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Wolf&amp;quot;,					Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Rage&amp;quot;,					Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Projection&amp;quot;,			Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Hex&amp;quot;,					Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Open&amp;quot;,					Var2 = 1		},
		{	Var1 = 0,	Text = &amp;quot;Storm&amp;quot;,					Var2 = 1		}
	}		

	-----------------------------------------------
	-- Registering the CVars for the CustomFrame --
	-----------------------------------------------
	for i=1, #Nova_ValueCheck do
		if GetCVar(&amp;quot;Nova_&amp;quot;..Nova_ValueCheck[i].Text) == nil then 
			RegisterCVar(&amp;quot;Nova_&amp;quot;..string.gsub(Nova_ValueCheck[i].Text, &amp;quot;%s&amp;quot;, &amp;quot;_&amp;quot;), Nova_ValueCheck[i].Var1) 
		end
		if GetCVar(&amp;quot;Nova_&amp;quot;..Nova_ValueCheck[i].Text..&amp;apos;_Enabled&amp;apos;) == nil then 
			RegisterCVar(&amp;quot;Nova_&amp;quot;..string.gsub(Nova_ValueCheck[i].Text, &amp;quot;%s&amp;quot;, &amp;quot;_&amp;quot;)..&amp;apos;_Enabled&amp;apos;, Nova_ValueCheck[i].Var2) 
		end
	end


-- Latency Adjuster
local minValue = 0.05
local maxValue = 0.3
local curPing = tonumber((select(3,GetNetStats()) + select(4,GetNetStats())) / 1000) + .025

if curPing &amp;lt; minValue then
	curPing = minValue
elseif curPing &amp;gt; maxValue then
	curPing = maxValue
end

PQR_SpellAvailableTime = curPing

----------------------------
-- To Integer from String --
----------------------------
for i=1, #Nova_ValueCheck do
	if Nova_ValueCheck[i].Var1 ~= nil then
		_G[&amp;apos;Nova_&amp;apos;..string.gsub(Nova_ValueCheck[i].Text, &amp;apos;%s&amp;apos;, &amp;apos;_&amp;apos;)] = tonumber(GetCVar(&amp;apos;Nova_&amp;apos;..string.gsub(Nova_ValueCheck[i].Text, &amp;apos;%s&amp;apos;, &amp;apos;_&amp;apos;)))
	end
	if Nova_ValueCheck[i].Var2 ~= nil then
		_G[&amp;apos;Nova_&amp;apos;..string.gsub(Nova_ValueCheck[i].Text, &amp;apos;%s&amp;apos;, &amp;apos;_&amp;apos;)..&amp;apos;Check&amp;apos;] = GetCVarBool(&amp;apos;Nova_&amp;apos;..string.gsub(Nova_ValueCheck[i].Text, &amp;apos;%s&amp;apos;, &amp;apos;_&amp;apos;)..&amp;apos;_Enabled&amp;apos;)
	end
end

--------------------
-- Slash Commands --
--------------------
if SlashMacros == nil then
	SlashMacros = true
	
	SLASH_COOLDOWNS1 = &amp;quot;/cooldowns&amp;quot;
	SLASH_COOLDOWNS2 = &amp;quot;/cooldown&amp;quot;
	function SlashCmdList.COOLDOWNS(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Cooldowns&amp;quot;) then
			xrn:message(&amp;quot;|cff9933ffCooldowns - Active.&amp;quot;)
			SetCVar(&amp;quot;Nova_Cooldowns&amp;quot;, 1)
		else			
			xrn:message(&amp;quot;|cff9933ffCooldowns - Inactive.&amp;quot;)
			SetCVar(&amp;quot;Nova_Cooldowns&amp;quot;, 0)
		end
	end
	SLASH_CLEAVE1 = &amp;quot;/cleave&amp;quot;
	function SlashCmdList.CLEAVE(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Cleave&amp;quot;) then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cleave&amp;quot;,nil,&amp;quot;0fffff&amp;quot;)
			xrn:message(&amp;quot;\124cFFFFFFFFCleave Rotation&amp;quot;)
			SetCVar(&amp;quot;Nova_Cleave&amp;quot;, 1)
			SetCVar(&amp;quot;Nova_AOE&amp;quot;, 0)
		else
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Single Target&amp;quot;,nil,&amp;quot;FFFFFF&amp;quot;)
		xrn:message(&amp;quot;\124cFFD4D4D4Single target Rotation&amp;quot;)
		SetCVar(&amp;quot;Nova_Cleave&amp;quot;, 0)
		end
	end				
	SLASH_AOE1 = &amp;quot;/aoe&amp;quot;
	function SlashCmdList.AOE(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_AOE&amp;quot;) then
			PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AOE&amp;quot;,nil,&amp;quot;0698FF&amp;quot;)
			xrn:message(&amp;quot;\124cFF3BB0FFArea of Effect Rotation&amp;quot;)
			SetCVar(&amp;quot;Nova_AOE&amp;quot;, 1)
			SetCVar(&amp;quot;Nova_Cleave&amp;quot;, 0)
		else
			PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Single Target&amp;quot;,nil,&amp;quot;FFFFFF&amp;quot;)
			xrn:message(&amp;quot;\124cFFD4D4D4Single target Rotation&amp;quot;) 
			SetCVar(&amp;quot;Nova_AOE&amp;quot;, 0)
		end
	end
	SLASH_GUIDANCE1 = &amp;quot;/guidance&amp;quot;
	function SlashCmdList.GUIDANCE(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Guidance&amp;quot;) then
			xrn:message(&amp;quot;\124cFF0000FFAncestrial Guidance - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Guidance&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFF0000FFAncestrial Guidance - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Guidance&amp;quot;, 0)
		end
	end
	SLASH_SHIFT1 = &amp;quot;/shift&amp;quot;
	function SlashCmdList.SHIFT(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Shift&amp;quot;) then
			xrn:message(&amp;quot;\124cFF0000FFAstral Shift - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Shift&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFF0000FFAstral Shift - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Shift&amp;quot;, 0)
		end
	end
	SLASH_CAPACITOR1 = &amp;quot;/capacitor&amp;quot;
	function SlashCmdList.CAPACITOR(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Capacitor&amp;quot;) then
			xrn:message(&amp;quot;\124cFFCC9900Capacitor Totem - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Capacitor&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC9900Capacitor Totem - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Capacitor&amp;quot;, 0)			
		end
	end	
	SLASH_TIDE1 = &amp;quot;/tide&amp;quot;
	function SlashCmdList.TIDE(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Tide&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFHealing Tide - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Tide&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFHealing Tide - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Tide&amp;quot;, 0)
		end
	end
	SLASH_BULWARK1 = &amp;quot;/bulwark&amp;quot;
	function SlashCmdList.BULWARK(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Bulwark&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFStone Bulwark Totem - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Bulwark&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFStone Bulwark Totem - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Bulwark&amp;quot;, 0)
		end
	end
	SLASH_HEX1 = &amp;quot;/hex&amp;quot;
	function SlashCmdList.HEX(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Hex&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFHex Mouseover - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Hex&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFHex Mouseover - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Hex&amp;quot;, 0)
		end
	end
		SLASH_WOLF1 = &amp;quot;/wolf&amp;quot;
	function SlashCmdList.WOLF(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Wolf&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFGhost Wolf - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Wolf&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFGhost Wolf - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Wolf&amp;quot;, 0)
		end
	end
			SLASH_RAGE1 = &amp;quot;/rage&amp;quot;
	function SlashCmdList.RAGE(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Rage&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFShamanistic Rage - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Rage&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFShamanistic Rage - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Rage&amp;quot;, 0)
		end
	end
			SLASH_PROJECTION1 = &amp;quot;/projection&amp;quot;
	function SlashCmdList.PROJECTION(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Projection&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFTotemic Projection - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Projection&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFTotemic Projection - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Projection&amp;quot;, 0)
		end
	end
				SLASH_OPEN1 = &amp;quot;/open&amp;quot;
	function SlashCmdList.OPEN(msg, editbox)
		if cTime &amp;gt; 9 then return false end
		if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then return false end
		if not GetCVarBool(&amp;quot;Nova_Open&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFOpener - Enabled.&amp;quot;)
			PQR_WriteToChat(&amp;quot;Opener will begin when you are within 25 yards of the target, and will open combat when you are just outside of melee range&amp;quot;)
			SetCVar(&amp;quot;Nova_Open&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFOpener - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Open&amp;quot;, 0)
		end
	end
					SLASH_STORM1 = &amp;quot;/storm&amp;quot;
	function SlashCmdList.STORM(msg, editbox)
		if not GetCVarBool(&amp;quot;Nova_Storm&amp;quot;) then
			xrn:message(&amp;quot;\124cFFFFFFFFThunderstorm - Queued.&amp;quot;)
			SetCVar(&amp;quot;Nova_Storm&amp;quot;, 1)
		else
			xrn:message(&amp;quot;\124cFFCC99FFThunderstorm - Canceled.&amp;quot;)
			SetCVar(&amp;quot;Nova_Storm&amp;quot;, 0)
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Unleash Elements</Name><Default>false</Default><SpellID>73680</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end
if QuickKill == true then return false end


if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) and not UnitBuffID(&amp;quot;player&amp;quot;,77756) then return false end

if Nova_AOE == 1 then return false end

local _,_,_,LScount = UnitBuffID(&amp;quot;player&amp;quot;,324)

if UnitBuffID(&amp;quot;player&amp;quot;, 324) then
	if LScount &amp;gt; 6 then 
	return false
	end
end

if LavaSurge then return false end

if FlameShock then
	if FlameShocktimer - GetTime() &amp;gt; 3 and FlameShocktimer - GetTime() &amp;lt; 7 
	and PQR_SpellAvailable(51505) and PQR_SpellAvailable(8050) then
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Spiritwalker&amp;apos;s Grace -Ascendance-</Name><Default>false</Default><SpellID>79206</SpellID><Actions></Actions><Lua>if Ascendance then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Ancestral Swiftness</Name><Default>false</Default><SpellID>16188</SpellID><Actions></Actions><Lua>if Nova_AOE == 1 then return false end
if Nova_Cooldowns ~= 1 then return false end
if Ascendance then return false end
if not PQI_SoapboxElementalOffensiveSettings_AncestrialSwiftness_enable then return false end
if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end


if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				return true
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					return true
				elseif Feed then
					return true
				end
			end
		end
	else
	return true
	end
else 
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Earth Shock</Name><Default>false</Default><SpellID>8042</SpellID><Actions></Actions><Lua>if Nova_AOE == 1 then return false end
local _,_,_,LScount = UnitBuffID(&amp;quot;player&amp;quot;,324)

if QuickKill == true then
return true
end

if UnitBuffID(&amp;quot;player&amp;quot;,324) then
	---if Nova_Cleave == 1 then
		---if LScount &amp;gt; 6 then
		---return true
		---end
	if LScount &amp;gt; 6 then 
	return true
	elseif LScount &amp;gt; 4 and FlameShock and FlameShocktimer - GetTime() &amp;gt; 5 and FlameShocktimer - GetTime() &amp;lt; 8 then
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Flame Shock -High-</Name><Default>false</Default><SpellID>8050</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end
if QuickKill() then return false end
if Nova_AOE == 1 then return false end
if FlameShock then
	if FlameShocktimer - GetTime() &amp;lt; 5 then
	return true
	end
else
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Flame Shock -Low-</Name><Default>false</Default><SpellID>8050</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end
if QuickKill() then return false end
if Nova_AOE == 1 then return false end
if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxElementalOffensiveSettings_Ascendance_enable then return false end
if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end


if UnitExists(&amp;quot;boss&amp;quot;..1) then
local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465 then
		if not UnitDebuffID(&amp;quot;player&amp;quot;, 138002) then
		return false
		elseif FlameShock then
			if FlameShocktimer - GetTime() &amp;lt;= 15 and PQR_SpellAvailable(114049) then
			return true
			end
		else
		return true
		end
	elseif FlameShock then
		if FlameShocktimer - GetTime() &amp;lt;= 15 and PQR_SpellAvailable(114049) then
		return true
		end
	else
	return true
	end
elseif FlameShock then
	if FlameShocktimer - GetTime() &amp;lt;= 15 and PQR_SpellAvailable(114049) then
	return true
	end
else
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Earth Elemental Totem</Name><Default>false</Default><SpellID>2062</SpellID><Actions></Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxElementalOffensiveSettings_AutoElementalTotem_enable then return false end
if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end


if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				if (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
				return true
				end
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					if (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
					return true
					end
				elseif Feed then
					if (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
					return true
					end
				end
			end
		end
	elseif (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
	return true
	end
elseif (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Ascendance</Name><Default>false</Default><SpellID>0</SpellID><Actions>/use 10</Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxEnhancementOffensiveSettings_Ascendance_enable then return false end
if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end
if Ascendance then return false end
if not PQR_SpellAvailable(114049) then return false end
if Nova_AOE == 1 then
	if FlameShock then
		if PQR_SpellAvailable(1535) then
		return false
		end
	elseif PQR_SpellAvailable(8050) then
	return false 
	end
end


if PSCD &amp;lt; 3 then return false end



if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465 then
	local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
		if not Fluidity then
		return false
		end				
	end	
end


CastSpellByName(GetSpellInfo(114049))</Lua><RecastDelay>3000</RecastDelay><Target>Player</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Synapse Springs</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local TargetValidation = TargetValidation
local Gloves = GetInventoryItemID(&amp;quot;player&amp;quot;, 10)
local srTimer, SearingTotem = GetTotemInfo(1)

-- If we don&amp;apos;t know Engineering. Don&amp;apos;t activate.
for i=1,9 do
	if select(7,GetProfessionInfo(i)) == 202 then hasEngi = true end
end

-- Don&amp;apos;t have Engineering.
if not hasEngi then return false end

-- Item not equipped?
if not IsEquippedItem(Gloves) then return false end

-- Don&amp;apos;t use it if it&amp;apos;s on cooldown as well!
if GetItemCooldown(Gloves) &amp;gt; 0 then return false end


if not Ascendance and not Bloodlust and SearingTotem ~= tostring(GetSpellInfo(2894)) then
if (ACD &amp;gt; 10 and FCD &amp;gt; 10) == false and ACD &amp;lt; 30 then return false end end

if not Ascendance and ACD &amp;lt; 45 and SearingTotem ~= tostring(GetSpellInfo(2894)) and not Bloodlust then return false end
if not TargetValidation(&amp;quot;target&amp;quot;,403) then return false end
	
	UseItemByName(Gloves)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Frag Belt</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Ability disabled in PQI
if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalOffensiveSettings_FragBelt_enable then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementOffensiveSettings_FragBelt_enable then return false end

-- If we don&amp;apos;t know Engineering. Don&amp;apos;t activate.
for i=1,9 do
	if select(7,GetProfessionInfo(i)) == 202 then hasEngi = true end
end

-- Don&amp;apos;t have Engineering.
if not hasEngi then return false end

local Belt = GetInventoryItemID(&amp;quot;player&amp;quot;, 6)

-- Not equipped?
if not IsEquippedItem(Belt) then return false end


-- Don&amp;apos;t use it if it&amp;apos;s on cooldown as well!
if GetItemCooldown(Belt) &amp;gt; 0 then return false end


	UseItemByName(Belt)
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end
	return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Chain Lightning</Name><Default>false</Default><SpellID>421</SpellID><Actions></Actions><Lua>if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) then return false end
if Nova_AOE ~= 1 and Nova_Cleave ~= 1 then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Searing Totem</Name><Default>false</Default><SpellID>3599</SpellID><Actions></Actions><Lua>local TOT1, TOTNAME, startTime, duration = GetTotemInfo(1)
TOTEXPIRE = startTime + duration - GetTime()
-------------------------------------------------------------

if QuickKill() then return false end
if TOTNAME == tostring(GetSpellInfo(8190)) then
	if Nova_AOE ~= 1 or not PQI_SoapboxEnhancementOffensiveSettings_MagmaTotem_enable then
	x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;)
---			CastSpellByName(GetSpellInfo(3599)) 
---		PQR_DelayRotation(0.3)
	return true
	end
end

if (GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalOffensiveSettings_TotemSlinger_enable) 
or (GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementOffensiveSettings_TotemSlinger_enable) then

	if TOTNAME ~= tostring(GetSpellInfo(2894)) 
	and Nova_AOE ~= 1
	and IsSpellInRange(tostring(GetSpellInfo(8050)), &amp;quot;target&amp;quot;) then
		if TOTEXPIRE == nil 
		or TOTEXPIRE &amp;lt; 2 then
		x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;)
	---	CastSpellByName(GetSpellInfo(3599)) 
	---	PQR_DelayRotation(0.3)
		return true
		end
	end	
end

if (GetSpecialization(&amp;quot;player&amp;quot;) == 1 and PQI_SoapboxElementalOffensiveSettings_TotemSlinger_enable) 
or (GetSpecialization(&amp;quot;player&amp;quot;) == 2 and PQI_SoapboxEnhancementOffensiveSettings_TotemSlinger_enable and IsSpellInRange(tostring(GetSpellInfo(73899)), &amp;quot;target&amp;quot;)) then
	if TOTNAME ~= tostring(GetSpellInfo(2894))
	and Nova_AOE ~= 1
	and IsSpellInRange(tostring(GetSpellInfo(8050)), &amp;quot;target&amp;quot;) then
		if TOTEXPIRE == nil or TOTEXPIRE &amp;lt; 2 then
			x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;) 
		---			CastSpellByName(GetSpellInfo(3599)) 
	---	PQR_DelayRotation(0.3) 
			return true
		elseif totemDistance &amp;gt; 41 and playerTargetDistance &amp;lt; 40 then
			x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;)
	---				CastSpellByName(GetSpellInfo(3599)) 
	---	PQR_DelayRotation(0.3)
	   	return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Flame Shock (Boss)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local TargetValidation = TargetValidation

if not PQI_SoapboxElementalOffensiveSettings_BossDotting_enable then return false end


-- Keep DoTs on bosses when in range
for i=1,4 do
	local bossUnit = &amp;quot;boss&amp;quot;..i
	
	-- Let&amp;apos;s try and detect immunities
	if UnitBuffID(bossUnit,116994) or UnitBuffID(bossUnit,122540) or UnitBuffID(bossUnit,123250) or UnitBuffID(bossUnit,106062) or UnitBuffID(bossUnit,110945)
		then return false end
	
	if TargetValidation(bossUnit,8050) then
		if not UnitDebuffID(bossUnit,8050,&amp;quot;PLAYER&amp;quot;) and T2D(bossUnit) &amp;gt;= 6 then
			CastSpellByName(GetSpellInfo(8050),bossUnit)
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Flame Shock (Focus)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;focus&amp;quot;) then return false end

-- Disable focus dotting if we unticked it.
if not PQI_SoapboxElementalOffensiveSettings_FocusDotting_enable then return false end

-- Use Corruption if not present on focus
if TargetValidation(&amp;quot;focus&amp;quot;,8050) and isMindControledUnit(&amp;quot;focus&amp;quot;) then
	if not UnitDebuffID(&amp;quot;focus&amp;quot;,8050,&amp;quot;PLAYER&amp;quot;) and T2D(&amp;quot;focus&amp;quot;) &amp;gt;= 6 then
		CastSpellByName(GetSpellInfo(8050),&amp;quot;focus&amp;quot;) return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Flame Shock (Mouseover)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local isMindControledUnit = isMindControledUnit

-- Disable mouseover dotting if we unticked it.
if not PQI_SoapboxElementalOffensiveSettings_MouseoverDotting_enable then return false end

if TargetValidation(&amp;quot;mouseover&amp;quot;,8050) and isMindControledUnit(&amp;quot;mouseover&amp;quot;) then
	if not UnitDebuffID(&amp;quot;mouseover&amp;quot;,8050,&amp;quot;PLAYER&amp;quot;) then
		CastSpellByName(GetSpellInfo(8050),&amp;quot;mouseover&amp;quot;) return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Ancestral Guidance</Name><Default>false</Default><SpellID>108281</SpellID><Actions></Actions><Lua>if Nova_Guidance ~= 1 then return false end


	return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Healing Surge</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local minHP = PQI_SoapboxElementalDefensiveSettings_BeginHealing_value or 15
local maxHP = PQI_SoapboxElementalDefensiveSettings_CancelHealing_value or 80


-- Disabled in PQInterface
if not PQI_SoapboxElementalDefensiveSettings_BeginHealing_enable then return false end

if Playerhealth &amp;gt;= maxHP then
	if UnitCastingInfo(&amp;quot;player&amp;quot;) == GetSpellInfo(8004) and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) then
		Healing = false
		SpellStopCasting()
	end
	return false
end


-- Heal ourself
if not UnitIsDeadOrGhost(&amp;quot;player&amp;quot;) then
	if (Playerhealth &amp;lt; minHP) or Healing then
	Healing = true
	CastSpellByName(GetSpellInfo(8004),&amp;quot;player&amp;quot;)
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Cleanse Spirit</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalDefensiveSettings_CleanseSpirit_enable then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementDefensiveSettings_CleanseSpirit_enable then return false end

if not PQR_SpellAvailable(51886) then return false end

for i=1,40 do
	if select(5,UnitDebuff(&amp;quot;player&amp;quot;,i)) == &amp;quot;Curse&amp;quot; then
		CastSpellByName(GetSpellInfo(51886),&amp;quot;player&amp;quot;) return true
	end
end

if IsInRaid() then group = &amp;quot;raid&amp;quot; elseif IsInGroup() then group = &amp;quot;party&amp;quot; else return false end

for i=1,GetNumGroupMembers() do
	local member = group..i
	
	if UnitIsDeadOrGhost(member) then return false end
	if not IsLineOfSight(member,3) then return false end
	
	for k=1,40 do
		if select(5,UnitDebuff(member,k)) == &amp;quot;Curse&amp;quot; then
			CastSpellByName(GetSpellInfo(51886),member) return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Purge</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local targets = {&amp;quot;target&amp;quot;,&amp;quot;focus&amp;quot;,&amp;quot;mouseover&amp;quot;,&amp;quot;arena1&amp;quot;,&amp;quot;arena2&amp;quot;,&amp;quot;arena3&amp;quot;,&amp;quot;arena4&amp;quot;,&amp;quot;arena5&amp;quot;,&amp;quot;boss1&amp;quot;,&amp;quot;boss2&amp;quot;,&amp;quot;boss3&amp;quot;,&amp;quot;boss4&amp;quot;}

if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalDefensiveSettings_Purge_enable then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementDefensiveSettings_Purge_enable then return false end

-- Not an attackable target
if not UnitExists(&amp;quot;target&amp;quot;) or not UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) or not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) then return false end
if MindControlled(&amp;quot;mouseover&amp;quot;) then return false end
-- Unit is dead, pass!
if UnitIsDeadOrGhost(&amp;quot;target&amp;quot;) then return false end

for i=1,#targets do
	for k=1,40 do
		if TargetValidation(targets[i], 370) then
			if select(9,UnitBuff(targets[i],k)) ~= nil then
				CastSpellByName(GetSpellInfo(370),targets[i]) return true
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---Success---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if CombatLog == nil then
    BuBa_CombatLog = CreateFrame(&amp;apos;Frame&amp;apos;)
    BuBa_CombatLog:RegisterEvent(&amp;quot;COMBAT_LOG_EVENT_UNFILTERED&amp;quot;)

 function OnSuccessfulCast(self, event, ...)
  local type, _, sourceGUID, sourceNAME, _, _, destGUID, destNAME = select(2, ...)
  if (event==&amp;quot;COMBAT_LOG_EVENT_UNFILTERED&amp;quot;) then
            if (type==&amp;quot;SPELL_CAST_SUCCESS&amp;quot;) 
             or (type==&amp;quot;SPELL_CAST_START&amp;quot;) then
                if sourceGUID == UnitGUID(&amp;quot;player&amp;quot;) then
		if select(12, ...) == 108270 and Nova_Bulwark == 1 then
		SetCVar(&amp;quot;Nova_Bulwark&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Stone Bulwark: \124cFFE61515Casted&amp;quot;) 
		elseif select(12, ...) == 108271 and Nova_Shift == 1 then
		SetCVar(&amp;quot;Nova_Shift&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Astral Shift: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 51490 and Nova_Storm == 1 then
		SetCVar(&amp;quot;Nova_Storm&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Thunderstorm: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 108281 and Nova_Guidance == 1 then
		SetCVar(&amp;quot;Nova_Guidance&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Ancestral Guidance: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 108280 and Nova_Tide == 1 then
		SetCVar(&amp;quot;Nova_Tide&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Healing Tide: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 108269 and Nova_Capacitor == 1 then
		SetCVar(&amp;quot;Nova_Capacitor&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Capacitor Totem: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 51514 and Nova_Hex == 1 then
		SetCVar(&amp;quot;Nova_Hex&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Hex: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 2645 and Nova_Wolf == 1 then
		SetCVar(&amp;quot;Nova_Wolf&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Ghost Wolf: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 30823 and Nova_Rage == 1 then
		SetCVar(&amp;quot;Nova_Rage&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Shamanistic Rage: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 108287 and Nova_Projection == 1 then
		SetCVar(&amp;quot;Nova_Projection&amp;quot;, 0)
		PQR_WriteToChat(&amp;quot;Totemic Projection: \124cFFE61515Casted&amp;quot;)
		elseif select(12, ...) == 8050 and Nova_Open == 1 then
		SetCVar(&amp;quot;Nova_Open&amp;quot;, 0)
		FlameOpen = false
		xrn:message(&amp;quot;\124cFFFFFFFFOpener - Completed Sucessfully!.&amp;quot;)
		elseif select(12, ...) == 2894 then
		PQR_DelayRotation(0.5)
      end
     end
    end
   end
  end

 BuBa_CombatLog:SetScript(&amp;apos;OnEvent&amp;apos;, OnSuccessfulCast)

    CombatLog = true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Ghost Wolf</Name><Default>false</Default><SpellID>2645</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 2645) then 
	if Nova_Wolf == 1 then
	MacroGhost = false
	RunMacroText(&amp;quot;/cancelform&amp;quot;)
	SetCVar(&amp;quot;Nova_Wolf&amp;quot;, 0)
	end
elseif Nova_Wolf == 1 then
MacroGhost = true
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Shamanistic Rage</Name><Default>false</Default><SpellID>30823</SpellID><Actions></Actions><Lua>if Nova_Rage ~= 1 then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Totemic Projection</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if Nova_Projection ~= 1 then return false end

if IsPlayerSpell(108287) then
	if PQR_SpellAvailable(108287) then
	
	CastSpellByName(GetSpellInfo(108287))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Click</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Queue</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not PQI_SoapboxElementalOffensiveSettings_SpellQueueType_enable then return false end
local v=PQI_SoapboxElementalOffensiveSettings_SpellQueueType_value or 1

if v == 1 then
	if IsMouseButtonDown() and UnitAffectingCombat(&amp;quot;player&amp;quot;) then
		if GetMouseFocus():GetName() ~= nil then
			SpellCancelQueuedSpell()
			RunMacroText(&amp;quot;/click &amp;quot;..GetMouseFocus():GetName())
		end
	end
elseif v == 2 then
	if GetMouseFocus():GetName() ~= nil and UnitAffectingCombat(&amp;quot;player&amp;quot;) then
		SpellCancelQueuedSpell()
		RunMacroText(&amp;quot;/click &amp;quot;..GetMouseFocus():GetName())
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Auto Target</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalOffensiveSettings_AutoTargetNextEnemy_enable then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementOffensiveSettings_AutoTargetNextEnemy_enable then return false end

if (UnitExists(&amp;quot;Target&amp;quot;) == nil 
or (UnitExists(&amp;quot;Target&amp;quot;) and UnitIsDead(&amp;quot;Target&amp;quot;)))
and UnitAffectingCombat(&amp;quot;Player&amp;quot;)
then TargetNearestEnemy() end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Spiritwalker&amp;apos;s Grace</Name><Default>false</Default><SpellID>79206</SpellID><Actions></Actions><Lua>if not PQR_IsMoving(1) then return false end

if (IsPlayerSpell(117014) and PQR_SpellAvailable(117014))
or (PQR_SpellAvailable(51505) and not LavaSurge) then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>[MACRO] Hex (Mouseover)</Name><Default>false</Default><SpellID>51514</SpellID><Actions></Actions><Lua>if IsMounted() then
return false
end

if Nova_Hex == 1 then
	if UnitExists(&amp;quot;mouseover&amp;quot;)
	and UnitIsUnit(&amp;quot;target&amp;quot;, &amp;quot;mouseover&amp;quot;) ~= 1
	and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;) == 1 then 
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Stormlash Totem</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--if Nova_AOE == 1 then return false end
if Nova_Cooldowns ~= 1 then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then if not PQI_SoapboxElementalOffensiveSettings_AutoStormslashTotem_enable then return false end end
if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then if not PQI_SoapboxEnhancementOffensiveSettings_AutoStormslashTotem_enable then return false end end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end end

---if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then
	---if PQI_SoapboxElementalOffensiveSettings_Ascendance_enable then 
		---if PQR_SpellAvailable(114049) then 
		---return false 
		---end
	---end
---elseif PQI_SoapboxEnhancementOffensiveSettings_Ascendance_enable then 
	---if PQR_SpellAvailable(114049) and not Ascendance then 
	---return false 
	---end
---end

if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				if IsUsableSpell(120668)
				and PQR_SpellAvailable(120668) then 
				CastSpellByName(GetSpellInfo(120668))
				return true
				end
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					if IsUsableSpell(120668)
					and PQR_SpellAvailable(120668) then 
					CastSpellByName(GetSpellInfo(120668))
					return true
					end
				elseif Feed then
					if IsUsableSpell(120668)
					and PQR_SpellAvailable(120668) then 
					CastSpellByName(GetSpellInfo(120668))
					return true
					end
				end
			end
		end
	elseif IsUsableSpell(120668)
	and PQR_SpellAvailable(120668) then 
	CastSpellByName(GetSpellInfo(120668))
	return true
	end
elseif IsUsableSpell(120668)
and PQR_SpellAvailable(120668) then 
CastSpellByName(GetSpellInfo(120668))
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Fire Elemental Totem</Name><Default>false</Default><SpellID>2894</SpellID><Actions>/use 10</Actions><Lua>--if Nova_AOE == 1 then return false end
if Nova_Cooldowns ~= 1 then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then if not PQI_SoapboxElementalOffensiveSettings_AutoElementalTotem_enable then return false end end
if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then if not PQI_SoapboxEnhancementOffensiveSettings_AutoElementalTotem_enable then return false end end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end end
local srTimer, SearingTotem = GetTotemInfo(1)
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then
if Nova_AOE == 1 then
	if FlameShock then
		if PQR_SpellAvailable(1535) then
		return false
		end
	elseif PQR_SpellAvailable(8050) then
	return false 
	end
end
end


if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				if PQR_SpellAvailable(2894) then
				return true
				end
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
   					if PQR_SpellAvailable(2894) then
					return true
					end
				elseif Feed then
					if PQR_SpellAvailable(2894) then
					return true
					end
				end
			end
		end
	elseif PQR_SpellAvailable(2894) then
	return true
	end
elseif PQR_SpellAvailable(2894) then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Lifeblood</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local SpecialUnit = SpecialUnit
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end end
if GetSpecialization(&amp;quot;player&amp;quot;) == 1 then if PQI_SoapboxElementalOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end end
if Nova_Cooldowns ~= 1 then return false end
local srTimer, SearingTotem = GetTotemInfo(1)

-- Herbalism&amp;apos;s Lifeblood
Lifeblood = {81708,74497,121279,55428,55480,55500,55501,55502,55503}

for i=1,#Lifeblood do
	if IsPlayerSpell(Lifeblood[i])
	and PQR_SpellAvailable(Lifeblood[i]) then
		if ElementalGlyph == true then
			if SearingTotem == tostring(GetSpellInfo(2894)) then
			CastSpellByName(GetSpellInfo(Lifeblood[i]),&amp;quot;player&amp;quot;)
			return true
			end
		else
		CastSpellByName(GetSpellInfo(Lifeblood[i]),&amp;quot;player&amp;quot;)
		return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Unleash Elements</Name><Default>false</Default><SpellID>73680</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end

if Nova_AOE == 1 then 
	if PQR_SpellAvailable(1535) then
	return true
	end
else
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Elemental Blast</Name><Default>false</Default><SpellID>117014</SpellID><Actions></Actions><Lua>local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)
if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) and (not name or count &amp;lt; 5) then return false end



if not name then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Lightning Bolt -High-</Name><Default>false</Default><SpellID>403</SpellID><Actions></Actions><Lua>if Nova_AOE == 1 or Nova_Cleave == 1 then return false end

local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)

if name and count &amp;gt; 4 then
	if PQR_SpellAvailable(403) then
		if TargetValidation(&amp;quot;target&amp;quot;, 403) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Feral Spirit -High-</Name><Default>false</Default><SpellID>51533</SpellID><Actions></Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxEnhancementOffensiveSettings_FeralSpirit_enable then return false end
if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end
if Nova_AOE == 1 then
	if FlameShock then
		if PQR_SpellAvailable(1535) then
		return false
		end
	elseif PQR_SpellAvailable(8050) then
	return false 
	end
end
if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				if itemCheck(EnhancementT15) &amp;gt; 3  then
				return true
				end
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					if itemCheck(EnhancementT15) &amp;gt; 3  then
					return true
					end
				elseif Feed then
					if itemCheck(EnhancementT15) &amp;gt; 3  then
					return true
					end
				end
			end
		end
	elseif itemCheck(EnhancementT15) &amp;gt; 3  then
	return true
	end
elseif itemCheck(EnhancementT15) &amp;gt; 3  then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Stormblast</Name><Default>false</Default><SpellID>0</SpellID><Actions>/use 10</Actions><Lua>if Nova_AOE == 1 then
	if FlameShock then
		if PQR_SpellAvailable(1535) then
		return false
		end
	elseif PQR_SpellAvailable(8050) then
	return false 
	end
end

if Ascendance then	
	if PQR_SpellAvailable(115356) then
		if TargetValidation(&amp;quot;target&amp;quot;, 73899) then
		CastSpellByName(GetSpellInfo(115356),&amp;quot;target&amp;quot;)
		return true
		end
	end
elseif not IsPlayerSpell(17364) then return false end
if PQR_SpellAvailable(17364) then
	if TargetValidation(&amp;quot;target&amp;quot;, 73899) then
	CastSpellByName(GetSpellInfo(17364),&amp;quot;target&amp;quot;)
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Flame Shock -High-</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end

if FlameShock then return false end

if QuickKill() then return false end
if UnitBuffID(&amp;quot;player&amp;quot;, 73683) then 
	if TargetValidation(&amp;quot;target&amp;quot;,8050) then
	CastSpellByName(GetSpellInfo(8050),&amp;quot;target&amp;quot;)
	BuffedFlame = true
	return true 
	end
elseif Nova_AOE == 1 or Nova_Cleave == 1 then
	if TargetValidation(&amp;quot;target&amp;quot;,8050) then
	CastSpellByName(GetSpellInfo(8050),&amp;quot;target&amp;quot;)
	return true 
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Lava Lash</Name><Default>false</Default><SpellID>0</SpellID><Actions>/use 10</Actions><Lua>local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,77661)

if Nova_AOE ~= 1 then
	if (name and count &amp;gt; 4) then
		if PQR_SpellAvailable(60103) then
			if TargetValidation(&amp;quot;target&amp;quot;, 60103) then
			CastSpellByName(GetSpellInfo(60103),&amp;quot;target&amp;quot;)
			return true
			end
		end
	end
elseif FlameShock then
	if PQR_SpellAvailable(60103) then
		if TargetValidation(&amp;quot;target&amp;quot;, 60103) then
		CastSpellByName(GetSpellInfo(60103),&amp;quot;target&amp;quot;)
		return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Lightning Bolt -Mid-</Name><Default>false</Default><SpellID>403</SpellID><Actions></Actions><Lua>if Nova_AOE == 1 or Nova_Cleave == 1 then return false end
local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)
if Ascendance then return false end
local Lightning = select(7,GetSpellInfo(403))/1000
---if LLCD &amp;lt; 1 then return false end
---if IsPlayerSpell(117012) and UECD &amp;lt; 1 then return false end
---if PSCD &amp;lt; 1 then return false end
---if IsPlayerSpell(117014) and EBCD &amp;lt; 1 then return false end

if Lightning &amp;gt;= GetSpellCD(60103) then return false end
if IsPlayerSpell(117012) and Lightning &amp;gt;= GetSpellCD(73608) then return false end
if Lightning &amp;gt;= GetSpellCD(73899) then return false end
if IsPlayerSpell(117014) and Lightning &amp;gt;= GetSpellCD(117014) then return false end


if itemCheck(EnhancementT15) &amp;gt; 1 then
	if name and count &amp;gt; 3 then
		if PQR_SpellAvailable(403) then
			if TargetValidation(&amp;quot;target&amp;quot;, 403) then
			return true
			end
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Flame Shock -Low-</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end

if QuickKill() then return false end

if UnitBuffID(&amp;quot;player&amp;quot;, 73683) then 
	if FlameShock then
		if FlameShocktimer - GetTime() &amp;lt; 10
		or BuffedFlame == false then
			if TargetValidation(&amp;quot;target&amp;quot;,8050) then
			CastSpellByName(GetSpellInfo(8050),&amp;quot;target&amp;quot;)
			BuffedFlame = true
			return true
			end
		end
	end
end

if UECD &amp;gt; 5 and not FlameShock then
	if TargetValidation(&amp;quot;target&amp;quot;,8050) then
	CastSpellByName(GetSpellInfo(8050),&amp;quot;target&amp;quot;)
	BuffedFlame = false
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Unleashed Fury</Name><Default>false</Default><SpellID>73680</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end

if IsPlayerSpell(117012) then
	if Nova_AOE == 1 then 
		if FlameShock then
			if PQR_SpellAvailable(1535) then
			return true
			end
		end
	elseif itemCheck(EnhancementT16) &amp;gt; 1 then
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Lightning Bolt -Low-</Name><Default>false</Default><SpellID>403</SpellID><Actions></Actions><Lua>if Nova_AOE == 1 or Nova_Cleave == 1 then return false end
local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)
if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) then return false end
if Ascendance then return false end
local Lightning = select(7,GetSpellInfo(403))/1000

if Lightning &amp;gt;= GetSpellCD(60103) then return false end
if Lightning &amp;gt;= GetSpellCD(73608) then return false end
if Lightning &amp;gt;= GetSpellCD(73899) then return false end
if IsPlayerSpell(117014) and Lightning &amp;gt;= GetSpellCD(117014) then return false end
---if LLCD &amp;lt; 1 then return false end
---if UECD &amp;lt; 1 then return false end
---if PSCD &amp;lt; 1 then return false end
---if IsPlayerSpell(117014) and EBCD &amp;lt; 1 then return false end

if name and count &amp;gt; 2 then
	if PQR_SpellAvailable(403) then
		if TargetValidation(&amp;quot;target&amp;quot;, 403) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Ancestral Swiftness</Name><Default>false</Default><SpellID>16188</SpellID><Actions></Actions><Lua>local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,44544)

if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxEnhancementOffensiveSettings_AncestrialSwiftness_enable then return false end
if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end

if name and count &amp;gt; 1 then return false end


if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				return true
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					return true
				elseif Feed then
					return true
				end
			end
		end
	else
	return true
	end
else 
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Lightning Bolt -AS-</Name><Default>false</Default><SpellID>403</SpellID><Actions></Actions><Lua>if Nova_AOE == 1 or Nova_Cleave == 1 then return false end

if UnitBuffID(&amp;quot;player&amp;quot;, 16188) then 
	if PQR_SpellAvailable(403) then
		if TargetValidation(&amp;quot;target&amp;quot;, 403) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Earth Shock</Name><Default>false</Default><SpellID>8042</SpellID><Actions></Actions><Lua>return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Feral Spirit -Low-</Name><Default>false</Default><SpellID>51533</SpellID><Actions></Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxEnhancementOffensiveSettings_FeralSpirit_enable then return false end
if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end
if Nova_AOE == 1 then
	if FlameShock then
		if PQR_SpellAvailable(1535) then
		return false
		end
	elseif PQR_SpellAvailable(8050) then
	return false 
	end
end
if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				return true
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					return true
				elseif Feed then
					return true
				end
			end
		end
	else
	return true
	end
else
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Earth Elemental Totem</Name><Default>false</Default><SpellID>2062</SpellID><Actions></Actions><Lua>if Nova_Cooldowns ~= 1 then return false end
if not PQI_SoapboxEnhancementOffensiveSettings_AutoElementalTotem_enable then return false end
if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() then return false end


if UnitExists(&amp;quot;boss&amp;quot;..1) then
	local BossID = tonumber(UnitGUID(&amp;quot;boss&amp;quot;..1):sub(6,10), 16)
	if BossID == 69465	
	or BossID == 69712 then
   		if BossID == 69465 then -- Jin&amp;apos;Rokh
		local Fluidity = UnitDebuffID(&amp;quot;player&amp;quot;, 138002)	
			if Fluidity then
				if (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
				return true
				end
			end				
    	elseif BossID == 69712 then -- Ji-Kun
  		local TargetID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(6,10), 16)
  		local Feed = UnitBuffID(&amp;quot;player&amp;quot;, 140741)
   			if TargetID == BossID then
   				if not UnitBuffID(&amp;quot;player&amp;quot;, 133755) then 
					if (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
					return true
					end
				elseif Feed then
					if (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
					return true
					end
				end
			end
		end
	elseif (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
	return true
	end
elseif (IsPlayerSpell(117013) and FCD &amp;gt;= 30) or (not IsPlayerSpell(117013) and FCD &amp;gt;= 60) then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Spiritwalker&amp;apos;s Grace</Name><Default>false</Default><SpellID>79206</SpellID><Actions></Actions><Lua>local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)

if not PQR_IsMoving(1) then return false end


if IsPlayerSpell(117014) then
	if PQR_SpellAvailable(117014) then
		if name then
			if count &amp;lt; 5 then
			return true
			end
		else
		return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Lightning Bolt</Name><Default>false</Default><SpellID>403</SpellID><Actions></Actions><Lua>local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)
if Nova_AOE == 1 or Nova_Cleave == 1 then return false end
if Ascendance then return false end

if ECD &amp;lt; 1 then return false end
if LLCD &amp;lt; 1 then return false end
if UECD &amp;lt; 1 then return false end
if PSCD &amp;lt; 1 then return false end
if IsPlayerSpell(117014) and EBCD &amp;lt; 1 then return false end

if name and count &amp;gt; 1 then
	if PQR_SpellAvailable(403) then
		if TargetValidation(&amp;quot;target&amp;quot;, 403) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---3. Elemental- Table---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if SOAPBOX_ELEMENTAL_DEF then return false end
if SOAPBOX_ELEMENTAL_OFF then return false end

		local Defensive = {
			name	= &amp;quot;Elemental Defensive Settings&amp;quot;,
			author	= &amp;quot;Soapbox&amp;quot;,
			abilities = {
				{ 	name	= &amp;quot;Healthstone&amp;quot;,
					enable	= true,
					widget	= {	type = &amp;quot;numBox&amp;quot;,
						value	= 50,
						step	= 5,
					},
				},
			{ 	name	= &amp;quot;Begin Healing&amp;quot;,
				tooltip = &amp;quot;&amp;quot;,
				enable	= true,
				widget	= { type = &amp;quot;numBox&amp;quot;,
					tooltip = &amp;quot;Set the health % value you want Healing Surge to be casted at.&amp;quot;,
					value	= 20,
					step	= 5,
				},
			},
			{ 	name	= &amp;quot;Cancel Healing&amp;quot;,
				tooltip = &amp;quot;&amp;quot;,
				enable	= true,
				widget	= { type = &amp;quot;numBox&amp;quot;,
					tooltip = &amp;quot;Set the health % value you want Healing Surge to be cancelled at.&amp;quot;,
					value	= 50,
					step	= 5,
				},
			},
				{ 	name	= &amp;quot;Purge&amp;quot;,
					enable	= false,
					tooltip = &amp;quot;Automatically Purge applicable targets.&amp;quot;,
				},
				
				{ 	name	= &amp;quot;Cleanse Spirit&amp;quot;,
					enable	= false,
					tooltip = &amp;quot;Automatically cleanse applicable raid members.&amp;quot;,
				},
			},
		}
		local Offensive = {
			name	= &amp;quot;Elemental Offensive Settings&amp;quot;,
			author	= &amp;quot;Soapbox&amp;quot;,
			abilities = {
				{  name = &amp;quot;Boss Functions&amp;quot;,
				tooltip = &amp;quot;Enabls the use of special functions on certain raid bosses&amp;quot;,
				enable = false,
				newSection = true,	
				},
				{ 	name	= &amp;quot;Spell Queue Type&amp;quot;,
			    tooltip = &amp;quot;Allows you to enable and select how you want Spell Queue overriding to work. It will either queue up the spell on the next GCD when you mouseover or click the ability.&amp;quot;,
				enable	= true,
				newSection  = true,
				widget	= { type = &amp;quot;select&amp;quot;,
					tooltip = &amp;quot;Select how you want to queue the next spell.&amp;quot;,
					values	= {
						&amp;quot;Click&amp;quot;,
						&amp;quot;Mouseover&amp;quot;,
					},
					width	= 80,
				},
				},
				{ 	name	= &amp;quot;Auto Target Next Enemy&amp;quot;,
					enable	= true,
				},
		    	{ 	name	= &amp;quot;Totem Slinger&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Refreshes Totems when they are out of range of the target&amp;quot;,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Potions&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Automated Usage of Potions&amp;quot;,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Racials&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Automated Usage of Racials&amp;quot;,
				},
				{ 	name	= &amp;quot;Auto Elemental Totem&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Auto Stormslash Totem&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Spiritwalker&amp;apos;s Grace&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Ancestrial Swiftness&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Elemental Mastery&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Ascendance&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Frag Belt&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Synapse Springs&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Boss Cooldowns&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Only Use cooldowns on Boss targets&amp;quot;,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Focus Dotting&amp;quot;,
					enable	= true,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Boss Dotting&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Mouseover Dotting&amp;quot;,
					enable	= true,
				},

			},
		}
		SOAPBOX_ELEMENTAL_DEF = PQI:AddRotation(Defensive)
		SOAPBOX_ELEMENTAL_OFF = PQI:AddRotation(Offensive)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---3. Enhancement Table---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if SOAPBOX_ENHANCEMENT_DEF then return false end
if SOAPBOX_ENHANCEMENT_OFF then return false end

		local Defensive = {
			name	= &amp;quot;Enhancement Defensive Settings&amp;quot;,
			author	= &amp;quot;Soapbox&amp;quot;,
			abilities = {
				{ 	name	= &amp;quot;Healthstone&amp;quot;,
					enable	= true,
					widget	= {	type = &amp;quot;numBox&amp;quot;,
						value	= 50,
						step	= 5,
					},
				},
				{ 	name	= &amp;quot;Purge&amp;quot;,
					enable	= false,
					tooltip = &amp;quot;Automatically Purge applicable targets.&amp;quot;,
				},
				
				{ 	name	= &amp;quot;Cleanse Spirit&amp;quot;,
					enable	= false,
					tooltip = &amp;quot;Automatically cleanse applicable raid members.&amp;quot;,
				},
			},
		}
		local Offensive = {
			name	= &amp;quot;Enhancement Offensive Settings&amp;quot;,
			author	= &amp;quot;Soapbox&amp;quot;,
			abilities = {
				{  name = &amp;quot;Boss Functions&amp;quot;,
				tooltip = &amp;quot;Enabls the use of special functions on certain raid bosses&amp;quot;,
				enable = false,
				newSection = true,	
				},
				{ 	name	= &amp;quot;Soapbox Tips&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Enables reccomendations on talents etc. based on current equipment&amp;quot;,
				},
				{ 	name	= &amp;quot;Spell Queue Type&amp;quot;,
			    tooltip = &amp;quot;Allows you to enable and select how you want Spell Queue overriding to work. It will either queue up the spell on the next GCD when you mouseover or click the ability.&amp;quot;,
				enable	= true,
				newSection  = true,
				widget	= { type = &amp;quot;select&amp;quot;,
					tooltip = &amp;quot;Select how you want to queue the next spell.&amp;quot;,
					values	= {
						&amp;quot;Click&amp;quot;,
						&amp;quot;Mouseover&amp;quot;,
					},
					width	= 80,
				},
				},
				{ 	name	= &amp;quot;Auto Target Next Enemy&amp;quot;,
					enable	= true,
				},
		    	{ 	name	= &amp;quot;Totem Slinger&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Refreshes Totems when they are out of range of the target&amp;quot;,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Magma Totem&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Automated Usage of Magma Totem in AOE&amp;quot;,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Fire Nova&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Automated Usage of Fire Nova during Cleave/AoE&amp;quot;,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Potions&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Automated Usage of Potions&amp;quot;,
					newSection  = true,
				},
				{ 	name	= &amp;quot;Racials&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Automated Usage of Racials&amp;quot;,
				},
				{ 	name	= &amp;quot;Auto Elemental Totem&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Auto Stormslash Totem&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Spiritwalker&amp;apos;s Grace&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Ancestrial Swiftness&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Elemental Mastery&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Ascendance&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Feral Spirit&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Frag Belt&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Synapse Springs&amp;quot;,
					enable	= true,
				},
				{ 	name	= &amp;quot;Boss Cooldowns&amp;quot;,
					enable	= true,
					tooltip = &amp;quot;Only Use cooldowns on Boss targets&amp;quot;,
					newSection  = true,
				},

			},
		}
		SOAPBOX_ENHANCEMENT_DEF = PQI:AddRotation(Defensive)
		SOAPBOX_ENHANCEMENT_OFF = PQI:AddRotation(Offensive)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Magma Totem</Name><Default>false</Default><SpellID>8190</SpellID><Actions></Actions><Lua>local TOT1, TOTNAME, startTime, duration = GetTotemInfo(1)
local TOTEXPIRE = startTime + duration - GetTime()
-------------------------------------------------------------
if Nova_AOE == 1 then
	if FlameShock then
		if PQR_SpellAvailable(1535) then
		return false
		end
	elseif PQR_SpellAvailable(8050) then
	return false 
	end
end

if TOTNAME == tostring(GetSpellInfo(3599)) then
	if Nova_AOE == 1 and PQI_SoapboxEnhancementOffensiveSettings_MagmaTotem_enable 
	and playerTargetDistance &amp;lt; 10 then
	x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;)
	return true
	end
end

if (GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalOffensiveSettings_TotemSlinger_enable) 
or (GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementOffensiveSettings_TotemSlinger_enable) then

	if TOTNAME ~= tostring(GetSpellInfo(2894)) 
	and Nova_AOE == 1
	and IsSpellInRange(tostring(GetSpellInfo(73899)), &amp;quot;target&amp;quot;) then
		if TOTEXPIRE == nil 
		or TOTEXPIRE &amp;lt; 2 then
		x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;)
		return true
		end
	end	
end

if (GetSpecialization(&amp;quot;player&amp;quot;) == 1 and PQI_SoapboxElementalOffensiveSettings_TotemSlinger_enable) 
or (GetSpecialization(&amp;quot;player&amp;quot;) == 2 and PQI_SoapboxEnhancementOffensiveSettings_TotemSlinger_enable) then
	if TOTNAME ~= tostring(GetSpellInfo(2894))
	and Nova_AOE == 1
	and IsSpellInRange(tostring(GetSpellInfo(73899)), &amp;quot;target&amp;quot;) then
		if TOTEXPIRE == nil or TOTEXPIRE &amp;lt; 2 then
			x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;) 
			return true
		elseif totemDistance &amp;gt; 10 and playerTargetDistance &amp;lt; 10 then
			x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;) 
	   	return true
		end
	end
end</Lua><RecastDelay>1500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Fire Nova</Name><Default>false</Default><SpellID>1535</SpellID><Actions></Actions><Lua>if not PQI_SoapboxEnhancementOffensiveSettings_FireNova_enable  then return false end
if Nova_Cleave ~= 1 and Nova_AOE ~= 1 then return false end
if not FlameShock then return false end

return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Buffs</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsMounted()
or UnitBuffID(&amp;quot;player&amp;quot;,104934)
or UnitBuffID(&amp;quot;player&amp;quot;,104269) then
return false
end

local mh, mhr, _, oh, ohr = GetWeaponEnchantInfo()
if mh==nil then
	hasmh = false
else
	hasmh = true
end
if oh==nil then
	hasoh = false
else
	hasoh = true
end
if not IsMounted() then
	if Playermana &amp;gt;= 25 and not UnitBuffID(&amp;quot;player&amp;quot;, 324) and not UnitBuffID(&amp;quot;player&amp;quot;, 52127) then
		CastSpellByName(GetSpellInfo(324),&amp;quot;player&amp;quot;)
	end
	if Playermana &amp;lt; 25 and not UnitBuffID(&amp;quot;player&amp;quot;, 52127) then
		CastSpellByName(GetSpellInfo(52127),&amp;quot;player&amp;quot;)
	end
	if Playermana &amp;gt; 75 and UnitBuffID(&amp;quot;player&amp;quot;, 52127) then	
		CastSpellByName(GetSpellInfo(324),&amp;quot;player&amp;quot;)
	end
	
	if GetSpecialization(&amp;quot;player&amp;quot;) == 2 then
		if hasmh == false then
			CastSpellByName(GetSpellInfo(8232),&amp;quot;player&amp;quot;)
		end
		if hasoh == false then
			CastSpellByName(GetSpellInfo(8024),&amp;quot;player&amp;quot;)
		end
	elseif GetSpecialization(&amp;quot;player&amp;quot;) == 1 then
		if hasmh == false then
			CastSpellByName(GetSpellInfo(8024),&amp;quot;player&amp;quot;)
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Ghost Wolf</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if MacroGhost == true then return false end

if IsSpellInRange(GetSpellInfo(60103), &amp;quot;target&amp;quot;) ~= 1 and not UnitBuffID(&amp;quot;player&amp;quot;, 2645) and not Ascendance and PQR_IsMoving(1) and SGCD &amp;gt; 0 and not Spirit then
	CastSpellByName(GetSpellInfo(2645))
end
if IsSpellInRange(GetSpellInfo(60103), &amp;quot;target&amp;quot;) == 1 and UnitBuffID(&amp;quot;player&amp;quot;, 2645) then
	RunMacroText(&amp;quot;/cancelform&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---0. Rotation Check---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization() == 1 then
	Spec = &amp;quot;Elemental&amp;quot;
	PQR_SwapRotation(&amp;quot;Elemental (Soapbox Shaman Serial EE1986)&amp;quot;) 
elseif GetSpecialization() == 2 then
	Spec = &amp;quot;Enhancement&amp;quot;
	PQR_SwapRotation(&amp;quot;Enhancement (Soapbox Shaman Serial EE1986)&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Chain</Name><Default>false</Default><SpellID>421</SpellID><Actions></Actions><Lua>if Nova_AOE ~= 1 and Nova_Cleave ~= 1 then return false end

local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)

if Ascendance then return false end
if ECD &amp;lt; 1 then return false end
if LLCD &amp;lt; 1 then return false end
if UECD &amp;lt; 1 then return false end
if PSCD &amp;lt; 1 then return false end
if IsPlayerSpell(117014) and EBCD &amp;lt; 1 then return false end

if name and count &amp;gt; 1 then
	if PQR_SpellAvailable(421) then
		if TargetValidation(&amp;quot;target&amp;quot;, 421) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Chain -AS-</Name><Default>false</Default><SpellID>421</SpellID><Actions></Actions><Lua>if Nova_AOE ~= 1 and Nova_Cleave ~= 1 then return false end

if UnitBuffID(&amp;quot;player&amp;quot;, 16188) then 
	if PQR_SpellAvailable(421) then
		if TargetValidation(&amp;quot;target&amp;quot;, 421) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Chain -High-</Name><Default>false</Default><SpellID>421</SpellID><Actions></Actions><Lua>if Nova_AOE ~= 1 and Nova_Cleave ~= 1 then return false end

local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)

if name and count &amp;gt; 4 then
	if PQR_SpellAvailable(421) then
		if TargetValidation(&amp;quot;target&amp;quot;, 421) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Chain -Low-</Name><Default>false</Default><SpellID>421</SpellID><Actions></Actions><Lua>if Nova_AOE ~= 1 and Nova_Cleave ~= 1 then return false end
local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)
if PQR_IsMoving(0.3) and not UnitBuffID(&amp;quot;player&amp;quot;, 79206) then return false end
if Ascendance then return false end
local Chain = select(7,GetSpellInfo(421))/1000

if Chain &amp;gt;= GetSpellCD(60103) then return false end
if Chain &amp;gt;= GetSpellCD(73608) then return false end
if Chain &amp;gt;= GetSpellCD(73899) then return false end
if IsPlayerSpell(117014) and Chain &amp;gt;= GetSpellCD(117014) then return false end

if name and count &amp;gt; 2 then
	if PQR_SpellAvailable(421) then
		if TargetValidation(&amp;quot;target&amp;quot;, 421) then
		return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Chain -Mid-</Name><Default>false</Default><SpellID>421</SpellID><Actions></Actions><Lua>if Nova_AOE ~= 1 and Nova_Cleave ~= 1 then return false end
local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,53817)
if Ascendance then return false end
local Chain = select(7,GetSpellInfo(421))/1000

if Chain &amp;gt;= GetSpellCD(60103) then return false end
if IsPlayerSpell(117012) and Chain &amp;gt;= GetSpellCD(73608) then return false end
if Chain &amp;gt;= GetSpellCD(73899) then return false end
if IsPlayerSpell(117014) and Chain &amp;gt;= GetSpellCD(117014) then return false end

if itemCheck(EnhancementT15) &amp;gt; 1 then
	if name and count &amp;gt; 3 then
		if PQR_SpellAvailable(421) then
			if TargetValidation(&amp;quot;target&amp;quot;, 421) then
			return true
			end
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-All- Shamanistic Rage</Name><Default>false</Default><SpellID>30823</SpellID><Actions></Actions><Lua>if Nova_Cleave == 1 or Nova_AOE == 1 then
	if Playermana &amp;lt; 65 then
	return true
	end
elseif Playermana &amp;lt; 40 then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Opener</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_SoapboxEnhancementOffensiveSettings_BossCooldowns_enable and not SpecialUnit() 
then return false end


local TOT1, TOTNAME, startTime, duration = GetTotemInfo(1)
local TOTEXPIRE = startTime + duration - GetTime()

if Nova_Open ~= 1 then return false end

if cTime &amp;gt; 10 then
return false end

if TargetValidation(&amp;quot;target&amp;quot;,8050) then

	if FlameOpen == true and not PQR_SpellAvailable(73680) then
		if PQR_UnitDistance(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) &amp;lt; 15 or IsSpellInRange(GetSpellInfo(73899), &amp;quot;target&amp;quot;) == 1 then
		CastSpellByName(GetSpellInfo(8050))
		return true
		end
	end


	
	if TOTNAME ~= tostring(GetSpellInfo(2894)) then
		if TOTEXPIRE == nil 
		or TOTEXPIRE &amp;lt; 2 then
		x2,y2 = PQR_UnitInfo(&amp;quot;Player&amp;quot;)
		CastSpellByName(GetSpellInfo(3599))
		return true
		end
	end	
	
	if PQR_SpellAvailable(79206) then
	CastSpellByName(GetSpellInfo(79206))
	return true
	end

	
	
	if PQR_SpellAvailable(51533) then
		if UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil then
		UseItemByName(76089)
		CastSpellByName(GetSpellInfo(51533))
		return true
		else
		CastSpellByName(GetSpellInfo(51533))
		return true
		end
	end
	
	if PQR_SpellAvailable(73680) and (PQR_UnitDistance(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) &amp;lt; 18 or IsSpellInRange(GetSpellInfo(73899), &amp;quot;target&amp;quot;) == 1) then
	CastSpellByName(GetSpellInfo(73680))
	FlameOpen = true
	return true
	end
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---Status Frame---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization(&amp;quot;player&amp;quot;) == 3 then
if not SoapboxFrame then

SoapboxFrame = true
_Chat = PQR_WriteToChat

--Notify Frame
PQ_NotifyFrame = CreateFrame(&amp;quot;Frame&amp;quot;)
PQ_NotifyFrame:ClearAllPoints()
PQ_NotifyFrame:SetHeight(12)
PQ_NotifyFrame:SetWidth(600)
PQ_NotifyFrame:Show()
PQ_NotifyFrame.text = PQ_NotifyFrame:CreateFontString(nil, &amp;quot;OVERLAY&amp;quot;, &amp;quot;MovieSubtitleFont&amp;quot;)
PQ_NotifyFrame.text:SetAllPoints()
PQ_NotifyFrame:SetPoint(&amp;quot;CENTER&amp;quot;, -680, -150)
PQ_NotifyFrame:SetScale(.75)
PQ_NotifyFrame:SetScript(&amp;quot;OnUpdate&amp;quot;, PQ_NotifyFrame_OnUpdate)
PQ_NotifyFrame:EnableMouse(true)
PQ_NotifyFrame:SetMovable(true)
PQ_NotifyFrame:RegisterForDrag(&amp;quot;LeftButton&amp;quot;)
PQ_NotifyFrame:SetScript(&amp;quot;OnDragStart&amp;quot;, PQ_NotifyFrame.StartMoving)
PQ_NotifyFrame:SetScript(&amp;quot;OnDragStop&amp;quot;, PQ_NotifyFrame.StopMovingOrSizing)
PQ_NotifyFrame.text:SetText(&amp;quot;|cffFFBE69Cooldowns: &amp;quot;..CDGlobal..&amp;quot;|cffFFBE69Fists Of Fury: &amp;quot;..FOFGlobal)
function PQ_Notify(message)
 	if PQ_NotifyFrame:IsShown() then
 		PQ_NotifyFrame.text:SetText(message) 	
 	end
end

SlashCmdList[&amp;apos;DEBUG&amp;apos;] = function()
if PQ_NotifyFrame:IsShown() then
		PQ_NotifyFrame:Hide()
	else
		PQ_NotifyFrame:Show()
	end
end
SLASH_DEBUG1 = &amp;quot;/pqd&amp;quot;

_Chat(&amp;quot;Setup Done!&amp;quot;)
end

if modtime == nil then
	modtime = 0
end
 

	if WW == false or WW == nil then
	PQ_Notify(&amp;quot;|cffFFBE69Cooldowns: &amp;quot;..CDGlobal..&amp;quot;|cffFFBE69Fists Of Fury: &amp;quot;..FOFGlobal)
	WW = true
	return true
	end
elseif GetSpecialization(&amp;quot;player&amp;quot;) == 1 then
if not SoapboxFrame then

SoapboxFrame = true
_Chat = PQR_WriteToChat

--Notify Frame
PQ_NotifyFrame = CreateFrame(&amp;quot;Frame&amp;quot;)
PQ_NotifyFrame:ClearAllPoints()
PQ_NotifyFrame:SetHeight(12)
PQ_NotifyFrame:SetWidth(600)
PQ_NotifyFrame:Show()
PQ_NotifyFrame.text = PQ_NotifyFrame:CreateFontString(nil, &amp;quot;OVERLAY&amp;quot;, &amp;quot;MovieSubtitleFont&amp;quot;)
PQ_NotifyFrame.text:SetAllPoints()
PQ_NotifyFrame:SetPoint(&amp;quot;CENTER&amp;quot;, -680, -150)
PQ_NotifyFrame:SetScale(.75)
PQ_NotifyFrame:SetScript(&amp;quot;OnUpdate&amp;quot;, PQ_NotifyFrame_OnUpdate)
PQ_NotifyFrame:EnableMouse(true)
PQ_NotifyFrame:SetMovable(true)
PQ_NotifyFrame:RegisterForDrag(&amp;quot;LeftButton&amp;quot;)
PQ_NotifyFrame:SetScript(&amp;quot;OnDragStart&amp;quot;, PQ_NotifyFrame.StartMoving)
PQ_NotifyFrame:SetScript(&amp;quot;OnDragStop&amp;quot;, PQ_NotifyFrame.StopMovingOrSizing)
PQ_NotifyFrame.text:SetText(&amp;quot;|cffFFBE69Cooldowns: |&amp;quot;..CDGlobal)
function PQ_Notify(message)
 	if PQ_NotifyFrame:IsShown() then
 		PQ_NotifyFrame.text:SetText(message) 	
 	end
end

SlashCmdList[&amp;apos;DEBUG&amp;apos;] = function()
if PQ_NotifyFrame:IsShown() then
		PQ_NotifyFrame:Hide()
	else
		PQ_NotifyFrame:Show()
	end
end
SLASH_DEBUG1 = &amp;quot;/pqd&amp;quot;

_Chat(&amp;quot;Setup Done!&amp;quot;)
end

if modtime == nil then
	modtime = 0
end

if PQI_SoapboxBrewmaster_Pause_enable then
	if PQI:IsHotkeys(PQI_SoapboxBrewmaster_Pause_key) and GetTime() - modtime &amp;gt; 1 
	and GetCurrentKeyBoardFocus() == nil then
	modtime = GetTime()
		if PauseSwap then 
			PauseSwap = nil
		else
			PauseSwap = 1
		end
	end
end

	if WW == true or WW == nil then
	PQ_Notify(&amp;quot;|cffFFBE69Cooldowns: |&amp;quot;..CDGlobal)
    WW = false
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Elemental- Unleashed Fury</Name><Default>false</Default><SpellID>73680</SpellID><Actions></Actions><Lua>if MindControlled(&amp;quot;target&amp;quot;) then return false end

if Nova_AOE == 1 then return false end
if QuickKill == true then return false end
if not FlameShock then return false end 

if IsPlayerSpell(117012) then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Start Attack</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>StartAttack(&amp;quot;target&amp;quot;)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>-Enhancement- Unleash AOE</Name><Default>false</Default><SpellID>73680</SpellID><Actions></Actions><Lua>if Nova_AOE == 1 or Nova_Cleave == 1 then 
	if PQR_SpellAvailable(1535) then
	return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>---Boss Special: Shaman---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization(&amp;quot;player&amp;quot;) == 1 and not PQI_SoapboxElementalOffensiveSettings_BossFunctions_enable then return false end
if GetSpecialization(&amp;quot;player&amp;quot;) == 2 and not PQI_SoapboxEnhancementOffensiveSettings_BossFunctions_enable then return false end

--Implement PQR_resumeAttack.. this is used to prevent
--abilities lower in the rotation from being cast.
if PQR_resumeAttack == nil then
	PQR_resumeAttack = 0
elseif PQR_resumeAttack &amp;gt; GetTime() then
	return true
else
	PQR_resumeAttack = 0
end


--IMPORTANT: Change this if you have any cleaves that would do damage to a secondary target
--as part of your single target rotation. Better to be safe than sorry! 
--Used for : Spirit Kings
local cleaveClass = false
local isAOE = strmatch(strupper(PQR_RotationName), &amp;quot;AOE&amp;quot;) --checks if we are in AOE mode.

for i=1,4 do
	local bossCheck = &amp;quot;boss&amp;quot;..i

	if UnitExists(bossCheck) then
		
		local npcID = tonumber(UnitGUID(bossCheck):sub(6,10), 16)
	local	 bossCasting,_,_,_,_,castEnd = UnitCastingInfo(bossCheck)
		local playerCasting,_,_,_,_,PlayercastEnd = UnitCastingInfo(&amp;quot;player&amp;quot;)
		
		if npcID == 62511 or npcID == 62711 then --Amber-Shaper Un&amp;apos;sok or Amber Monstrosity
			local reshapeName = GetSpellInfo(122370)
			local reshapeLife = UnitDebuff(&amp;quot;player&amp;quot;, reshapeName)
			
			if reshapeLife ~= nil then
				local playerCasting = UnitCastingInfo(&amp;quot;vehicle&amp;quot;)
				local playerCasting2 = UnitCastingInfo(&amp;quot;player&amp;quot;)
				--grab spell names for abilities:
				local amberExplosion = GetSpellInfo(122402)
				
				--interrupt self if casting amber explosion
				if playerCasting == amberExplosion then
					--Press the 2nd button (Struggle for Control)
					RunMacroText(&amp;quot;/click OverrideActionBarButton2&amp;quot;)
					return true
				end
				
				--interrupt self if casting amber explosion
				if playerCasting2 == amberExplosion then
					--Press the 2nd button (Struggle for Control)
					RunMacroText(&amp;quot;/click OverrideActionBarButton2&amp;quot;)
					return true
				end
				
				--interrupt the target if casting amber explosion
				if bossCasting and bossCasting == amberExplosion then
					TargetUnit(bossCheck)
					--Press the 1st button (Amber Strike)
					RunMacroText(&amp;quot;/click OverrideActionBarButton1&amp;quot;)
					return true
				end
				
				if UnitExists(&amp;quot;boss2&amp;quot;) then
					if bossCheck == &amp;quot;boss2&amp;quot; then 
						return true --prevent the rotation from executing while reshaped
					end
				else
					return true
				end

			end
			
		elseif npcID == 60709 then --Spirit Kings: Qiang. (Impervious Shield)
			--Stop all attacks until 0.2 seconds after cast time ends and until buff (Impervious Shield) is gone.
			
			--only continue checking if we are targetting the boss or have no target.
			if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or (cleaveClass or isAOE) then
				local impName = GetSpellInfo(117961)
				local impShieldBuff = UnitBuffID(bossCheck, 117961)
				
				if (bossCasting and bossCasting == impName) then
					StopAttack()
					SpellStopCasting()
					local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
					PQR_resumeAttack = GetTime() + delayAdd + 0.2
					return true
				end
				
				if impShieldBuff then
					StopAttack()
					SpellStopCasting()
					return true
				end
			end
			
		elseif npcID == 60710 then --Spirit Kings: Subetai. (Sleight of Hand)
			--Stop all attacks when casting Sleight of Hand, and until 0.2 seconds after cast time ends.
			--Also stop attacks if not stunned.
			
			--only continue checking if we are targetting the boss or have no target.
			if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or (cleaveClass or isAOE) then
				local sleightName = GetSpellInfo(118162)
				local sleightBuff = UnitBuffID(bossCheck, 118162)
				--				  HoJ,   FoJ,  Kidney  
				local stunList = { 853, 105593, 408 }
				local isStunned = nil
				for _,v in ipairs(stunList) do
					local debuffCheck = UnitDebuffID(bossCheck, v)
					if debuffCheck then
						isStunned = true
					end
				end
				
				if (bossCasting and bossCasting == sleightName) then
					StopAttack()
					SpellStopCasting()
					local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
					PQR_resumeAttack = GetTime() + delayAdd + 0.2
					return true
				end
				
				if sleightBuff and not isStunned then
					StopAttack()
					SpellStopCasting()
					return true
				end
			end

		elseif npcID == 60701 then --Spirit Kings: Zian. (Shield of Darkness)
			--Stop all attacks until 0.5 seconds after cast time ends and until buff (Shield of Darkness) is gone.
						
			if (not UnitExists(&amp;quot;target&amp;quot;)) or (UnitIsUnit(&amp;quot;target&amp;quot;, bossCheck)) or (cleaveClass or isAOE) then
				local sodName = GetSpellInfo(117697)
				local sodBuff = UnitBuffID(bossCheck, 117697)
				
				if (bossCasting and bossCasting == sodName) then
					StopAttack()
					SpellStopCasting()
					local delayAdd = (castEnd/1000) - GetTime() --the number of seconds remaining on the cast.
					PQR_resumeAttack = GetTime() + delayAdd + 0.5 --0.5 to account for lag... REALLY do not want to set this off.
					return true
				end
				
				if sodBuff then
					StopAttack()
					SpellStopCasting()
					return true
				end
			end
		elseif npcID == 71161 or npcID == 71157 or npcID == 71156 or npcID == 71155 or npcID == 71160 or npcID == 71154 or npcID == 71152 or npcID == 71158 or npcID == 71153 then ---Klaxxi
			if UnitBuffID(&amp;quot;player&amp;quot;,141857) and not UnitBuffID(&amp;quot;player&amp;quot;,143373) then
				if PQR_SpellAvailable(143373) then
				RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;)
				return true
				end
			end
			if UnitBuffID(&amp;quot;player&amp;quot;,143373) then
				if UnitDebuffID(&amp;quot;target&amp;quot;,144276) and PQR_SpellAvailable(144275) then
				RunMacroText(&amp;quot;/click OverrideActionBarButton2&amp;quot;)
				return true
				elseif not UnitDebuffID(&amp;quot;target&amp;quot;,144276) and PQR_SpellAvailable(144276) then
				RunMacroText(&amp;quot;/click OverrideActionBarButton3&amp;quot;)
				return true
				elseif PQR_SpellAvailable(144274) then
				RunMacroText(&amp;quot;/click OverrideActionBarButton1&amp;quot;)
				return true
				elseif PQR_SpellAvailable(144181) then
				RunMacroText(&amp;quot;/click OverrideActionBarButton4&amp;quot;)
				return true
				end
			end
		elseif npcID == 71529 then --Thok: Deafening
			local Deaf = GetSpellInfo(143343)
			local BossCasting,_,_,_,_,BossCastEnd = UnitCastingInfo(bossCheck)
			local PlayerCasting,_,_,_,_,PlayerCastEnd = UnitCastingInfo(&amp;quot;player&amp;quot;)
			if (BossCasting and BossCasting == Deaf) then	
				local BossTimeLeft = (BossCastEnd/1000) - GetTime()
				if PlayerCasting then
				local PlayerTimeLeft = (PlayerCastEnd/1000) - GetTime()
					if BossTimeLeft &amp;lt;= PlayerTimeLeft then
					SpellStopCasting()
					return true
					end
				end
			end
		end
	end
end

--click button to leave.
--Gara&amp;apos;jal isn&amp;apos;t a boss while in the Spirit Realm.
local returnSoul = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,116161))
if returnSoul and returnSoul - GetTime() &amp;lt; 2 then 
	RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></SHAMAN>