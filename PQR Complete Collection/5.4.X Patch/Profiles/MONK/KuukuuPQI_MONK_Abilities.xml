<?xml version="1.0" encoding="utf-8" ?><MONK><Ability><Name>(BM) Guard</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;player&amp;quot;) &amp;gt;= 34 then
	if PQR_SpellAvailable(115295) 
	and IsSpellKnown(115295)
	and UnitPower(&amp;quot;player&amp;quot;, 12) &amp;gt;= 2
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and UnitBuffID (&amp;quot;player&amp;quot;,118636) ~= nil
	and UnitBuffID (&amp;quot;player&amp;quot;,115295) == nil
	then
		if not IsInRaid()
		and PQI_KuukuuBrewmaster_AutoGuardDungeon_enable and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt; PQI_KuukuuBrewmaster_AutoGuardDungeon_value
		then 
			CastSpellByName(GetSpellInfo(115295))
			return true
		end
	
		if IsMouseButtonDown(5)
		then
			CastSpellByName(GetSpellInfo(115295))
			return true
		end
	
		if PQI_KuukuuBrewmaster_AutoGuard_enable and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt; PQI_KuukuuBrewmaster_AutoGuard_value
		then
			CastSpellByName(GetSpellInfo(115295))
			return true
		end
	end
end

if UnitLevel(&amp;quot;player&amp;quot;) &amp;lt; 34 then
if PQR_SpellAvailable(115295) 
and IsSpellKnown(115295)
and UnitPower(&amp;quot;player&amp;quot;, 12) &amp;gt;= 2
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitBuffID (&amp;quot;player&amp;quot;,115295) == nil
then
	if not IsInRaid()
	and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt; 75
	then 
		CastSpellByName(GetSpellInfo(115295))
		return true
	end
	
	if (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt; 35
	then
		CastSpellByName(GetSpellInfo(115295))
		return true
	end
end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Invoke Xuen</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if  PQI:IsHotkeys(PQI_KuukuuBrewmaster_InvokeXuen_key)
and IsSpellKnown(123904)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	then CastSpellByName(GetSpellInfo(123904))
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Jab</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;player&amp;quot;) &amp;lt; 11 then
	if PQR_SpellAvailable(100780)
	and IsSpellKnown(100780)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40
	then
		CastSpellByName(GetSpellInfo(100780))
		return true
	end
end

if UnitLevel(&amp;quot;player&amp;quot;) &amp;gt;= 11 then
	local KSStart, KSDuration = GetSpellCooldown(121253)
	local KSCD = KSStart + KSDuration - GetTime() 
	local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
	local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
	JabOK = CurrentEnergy - 40 + (KSCD * EnergyRegen)
	if PQR_SpellAvailable(100780)
	and IsSpellKnown(100780)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40 then
		if JabOK &amp;gt;= 30 then
			CastSpellByName(GetSpellInfo(100780))
			return true
		end
		if JabOK &amp;lt; 30 then
			CastSpellByName(GetSpellInfo(100787))
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Functions</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if  (select(2, UnitClass(&amp;quot;player&amp;quot;)) ~= &amp;quot;MONK&amp;quot;)
then
	print(&amp;quot;Error: Wrong Class&amp;quot;)
	PQR_StopRotation()
elseif GetSpecialization() == nil
then
	print(&amp;quot;Error: Wrong Spec - None selected!&amp;quot;)
	PQR_StopRotation()
end

if GetSpecialization() == 1
	then
		if GetShapeshiftForm() ~= 1
			then CastShapeshiftForm(1)
		end
end

--Code by Christopher X
busy											= IsMounted() or UnitBuff(&amp;quot;player&amp;quot;,&amp;quot;Food&amp;quot;) or UnitBuff(&amp;quot;player&amp;quot;,&amp;quot;Drink&amp;quot;) or UnitInVehicle(&amp;quot;player&amp;quot;) or UnitIsDead(&amp;quot;player&amp;quot;) or UnitChannelInfo(&amp;quot;player&amp;quot;) or UnitCastingInfo(&amp;quot;player&amp;quot;)
TigerBrew 										= UnitBuffID(&amp;quot;player&amp;quot;, 125195, &amp;quot;EXACT|PLAYER&amp;quot;)
TigerBrewStacks 								= select(4,UnitBuffID(&amp;quot;player&amp;quot;,125195))
TigerBrewBuff 									= UnitBuffID(&amp;quot;player&amp;quot;, 116740, &amp;quot;EXACT|PLAYER&amp;quot;)

local blBuffs = {2825, 32182, 80353, 90355}
for i=1, #blBuffs do
	if UnitBuffID(&amp;quot;player&amp;quot;,blBuffs[i]) then
		Bloodlust, _, _, _, _, _, BLTimer = UnitBuffID(&amp;quot;player&amp;quot;,blBuffs[i])
	end
end

if PQR_RotationStarted == true then
  PQR_RotationStarted = false
  COMBATLOG:UnregisterEvent(&amp;quot;COMBAT_LOG_EVENT&amp;quot;) --This is to help reduce/remove spell lag during raids/large groups of people
   return true
end

local PartyBuffs = 
{
	stats = { 117666,1126,20217, 90363 },
	crit = { 116781,17007,1459,61316,24604,90309,126373,126309 }
}

function ClassBuffs(i,unit)
	if i == 1 then
		for x=1, #PartyBuffs.stats do
			if UnitBuffID(unit,PartyBuffs.stats[x])
			then
				return true
			end
		end
	elseif i == 2 then
		for x=1, #PartyBuffs.crit do
			if UnitBuffID(unit,PartyBuffs.crit[x])
			then
				return true
			end
		end
	end
end

-- Dummy Check
function dummy()
 dummies = {
  31146, --Raider&amp;apos;s Training Dummy - Lvl ??
  67127, --Training Dummy - Lvl 90
  46647, --Training Dummy - Lvl 85
  32546, --Ebon Knight&amp;apos;s Training Dummy - Lvl 80
  31144, --Training Dummy - Lvl 80
  32667, --Training Dummy - Lvl 70
  32542, --Disciple&amp;apos;s Training Dummy - Lvl 65
  32666, --Training Dummy - Lvl 60
  32545, --Initiate&amp;apos;s Training Dummy - Lvl 55 
  32541, --Initiate&amp;apos;s Training Dummy - Lvl 55 (Scarlet Enclave) 
 }
 for i=1, #dummies do
  if UnitExists(&amp;quot;target&amp;quot;) then
   dummyID = tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(-13, -9), 16)
  else
   dummyID = 0
  end
  if dummyID == dummies[i] then
   return true
  end 
 end
end

-- Rotation Timer
function timecheck()
 if sTimer == nil then
  sTimer = 0
 end
 if cTime == nil then
  cTime = 0
 end
 if UnitAffectingCombat(&amp;quot;player&amp;quot;) and sTimer == 0 then
   sTimer = GetTime()
 end
 if sTimer &amp;gt; 0 then
   cTime = (GetTime() - sTimer)
 end
 if not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not UnitExists(&amp;quot;target&amp;quot;) then
  sTimer = 0
  cTime = 0
 end
 return cTime
end

timecheck()
--Dummy 5min DPS Test
if UnitExists(&amp;quot;target&amp;quot;) then
	if cTime &amp;gt;= 300 and dummy() then  
		StopAttack()
		ClearTarget()
		print(&amp;quot;5 Minute Dummy Test Concluded - Profile Stopped&amp;quot;)
		PQR_StopRotation()
	end
end

if Pandas == nil then
Pandas = { }
end

if LoadSEFFunctions == nil then
	LoadSEFFunctions = true

	function SEFFrame_OnEvent(self,event,...)

--Combat log events
		if event == &amp;quot;COMBAT_LOG_EVENT_UNFILTERED&amp;quot; then    
			local SubEvent = select(2, ...)
			local SourceName = select(5, ...)
			local DestGUID = select(8, ...)
			local DestName = select(9, ...)
			local SpellID = select(12, ...)
			local SpellName = select(13, ...)
			local ExtraSpellID = select(15, ...)
			local ExtraSpellName = select(16, ...)

			if SubEvent == &amp;quot;SPELL_CAST_SUCCESS&amp;quot; then
				if SourceName == UnitName(&amp;quot;player&amp;quot;) then
					if SpellID == 137639 then
						table.insert( Pandas, DestGUID )
					end
				end
			end

			if SubEvent == &amp;quot;SPELL_AURA_REMOVED&amp;quot; then
				if SourceName == UnitName(&amp;quot;player&amp;quot;) then
					if SpellID == 137639 then
						Pandas = { }
					end
				end
			end
		end
	end
end

if LoadSEFFrame == nil then
	LoadSEFFrame = true

	SEFFrame = CreateFrame(&amp;quot;Frame&amp;quot;)
	SEFFrame:RegisterEvent(&amp;quot;COMBAT_LOG_EVENT_UNFILTERED&amp;quot;)
	SEFFrame:SetScript(&amp;quot;OnEvent&amp;quot;, SEFFrame_OnEvent)
	SEFFrame:Show()
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Blackout Kick</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local bok,_,_,bokcount,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,115307)

if PQR_SpellAvailable(100784)
and IsSpellKnown(100784)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
then
	if UnitBuffID(&amp;quot;player&amp;quot;,115307) == nil
	and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;=2
	then 
		CastSpellByName(GetSpellInfo(100784))
		return true
	end
	
	if bok 
	and expires-GetTime() &amp;lt;=3
	then 
		CastSpellByName(GetSpellInfo(100784))
		return true
	end
	
	if UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 4
	then 
		CastSpellByName(GetSpellInfo(100784))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Tier 4</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>stunDisarmKey= IsMouseButtonDown(3)

if PQR_SpellAvailable(119381) 
and IsSpellKnown(119381)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and stunDisarmKey
then CastSpellByName(GetSpellInfo(119381))
return true
end

if PQR_SpellAvailable(119392) 
and IsSpellKnown(119392)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and stunDisarmKey
then CastSpellByName(GetSpellInfo(119392))
return true
end

if PQR_SpellAvailable(116844) 
and IsSpellKnown(116844)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and stunDisarmKey
then CastSpellByName(GetSpellInfo(116844),&amp;quot;player&amp;quot;)
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Touch of Death</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(115080)
and IsSpellKnown(115080)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitHealth(&amp;quot;target&amp;quot;) &amp;lt;= UnitHealth(&amp;quot;player&amp;quot;) 
and not UnitIsPlayer(&amp;quot;target&amp;quot;)
then 
	for i=1,GetNumGlyphSockets() do
		if select(4, GetGlyphSocketInfo(i)) == 123391 then 
			CastSpellByName(GetSpellInfo(115080))
			return true 
		end
	end
	
	if UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 3
	then 
		CastSpellByName(GetSpellInfo(115080))
  		return true
  	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Interrupt Focus</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if select(2,GetSpellCooldown(116705)) == 0
		and IsSpellInRange(GetSpellInfo(100780),&amp;quot;focus&amp;quot;)
		and PQR_IsInterruptAll() 
			then
			CastSpellByName(GetSpellInfo(116705),&amp;quot;focus&amp;quot;)
			PQR_DelayRotation(.5)
	end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Keg Smash</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;player&amp;quot;) &amp;lt; 11 then
return false
end

local inRange = 0
local unit = &amp;quot;target&amp;quot;
local KegSmash = GetSpellInfo(121253)

if IsSpellInRange(GetSpellInfo(100780), &amp;quot;target&amp;quot;) == 1
then
inRange = 1
end

if PQR_SpellAvailable(121253) 
and IsSpellKnown(121253)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40
and inRange ==1
then CastSpellByName(KegSmash)
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Chi Brew</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsSpellKnown(115399)
and PQR_SpellAvailable(115399)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower(&amp;quot;player&amp;quot;,12) == 0
then
	CastSpellByName(GetSpellInfo(115399),nil)
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Black Ox Statue</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(115315)
and GetNumGroupMembers() ~= 0
and IsSpellKnown(115315)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and not IsMounted()
and not UnitBuffID(&amp;quot;player&amp;quot;,126119)
and not GetCurrentKeyBoardFocus() then 
	CastSpellByName(GetSpellInfo(115315))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
	return true 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Tiger Palm &amp;lt;=3</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local TigerPower,_,_,_,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,125359)

if PQR_SpellAvailable (100787)
and UnitAffectingCombat(&amp;quot;player&amp;quot;) 
and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 1
then
	if UnitBuffID(&amp;quot;player&amp;quot;,125359) == nil then
		CastSpellByName(GetSpellInfo(100787))
		return true
	end
	
	if TigerPower and expires - GetTime() &amp;lt;= 3 then
		CastSpellByName(GetSpellInfo(100787))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Tigereye Brew</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code provided by Christopher X
if UnitAffectingCombat(&amp;quot;player&amp;quot;) then
-------------------------
--Tiger&amp;apos;s Brew (NO RoR)--
-------------------------
	if not TigerBrewBuff then
--Excess TB stacks
		if TigerBrew and TigerBrewStacks&amp;gt;=10 and PQR_SpellAvailable(107428) then
			CastSpellByName(GetSpellInfo(116740))
			RunMacroText(&amp;quot;/use 10&amp;quot;)
		end
--Powerful proc
		if TigerBrew and TigerBrewStacks&amp;gt;=3 and TrinketProc and TrinkTimer - GetTime() &amp;gt; 7 then
			powerfulproc = &amp;quot;true&amp;quot;
			CastSpellByName(GetSpellInfo(116740))
			RunMacroText(&amp;quot;/use 10&amp;quot;)
		end
--Bloodlust
		if Bloodlust and BLTimer - GetTime() &amp;gt; 10 and TigerBrew and TigerBrewStacks&amp;gt;=10 then
			CastSpellByName(GetSpellInfo(116740))
			RunMacroText(&amp;quot;/use 10&amp;quot;)
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Energizing Brew</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local EnergyMax = UnitPowerMax(&amp;quot;player&amp;quot;)
local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local TimetoMax = (EnergyMax - CurrentEnergy) * (1.0 / EnergyRegen)

if PQR_SpellAvailable(115288)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and TimetoMax &amp;gt; 5 then
	CastSpellByName(GetSpellInfo(115288),nil)
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) RSK Debuff</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local RSK,_,_,_,_,_,RSKtimer = UnitDebuffID(&amp;quot;target&amp;quot;,130320)

if PQR_SpellAvailable(107428)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 2
then
	if not RSK then
		CastSpellByName(GetSpellInfo(107428))
		return true
	elseif RSK and RSKtimer - GetTime() &amp;lt;= 2 then
		CastSpellByName(GetSpellInfo(107428))
		return true
		end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Tiger Palm</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local TigerPower,_,_,_,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,125359)
local RSK,_,_,_,_,_,RSKtimer = UnitDebuffID(&amp;quot;target&amp;quot;,130320)
local EnergyMax = UnitPowerMax(&amp;quot;player&amp;quot;)
local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local TimetoMax = (EnergyMax - CurrentEnergy) * (1.0 / EnergyRegen)

if PQR_SpellAvailable(100787) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and not UnitBuffID(&amp;quot;player&amp;quot;, 125359)
and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 1 
and RSK and RSKtimer - GetTime() &amp;gt; 2
then
	CastSpellByName(GetSpellInfo(100787))
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Invoke Xuen</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsSpellKnown(123904) then
	if PQI_KuukuuWindwalker_InvokeXuen_enable 
	and PQI:IsHotkeys(PQI_KuukuuWindwalker_InvokeXuen_key)
	and PQR_SpellAvailable (123904)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
		then CastSpellByName(GetSpellInfo(123904))
		return true
	end
	if UnitLevel(&amp;quot;target&amp;quot;) == -1
	and not PQI_KuukuuWindwalker_InvokeXuen_enable
	and PQR_SpellAvailable (123904)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
		then CastSpellByName(GetSpellInfo(123904))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Rising Sun Kick</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(107428)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 2
then
	CastSpellByName(GetSpellInfo(107428))
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Chi Wave</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local EnergyMax = UnitPowerMax(&amp;quot;player&amp;quot;)
local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local TimetoMax = (EnergyMax - CurrentEnergy) * (1.0 / EnergyRegen)

if PQR_SpellAvailable(115098)
and PQI_KuukuuWindwalker_ChiWave_enable
and IsSpellKnown(115098) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and TimetoMax &amp;gt; 2
and UnitPower(&amp;quot;player&amp;quot;,12) ~= 4
then 
	CastSpellByName(GetSpellInfo(115098),&amp;quot;target&amp;quot;)
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Blackout Kick</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local RSKStart, RSKDuration = GetSpellCooldown(107428)
local RSKCD = (RSKStart + RSKDuration - GetTime())
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local BoKOK = CurrentEnergy + (EnergyRegen * RSKCD)


if PQR_SpellAvailable(100784)
and IsSpellKnown(100784)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
then
	if UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 2 
	and BoKOK &amp;gt;= 40
	then
		CastSpellByName(GetSpellInfo(100784))
		return true
	end
	
	if  UnitPower(&amp;quot;player&amp;quot;,12) ==4 
	then
		CastSpellByName(GetSpellInfo(100784))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Blackout Kick CB</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(100784)
and IsSpellKnown(100784)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitBuffID(&amp;quot;player&amp;quot;, 116768) then
	CastSpellByName(GetSpellInfo(100784))
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Tiger Palm CB</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CB,_,_,_,_,_,CBTime = UnitBuffID(&amp;quot;player&amp;quot;, 118864)
local EnergyMax = UnitPowerMax(&amp;quot;player&amp;quot;)
local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local TimetoMax = (EnergyMax - CurrentEnergy) * (1.0 / EnergyRegen)

if PQR_SpellAvailable(100787) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitBuffID(&amp;quot;player&amp;quot;, 118864) then
	
	if TimetoMax &amp;gt;= 2 then
		CastSpellByName(GetSpellInfo(100787))
		return true
	end
	
	if CBTime - GetTime() &amp;lt;= 2 then
		CastSpellByName(GetSpellInfo(100787))
		return true
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Jab</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(100780)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower(&amp;quot;player&amp;quot;,12) &amp;lt;= 2 then
		CastSpellByName(GetSpellInfo(100780))
		return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Fist of Fury</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local EnergyMax = UnitPowerMax(&amp;quot;player&amp;quot;)
local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local TimetoMax = (EnergyMax - CurrentEnergy) * (1.0 / EnergyRegen)
local FoFCast = (4 / (1 + UnitSpellHaste(&amp;quot;Player&amp;quot;) / 100))
local TP,_,_,_,_,_,TPtimer = UnitBuffID(&amp;quot;player&amp;quot;,125359)
local RSKStart, RSKDuration = GetSpellCooldown(107428)
local RSKCD = RSKStart + RSKDuration - GetTime() 

if PQR_SpellAvailable(113656) 
and PQI_KuukuuWindwalker_FistsofFury_enable
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and not UnitBuffID(&amp;quot;player&amp;quot;,115228)
and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 3
and TimetoMax &amp;gt; FoFCast
and RSKCD &amp;gt; FoFCast
and TP and TPtimer - GetTime() &amp;gt; FoFCast
and not PQR_IsMoving(0.1)
then
	CastSpellByName(GetSpellInfo(113656))
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Breath of Fire</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local bok,_,_,bokcount,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,115307)

if AoE == false then
	if UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and PQR_SpellAvailable(115181)
	and IsSpellKnown(115181)
	and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 4 
	and bok and expires-GetTime() &amp;gt;=4
	and UnitDebuffID(&amp;quot;target&amp;quot;,123727) then 
		CastSpellByName(GetSpellInfo(115181))
		return true
	end
elseif AoE == true then
	if UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and PQR_SpellAvailable(115181)
	and IsSpellKnown(115181)
	and UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt;= 4 
	and bok and expires-GetTime() &amp;gt;=4 then 
		CastSpellByName(GetSpellInfo(115181))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Desperate Measures</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(115072)
and IsSpellKnown(115072) 
and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40
and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt;= 35
then CastSpellByName(GetSpellInfo(115072))
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Dizzying Haze</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI:IsHotkeys(PQI_KuukuuBrewmaster_DizzyingHaze_key) and not GetCurrentKeyBoardFocus() 
and not UnitChannelInfo(&amp;quot;player&amp;quot;) 
and not IsMounted()
and IsSpellKnown(115180) 
and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 25
then 
  SpellCancelQueuedSpell() 
  CastSpellByName(GetSpellInfo(115180),nil) 
  if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end 
  return true 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Elusive Brew</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local name,_,_,count,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,128939)


if name
and IsSpellKnown(115308)
and select(3, UnitBuffID(&amp;quot;player&amp;quot;,115308)) ~= &amp;quot;ability_monk_elusiveale&amp;quot;
and (count&amp;gt;=10 or (count &amp;gt;=2 and expires - GetTime() &amp;lt; 4))
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
then CastSpellByName(GetSpellInfo(115308),nil)
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Expel Harm</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local inRange = 0

if IsSpellInRange(GetSpellInfo(100780), &amp;quot;target&amp;quot;) == 1
then
inRange = 1
end

if PQR_SpellAvailable(115072)
and IsSpellKnown(115072) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40
and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt;= 85
and inRange ==1
then CastSpellByName(GetSpellInfo(115072))
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Fortifying Brew</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(115203)
and IsSpellKnown(115203)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and ((100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt;= 35 or  PQI:IsHotkeys(PQI_KuukuuBrewmaster_FortifyingBrew_key))
	then CastSpellByName(GetSpellInfo(115203),nil)
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Purifying Brew</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local bok,_,_,bokcount,_,_,expires = UnitBuffID(&amp;quot;player&amp;quot;,115307)

if bok then
	expires = expires - GetTime()
else
	expires = 0
end


if PQR_SpellAvailable(119582)
and IsSpellKnown(119582)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and (UnitPower(&amp;quot;player&amp;quot;, 12) &amp;gt;= 3 or UnitBuffID(&amp;quot;player&amp;quot;,138237)) then
	if UnitDebuffID(&amp;quot;player&amp;quot;, 124273) then
		CastSpellByName(GetSpellInfo(119582),nil)
		return true
	end
	if UnitDebuffID(&amp;quot;player&amp;quot;, 124274) and (expires &amp;gt; 4 or UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt; 3) then
		CastSpellByName(GetSpellInfo(119582),nil)
		return true
	end		
	if UnitDebuffID(&amp;quot;player&amp;quot;, 124275) and (expires &amp;gt; 10 or UnitPower(&amp;quot;player&amp;quot;,12) &amp;gt; 3) then
		CastSpellByName(GetSpellInfo(119582),nil)
		return true
	end	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Spinning Crane Kick</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local inRange = 0
local KSStart, KSDuration = GetSpellCooldown(121253)
local KSCD = KSStart + KSDuration - GetTime() 
local RJW = 0

if select(5,GetTalentInfo(16)) == true
then
RJW = 1
end

if IsSpellInRange(GetSpellInfo(100780), &amp;quot;target&amp;quot;) == 1
then
inRange = 1
end

if AoE
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40
and inRange ==1
and KSCD &amp;gt; 3
then
	if PQR_SpellAvailable(116847)
	and not UnitBuffID(&amp;quot;player&amp;quot;,116847)
	and RJW == 1 then
		CastSpellByName(GetSpellInfo(116847))
		return true
	end
	if PQR_SpellAvailable(101546) 
	and IsSpellKnown(101546)
	and RJW == 0 then
		CastSpellByName(GetSpellInfo(101546))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Spinning Crane Kick</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local inRange = 0 
local RJW = 0

if select(5,GetTalentInfo(16)) == true
then
RJW = 1
end

if IsSpellInRange(GetSpellInfo(100780), &amp;quot;target&amp;quot;) == 1
then
inRange = 1
end

if AoE
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and inRange ==1
then
	if PQR_SpellAvailable(116847)
	and not UnitBuffID(&amp;quot;player&amp;quot;,116847)
	and RJW == 1 then
		CastSpellByName(GetSpellInfo(116847))
		return true
	end
	if PQR_SpellAvailable(101546) 
	and IsSpellKnown(101546)
	and RJW == 0 then
		CastSpellByName(GetSpellInfo(101546))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Tiger Palm</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;player&amp;quot;) &amp;gt;= 34 then
	if IsSpellKnown(100787)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;) then
		if  UnitBuffID (&amp;quot;player&amp;quot;,118636) == nil
			then CastSpellByName(GetSpellInfo(100787))
			return true
		elseif UnitBuffID (&amp;quot;player&amp;quot;,125359) == nil
			then CastSpellByName(GetSpellInfo(100787))
			return true
		elseif UnitPower (&amp;quot;player&amp;quot;) &amp;lt;= 30
			then CastSpellByName(GetSpellInfo(100787))
			return true
		end
	end



elseif IsSpellKnown(100787)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and UnitPower (&amp;quot;player&amp;quot;,12) &amp;gt;= 1 then
		if  UnitBuffID (&amp;quot;player&amp;quot;,118636) == nil
			then CastSpellByName(GetSpellInfo(100787))
			return true
		elseif UnitPower (&amp;quot;player&amp;quot;) &amp;lt;= 30
			then CastSpellByName(GetSpellInfo(100787))
			return true
		end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Expel Harm</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local inRange = 0

if IsSpellInRange(GetSpellInfo(100780), &amp;quot;target&amp;quot;) == 1
then
inRange = 1
end

if PQR_SpellAvailable(115072)
and PQI_KuukuuWindwalker_ExpelHarm_enable
and IsSpellKnown(115072) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40
and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt;= 85
and inRange ==1
then CastSpellByName(GetSpellInfo(115072))
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Pause</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsMounted() then
	return true
end

if GetSpecialization() == 1 then
	if (PQI_KuukuuBrewmaster_Pause_enable and PQI: IsHotkeys(PQI_KuukuuBrewmaster_Pause_key)) then
		return true
	end
end
	
if GetSpecialization() == 3 then
	if (PQI_KuukuuWindwalker_Pause_enable and PQI: IsHotkeys(PQI_KuukuuWindwalker_Pause_key)) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Detox</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_KuukuuBrewmaster_Detox_enable then
	if IsInRaid() then
    	 group = &amp;quot;raid&amp;quot; elseif IsInGroup() then
     	group = &amp;quot;party&amp;quot; end  for i = 1, GetNumGroupMembers() do
     	for d = 1, 40 do
        	 if ( select(5, UnitDebuff(group..i, d)) == &amp;quot;Poison&amp;quot;
          	or select(5, UnitDebuff(group..i, d)) == &amp;quot;Disease&amp;quot; ) then
            	 PQR_CustomTarget = group..i 
            	if PQR_UnitDistance(&amp;quot;player&amp;quot;, PQR_CustomTarget) &amp;lt;= 40 then
                 	CastSpellByName(GetSpellInfo(115450), PQR_CustomTarget)
             	end
         	end
     	end
 	end
 end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Tier 2</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(115098)
and IsSpellKnown(115098) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt; 80
then CastSpellByName(GetSpellInfo(115098),&amp;quot;player&amp;quot;)
return true
end

if PQR_SpellAvailable(123986)
and IsSpellKnown(123986) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and (100*(UnitHealth(&amp;quot;player&amp;quot;)/UnitHealthMax(&amp;quot;player&amp;quot;))) &amp;lt; 75
then CastSpellByName(GetSpellInfo(123986))
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Chi Wave filler</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(115098)
and PQI_KuukuuWindwalker_ChiWave_enable
and IsSpellKnown(115098) 
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower(&amp;quot;player&amp;quot;,12) == 0
then 
	CastSpellByName(GetSpellInfo(115098),&amp;quot;target&amp;quot;)
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) (Manual) Black Ox Statue</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsMouseButtonDown(4)
then
	CastSpellByName(GetSpellInfo(115315))
	if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
	return true 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Diesall Frame--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if Kuukuu_Brewmaster then return false end

local config = {
	name	= &amp;apos;Brewmaster&amp;apos;,
	author	= &amp;apos;Kuukuu&amp;apos;,
	abilities = {
	{	name = &amp;quot;Auto Buffs&amp;quot;,
					tooltip = &amp;quot;Enables Automatic Buffing&amp;quot;,
					enable = true,
				},
				{ 	name = &amp;quot;Auto Target&amp;quot;,
					enable = true,
					tooltip = &amp;quot;If you dont have a target it will target your focus target&amp;quot;,
				},
				{ 	name = &amp;quot;Healthstone&amp;quot;,	
					enable = true,
					tooltip = &amp;quot;Auto use of Healthstone at specific HP percent&amp;quot;,
					widget = { type = &amp;apos;numBox&amp;apos;,
						value = 30,
						step = 5,
						max = 100,
						min = 0,
						tooltip = &amp;quot;The percent of HP to use Healthstone at&amp;quot;,
					},
				},
				{ 	name = &amp;quot;Auto Guard&amp;quot;,
					enable = true,
					tooltip = &amp;quot;Enables auto use of Guard at specific HP percent&amp;quot;,
					widget = { type = &amp;apos;numBox&amp;apos;,
						value = 35,
						step = 5,
						max = 100,
						min = 0,
						tooltip = &amp;quot;The percent of HP to use Guard at&amp;quot;,
					},
				},
					{ 	name = &amp;quot;Auto Guard Dungeon&amp;quot;,
					enable = true,
					tooltip = &amp;quot;Enables auto use of Guard in dungeons at specific HP percent&amp;quot;,
					widget = { type = &amp;apos;numBox&amp;apos;,
						value = 75,
						step = 5,
						max = 100,
						min = 0,
						tooltip = &amp;quot;The percent of HP to use Guard at&amp;quot;,
					},
				},
	},
	hotkeys = {
		{	name = &amp;quot;Area of Effect&amp;quot;,	enable = true,	hotkeys = {	&amp;apos;lc&amp;apos; },	},
		{	name = &amp;quot;Pause&amp;quot;,			enable = true,	hotkeys = {	&amp;apos;la&amp;apos;	},	},
		{	name = &amp;quot;Dizzying Haze&amp;quot;,			enable = true,	hotkeys = {	 &amp;apos;ls&amp;apos;	},	}, 
		{	name = &amp;quot;Tier 5&amp;quot;,			enable = true,	hotkeys = {	 &amp;apos;rs&amp;apos;	},	}, 
		{	name = &amp;quot;Fortifying Brew&amp;quot;,			enable = true,	hotkeys = {	 &amp;apos;ra&amp;apos;	},	}, 
		{	name = &amp;quot;Invoke Xuen&amp;quot;,			enable = true,	hotkeys = {	 &amp;apos;rc&amp;apos;	},	}, 
	
	},
}
Kuukuu_Brewmaster = PQI:AddRotation(config)

if Kuukuu_Windwalker then return false end

local wwconfig = {
	name	= &amp;apos;Windwalker&amp;apos;,
	author	= &amp;apos;Kuukuu&amp;apos;,
	abilities = {
	{	name = &amp;quot;Auto Buffs&amp;quot;,
					tooltip = &amp;quot;Enables Automatic Buffing&amp;quot;,
					enable = true,
				},
				{ 	name = &amp;quot;Auto Target&amp;quot;,
					enable = true,
					tooltip = &amp;quot;If you dont have a target it will target your focus target&amp;quot;,
				},
				{	name = &amp;quot;Fists of Fury&amp;quot;,
					enable = true,
					tooltip = &amp;quot;Enables Fists of Fury&amp;quot;,
				},
				{	name = &amp;quot;Touch of Karma&amp;quot;,
					enable = false,
					tooltip = &amp;quot;Enables Touch of Karma&amp;quot;,
				},
				{ 	name = &amp;quot;Chi Stacker&amp;quot;,
					enable = true,
					tooltip = &amp;quot;Builds Chi out of combat using Expel Harm&amp;quot;,
				},
				{ 	name = &amp;quot;Chi Wave&amp;quot;,
					enable = true,
					tooltip = &amp;quot;Enables use of Chi Wave&amp;quot;,
				},
				{ 	name = &amp;quot;Expel Harm&amp;quot;,
					enable = true,
					tooltip = &amp;quot;Enables use of Expel Harm&amp;quot;,
				},
				{ 	name = &amp;quot;Healthstone&amp;quot;,	
					enable = true,
					tooltip = &amp;quot;Auto use of Healthstone at specific HP percent&amp;quot;,
					widget = { type = &amp;apos;numBox&amp;apos;,
						value = 30,
						step = 5,
						max = 100,
						min = 0,
						tooltip = &amp;quot;The percent of HP to use Healthstone at&amp;quot;,
					},
				},
	},
	hotkeys = {
		{	name = &amp;quot;Area of Effect&amp;quot;,enable = true,	hotkeys = {	&amp;apos;lc&amp;apos; },	},
		{	name = &amp;quot;Pause&amp;quot;,			enable = true,	hotkeys = {	&amp;apos;la&amp;apos;	},	},
		{	name = &amp;quot;SEF&amp;quot;,			enable = true,	hotkeys = {	&amp;apos;ls&amp;apos;	},	},
		{	name = &amp;quot;Tier 5&amp;quot;,		enable = true,	hotkeys = {	 &amp;apos;rs&amp;apos;	},	}, 
		{	name = &amp;quot;Invoke Xuen&amp;quot;,	enable = true,	hotkeys = {	 &amp;apos;rc&amp;apos;	},	}, 
		{	name = &amp;quot;Touch of Karma&amp;quot;,enable = false,	hotkeys = {	 &amp;apos;rc&amp;apos;,&amp;apos;rs&amp;apos;	},	}, 
	
	},
}
Kuukuu_Windwalker = PQI:AddRotation(wwconfig)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Healthstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local PlayerHP = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)

if PQI_KuukuuBrewmaster_Healthstone_enable and PlayerHP &amp;lt; PQI_KuukuuBrewmaster_Healthstone_value
and GetItemCount(5512,false,false) &amp;gt; 0 
	and ( select(2, GetItemCooldown(5512)) == 0 ) then
    	UseItemByName(5512)
    	return true
    end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(BM) Tiger Palm Pre 34</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsSpellKnown(100787)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower (&amp;quot;player&amp;quot;,12) &amp;gt;= 1 then
	if  UnitBuffID (&amp;quot;player&amp;quot;,118636) == nil
		then CastSpellByName(GetSpellInfo(100787))
		return true
	elseif UnitPower (&amp;quot;player&amp;quot;) &amp;lt;= 30
		then CastSpellByName(GetSpellInfo(100787))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Jab</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitLevel(&amp;quot;player&amp;quot;) &amp;gt;= 7 then
	if PQR_SpellAvailable(100780)
	and IsSpellKnown(100780)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40
	and UnitPower (&amp;quot;player&amp;quot;,12) &amp;lt;= 1 then
		CastSpellByName(GetSpellInfo(100780))
		return true
	end
	
else
	if PQR_SpellAvailable(100780)
	and IsSpellKnown(100780)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and UnitPower (&amp;quot;player&amp;quot;) &amp;gt;= 40 then
		CastSpellByName(GetSpellInfo(100780))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Tiger Palm</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsSpellKnown(100787)
and UnitAffectingCombat(&amp;quot;player&amp;quot;)
and UnitPower (&amp;quot;player&amp;quot;,12) &amp;gt;= 1 then
	if UnitBuffID (&amp;quot;player&amp;quot;,125359) == nil
		then CastSpellByName(GetSpellInfo(100787))
		return true
	elseif UnitPower (&amp;quot;player&amp;quot;) &amp;lt;= 30
		then CastSpellByName(GetSpellInfo(100787))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Trinkets</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code by Christopher X

--------------------------------------
--Agi Proc Trinket List (Buff NAMES)-- --If you need to add more, don&amp;apos;t forget the comma after buff name
--------------------------------------
local tBuffs = {
                --Extra
                
				--Heroic Dungeons
                126484, --Flashing Steel
                126489, --Relentlessness
                126483, --Windswept
                --T14 (Mogu, HoF, ToES)
                126554, --Agile
                126599, --Velocity
                126649, --Unrelenting Attacks
                136086, --Archer&amp;apos;s Grace
                --Purchased Trinkets (Valor/Darkmoon ect.)
                105574, --Zen Alchemist Stone
                128984, --Blessing of the Celestials
				138699, --Superluminal
				--ToT Trinkets (RoR not handeled here)
				138938, --Juju Madness
				138756, --Blades of Renataki
				138895, --Frenzy
				139121, --Re-Origination (Haste)
				139120, --Re-Origination (Mastery)
				139117  --Re-Origination (Critical Strike)
}

--------------------------
--Trinket Buff Detection-- --Note: if you call this function, you must set a timer!
--------------------------
    for i=1, #tBuffs do
        if UnitBuff(&amp;quot;player&amp;quot;,tBuffs[i]) then
            TrinketProc, _, _, _, _, _, TrinkTimer = UnitBuff(&amp;quot;player&amp;quot;,tBuffs[i])
        end
    end
    
---------------------
--Auto-use Trinkets--
---------------------
if CombatConditions then
    --Top Trinket Slot
    if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13)==0 then
         RunMacroText(&amp;quot;/use 13&amp;quot;)
    end
    --Bot Trinket Slot
    if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,14)==0 then
        RunMacroText(&amp;quot;/use 14&amp;quot;)
    end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) AoE/Single Target Swap</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not ToggleTimer then ToggleTimer = GetTime() -0.5 end

if GetSpecialization() == 1 then
	if PQI:IsHotkeys(PQI_KuukuuBrewmaster_AreaofEffect_key) and GetTime() - ToggleTimer &amp;gt;= 0.5 then
		ToggleTimer = GetTime()

	  	if AoE  then 
	
    		AoE  = false 
			print(&amp;quot;AoE mode disabled!&amp;quot;)

	  	else 
    		
			AoE  = true 
			print(&amp;quot;AoE mode enabled!&amp;quot;)

  		end	
	end
end

if GetSpecialization() == 3 then
	if PQI:IsHotkeys(PQI_KuukuuWindwalker_AreaofEffect_key) and GetTime() - ToggleTimer &amp;gt;= 0.5 then
		ToggleTimer = GetTime()

	  	if AoE  then 
	
    		AoE  = false 
			print(&amp;quot;AoE mode disabled!&amp;quot;)

	  	else 
    		
			AoE  = true 
			print(&amp;quot;AoE mode enabled!&amp;quot;)

  		end	
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Buffs</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization() == 1 then
	if not busy and PQI_KuukuuBrewmaster_AutoBuffs_enable then
		if GetNumGroupMembers() &amp;gt; 0 then
			if IsInRaid() then
    			 group = &amp;quot;raid&amp;quot; 
    		elseif IsInGroup() then
     			group = &amp;quot;party&amp;quot;
     		end
			for i = 1, GetNumGroupMembers() do
				if not ClassBuffs(1,&amp;quot;player&amp;quot;) then
    				if PQR_SpellAvailable(115921) then
        				CastSpellByName(GetSpellInfo(115921),&amp;quot;player&amp;quot;)
		    		end
				end
			end
		else 
			if not ClassBuffs(1,&amp;quot;player&amp;quot;) then
    			if PQR_SpellAvailable(115921) then
        			CastSpellByName(GetSpellInfo(115921),&amp;quot;player&amp;quot;)
	    		end
			end
		end
	end
end
if GetSpecialization() == 3 then
	if not busy and PQI_KuukuuWindwalker_AutoBuffs_enable then
		if GetNumGroupMembers() &amp;gt; 0 then
			if IsInRaid() then
    		 	group = &amp;quot;raid&amp;quot; 
    		elseif IsInGroup() then
	     		group = &amp;quot;party&amp;quot;
    	 	end
			for i = 1, GetNumGroupMembers() do
				if not ClassBuffs(1,&amp;quot;player&amp;quot;) then
    				if PQR_SpellAvailable(115921) then
        				CastSpellByName(GetSpellInfo(115921),&amp;quot;player&amp;quot;)
		    		end
				end
				if not ClassBuffs(2,&amp;quot;player&amp;quot;) then
    				if PQR_SpellAvailable(116781) then
        				CastSpellByName(GetSpellInfo(116781),&amp;quot;player&amp;quot;)
	    			end
				end
			end
		else 
			if not ClassBuffs(1,&amp;quot;player&amp;quot;) then
    			if PQR_SpellAvailable(115921) then
        			CastSpellByName(GetSpellInfo(115921),&amp;quot;player&amp;quot;)
	    		end
			end
			if not ClassBuffs(2,&amp;quot;player&amp;quot;) then
		    	if PQR_SpellAvailable(116781) then
    		    	CastSpellByName(GetSpellInfo(116781),&amp;quot;player&amp;quot;)
    			end
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Auto Attack</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-----------------------------------
--Auto-Target something to attack--
-----------------------------------
if combat and PQI_KuukuuBrewmaster_AutoTarget_enable then
	if not UnitExists(&amp;quot;target&amp;quot;) or UnitIsDead(&amp;quot;target&amp;quot;)
		then TargetNearestEnemy()
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Chi Stacker</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not busy and PQI_KuukuuWindwalker_ChiStacker_enable then
    if PQR_SpellAvailable(115072) then
        CastSpellByName(GetSpellInfo(115072))
    end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Storm, Earth, Fire</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not ToggleTimer then ToggleTimer = GetTime() end

if PQI:IsHotkeys(PQI_KuukuuWindwalker_SEF_key)
and UnitAffectingCombat(&amp;quot;player&amp;quot;) 
and UnitExists(&amp;quot;mouseover&amp;quot;)then
	if not UnitBuffID(&amp;quot;player&amp;quot;, 137639)
	then	
		CastSpellByName(GetSpellInfo(137639),&amp;quot;mouseover&amp;quot;)
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(All) Tier 5</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetSpecialization() == 1 then
	if  PQI:IsHotkeys(PQI_KuukuuBrewmaster_Tier5_key) then

		if IsSpellKnown(122278)
		and UnitAffectingCombat(&amp;quot;player&amp;quot;)
			then CastSpellByName(GetSpellInfo(122278))
			return true
		end
	
		if IsSpellKnown(122783)
		and UnitAffectingCombat(&amp;quot;player&amp;quot;)
			then CastSpellByName(GetSpellInfo(122783))
			return true
		end
	end
end

if GetSpecialization() == 3 then
	if  PQI:IsHotkeys(PQI_KuukuuWindwalker_Tier5_key) then

		if IsSpellKnown(122278)
		and UnitAffectingCombat(&amp;quot;player&amp;quot;)
			then CastSpellByName(GetSpellInfo(122278))
			return true
		end
	
		if IsSpellKnown(122783)
		and UnitAffectingCombat(&amp;quot;player&amp;quot;)
			then CastSpellByName(GetSpellInfo(122783))
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Test Disable</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if (select(11, UnitDebuff(&amp;quot;target&amp;quot;,GetSpellInfo(116706)))) == 116706
	then return false
else
	CastSpellByName(GetSpellInfo(116095))
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tigereye Brew Test</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code provided by Christopher X
if UnitAffectingCombat(&amp;quot;player&amp;quot;) then
-------------------------
--Tiger&amp;apos;s Brew (NO RoR)--
-------------------------
	if not TigerBrewBuff then
--Excess TB stacks
		if TigerBrew and TigerBrewStacks&amp;gt;=10 and PQR_SpellAvailable(107428) then
			CastSpellByName(GetSpellInfo(116740))
			RunMacroText(&amp;quot;/use 10&amp;quot;)
		end
--Bloodlust
		if Bloodlust and BLTimer - GetTime() &amp;gt; 10 and TigerBrew and TigerBrewStacks&amp;gt;=10 then
			CastSpellByName(GetSpellInfo(116740))
			RunMacroText(&amp;quot;/use 10&amp;quot;)
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Storm, Earth, Fire Test</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code by DiabloFan--
local SEF,_,_,SEFCount = UnitBuffID(&amp;quot;player&amp;quot;,137639)
local SEFFocus = true
SEFMouseover = true

if not SEFTimer then SEFTimer = GetTime() end

if UnitExists(&amp;quot;target&amp;quot;) 
and PQI:IsHotkeys(PQI_KuukuuWindwalker_SEF_key)
and UnitAffectingCombat(&amp;quot;player&amp;quot;) then
    
    --Cancel Pandas on our current target
	for i=1,#Pandas do
       	if UnitGUID(&amp;quot;mouseover&amp;quot;) == Pandas[i]
       	and GetTime() - SEFTimer &amp;gt;= 3 then
		    if PQR_SpellAvailable(137639) then
                CastSpellByName(GetSpellInfo(137639),&amp;quot;mouseover&amp;quot;)
               	return true
           	end
       	end
   	end
    
    if not SEF or SEFCount &amp;lt; 2 then
    
        --Mouseover
        if UnitExists(&amp;quot;mouseover&amp;quot;) then
                for i=1,#Pandas do
                    if UnitGUID(&amp;quot;mouseover&amp;quot;) == Pandas[i] then
                        SEFMouseover = nil
                    end
                end
                
                if SEFMouseover ~= nil then
                    if PQR_SpellAvailable(137639)
                    and IsSpellInRange(GetSpellInfo(137639),&amp;quot;mouseover&amp;quot;) == 1
                    and not UnitIsUnit (&amp;quot;target&amp;quot;, &amp;quot;mouseover&amp;quot;) then
                        CastSpellByName(GetSpellInfo(137639),&amp;quot;mouseover&amp;quot;)
                        SEFTimer = GetTime()
                        return true
                    end
                end
        end
    end
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>(WW) Touch of Karma</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if (IsSpellKnown(122470)) then
	if (PQI_KuukuuWindwalker_TouchofKarma_enable and PQI:IsHotkeys(PQI_KuukuuWindwalker_TouchofKarma_key) and PQR_SpellAvailable (122470) and UnitAffectingCombat(&amp;quot;player&amp;quot;)) then 
		CastSpellByName(GetSpellInfo(122470))
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></MONK>
