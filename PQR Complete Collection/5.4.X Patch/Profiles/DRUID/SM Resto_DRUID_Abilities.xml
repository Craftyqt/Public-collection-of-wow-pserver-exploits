<?xml version="1.0" encoding="utf-8" ?><DRUID><Ability><Name>&amp;gt; Initialize</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>GroupInfo() 
CastClick() 

if IsLeftAltKeyDown() 
or IsMounted()
or SpellIsTargeting()
or UnitBuffID(&amp;quot;player&amp;quot;,80169)
or UnitBuffID(&amp;quot;player&amp;quot;,87959)
or UnitChannelInfo(&amp;quot;player&amp;quot;) 
or UnitIsDeadOrGhost(&amp;quot;player&amp;quot;) 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>&amp;gt; Healing spells</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local InCombat = false
for i=1, #members do if UnitAffectingCombat(members[i].Unit) then InCombat = true end end
if not InCombat and not IsLeftShiftKeyDown() then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Mark of the Wild</Name><Default>false</Default><SpellID>1126</SpellID><Actions></Actions><Lua>if not UnitAffectingCombat(&amp;quot;player&amp;quot;) then
  for i=1,#members do 
    if not HaveBuff(members[i].Unit,{115921,20217,1126,90363}) 
    then return true end
  end
end</Lua><RecastDelay>10000</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rejuvenation</Name><Default>false</Default><SpellID>774</SpellID><Actions></Actions><Lua>if members[1].HP &amp;lt; 95
and not HaveBuff(members[1].Unit,774,0,&amp;quot;PLAYER&amp;quot;) 
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Regrowth</Name><Default>false</Default><SpellID>8936</SpellID><Actions></Actions><Lua>if (members[1].HP &amp;lt; 51
and not PQR_IsMoving()) or (UnitBuffID(&amp;quot;player&amp;quot;, 33891) and UnitBuffID(&amp;quot;player&amp;quot;,16870)
and members[1].HP &amp;lt; 90)
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Lifebloom</Name><Default>false</Default><SpellID>33763</SpellID><Actions></Actions><Lua>if not CheckLifebloom then
  function CheckLifebloom(t)
    local _,_,_,Lbcount,_,_,Lbtimer = UnitBuffID(t,33763,&amp;quot;PLAYER&amp;quot;) 
    return Lbcount, Lbtimer 
  end 
end 

local Lbonmembers, tree = false, UnitBuffID(&amp;quot;player&amp;quot;,33891)
for i = 1, #members do
  if CheckLifebloom(members[i].Unit) then Lbonmembers = true end
end

local castdone = false
for i = 1, #members do
  local Lbcount, Lbtimer = CheckLifebloom(members[i].Unit)
  if castdone then break end
  if ( UnitThreatSituation(members[i].Unit) == 3 or ( UnitGroupRolesAssigned(members[i].Unit) == &amp;quot;TANK&amp;quot; and not Lbonmembers ) or tree ) 
  and ( not Lbonmembers or ( Lbcount and not tree ) or ( not Lbcount and tree ) ) 
  and ( Lbcount ~= 3 or Lbtimer - GetTime() &amp;lt; 5 ) 
  then 
    PQR_CustomTarget = members[i].Unit 
    castdone = true 
    return true 
  end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Swiftmend</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if ( UnitBuffID(members[1].Unit, 774)
	 or UnitBuffID(members[1].Unit, 8936) ) then
	 	if members[1].HP &amp;lt; 86 and GetSpellCooldown(18562) == 0 then
	 		CastSpellByName(GetSpellInfo(18562), members[1].Unit)
	 		return true
	 	end
	end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Innervate</Name><Default>false</Default><SpellID>29166</SpellID><Actions></Actions><Lua>if 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;) &amp;lt; 75 
and UnitAffectingCombat(&amp;quot;player&amp;quot;) 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Nature&amp;apos;s Cure</Name><Default>false</Default><SpellID>88423</SpellID><Actions></Actions><Lua>--buff = { 109325, 104599, 104601, 104600, 103434, 96328, 96325, 96326, 92876, 92877, 92878, 86788 }
local candispel = 1

--for i,v in ipairs(buff) do
-- if UnitDebuffID(members[1].Unit,v) then candispel = nil end
--end

local i = 1
local buff,_,_,count,bufftype,duration = UnitDebuff(members[1].Unit, i)
while buff do
  if bufftype == &amp;quot;Magic&amp;quot;
  or bufftype == &amp;quot;Curse&amp;quot;
  and UnitIsFriend(&amp;quot;player&amp;quot;,members[1].Unit)
  then
  PQR_CustomTarget = members[1].Unit
  return true end
  i = i + 1;
  buff,_,_,count,bufftype,duration = UnitDebuff(members[1].Unit, i)
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Ironbark</Name><Default>false</Default><SpellID>102342</SpellID><Actions></Actions><Lua>if members[1].HP &amp;lt; 30 
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Wild Growth</Name><Default>false</Default><SpellID>48438</SpellID><Actions></Actions><Lua>if group.low &amp;gt; 2 
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>500</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tree of Life</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsLeftShiftKeyDown()
and select(2,GetTalentRowSelectionInfo(4)) == 11
and IsUsableSpell(33891)
and select(2,GetSpellCooldown(33891)) &amp;lt; 2
and not UnitBuffID(&amp;quot;player&amp;quot;, 33891)
then
CastSpellByName(tostring(GetSpellInfo(33891)))
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tranquility</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsRightControlKeyDown()
and IsUsableSpell(740)
and select(2,GetSpellCooldown(740)) &amp;lt; 2
then
CastSpellByName(GetSpellInfo(740))
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Regrowth Clearcast</Name><Default>false</Default><SpellID>8936</SpellID><Actions></Actions><Lua>if members[1].HP &amp;lt; 99
and UnitBuffID(&amp;quot;player&amp;quot;,16870)
and not PQR_IsMoving() 
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>2000</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Barkskin</Name><Default>false</Default><SpellID>22812</SpellID><Actions></Actions><Lua>if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 50 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rejuvenation Moving</Name><Default>false</Default><SpellID>774</SpellID><Actions></Actions><Lua>if members[1].HP &amp;lt; 85 and PQR_IsMoving(1)
and not HaveBuff(members[1].Unit,774,0,&amp;quot;PLAYER&amp;quot;) 
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>500</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Nature&amp;apos;s Cure Mouseover</Name><Default>false</Default><SpellID>88423</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;mouseover&amp;quot;)
   then

local i = 1
local buff,_,_,count,bufftype,duration = UnitDebuff(&amp;quot;mouseover&amp;quot;, i)
while buff do
  if bufftype == &amp;quot;Magic&amp;quot; 
  and UnitIsFriend(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
  then return true end
  i = i + 1;
  buff,_,_,count,bufftype,duration = UnitDebuff(&amp;quot;mouseover&amp;quot;, i)
end

end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Hagara Cure Mouseover</Name><Default>false</Default><SpellID>88423</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;mouseover&amp;quot;)
   then

local i = 1
local buff,_,_,count,bufftype,duration = UnitDebuff(&amp;quot;mouseover&amp;quot;, i)
while buff do
  if bufftype == &amp;quot;Magic&amp;quot; 
  and UnitIsFriend(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
  and UnitDebuffID(&amp;quot;mouseover&amp;quot;,109325)
  and UnitDebuffID(&amp;quot;mouseover&amp;quot;,110317)
  then return true end
  i = i + 1;
  buff,_,_,count,bufftype,duration = UnitDebuff(&amp;quot;mouseover&amp;quot;, i)
end

end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rejuv Swiftmend Spam</Name><Default>false</Default><SpellID>774</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;, 774, &amp;quot;player&amp;quot;) == nil and
GetSpellCooldown(18562) == 0
then
return true
end</Lua><RecastDelay>500</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rebirth</Name><Default>false</Default><SpellID>20484</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;mouseover&amp;quot;) and
   UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;) and
   UnitCanCooperate(&amp;quot;player&amp;quot;, &amp;quot;mouseover&amp;quot;) and
   IsSpellInRange(&amp;quot;Rebirth&amp;quot;, &amp;quot;mouseover&amp;quot;) and 
   GetSpellCooldown(20484) == 0 and
   UnitChannelInfo(&amp;quot;player&amp;quot;) == nil
then
return true
end</Lua><RecastDelay>500</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Trinket 2</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if members[1].HP &amp;lt; 40
and GetInventoryItemCooldown(&amp;quot;player&amp;quot;,14) == 0
then UseInventoryItem(14)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>&amp;gt; Functions</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if SetFunctions == nil then

--------------------------------------------------

function HaveBuff(UnitID,SpellID,TimeLeft,Filter) 
  if not TimeLeft then TimeLeft = 0 end
  if type(SpellID) == &amp;quot;number&amp;quot; then SpellID = { SpellID } end 
  for i=1,#SpellID do 
    local spell, rank = GetSpellInfo(SpellID[i])
    if spell then
      local buff = select(7,UnitBuff(UnitID,spell,rank,Filter)) 
      if buff and ( buff == 0 or buff - GetTime() &amp;gt; TimeLeft ) then return true end
    end
  end
end

--------------------------------------------------

function HaveDebuff(UnitID,SpellID,TimeLeft,Filter) 
  if not TimeLeft then TimeLeft = 0 end
  if type(SpellID) == &amp;quot;number&amp;quot; then SpellID = { SpellID } end 
  for i=1,#SpellID do 
    local spell, rank = GetSpellInfo(SpellID[i])
    if spell then
      local debuff = select(7,UnitDebuff(UnitID,spell,rank,Filter)) 
      if debuff and ( debuff == 0 or debuff - GetTime() &amp;gt; TimeLeft ) then return true end
    end
  end
end

--------------------------------------------------

function CalculateHP(t)
  incomingheals = UnitGetIncomingHeals(t) or 0
  return 100 * ( UnitHealth(t) + incomingheals ) / UnitHealthMax(t)
end

--------------------------------------------------

function CanHeal(t)
  if UnitInRange(t) and UnitCanCooperate(&amp;quot;player&amp;quot;,t) and not UnitIsEnemy(&amp;quot;player&amp;quot;,t) 
  and not UnitIsCharmed(t) and not UnitIsDeadOrGhost(t) and not PQR_IsOutOfSight(t) 
  then return true end 
end

--------------------------------------------------

function GroupInfo()
  members, group = { { Unit = &amp;quot;player&amp;quot;, HP = CalculateHP(&amp;quot;player&amp;quot;) } }, { low = 0, tanks = { } } 
  group.type = IsInRaid() and &amp;quot;raid&amp;quot; or &amp;quot;party&amp;quot; 
  group.number = GetNumGroupMembers()
  for i=1,group.number do if CanHeal(group.type..i) then 
    local unit, hp = group.type..i, CalculateHP(group.type..i) 
    table.insert( members,{ Unit = unit, HP = hp } ) 
    if hp &amp;lt; 90 then group.low = group.low + 1 end 
    if UnitGroupRolesAssigned(unit) == &amp;quot;TANK&amp;quot; then table.insert(group.tanks,unit) end 
  end end 
  if group.type == &amp;quot;raid&amp;quot; and #members &amp;gt; 1 then table.remove(members,1) end 
  table.sort(members, function(x,y) return x.HP &amp;lt; y.HP end)
  local customtarget = CanHeal(&amp;quot;target&amp;quot;) and &amp;quot;target&amp;quot; -- or CanHeal(&amp;quot;mouseover&amp;quot;) and GetMouseFocus() ~= WorldFrame and &amp;quot;mouseover&amp;quot; 
  if customtarget then table.sort(members, function(x) return UnitIsUnit(customtarget,x.Unit) end) end 
end

--------------------------------------------------

function CastClick()
  if IsMouseButtonDown(1) and MainMenuBar:IsShown() then 
    local mousefocus = GetMouseFocus() 
    if mousefocus and mousefocus.feedback_action 
    then SpellCancelQueuedSpell() PQR_DelayRotation(1) end
  end
end

--------------------------------------------------

  SetFunctions = true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Nature&amp;apos;s swiftness</Name><Default>false</Default><SpellID>132158</SpellID><Actions></Actions><Lua>if not UnitBuffID(&amp;quot;player&amp;quot;,132158)
and PQR_SpellAvailable(132158) then
return true
end</Lua><RecastDelay>500</RecastDelay><Target>Click</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healing Touch</Name><Default>false</Default><SpellID>5185</SpellID><Actions></Actions><Lua>if members[1].HP &amp;lt; 76
and not PQR_IsMoving() 
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Regrowth Huehue Edition</Name><Default>false</Default><SpellID>8936</SpellID><Actions></Actions><Lua>if (members[1].HP &amp;lt; 86
and not PQR_IsMoving()) or (UnitBuffID(&amp;quot;player&amp;quot;, 33891) and members[1].HP &amp;lt; 90)
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Healing Touch Clearcast</Name><Default>false</Default><SpellID>5185</SpellID><Actions></Actions><Lua>if members[1].HP &amp;lt; 99
and UnitBuffID(&amp;quot;player&amp;quot;,16870) and not UnitBuffID(&amp;quot;player&amp;quot;, 33891)
and not PQR_IsMoving() 
then
  PQR_CustomTarget = members[1].Unit
  return true
end</Lua><RecastDelay>2000</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>False</SkipUnknown></Ability></DRUID>