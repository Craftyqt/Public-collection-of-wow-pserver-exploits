<?xml version="1.0" encoding="utf-8" ?><PALADIN><Ability><Name>-- Start Fight --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PauseKey
or IsMounted() 
--or SpellIsTargeting()
or UnitInVehicle(&amp;quot;player&amp;quot;)
or UnitIsDead(&amp;quot;target&amp;quot;) 
or UnitIsDead(&amp;quot;player&amp;quot;)
or UnitIsDeadOrGhost(&amp;quot;player&amp;quot;) 
or UnitIsFriend(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) 
or not UnitAffectingCombat(&amp;quot;player&amp;quot;)
or not UnitExists(&amp;quot;target&amp;quot;) 
then
	return true
end

maxMSinterrupt =(math.random(20,65)/100)
minMSinterrupt = 0.3  
channelInterrupt = (math.random(20,100)/10)</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Cooldowns</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if burstKey then
   -- King
    if PQR_SpellAvailable(86698) then 
    CastSpellByName(tostring(GetSpellInfo(86698))) 
	end

	--Trinkets
	if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13) == 0 then 
			UseInventoryItem(13) 
	end
	
	-- Holy avnger
	if PQR_SpellAvailable(105809) then
		CastSpellByName(tostring(GetSpellInfo(105809)))  
	end
	
	--AV
	if PQR_SpellAvailable(31884) then 
	CastSpellByName(tostring(GetSpellInfo(31884)))  
	end
	
	--Execution Sentence
	if PQR_SpellAvailable(114157) then
	CastSpellByName(tostring(GetSpellInfo(114157)))   
	end
	
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--- Init ---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- PQInterface is an absolute requirement from now on.
--if not IsAddOnLoaded(&amp;quot;PQInterface&amp;quot;) then
--	PQR_WriteToChat(&amp;quot;|cffDC143CPQInterface is required to run this profile!|cffffffff&amp;quot;, &amp;quot;Warning&amp;quot;)
--	PQR_WriteToChat(&amp;quot;|cffDC143CThe profile has been stopped.|cffffffff&amp;quot;, &amp;quot;Warning&amp;quot;)
--	PQR_StopRotation()
--end
 

-- Load LUA data files.
if PQR_RotationStarted then
PlaySoundFile(&amp;quot;Sound\\\\Creature\\\\Ashbringer\\\\ASH_SPEAK_12.wav&amp;quot;)
	PQR_RotationStarted = false
	StatusReport = true
	
	-- Load required data files
	if PQR_LoadLua ~= nil then
		if PQR_LoadLua(&amp;quot;PQR_Pally_pvp.lua&amp;quot;) == false then
			PQR_WriteToChat(&amp;quot;|cffb73737You&amp;apos;re missing PQR_PallyPvP.lua - Make sure it&amp;apos;s in your Data folder! The Rotation has been halted.|cffffffff&amp;quot;, &amp;quot;Error&amp;quot;)
			PQR_StopRotation()
			return true
		end
		if PQR_LoadLua(&amp;quot;PQR_PQI.lua&amp;quot;) == false then
			PQR_WriteToChat(&amp;quot;|cffb73737You&amp;apos;re missing PQR_PQI.lua - It&amp;apos;s required to run the profile! The Rotation has been halted.|cffffffff&amp;quot;, &amp;quot;Error&amp;quot;)
			PQR_StopRotation()
			return true
		end
	end
end
--Checks--
 HA = PQR_UnitBuffID(&amp;quot;player&amp;quot;, 105809)                                            -- Holy Avenger
 HP = UnitPower(&amp;quot;player&amp;quot;, 9)                                                      -- Holy Power
 myMana = 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;)
 myHp = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)                      -- Player Hp
 EnemyHP = 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)                   -- Target Hp
 jdg = PQR_SpellAvailable(20271)                                                  --Judge
 HordeFlag = UnitBuffID(&amp;quot;player&amp;quot;, 23333)                                          -- Check flag
 exo = PQR_SpellAvailable(879)                                                    -- Exorsism
 CS = PQR_SpellAvailable(35395)
 sh = select(4, UnitAura(&amp;quot;player&amp;quot;, &amp;quot;Selfless Healer&amp;quot;))                            -- Selfless Healer
 KStack = select(4, UnitBuffID(&amp;quot;player&amp;quot;, 86700))

-- OPTIONS -- 
DSV = PQI_SigRet_DivineShield_value --Divine shield
DSE = PQI_SigRet_DivineShield_enable --Divine shield
DPV = PQI_SigRet_DivineProtection_value --Divine Protection
DPE = PQI_SigRet_DivineProtection_enable --Divine Protection
HEALPV = PQI_SigRet_HealSelf_value -- Heal player value
HEALPE = PQI_SigRet_HealSelf_enable -- Heal Player enable
HEALOV = PQI_SigRet_HealOther_value --Heal others value
HEALOE = PQI_SigRet_HealOther_enable --Heal others enable
AutoFreedom = PQI_SigRet_AutoFreedom_enable
AutoStunE = PQI_SigRet_AutoStun_enable
AutoStunV = PQI_SigRet_AutoStun_value
AutoSacE = PQI_SigRet_AutoSac_enable
AutoBuffE = PQI_SigRet_AutoBuff_enable
AutoBlindE = PQI_SigRet_AutoBlind_enable
AutoBlindV = PQI_SigRet_AutoBlind_value
AutoBoP   =  PQI_SigRet_AutoBoP_enable
BopHp     =  PQI_SigRet_AutoBoP_value

GroupInfo() 

--Keybinds
FolKey              = PQI:IsHotkeys(PQI_SigRet_FolKey_key) 
DefenciveKey		= PQI:IsHotkeys(PQI_SigRet_BlindingLightkey_key)  
PauseKey        	= PQI:IsHotkeys(PQI_SigRet_Pause_key)
StunKey             = PQI:IsHotkeys(PQI_SigRet_StunKey_key)
FearKey             = PQI:IsHotkeys(PQI_SigRet_FearKey_key)
AoeKey              = PQI:IsHotkeys(PQI_SigRet_AoeKey_key)

if not PQI_SigRet_BurstKey_enable then 
	burstKey				= IsMouseButtonDown(3)
else 
 	burstKey				= PQI:IsHotkeys(PQI_SigRet_BurstKey_key)
end
if not PQI_SigRet_FolKey_enable then 
	FolKey 				= IsMouseButtonDown(4)
else 
 	FolKey 				= PQI:IsHotkeys(PQI_SigRet_FolKey_key)
end
if not PQI_SigRet_StunKey_enable then 
	StunKey			= IsMouseButtonDown(5)
else 
 	StunKey			= PQI:IsHotkeys(PQI_SigRet_StunKey_key)
end


if not PQI_SigRet_Pause_enable then 
	PauseKey = false
end
if not PQI_SigRet_BlindingLightkey_enable then 
	DefenciveKey = false 
end


if PauseKey
or IsMounted() then
	return true
end

--if UnitIsDeadOrGhost(&amp;quot;player&amp;quot;) 
--and deadcheck ~= 1
--then
--deadcheck = 1
--end

--if not UnitIsDeadOrGhost(&amp;quot;player&amp;quot;) 
--and deadcheck == 1
--then
--deadcheck = 0
--PlaySoundFile(&amp;quot;Sound\\\\Creature\\\\Witch Doctor\\\\Witchdoctorready1.ogg&amp;quot;)
--end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Divine Shield</Name><Default>false</Default><SpellID>642</SpellID><Actions></Actions><Lua>if DSE then
if myHp &amp;lt; DSV and (HordeFlag == nil or UnitBuffID(&amp;quot;player&amp;quot;, 23335) == nil) then
	return true
end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Key:Blinding Light</Name><Default>false</Default><SpellID>115750</SpellID><Actions></Actions><Lua>if DefenciveKey then
return true
end

if AutoBlindE 
and PQR_SpellAvailable(115750)
then
if UnitExists(&amp;quot;focus&amp;quot;) 
and CheckInteractDistance(&amp;quot;focus&amp;quot;,3)
and EnemyHP &amp;lt; AutoBlindV
and not UnitIsUnit(&amp;quot;focus&amp;quot;,&amp;quot;target&amp;quot;)
and not HaveDebuff(&amp;quot;focus&amp;quot;,cccheck(),0)
and not HaveBuff(&amp;quot;focus&amp;quot;,iDMG(),0) 
then
CastSpellByName(tostring(GetSpellInfo(115750))) 
end
for j=1 , #cTar do
if UnitExists(cTar[j])	
and CheckInteractDistance(cTar[j],3)
and EnemyHP &amp;lt;= AutoBlindV
and UnitCanAttack(&amp;quot;player&amp;quot;,cTar[j]) 
and not UnitExists(&amp;quot;focus&amp;quot;)
and UnitIsPlayer(cTar[j])
and not UnitIsUnit(cTar[j],&amp;quot;target&amp;quot;)
and not HaveDebuff(cTar[j],cccheck(),0)
and not HaveBuff(cTar[j],iDMG(),0) 
then
CastSpellByName(tostring(GetSpellInfo(115750))) 
end
end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Buff</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local hasSeal = false
if GetShapeshiftForm() ~= 0 then hasSeal = true else hasSeal = false end



if hasSeal == false then
CastShapeshiftForm(1)
end


-- buff
if AutoBuffE 
and not UnitAffectingCombat(&amp;quot;player&amp;quot;) then

if not HaveBuff(&amp;quot;player&amp;quot;,{115921,20217,1126,90363}) then 
		CastSpellByName(GetSpellInfo(20217), &amp;quot;player&amp;quot;)
elseif HaveBuff(&amp;quot;player&amp;quot;,{115921,1126,90363}) then
  if not HaveBuff(&amp;quot;player&amp;quot;,{116956,19740}) then 
    		CastSpellByName(GetSpellInfo(19740), &amp;quot;player&amp;quot;) 
    	end
    end
 end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Cleanse</Name><Default>false</Default><SpellID>4987</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(4987) then
	for i=1, #members do
		if Dpoisons(members[i].Unit) then
			PQR_CustomTarget = members[i].Unit
			return true
		end	
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Crusader Strike</Name><Default>false</Default><SpellID>35395</SpellID><Actions></Actions><Lua>local SI = 35395
if AoeKey then
SI = 53595
end

--If Holy Avenger is up
if HA ~= nil and HP &amp;lt;= 2 and CS == true 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change
then
_castSpell(SI, &amp;quot;target&amp;quot;)
end


--if its not up.
if HA == nil and HP &amp;lt; 5 and CS == true 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) -- change
then
_castSpell(SI, &amp;quot;target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Divine Protection</Name><Default>false</Default><SpellID>498</SpellID><Actions></Actions><Lua>if DPE then
if PQR_SpellAvailable(498)
and HaveDebuff(&amp;quot;player&amp;quot;,44572) or myHp &amp;lt; DPV then 
return true
end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Remove Root(I)</Name><Default>false</Default><SpellID>121783</SpellID><Actions></Actions><Lua>if (hasRoot(&amp;quot;player&amp;quot;) ~= nil or isSlowed(&amp;quot;player&amp;quot;)~= nil)
and myMana &amp;gt; 20 
and not inMelee()
then
return true
end</Lua><RecastDelay>1000</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Exorcism</Name><Default>false</Default><SpellID>879</SpellID><Actions></Actions><Lua>-- If holy Avenger is up
if HA ~= nil and HP &amp;lt;= 2 and exo or not inMelee() 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change  
then
_castSpell(879, &amp;quot;target&amp;quot;)
end

-- If its not up
if HA == nil and HP &amp;lt; 5 and exo or not inMelee() 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change 
then
_castSpell(879, &amp;quot;target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Key: Flash of Light</Name><Default>false</Default><SpellID>19750</SpellID><Actions></Actions><Lua>if FolKey and UnitIsFriend(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) then
return true
elseif FolKey and UnitIsEnemy(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) then
CastSpellByName(GetSpellInfo(19750), &amp;quot;player&amp;quot;)
return false
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Flash of Light Selfless Outhealer</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if HEALPE then
if myHp &amp;lt; HEALPV
and sh == 3 then
    CastSpellByName(GetSpellInfo(19750), &amp;quot;player&amp;quot;)
end
end

if HEALOE then
if PQR_SpellAvailable(19750) then
	for i=1, #members do
		if UnitDebuffID(members[i].Unit, 33786) then
			return false
		end
		
		if members[i].HP &amp;lt; HEALOV
		and IsLineOfSight(members[i].Unit, 1)
		and not UnitIsEnemy(members[i].Unit, &amp;quot;player&amp;quot;)
		and sh == 3 then
		_castSpell(19750, members[i].Unit)
		end
	end
end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto HoF</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if hasRoot(&amp;quot;player&amp;quot;) ~= nil or isSlowed(&amp;quot;player&amp;quot;)~= nil
and PQR_SpellAvailable(1044)
and not inMelee()
and not HaveBuff(&amp;quot;player&amp;quot;,1022) then 
CastSpellByID(1044, &amp;quot;player&amp;quot;)
end

if AutoFreedom then
	if PQR_SpellAvailable(1044) then
		for i=1, #members do
		local class = select(2, UnitClass(members[i].Unit))
 			if hasRoot(members[i].Unit) ~= nil or isSlowed(members[i].Unit)~= nil
 			and IsLineOfSight(members[i].Unit, 1)
 			and not HaveBuff(members[i].Unit,1022)
 			and not (class==&amp;quot;MAGE&amp;quot; or class==&amp;quot;DRUID&amp;quot; or class==&amp;quot;WARLOCK&amp;quot;)
 			and not HaveBuff(&amp;quot;player&amp;quot;,1044) 
			then
				_castSpell(1044, members[i].Unit)
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Hammer of Wrath</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--if not PQR_UnitFacing(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) then
--	return false
--end

if UnitBuffID(&amp;quot;player&amp;quot;, 31884) or EnemyHP &amp;lt;= 20 then
	if HP &amp;lt; 5 or not inMelee() 
	and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change  
	then
	CastSpellByName(GetSpellInfo(24275), &amp;quot;target&amp;quot;)
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Holy Prism</Name><Default>false</Default><SpellID>114165</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(114165) == false or UnitBuffID(&amp;quot;player&amp;quot;, 84963) == nil then
return false
end

if PQR_SpellAvailable(114165) and UnitBuffID(&amp;quot;player&amp;quot;, 84963) ~= nil 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change
then
_castSpell(114165, &amp;quot;target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Inquisition</Name><Default>false</Default><SpellID>84963</SpellID><Actions></Actions><Lua>local holyPower = UnitPower(&amp;quot;player&amp;quot;, 9)
local inquisition, _, _, _, _, _, inquisitionEndTime = PQR_UnitBuffID(&amp;quot;player&amp;quot;, 84963)


if inquisition ~= nil then
	inquisitionEndTime = inquisitionEndTime - GetTime()
end

if inquisition == nil or inquisitionEndTime &amp;lt;= 4 then
	if holyPower &amp;gt;= 3 then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Judgment</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--if Holy Avenger is up
if HA ~= nil and HP &amp;lt;= 2 and jdg == true or not inMelee() 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change 
then
_castSpell(20271, &amp;quot;target&amp;quot;)
end

-- If its not up
if HA == nil and HP &amp;lt; 5 and jdg == true or not inMelee() 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change
then
_castSpell(20271, &amp;quot;target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Templars Verdict</Name><Default>false</Default><SpellID>85256</SpellID><Actions></Actions><Lua>local SI2 = 85256
if AoeKey then
SI2 = 53385
end

if HP &amp;gt;= 3 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change
then
--castSpell(SI2, &amp;quot;target&amp;quot;)
CastSpellByName(GetSpellInfo(SI2), &amp;quot;target&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto WoG</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if HEALPE then
if myHp &amp;lt; HEALPV 
and HP &amp;gt;= 3 then
    CastSpellByName(GetSpellInfo(85673), &amp;quot;player&amp;quot;)
end
end

if HEALOE then
if PQR_SpellAvailable(85673) then
	for i=1, #members do
		if UnitDebuffID(members[i].Unit, 33786) then
			return false
		end

		if members[i].HP &amp;lt; HEALOV 
		and not UnitIsEnemy(members[i].Unit, &amp;quot;player&amp;quot;)
		and IsLineOfSight(members[i].Unit, 1)
		and HP &amp;gt;= 3 then
		_castSpell(85673, members[i].Unit)
		end
	end
end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Key:Stun</Name><Default>false</Default><SpellID>853</SpellID><Actions></Actions><Lua>if StunKey 
and PQR_SpellAvailable(853) 
then

if UnitExists(&amp;quot;focus&amp;quot;) 
and not HaveDebuff(&amp;quot;focus&amp;quot;,cccheck(),0)
and not HaveBuff(&amp;quot;focus&amp;quot;,iDMG(),0) 
then
_castSpell(853, &amp;quot;Focus&amp;quot;)
end

if UnitExists(&amp;quot;target&amp;quot;)
and not UnitExists(&amp;quot;focus&amp;quot;) 
and not HaveDebuff(&amp;quot;target&amp;quot;,cccheck(),0)
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) 
then
_castSpell(853, &amp;quot;target&amp;quot;)
end
end


if AutoStunE 
and PQR_SpellAvailable(853) 
then
if  UnitExists(&amp;quot;focus&amp;quot;) 
	 and not UnitIsDeadOrGhost(&amp;quot;focus&amp;quot;) 
	 and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;focus&amp;quot;) 
	 and UnitIsPlayer(&amp;quot;focus&amp;quot;)
	 and EnemyHP &amp;lt; AutoStunV
	 and not HaveDebuff(&amp;quot;focus&amp;quot;,cccheck(),0)
	 and not HaveBuff(&amp;quot;focus&amp;quot;,iDMG(),0) 
	 then
	_castSpell(853, &amp;quot;Focus&amp;quot;)
	end
	
	for j=1 , #cTar do
	 if  UnitExists(cTar[j])
	 and EnemyHP &amp;lt;= AutoStunV
	 and not UnitIsDeadOrGhost(cTar[j]) 
	 and not UnitExists(&amp;quot;focus&amp;quot;)
	 and UnitIsPlayer(cTar[j])
	 and not UnitIsUnit(cTar[j],&amp;quot;target&amp;quot;)
	 and not HaveDebuff(cTar[j],cccheck(),0)
     and not HaveBuff(cTar[j],iDMG(),0) 
     then
     _castSpell(853, cTar[j])
     end
     end
	
end</Lua><RecastDelay>0</RecastDelay><Target>Focus</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Interupt</Name><Default>false</Default><SpellID>96231</SpellID><Actions></Actions><Lua>for i=1, #cTar do
	if UnitExists(cTar[i]) then
			local spellName, _, _, _, _, endCast, _, _,canInterrupt = UnitCastingInfo(cTar[i])
			for _, v in ipairs(castInt()) do
				if GetSpellInfo(v) == spellName and canInterrupt == false then
					if ((endCast/1000) - GetTime()) &amp;lt; maxMSinterrupt  
					and ((endCast/1000) - GetTime()) &amp;gt; minMSinterrupt  
					then
						PQR_CustomTarget = cTar[i]
						if select(2,GetSpellCooldown(96231)) == 0
							and rangeCheck(96231,cTar[i])
							then
							CastSpellByName(GetSpellInfo(96231),PQR_CustomTarget)
							PQR_DelayRotation(.5)
							return true
						end
						if ( select(2,GetSpellCooldown(96231)) ~= 0
							or IsSpellInRange(GetSpellInfo(96231),PQR_CustomTarget) == 0)
							and select(2,GetSpellCooldown(28730)) == 0
							and CheckInteractDistance(PQR_CustomTarget,3)
								then
								CastSpellByName(GetSpellInfo(28730),PQR_CustomTarget)
								PQR_DelayRotation(.5)
								return true
								
						end
					end
				end
			end
	
	

---------------------------------------------





	
			local spellName, _, _, _, startTime, endCast, _, canInterrupt = UnitChannelInfo(cTar[i])
			for _, v in ipairs(channelInt()) do
				if GetSpellInfo(v) == spellName and canInterrupt == false then
					if ((endCast/1000) - GetTime()) &amp;lt; channelInterrupt  
					then
						PQR_CustomTarget = cTar[i]
						if select(2,GetSpellCooldown(96231)) == 0
							and rangeCheck(96231,cTar[i])
							then
							CastSpellByName(GetSpellInfo(96231),PQR_CustomTarget)
							PQR_DelayRotation(.5)
							return true
						end
						if ( select(2,GetSpellCooldown(96231)) ~= 0
							or IsSpellInRange(GetSpellInfo(96231),PQR_CustomTarget) == 0)
							and select(2,GetSpellCooldown(28730)) == 0
							and CheckInteractDistance(PQR_CustomTarget,3)
								then
								CastSpellByName(GetSpellInfo(28730),PQR_CustomTarget)
								PQR_DelayRotation(.5)
								return true
						end
					end
				end
			end
		end
	end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto Sac</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AutoSacE then
	if PQR_SpellAvailable(6940) then
		for i=1, #members do
		    if dispellableCC(members[i].Unit) == true 
		    and IsLineOfSight(members[i].Unit, 1)
 			then
				_castSpell(6940, members[i].Unit)
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto BoP</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if AutoBoP then

if PQR_SpellAvailable(1022) then
for i=1, #members do
local class = select(2, UnitClass(members[i].Unit))
if members[i].HP &amp;lt; BopHp
and IsLineOfSight(members[i].Unit, 1)
and not (class==&amp;quot;PALADIN&amp;quot;)
and not HaveBuff(members[i].Unit,iDMG(),0)
and not HaveDebuff(members[i].Unit,25771)
and not UnitBuffID(members[i].Unit, 23333)
and (IsHealer(members[i].Unit) or (class==&amp;quot;MAGE&amp;quot;) or (class==&amp;quot;PRIEST&amp;quot;) or (class==&amp;quot;WARLOCK&amp;quot;))
then
_castSpell(1022, members[i].Unit)
end
end
end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Auto HealthStone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if myHp &amp;lt; 50
and GetItemCount(5512,false,false) &amp;gt; 0 
and ( select(2, GetItemCooldown(5512)) == 0 ) then
    UseItemByName(5512)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Execution Sentence</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(114157) 
and cdRemains(31884) &amp;gt; 50 
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) --change 
then 
		_castSpell(114157, &amp;quot;target&amp;quot;)
	end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Key: Fear</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if FearKey then
if UnitExists(&amp;quot;focus&amp;quot;) 
and not HaveDebuff(&amp;quot;focus&amp;quot;,cccheck(),0)
and not HaveBuff(&amp;quot;focus&amp;quot;,iDMG(),0) 
then
CastSpellByName(GetSpellInfo(10326), &amp;quot;focus&amp;quot;)
--_castSpell(10326, &amp;quot;Focus&amp;quot;)
end

if UnitExists(&amp;quot;target&amp;quot;)
and not UnitExists(&amp;quot;focus&amp;quot;) 
and not HaveDebuff(&amp;quot;target&amp;quot;,cccheck(),0)
and not HaveBuff(&amp;quot;target&amp;quot;,iDMG(),0) 
then
CastSpellByName(GetSpellInfo(10326), &amp;quot;target&amp;quot;)
--_castSpell(10326, &amp;quot;target&amp;quot;)
end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></PALADIN>