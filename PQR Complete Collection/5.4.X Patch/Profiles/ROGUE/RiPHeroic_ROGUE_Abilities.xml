<?xml version="1.0" encoding="utf-8" ?><ROGUE><Ability><Name>Preparation</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local start, duration, enabled = GetSpellCooldown(1856)
local vanishCD = duration + start - GetTime()

if  vanishCD &amp;gt; 60 and vanishCD &amp;lt; 118 and PQR_SpellAvailable(14185) then
	CastSpellByName(tostring(GetSpellInfo(14185)),&amp;quot;Player&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Trinket</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,trinketcd,trinkethasuse = GetInventoryItemCooldown(&amp;quot;player&amp;quot;,14)

if trinketcd == 0 and trinkethasuse == 1 and not UnitChannelInfo(&amp;quot;player&amp;quot;) 
then UseInventoryItem(14) return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Feint</Name><Default>false</Default><SpellID>1966</SpellID><Actions></Actions><Lua>local FeintUP = Buff_Check( 1966, &amp;quot;player&amp;quot; )

if nv_feint and not FeintUP then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Recuperate</Name><Default>false</Default><SpellID>73651</SpellID><Actions></Actions><Lua>if nv_feint and UnitBuffID(&amp;quot;player&amp;quot;,73651) == nil
and 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 50
and GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) &amp;gt; 0
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Stealth</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Stealth = UnitBuffID(&amp;quot;Player&amp;quot;,1784)
local StealthCD = PQR_SpellAvailable(1784)

if not IsMounted()
and PQR_IsCastingSpell()
and not SpellIsTargeting()
and not UnitBuffID(&amp;quot;Player&amp;quot;,80169)
and not UnitBuffID(&amp;quot;Player&amp;quot;,87959)
and not UnitIsDeadOrGhost(&amp;quot;Player&amp;quot;)
and not UnitAffectingCombat(&amp;quot;Player&amp;quot;)then
if not Stealth and StealthCD and PQI_RipHeroic_Stealth_enable then
   CastSpellByName(tostring(GetSpellInfo(1784)),&amp;quot;Player&amp;quot;) 
end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Expose Armor</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PQI_RipHeroic_ExposeArmor_enable then
--Misc
	local hasTarget = UnitExists(&amp;quot;Target&amp;quot;)
	local Enemy = UnitCanAttack(&amp;quot;Player&amp;quot;,&amp;quot;Target&amp;quot;)
	local isDead = UnitIsDead(&amp;quot;Target&amp;quot;)
	local waBuff = select(4,UnitDebuffID(&amp;quot;Target&amp;quot;,113746))

		if hasTarget and Enemy and not isDead then	
			if not waBuff or waBuff &amp;lt; 3 then
				CastSpellByName(tostring(GetSpellInfo(8647)))
			end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and SafeToCastCD() then
	UseItem(10)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Marked for Death</Name><Default>false</Default><SpellID>137619</SpellID><Actions></Actions><Lua>if PQR_SpellAvailable(137619) and IsUsableSpell(137619) then
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tempest</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Temp, TempTimeLeft 	= Debuff_Check( 122233, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )


if not Temp and CPs &amp;gt; 4 and nv_multi then

	CastSpellByName( GetSpellInfo(121411), nil )
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Fan</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if nv_multi and GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 5 then

	CastSpellByName( GetSpellInfo(51723), nil )
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Eviscerate</Name><Default>false</Default><SpellID>2098</SpellID><Actions></Actions><Lua>if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;gt; 4 then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>SnD</Name><Default>false</Default><SpellID>5171</SpellID><Actions></Actions><Lua>if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;gt; 4 then

	if UnitBuffID( &amp;quot;player&amp;quot;, 5171 ) == nil then
	
		return true
		
	elseif select(7, UnitBuffID( &amp;quot;player&amp;quot;, 5171 ) ) - GetTime() &amp;lt; 4 then
	
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Vanish</Name><Default>false</Default><SpellID>1856</SpellID><Actions></Actions><Lua>if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and not nv_multi and not PQR_SpellAvailable(51713) then

	if  GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 2 and not UnitDebuffID( &amp;quot;target&amp;quot;, 91021, &amp;quot;PLAYER&amp;quot; ) 
	    and not ( UnitBuffID( &amp;quot;player&amp;quot;, 115191 ) or UnitBuffID( &amp;quot;player&amp;quot;, 115193 ) ) 
	    and not UnitBuffID( &amp;quot;player&amp;quot;, 51713 ) 
	    then
	
		if UnitPower( &amp;quot;player&amp;quot; ) &amp;gt; 59 then

					return true

		end

	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tricks of the Trade</Name><Default>false</Default><SpellID>57934</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
if UnitExists(&amp;quot;focus&amp;quot;) and UnitInParty(&amp;quot;focus&amp;quot;) and not UnitIsDead(&amp;quot;focus&amp;quot;) and not PQR_IsOutOfSight(&amp;quot;focus&amp;quot;, 1) and Rup and RupTimeLeft &amp;gt; 3 then

	PQR_CustomTarget = &amp;quot;focus&amp;quot;
	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Start</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Shadowstep 		= Buff_Check( 36554, &amp;quot;player&amp;quot; )
if UnitIsDead(&amp;quot;target&amp;quot;)
or not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)
or UnitBuffID(&amp;quot;target&amp;quot;, 143593)
or ( (not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not Shadowstep) and not UnitIsPlayer(&amp;quot;target&amp;quot;) and not Buff_Check( 115193, &amp;quot;player&amp;quot; ))
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Shadow Dance</Name><Default>false</Default><SpellID>51713</SpellID><Actions>/use 10</Actions><Lua>if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and not UnitBuffID( &amp;quot;player&amp;quot;, 121471 ) then

	if  GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 3 and not UnitDebuffID( &amp;quot;target&amp;quot;, 91021, &amp;quot;PLAYER&amp;quot; ) and not ( UnitBuffID( &amp;quot;player&amp;quot;, 115191 ) or UnitBuffID( &amp;quot;player&amp;quot;, 115193 ) ) then
	
		if UnitPower( &amp;quot;player&amp;quot; ) &amp;gt; 74 then

			return true		
		
		end

	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Shadow Blades</Name><Default>false</Default><SpellID>121471</SpellID><Actions>/use 10</Actions><Lua>if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and UnitBuffID( &amp;quot;player&amp;quot;, 51713 ) then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rupture</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>local Garrote = Debuff_Check( 703, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )


if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;gt; 4 and not nv_multi and not Garrote then

		if UnitDebuffID( &amp;quot;target&amp;quot;, 1943, &amp;quot;PLAYER&amp;quot; ) == nil then
	
			return true
		
		elseif select(7,  UnitDebuffID( &amp;quot;target&amp;quot;, 1943, &amp;quot;PLAYER&amp;quot; ) ) - GetTime() &amp;lt; 3 then
	
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Premeditation</Name><Default>false</Default><SpellID>14183</SpellID><Actions></Actions><Lua>if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 5 and UnitBuffID( &amp;quot;player&amp;quot;, 51713 ) or UnitBuffID( &amp;quot;player&amp;quot;, 115193 ) or UnitBuffID( &amp;quot;player&amp;quot;, 115191 ) then
		CastSpellByName(tostring(GetSpellInfo(14183)),&amp;quot;Player&amp;quot;) 
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Loading</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not PQR_LoadLua(&amp;quot;PQR_PQI.lua&amp;quot;) then
	PQR_WriteToChat(&amp;quot;PQR_PQI.lua is missing. Rotation has been stopped.&amp;quot;, &amp;quot;Error&amp;quot;)
  	PQR_StopRotation()
  	return true
end

	
if PQR_RotationStarted then
	CD_Off = &amp;quot;Off&amp;quot;
	CD_BossOnly = &amp;quot;Boss&amp;quot;
	CD_On = &amp;quot;On&amp;quot;
	nv_CDs = CD_BossOnly
 	nv_multi = false
 	nv_feint = false
	nv_shs	= false
 	combopoints = 0
	
	local nv_binds = {
		pause     = &amp;quot;LeftShift&amp;quot;,
		cooldowns = &amp;quot;RightControl&amp;quot;,
 		feint 	  = &amp;quot;LeftAlt&amp;quot;,
 		aoe 	  = &amp;quot;RightShift&amp;quot;,
		shs		  = &amp;quot;LeftControl&amp;quot;,
	}

	IsPauseBind = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;pause&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
	IsCDsBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;cooldowns&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsFeintBind = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;feint&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsAoEBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;aoe&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsShSBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;shs&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
	

	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	end
	if nv_multi then
		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	end
	if nv_feint then
		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	end
		if nv_shs then
		PQR_WriteToChat(&amp;quot;ShS: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;ShS: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
	end
	
		
	
	 
	function EventHandler(self, event, ...)

		 
		if event == &amp;quot;UNIT_COMBO_POINTS&amp;quot; then
			combopoints = GetComboPoints(&amp;quot;player&amp;quot;)
		end

		 
		if event == &amp;quot;PLAYER_REGEN_ENABLED&amp;quot; then
			if UnitBuffID(&amp;quot;player&amp;quot;, 1856) then return end
			print(&amp;quot;\124cFF15E61CYou are Stealthed&amp;quot;);
			restealth = GetTime()
		end

		if event == &amp;quot;PLAYER_TARGET_CHANGED&amp;quot; or event == &amp;quot;PLAYER_REGEN_ENABLED&amp;quot; then
			if UnitBuffID(&amp;quot;player&amp;quot;, 1856) then return end
			
			
			if UnitIsUnit(&amp;quot;target&amp;quot;, &amp;quot;focus&amp;quot;) then return end
			 
			local s, _, _, _, _, _, sexpire = UnitBuffID(&amp;quot;player&amp;quot;, 73651)
			sexpire = (sexpire ~= nil) and sexpire or 0
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (sexpire - GetTime()) &amp;lt; 6 and (UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)) &amp;lt; 1 then
				CastSpellByID(73651)
				return
			end
			local r, _, _, _, _, _, rexpire = UnitBuffID(&amp;quot;player&amp;quot;, 5171)
			rexpire = (rexpire ~= nil) and rexpire or 0
		  
		  
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (rexpire - GetTime()) &amp;lt; 3 then
				CastSpellByID(5171)
				return
			end
		end
	end
  
	if not OurFrame then

 
	frame = CreateFrame(&amp;quot;FRAME&amp;quot;, &amp;quot;OurFrame&amp;quot;)
	frame:RegisterEvent(&amp;quot;UNIT_COMBO_POINTS&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_REGEN_ENABLED&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_TARGET_CHANGED&amp;quot;)
	frame:SetScript(&amp;quot;OnEvent&amp;quot;, EventHandler)

	print(&amp;quot;\124cFF15E61CGood Game with Neyia ViP Ultimate Rogue PvE&amp;quot;)

	end
	
	PQR_RotationStarted = false

end

 
if UnitBuffID(&amp;quot;player&amp;quot;, 1784)
   or UnitBuffID(&amp;quot;player&amp;quot;, 11327)
   or UnitIsDeadOrGhost(&amp;quot;Player&amp;quot;)
   or UnitAffectingCombat(&amp;quot;player&amp;quot;)
   or IsMounted()
   or UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil
then 
	restealth = false
end

 
if UnitAffectingCombat(&amp;quot;player&amp;quot;) and not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) and not UnitExists(&amp;quot;boss1&amp;quot;) then
	TargetNearestEnemy()
end


 -- Tortos - Quake Stomp 
        if BossID == 67977 then 
            if castName == &amp;quot;Quake Stomp&amp;quot; 
             and not UnitBuffID(&amp;quot;player&amp;quot;, 1966) then 
                CastSpellByName(tostring(GetSpellInfo(1966)),&amp;quot;Player&amp;quot;) 
            end 
        end 



if IsPauseBind() or IsMounted() or UnitBuffID(&amp;quot;target&amp;quot;, 143593) then

	return true 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Hemorrhage</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not UnitBuffID( &amp;quot;player&amp;quot;, 115191 ) and not UnitBuffID( &amp;quot;player&amp;quot;, 31665 ) and not UnitBuffID( &amp;quot;player&amp;quot;, 51713 ) then

	if  GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 5  then
	
		if UnitDebuffID( &amp;quot;target&amp;quot;, 89775 ) == nil then
		
			CastSpellByName( GetSpellInfo(16511), nil )	
			return true
			
		end
	
	end
	
	if ( PQR_UnitFacing(&amp;quot;target&amp;quot;, &amp;quot;player&amp;quot;) or PQR_NotBehindTarget() ) and ( GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 5) then

		
			CastSpellByName( GetSpellInfo(16511), nil )	
			return true

	
	elseif not PQR_UnitFacing( &amp;quot;target&amp;quot;, &amp;quot;player&amp;quot; ) and ( GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) == 4 and UnitPower( &amp;quot;player&amp;quot; ) &amp;gt; 79 ) then
		
			CastSpellByName( GetSpellInfo(16511), nil )	
			return true
		
	end
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Ambush</Name><Default>false</Default><SpellID>8676</SpellID><Actions></Actions><Lua>if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 5 then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Backstab</Name><Default>false</Default><SpellID>53</SpellID><Actions></Actions><Lua>if not UnitBuffID( &amp;quot;player&amp;quot;, 1784 ) and not UnitBuffID( &amp;quot;player&amp;quot;, 11327 ) and not UnitBuffID( &amp;quot;player&amp;quot;, 51713 ) then

	if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 5  and not PQR_NotBehindTarget() then

		if UnitPower( &amp;quot;player&amp;quot; ) &amp;gt; 35 then
		
			return true
			
		end
		
	end
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Cooldowns</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not nv_CDsKeyDown then nv_CDsKeyDown = 0 end

if IsCDsBind() and GetTime() - nv_CDsKeyDown &amp;gt; 0.2 then
	nv_CDsKeyDown = GetTime()
	
	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
		nv_CDs = CD_BossOnly
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
		nv_CDs = CD_Off
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
		nv_CDs = CD_On
	end
end

 if not nv_AoEKeyDown then nv_AoEKeyDown = 0 end

 if IsAoEBind() and GetTime() - nv_AoEKeyDown &amp;gt; 0.2 then
 	nv_AoEKeyDown = GetTime()
	
 	if nv_multi then 
 
     	nv_multi  = false
     	PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;) 

   	else 
    	
 		nv_multi  = true 
 		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)

   	end
 end

 if not nv_FeintKeyDown then nv_FeintKeyDown = 0 end
 if IsFeintBind() and GetTime() - nv_FeintKeyDown &amp;gt; 0.2 then
 	nv_FeintKeyDown = GetTime()
	
 	if nv_feint then 

     	nv_feint  = false 
     	PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)

   	else 
    	
 		nv_feint  = true 
 		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
 
   	end
 end

if not nv_ShSKeyDown then nv_ShSKeyDown = 0 end

if IsShSBind() and GetTime() - nv_ShSKeyDown &amp;gt; 0.2 then
	nv_ShSKeyDown = GetTime()
	
	if nv_shs then 

    	nv_shs  = false 
    	PQR_WriteToChat(&amp;quot;ShS: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)

  	else 
    	
		nv_shs  = true 
		PQR_WriteToChat(&amp;quot;ShS: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)

  	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Hemoplay</Name><Default>false</Default><SpellID>16511</SpellID><Actions></Actions><Lua>if not UnitDebuffID( &amp;quot;target&amp;quot;, 89755, &amp;quot;PLAYER&amp;quot; ) then
	CastSpellByName(GetSpellInfo(16511),&amp;quot;player&amp;quot;)	
return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: AR</Name><Default>false</Default><SpellID>13750</SpellID><Actions></Actions><Lua>local ShadowBladesUP 	= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)

if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Ambush</Name><Default>false</Default><SpellID>8676</SpellID><Actions></Actions><Lua>return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : AT</Name><Default>false</Default><SpellID>25046</SpellID><Actions></Actions><Lua>local CurrentEnergy	= UnitPower(&amp;quot;player&amp;quot;)

if CurrentEnergy &amp;lt; 75 and nv_CDs then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Evisc</Name><Default>false</Default><SpellID>2098</SpellID><Actions></Actions><Lua>local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )


if ( CPs == 5 and DeepInsightUP ) then

	return true
	
elseif Anti then

	if AntiCharges &amp;gt;= 4 and CPs == 5 then
	
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Evisc 2</Name><Default>false</Default><SpellID>2098</SpellID><Actions></Actions><Lua>local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )


if CPs == 5 then

	return true
	
elseif Anti then

	if AntiCharges &amp;gt;= 4 and CPs == 5 then
	
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: FoK</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );

if nv_multi and (CPs &amp;lt; 5 or (not Anti or AntiCharges &amp;lt; 5)) and not van then

	CastSpellByName( GetSpellInfo(51723), nil )
	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: KS</Name><Default>false</Default><SpellID>51690</SpellID><Actions>/use 10</Actions><Lua>local SnD, SnDTimeLeft 	= Buff_Check( 5171, &amp;quot;player&amp;quot; )
local ShadowBladesUP 	= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local AdrenalinRushUP 	= Buff_Check( 13750, &amp;quot;player&amp;quot; )
local DeepInsightUP		= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local CurrentEnergy		= UnitMana(&amp;quot;player&amp;quot;)

if (nv_CDs == CD_On ) and not ( ShadowBladesUP or AdrenalinRushUP ) and CurrentEnergy &amp;lt; 35 and not UnitBuffID(&amp;quot;player&amp;quot;,144849) then

	if SnD then
	
		if SnDTimeLeft &amp;gt; 3 then
	
			return true
			
		end

	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: RvS</Name><Default>false</Default><SpellID>84617</SpellID><Actions></Actions><Lua>local RvS, RvSTimeLeft 		= Debuff_Check( 84617, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )

if not DeepInsightUP then

	if Anti then
	
		if AntiCharges &amp;lt; 5 then
		
			if RvS then
			
			
				if RvSTimeLeft &amp;lt; 2 then
				
					BGTrigger()
					return true
				
				end
			
			else
				
				BGTrigger()
				return true
				
			end
		
		elseif AntiCharges &amp;gt; 4 and CPs &amp;lt; 5 then
		
			if RvS then
			
			
				if RvSTimeLeft &amp;lt; 2 then
				
					BGTrigger()
					return true
				
				end
			
			else
				
				BGTrigger()
				return true
				
			end		
		
		end
		
	
	else
	
		if RvS then
			
			if RvSTimeLeft &amp;lt; 2 then
			
				BGTrigger()
				return true
				
			end
			
		else
		
			BGTrigger()
			return true
			
		end
	
	end

elseif DeepInsightUP and CPs &amp;lt; 5 then

	if RvS then
			
		if RvSTimeLeft &amp;lt; 2 then
			
			BGTrigger()
			return true
				
		end
			
	else
		
		BGTrigger()
		return true
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Rup</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP		= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local BladeFlurryUP		= Buff_Check( 13877, &amp;quot;player&amp;quot; )

if Rup and CPs == 5 then

	if RupTimeLeft &amp;lt; 2 then
	
		return true
		
	end

elseif not Rup and CPs == 5 then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Rup (DeepInsight)</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP		= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local BladeFlurryUP		= Buff_Check( 13877, &amp;quot;player&amp;quot; )

if DeepInsightUP and Rup and CPs == 5 then

	if RupTimeLeft &amp;lt; 2 then
	
		return true
		
	end

elseif DeepInsightUP and not Rup and CPs == 5 then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: ShB</Name><Default>false</Default><SpellID>121471</SpellID><Actions></Actions><Lua>local AdrenalinRushUP = Buff_Check( 13750, &amp;quot;player&amp;quot; )

if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and AdrenalinRushUP then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: SS</Name><Default>false</Default><SpellID>1752</SpellID><Actions></Actions><Lua>local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )

if DeepInsightUP then

	if CPs &amp;lt; 5 then
	
		BGTrigger()
		return true
		
	end
	
elseif not DeepInsightUP then

	if Anti then
	
		if AntiCharges &amp;lt; 5 or ( AntiCharges &amp;gt; 4 and CPs &amp;lt; 5 ) then
		
			BGTrigger()
			return true
			
		end
	 
	else
	
		BGTrigger()
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: SnD</Name><Default>false</Default><SpellID>5171</SpellID><Actions></Actions><Lua>local SnD, SnDTimeLeft = Buff_Check( 5171, &amp;quot;player&amp;quot; )
local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

if SnD and CPs &amp;gt; 0 then

	if SnDTimeLeft &amp;lt; 2 or ( SnDTimeLeft &amp;lt;15 and BGStack == 3 and CPs &amp;gt;= 4 ) then
	
		return true
		
	end

elseif not SnD and CPs &amp;gt; 0 then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Start</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Shadowstep 		= Buff_Check( 36554, &amp;quot;player&amp;quot; )
if UnitIsDead(&amp;quot;target&amp;quot;)
or not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)
or ( (not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not Shadowstep) and not UnitIsPlayer(&amp;quot;target&amp;quot;) and not Buff_Check( 115193, &amp;quot;player&amp;quot; )) 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: ToT</Name><Default>false</Default><SpellID>57934</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;focus&amp;quot;) and UnitInParty(&amp;quot;focus&amp;quot;) and not UnitIsDead(&amp;quot;focus&amp;quot;) and not PQR_IsOutOfSight(&amp;quot;focus&amp;quot;, 1) then

	PQR_CustomTarget = &amp;quot;focus&amp;quot;
	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Vanish</Name><Default>false</Default><SpellID>1856</SpellID><Actions></Actions><Lua>local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local AdrenalinRushUP 		= Buff_Check( 13750, &amp;quot;player&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local CurrentEnergy			= UnitPower(&amp;quot;player&amp;quot;)

if nv_CDs and not nv_multi and not PQR_UnitFacing(&amp;quot;target&amp;quot;, &amp;quot;player&amp;quot;) and CurrentEnergy &amp;lt; 30 then

	if not ShadowBladesUP and not AdrenalinRushUP and ( DeepInsightUP and CPs &amp;lt; 4 ) then
	
	
	elseif not ShadowBladesUP and not AdrenalinRushUP then
	
		if Anti then
		
			if AntiCharges &amp;lt; 4 or CPs &amp;lt; 4 or ( CPs == 4 and AntiCharges &amp;lt; 5 ) then
			
				return true
			
			end
				
		else
		
			return true
		
		end
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Init</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not PQR_LoadLua(&amp;quot;PQR_PQI.lua&amp;quot;) then
	PQR_WriteToChat(&amp;quot;PQR_PQI.lua is missing. Rotation has been stopped.&amp;quot;, &amp;quot;Error&amp;quot;)
  	PQR_StopRotation()
  	return true
end

if PQR_RotationStarted then
	CD_Off = &amp;quot;Off&amp;quot;
	CD_BossOnly = &amp;quot;Boss&amp;quot;
	CD_On = &amp;quot;On&amp;quot;
	nv_CDs = CD_BossOnly
 	nv_multi = false
 	nv_feint = false
	nv_flurry	= false
 	combopoints = 0
	
	local nv_binds = {
		pause     = &amp;quot;LeftShift&amp;quot;,
		cooldowns = &amp;quot;RightControl&amp;quot;,
 		feint 	  = &amp;quot;LeftAlt&amp;quot;,
 		aoe 	  = &amp;quot;RightShift&amp;quot;,
		flurry		  = &amp;quot;LeftControl&amp;quot;,
	}

	IsPauseBind = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;pause&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
	IsCDsBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;cooldowns&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsFeintBind = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;feint&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsAoEBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;aoe&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsFlurryBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;flurry&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
	

	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only (Without KS)&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Boss Only (Without KS)&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	else
	PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	if nv_multi then
		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	if nv_feint then
		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Feint: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Feint: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
		if nv_flurry then
		PQR_WriteToChat(&amp;quot;Flurry: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Flurry: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Flurry: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Flurry: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	
	
	
	function EventHandler(self, event, ...)

		if event == &amp;quot;UNIT_COMBO_POINTS&amp;quot; then
			combopoints = GetComboPoints(&amp;quot;player&amp;quot;)
		end

		if event == &amp;quot;PLAYER_REGEN_ENABLED&amp;quot; then
			print(&amp;quot;\124cFF15E61CYou are stealthed&amp;quot;);
			restealth = GetTime()
		end

		if event == &amp;quot;PLAYER_TARGET_CHANGED&amp;quot; then
			local redirect = GetSpellCooldown(73981)
			if (0 == redirect and combopoints &amp;gt;= 4 and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)) then
				CastSpellByID(73981)
			end			
			if not UnitAffectingCombat(&amp;quot;player&amp;quot;) then return end
			if UnitIsUnit(&amp;quot;target&amp;quot;, &amp;quot;focus&amp;quot;) then return end
			local s, _, _, _, _, _, sexpire = UnitBuffID(&amp;quot;player&amp;quot;, 73651)
			sexpire = (sexpire ~= nil) and sexpire or 0
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (sexpire - GetTime()) &amp;lt; 6 and (UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)) &amp;lt; 1 then
				CastSpellByID(73651)
				return
			end
			local r, _, _, _, _, _, rexpire = UnitBuffID(&amp;quot;player&amp;quot;, 5171)
			rexpire = (rexpire ~= nil) and rexpire or 0
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (12 + (combopoints * 6)) &amp;gt; (rexpire - GetTime()) then
				CastSpellByID(5171)
				return
			end
		end
	end
  
	if not OurFrame then

	frame = CreateFrame(&amp;quot;FRAME&amp;quot;, &amp;quot;OurFrame&amp;quot;)
	frame:RegisterEvent(&amp;quot;UNIT_COMBO_POINTS&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_REGEN_ENABLED&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_TARGET_CHANGED&amp;quot;)
	frame:SetScript(&amp;quot;OnEvent&amp;quot;, EventHandler)

	print(&amp;quot;Loaded event handler&amp;quot;)

	end
	
	PQR_RotationStarted = false

end

if UnitBuffID(&amp;quot;player&amp;quot;, 1784)
   or UnitBuffID(&amp;quot;player&amp;quot;, 11327)
   or UnitIsDeadOrGhost(&amp;quot;Player&amp;quot;)
   or UnitAffectingCombat(&amp;quot;player&amp;quot;)
   or IsMounted()
   or UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil
then 
	restealth = true
end

if UnitAffectingCombat(&amp;quot;player&amp;quot;) and not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) then
	TargetNearestEnemy()
end


if IsPauseBind() or IsMounted() or UnitBuffID(&amp;quot;target&amp;quot;, 143593) then

	return true 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: Flurry</Name><Default>false</Default><SpellID>13877</SpellID><Actions></Actions><Lua>local FlurryUP = Buff_Check( 13877, &amp;quot;player&amp;quot; )

if nv_flurry and not FlurryUP then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat: FlurryOFF</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local FlurryUP = Buff_Check( 13877, &amp;quot;player&amp;quot; )

if not nv_flurry and FlurryUP then
	RunMacroText(&amp;quot;/cancelaura Blade Flurry&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Cooldowns</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not nv_CDsKeyDown then nv_CDsKeyDown = 0 end

if IsCDsBind() and GetTime() - nv_CDsKeyDown &amp;gt; 0.2 then
	nv_CDsKeyDown = GetTime()
	
	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only (Without KS)&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		nv_CDs = CD_BossOnly
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		nv_CDs = CD_Off
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)
		nv_CDs = CD_On
	end
end

 if not nv_AoEKeyDown then nv_AoEKeyDown = 0 end

 if IsAoEBind() and GetTime() - nv_AoEKeyDown &amp;gt; 0.2 then
 	nv_AoEKeyDown = GetTime()
	
 	if nv_multi then 
 
     	nv_multi  = false 
 		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)

   	else 
    	
 		nv_multi  = true 
 		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)

   	end
 end

 if not nv_FeintKeyDown then nv_FeintKeyDown = 0 end
 if IsFeintBind() and GetTime() - nv_FeintKeyDown &amp;gt; 0.2 then
 	nv_FeintKeyDown = GetTime()
	
 	if nv_feint then 

     	nv_feint  = false 
 		PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)

   	else 
    	
 		nv_feint  = true 
 		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Subtlety&amp;quot;)
 
   	end
 end

if not nv_FlurryKeyDown then nv_FlurryKeyDown = 0 end

if IsFlurryBind() and GetTime() - nv_FlurryKeyDown &amp;gt; 0.2 then
	nv_FlurryKeyDown = GetTime()
	
	if nv_flurry then 

    	nv_flurry  = false 
		PQR_WriteToChat(&amp;quot;Flurry: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)

  	else 
    	
		nv_flurry  = true 
		PQR_WriteToChat(&amp;quot;Flurry: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Combat&amp;quot;)

  	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Init</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not PQR_LoadLua(&amp;quot;PQR_PQI.lua&amp;quot;) then
	PQR_WriteToChat(&amp;quot;PQR_PQI.lua is missing. Rotation has been stopped.&amp;quot;, &amp;quot;Error&amp;quot;)
  	PQR_StopRotation()
  	return true
end

 	if PQR_RotationStarted then
	CD_Off = &amp;quot;Off&amp;quot;
	CD_BossOnly = &amp;quot;Boss&amp;quot;
	CD_On = &amp;quot;On&amp;quot;
	nv_CDs = CD_BossOnly
 	nv_multi = false
 	nv_feint = false
	nv_shs	= false
 	combopoints = 0
 	restealth = false	
	
	local nv_binds = {
		pause     = &amp;quot;LeftShift&amp;quot;,
		cooldowns = &amp;quot;RightControl&amp;quot;,
 		feint 	  = &amp;quot;LeftAlt&amp;quot;,
 		aoe 	  = &amp;quot;RightShift&amp;quot;,
		shs		  = &amp;quot;LeftControl&amp;quot;,
	}

	IsPauseBind = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;pause&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
	IsCDsBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;cooldowns&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsFeintBind = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;feint&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsAoEBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;aoe&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
 	IsShSBind   = _G[&amp;apos;Is&amp;apos;..nv_binds[&amp;quot;shs&amp;quot;]..&amp;apos;KeyDown&amp;apos;]
	
	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
 	if nv_multi then
 		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
 		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
 	else
 		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
 		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
 	end
 	if nv_feint then
 		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
 		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Feint: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
 	else
 		PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
 		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Feint: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
 	end
 	if nv_shs then
		PQR_WriteToChat(&amp;quot;ShS: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;ShS: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;ShS: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;ShS: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	
	

	function EventHandler(self, event, ...)


		if event == &amp;quot;UNIT_COMBO_POINTS&amp;quot; then
			combopoints = GetComboPoints(&amp;quot;player&amp;quot;)
		end

		if event == &amp;quot;PLAYER_REGEN_ENABLED&amp;quot; then
			if UnitBuffID(&amp;quot;player&amp;quot;, 1856) then return end
			print(&amp;quot;\124cFF15E61CYou are Stealthed&amp;quot;);
			restealth = GetTime()
		end

		if event == &amp;quot;PLAYER_TARGET_CHANGED&amp;quot; or event == &amp;quot;PLAYER_REGEN_ENABLED&amp;quot; then
			if UnitBuffID(&amp;quot;player&amp;quot;, 1856) then return end
			if UnitIsUnit(&amp;quot;target&amp;quot;, &amp;quot;focus&amp;quot;) then return end
			local s, _, _, _, _, _, sexpire = UnitBuffID(&amp;quot;player&amp;quot;, 73651)
			sexpire = (sexpire ~= nil) and sexpire or 0
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (sexpire - GetTime()) &amp;lt; 6 and (UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)) &amp;lt; 1 then
				CastSpellByID(73651)
				return
			end
			local r, _, _, _, _, _, rexpire = UnitBuffID(&amp;quot;player&amp;quot;, 5171)
			rexpire = (rexpire ~= nil) and rexpire or 0
	
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (rexpire - GetTime()) &amp;lt; 3 then
				CastSpellByID(5171)
				return
			end
		end
	end
  
	if not OurFrame then

frame = CreateFrame(&amp;quot;FRAME&amp;quot;, &amp;quot;OurFrame&amp;quot;)
	frame:RegisterEvent(&amp;quot;UNIT_COMBO_POINTS&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_REGEN_ENABLED&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_TARGET_CHANGED&amp;quot;)
	frame:SetScript(&amp;quot;OnEvent&amp;quot;, EventHandler)

	print(&amp;quot;\124cFF15E61CGood Game with Rip ViP Ultimate Rogue PvE&amp;quot;)

	end
	
	PQR_RotationStarted = false

end

 
if UnitBuffID(&amp;quot;player&amp;quot;, 1784)
   or UnitBuffID(&amp;quot;player&amp;quot;, 11327)
   or UnitIsDeadOrGhost(&amp;quot;Player&amp;quot;)
   or UnitAffectingCombat(&amp;quot;player&amp;quot;)
   or IsMounted()
   or UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil
then 
	restealth = false
end


if UnitAffectingCombat(&amp;quot;player&amp;quot;) and not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) and not UnitExists(&amp;quot;boss1&amp;quot;) then
	TargetNearestEnemy()
end

if IsPauseBind() or IsMounted() or UnitBuffID(&amp;quot;target&amp;quot;, 143593) then

	return true 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Cooldowns</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not nv_CDsKeyDown then nv_CDsKeyDown = 0 end

if IsCDsBind() and GetTime() - nv_CDsKeyDown &amp;gt; 0.2 then
	nv_CDsKeyDown = GetTime()
	
	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
		nv_CDs = CD_BossOnly
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
		nv_CDs = CD_Off
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
		nv_CDs = CD_On
	end
end

 if not nv_AoEKeyDown then nv_AoEKeyDown = 0 end

 if IsAoEBind() and GetTime() - nv_AoEKeyDown &amp;gt; 0.2 then
 	nv_AoEKeyDown = GetTime()
	
 	if nv_multi then 
 
     	nv_multi  = false 
 		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)

   	else 
    	
 		nv_multi  = true 
 		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)

   	end
 end

 if not nv_FeintKeyDown then nv_FeintKeyDown = 0 end
 if IsFeintBind() and GetTime() - nv_FeintKeyDown &amp;gt; 0.2 then
 	nv_FeintKeyDown = GetTime()
	
 	if nv_feint then 

     	nv_feint  = false 
 		PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)

   	else 
    	
 		nv_feint  = true 
 		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip : Assassination&amp;quot;)
 
   	end
 end
 
 if not nv_ShSKeyDown then nv_ShSKeyDown = 0 end

if IsShSBind() and GetTime() - nv_ShSKeyDown &amp;gt; 0.2 then
	nv_ShSKeyDown = GetTime()
	
	if nv_shs then 

    	nv_shs  = false 
		PQR_WriteToChat(&amp;quot;ShS: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rip: Assassination&amp;quot;)

  	else 
    	
		nv_shs  = true 
		PQR_WriteToChat(&amp;quot;ShS: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rip: Assassination&amp;quot;)

  	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Start</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Shadowstep 		= Buff_Check( 36554, &amp;quot;player&amp;quot; )
if UnitIsDead(&amp;quot;target&amp;quot;)
or not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)
or ( (not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not Shadowstep) and not UnitIsPlayer(&amp;quot;target&amp;quot;) and not Buff_Check( 115193, &amp;quot;player&amp;quot; ))
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if SafeToCastCD() 
and not PQR_SpellAvailable(121471) 
and not PQR_SpellAvailable(79140) then
	UseItem(10)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Arcane Torrent</Name><Default>false</Default><SpellID>25046</SpellID><Actions></Actions><Lua>local CurrentEnergy	= UnitPower(&amp;quot;player&amp;quot;)

if CurrentEnergy &amp;lt; 75 
and (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) 
and SafeToCastCD() then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Racials</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) 
and SafeToCastCD() then
  
	if IsPlayerSpell(26297) 
	and PQR_SpellAvailable(26297) then
		CastSpellByName(GetSpellInfo(26297),&amp;quot;player&amp;quot;)
	end
	if IsPlayerSpell(20572) 
	and PQR_SpellAvailable(20572) then
		CastSpellByName(GetSpellInfo(20572),&amp;quot;player&amp;quot;)
	end 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Vanish</Name><Default>false</Default><SpellID>1856</SpellID><Actions></Actions><Lua>local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local CurrentEnergy			= UnitPower(&amp;quot;player&amp;quot;)
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );

if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) 
and SafeToCastCD()
and not nv_multi 
and CPs &amp;lt; 5 
and CurrentEnergy &amp;lt; 60 
and not PQR_SpellAvailable(121471) 
and not Blindside 
and (not Env or EnvTimeLeft &amp;lt; 1) 
and Rup 
and RupTimeLeft &amp;gt; 2 then

	if not ShadowBladesUP  then

		return true
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Ambush</Name><Default>false</Default><SpellID>8676</SpellID><Actions></Actions><Lua>return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Shadow Blades</Name><Default>false</Default><SpellID>121471</SpellID><Actions></Actions><Lua>local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local VenStart, VenDuration = GetSpellCooldown(79140);
if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) 
and (VenStart + VenDuration - GetTime()) &amp;lt; 119.1 
and Rup 
and RupTimeLeft &amp;gt; 2 
and SafeToCastCD() then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Slice and Dice</Name><Default>false</Default><SpellID>5171</SpellID><Actions></Actions><Lua>local SnD, SnDTimeLeft = Buff_Check( 5171, &amp;quot;player&amp;quot; )
local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

if SnD 
and CPs &amp;gt; 0 then

	if SnDTimeLeft &amp;lt; 2 then
	
		return true
		
	end

elseif not SnD 
and CPs &amp;gt; 0 then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Dispatch Energy</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CurHealth		 	= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))

if (CurHealth &amp;lt; 35 or Blindside) and not van then

	if CurrentEnergy &amp;gt; 110 then
	
		if Rup then
		
			if RupTimeLeft &amp;lt; 2 then
			
				CastSpellByName( GetSpellInfo(111240), nil )
				return true
			
			end
		
		else
		
			CastSpellByName( GetSpellInfo(111240), nil )
			return true
		
		end
	
	end
	
	if Blindside 
	and CPs &amp;gt; 4 
	and Rup 
	and RupTimeLeft &amp;gt; 3 
	and Env 
	and (not Anti or ((ShadowBladesUP and AntiCharges &amp;lt; 3) 
	or (not ShadowBladesUP and AntiCharges &amp;lt; 4))) 
	and (CurrentEnergy + (EnergyRegen * 1.5)) &amp;lt; 100 then
		CastSpellByName( GetSpellInfo(111240), nil )
		return true
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Mutilate Energy</Name><Default>false</Default><SpellID>1329</SpellID><Actions></Actions><Lua>local CurHealth		 	= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

if CurHealth &amp;gt; 35 then

	if CurrentEnergy &amp;gt; 110 then
	
		if Rup then
		
			if RupTimeLeft &amp;lt; 2 then
			
				return true
			
			end
		
		else
			return true
		
		end
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Rupture</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

if Rup then

	if CPs &amp;gt; 0 
	and RupTimeLeft &amp;lt; 2 then
	
		return true
		
	end
		
else

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Feint</Name><Default>false</Default><SpellID>1966</SpellID><Actions></Actions><Lua>local FeintUP = Buff_Check( 1966, &amp;quot;player&amp;quot; )

if nv_feint 
and not FeintUP then

return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Vendetta</Name><Default>false</Default><SpellID>79140</SpellID><Actions></Actions><Lua>local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;) 
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) 
and SafeToCastCD() 
and Rup
and RupTimeLeft &amp;gt; 2 then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Envenom</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Ven, VenTimeLeft 	= Debuff_Check( 79140, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local ShadowBladesUP, SBTimeLeft	= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local EnergyAfterEnvenom = CurrentEnergy + (EnergyRegen * 1.5)


if CPs &amp;gt; 4 
and Rup 
and not ShadowBladesUP 
and (not Anti or AntiCharges &amp;lt; 4) then

	if RupTimeLeft &amp;lt; 6 
	and RupTimeLeft &amp;gt; 3 
	and (CurrentEnergy + (EnergyRegen * (RupTimeLeft - 2)) + 25) &amp;lt; 110 then
		return
	end
	
	if RupTimeLeft &amp;lt; 3 
	or (RupTimeLeft &amp;gt; 3 
	and CurrentEnergy &amp;lt; 60 and not Ven) then
		return
	end
	
end

if CPs &amp;gt; 4 
and (not Env or EnvTimeLeft &amp;lt; 1 
or (EnergyAfterEnvenom &amp;gt; 100 
and (Anti and AntiCharges &amp;gt; 2)) 
or (ShadowBladesUP 
and SBTimeLeft &amp;gt; 1 
and (EnergyAfterEnvenom &amp;lt; 100 
or (Anti and AntiCharges &amp;gt; 2))))  then
	CastSpellByName( GetSpellInfo(32645), nil )
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Envenom SnD</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local SnD, SnDTimeLeft = Buff_Check( 5171, &amp;quot;player&amp;quot; )

if CPs &amp;gt;= 2 
and SnD 
and SnDTimeLeft &amp;lt; 3 then

	CastSpellByName( GetSpellInfo(32645), nil )
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Tricks of the Trade</Name><Default>false</Default><SpellID>57934</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
if UnitExists(&amp;quot;focus&amp;quot;) 
and UnitInParty(&amp;quot;focus&amp;quot;) 
and not UnitIsDead(&amp;quot;focus&amp;quot;) 
and not PQR_IsOutOfSight(&amp;quot;focus&amp;quot;, 1) 
and Rup 
and RupTimeLeft &amp;gt; 3 then

	PQR_CustomTarget = &amp;quot;focus&amp;quot;
	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Fan of Knives</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if nv_multi and GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 5 then

	CastSpellByName( GetSpellInfo(51723), nil )
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Dispatch</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local CurHealth		 	= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )

if Blindside
	and not van
	and (CPs &amp;lt; 5
	or (Env
		and EnvTimeLeft &amp;gt; 2 
		and (not Anti
			or (ShadowBladesUP and AntiCharges &amp;lt; 3 and (CurrentEnergy + (EnergyRegen * 1.5)) &amp;lt; 100)
			or (not ShadowBladesUP and AntiCharges &amp;lt; 4)
			)
		)
	)
then

	CastSpellByName( GetSpellInfo(111240), nil )
	return true

elseif CurHealth &amp;lt; 35
	and not van
	and (CPs &amp;lt; 5 
	or (Env 
		and EnvTimeLeft &amp;gt; 2
		and (not Anti
			or (ShadowBladesUP and AntiCharges &amp;lt; 3)
			or (not ShadowBladesUP and AntiCharges &amp;lt; 4)
			)
		)
	)
then

	CastSpellByName( GetSpellInfo(111240), nil )
	return true

end
</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Mutilate</Name><Default>false</Default><SpellID>1329</SpellID><Actions></Actions><Lua>local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );
local vstart, vduration = GetSpellCooldown(1856);
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )

if van 
and (vstart + vduration - GetTime()) &amp;gt; 119.9 then return end

if CPs &amp;lt; 5 
or (Env and EnvTimeLeft &amp;gt; 2 
and (not Anti or AntiCharges &amp;lt; 3)) then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Stealth</Name><Default>false</Default><SpellID>1784</SpellID><Actions></Actions><Lua>local Stealth = UnitBuffID(&amp;quot;Player&amp;quot;,1784)
local StealthCD = PQR_SpellAvailable(1784)

if not IsMounted()
and PQR_IsCastingSpell()
and not SpellIsTargeting()
and not UnitBuffID(&amp;quot;Player&amp;quot;,80169)
and not UnitBuffID(&amp;quot;Player&amp;quot;,87959)
and not UnitIsDeadOrGhost(&amp;quot;Player&amp;quot;)
and not UnitAffectingCombat(&amp;quot;Player&amp;quot;)then
if not Stealth and StealthCD and PQI_RipHeroic_Stealth_enable then
   CastSpellByName(tostring(GetSpellInfo(1784)),&amp;quot;Player&amp;quot;) 
end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Redirect</Name><Default>false</Default><SpellID>73981</SpellID><Actions></Actions><Lua>local cpstarget = GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
if combopoints &amp;gt; cpstarget
	and combopoints &amp;gt;= 2
	and not IsStealthed()
	and UnitExists(&amp;quot;target&amp;quot;)
	and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
	and 1 == IsSpellInRange(GetSpellInfo(73981), &amp;quot;target&amp;quot;)
then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Poisons</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil then return end
local DP = 1
local WP = 0
local LP = 1
local CP = 0
local MNP = 0
local PARP = 0

MHPOISON = nil
if ( DP ~= 1 and WP == 1 ) then
	MHPOISON = 8679
elseif ( DP == 1 and WP ~= 1 ) then
	MHPOISON = 2823
elseif ( DP == 1 and WP == 1 ) then
	return false
elseif ( DP ~= 1 and WP ~= 1 ) then
	return false
end

OHPOISON = nil
if ( LP == 1 and CP ~= 1 and MNP ~= 1 and PARP ~= 1 ) then
	OHPOISON = 108211
elseif ( LP ~= 1 and CP == 1 and MNP ~= 1 and PARP ~= 1 ) then
	OHPOISON = 3408
elseif ( LP ~= 1 and CP ~= 1 and MNP == 1 and PARP ~= 1 ) then
	OHPOISON = 5761
elseif ( LP ~= 1 and CP ~= 1 and MNP ~= 1 and PARP == 1 ) then
	OHPOISON = 108215
elseif ( ( LP == 1 and CP == 1 and MNP ~= 1 and PARP ~= 1 ) or
		 ( LP == 1 and CP ~= 1 and MNP == 1 and PARP ~= 1 ) or
		 ( LP == 1 and CP ~= 1 and MNP ~= 1 and PARP == 1 ) or
		 ( LP ~= 1 and CP == 1 and MNP == 1 and PARP ~= 1 ) or
		 ( LP ~= 1 and CP == 1 and MNP ~= 1 and PARP == 1 ) or
		 ( LP ~= 1 and CP ~= 1 and MNP == 1 and PARP == 1 ) or
		 ( LP ~= 1 and CP ~= 1 and MNP ~= 1 and PARP ~= 1 ) ) then
	return false
end

if not IsMounted() then
if not UnitBuffID(&amp;quot;player&amp;quot;, MHPOISON) then
	CastSpellByName(GetSpellInfo(MHPOISON))
end
if not UnitBuffID(&amp;quot;player&amp;quot;, OHPOISON) then
	CastSpellByName(GetSpellInfo(OHPOISON))
end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Other (Waiting)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local start, duration, enabled = GetSpellCooldown(51713);

if nv_CDs then

	if PQR_SpellAvailable(1856) and not PQR_SpellAvailable(51713) 
	and not UnitDebuffID( &amp;quot;target&amp;quot;, 91021, &amp;quot;PLAYER&amp;quot; ) 
	and not ( UnitBuffID( &amp;quot;player&amp;quot;, 115191 ) or UnitBuffID( &amp;quot;player&amp;quot;, 115193 ) ) 
	and not UnitBuffID( &amp;quot;player&amp;quot;, 51713 ) 
	then

		if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 4 then
	
			if UnitPower( &amp;quot;player&amp;quot; ) &amp;lt; 59 then

				return true

			end
	
		end

	end
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Waiting</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local start, duration, enabled = GetSpellCooldown(51713);

if nv_CDs then

	if PQR_SpellAvailable(51713) and not UnitDebuffID( &amp;quot;target&amp;quot;, 91021, &amp;quot;PLAYER&amp;quot; ) and not ( UnitBuffID( &amp;quot;player&amp;quot;, 115191 ) or UnitBuffID( &amp;quot;player&amp;quot;, 115193 ) ) then

		if GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; ) &amp;lt; 4 then
	
			if UnitPower( &amp;quot;player&amp;quot; ) &amp;lt; 75 then
		
				return true
					
			end
	
		end

	end
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>ShadowStep</Name><Default>false</Default><SpellID>36554</SpellID><Actions></Actions><Lua>if nv_shs  and not UnitBuffID(&amp;quot;player&amp;quot;,146540) then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Redirect</Name><Default>false</Default><SpellID>73981</SpellID><Actions></Actions><Lua>local cpstarget = GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
if combopoints &amp;gt; cpstarget
	and combopoints &amp;gt;= 2
	and not IsStealthed()
	and UnitExists(&amp;quot;target&amp;quot;)
	and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
	and 1 == IsSpellInRange(GetSpellInfo(73981), &amp;quot;target&amp;quot;)
then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Boss Mechanics</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Darkmoon Faerie Cannon 
if select(7,UnitBuffID(&amp;quot;player&amp;quot;,102116)) 
 and select(7,UnitBuffID(&amp;quot;player&amp;quot;,102116)) - GetTime() &amp;lt; 1.07 then  
    CancelUnitBuff(&amp;quot;player&amp;quot;,&amp;quot;Magic Wings&amp;quot;)  
end 

-- Gara&amp;apos;jal the Spiritbinder 
local timer = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,116161)) 
if timer and timer - GetTime() &amp;lt; 1.5 then 
    SpellStopCasting() 
    RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) 
end 

for i = 1, 4 do 
    local bossUnit = &amp;quot;boss&amp;quot;..i 
     
    if UnitExists(bossUnit) then 
        local castName = UnitCastingInfo(&amp;quot;target&amp;quot;) 
        local channelName = UnitChannelInfo(&amp;quot;target&amp;quot;) 
        local BossID = tonumber(UnitGUID(bossUnit):sub(6,10), 16) 

        -- Lei Shen - Thunderstruck 
        if BossID == 68397 then 
            if castName == &amp;quot;Thunderstruck&amp;quot; 
             and not UnitBuffID(&amp;quot;player&amp;quot;, 1966) then 
                CastSpellByName(tostring(GetSpellInfo(1966)),&amp;quot;Player&amp;quot;) 
            end 
        end 

        if BossID == 68476 then 
            if castName == &amp;quot;Dire Call&amp;quot; 
             and not UnitBuffID(&amp;quot;player&amp;quot;, 1966) then 
                 CastSpellByName(tostring(GetSpellInfo(1966)),&amp;quot;Player&amp;quot;) 
            end 
        end 

        -- Jin&amp;apos;rokh - Ionization 
        if BossID == 69465 then 
            if castName == &amp;quot;Ionization&amp;quot; then 
                CastSpellByName(tostring(GetSpellInfo(31224)),&amp;quot;Player&amp;quot;) 
            end 
        end 

        -- Tortos - Quake Stomp 
        if BossID == 67977 then 
            if castName == &amp;quot;Quake Stomp&amp;quot; 
             and not UnitBuffID(&amp;quot;player&amp;quot;, 1966) then 
                CastSpellByName(tostring(GetSpellInfo(1966)),&amp;quot;Player&amp;quot;) 
            end 
        end 

        -- Ji-kun - Quills 
        if BossID == 69712 then 
            if channelName == &amp;quot;Quills&amp;quot; 
             and not UnitBuffID(&amp;quot;player&amp;quot;, 1966) then 
                CastSpellByName(tostring(GetSpellInfo(1966)),&amp;quot;Player&amp;quot;) 
            end 
        end 

        -- Primordius - Caustic Gas 
        if BossID == 69017 then 
            if castName == &amp;quot;Caustic Gas&amp;quot; 
             and not UnitBuffID(&amp;quot;player&amp;quot;, 1966) then 
                CastSpellByName(tostring(GetSpellInfo(1966)),&amp;quot;Player&amp;quot;) 
            end 
        end 

        -- Dark Animus - Interrupting Jolt 
        if BossID == 69427 then 
            if castName == &amp;quot;Interrupting Jolt&amp;quot; 
             and not UnitBuffID(&amp;quot;player&amp;quot;, 1966) then 
                CastSpellByName(tostring(GetSpellInfo(1966)),&amp;quot;Player&amp;quot;) 
            end 
        end 
         
        -- Sha of Pride - Swelling Pride
        if BossID == 71734 then 
            if castName == &amp;quot;Swelling Pride&amp;quot; then 
                CastSpellByName(tostring(GetSpellInfo(31224)),&amp;quot;Player&amp;quot;) 
            end 
        end 
         
        -- Sun Tenderheart - Calamity
        if BossID == 71480 then 
            if  CastSpellByName(tostring(GetSpellInfo(143544)),&amp;quot;Target&amp;quot;) then 
                CastSpellByName(tostring(GetSpellInfo(31224)),&amp;quot;Player&amp;quot;) 
            end 
        end
         -- Sun Tenderheart - Calamity 2
        if BossID == 71480 then 
            if  CastSpellByName(tostring(GetSpellInfo(143491)),&amp;quot;Target&amp;quot;) then 
                CastSpellByName(tostring(GetSpellInfo(31224)),&amp;quot;Player&amp;quot;) 
            end 
        end
        
        -- Embodied Anguish - Defensive
        if UnitBuffID(&amp;quot;player&amp;quot;,143840) then
                CastSpellByName(tostring(GetSpellInfo(5277)),&amp;quot;Player&amp;quot;) 
        end
        
         -- Corrupted Prison - Cloak
        if UnitBuffID(&amp;quot;player&amp;quot;,144684) 
        	or UnitBuffID(&amp;quot;player&amp;quot;,144683) 
        	or UnitBuffID(&amp;quot;player&amp;quot;,144636) 
        	or UnitBuffID(&amp;quot;player&amp;quot;,144574)  then
                CastSpellByName(tostring(GetSpellInfo(31224)),&amp;quot;Player&amp;quot;) 
        end
        
       
         -- Whirling Corruption - Cloak
            if UnitBuffID(&amp;quot;target&amp;quot;,144985) then 
                CastSpellByName(tostring(GetSpellInfo(31224)),&amp;quot;Player&amp;quot;) 
            end 
       
         -- Empowered Whirling Corruption - Cloak
            if UnitBuffID(&amp;quot;target&amp;quot;,145037) then 
                CastSpellByName(tostring(GetSpellInfo(31224)),&amp;quot;Player&amp;quot;) 
            end 
        
    end 
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>BloodFury</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and SafeToCastCD() then
  
	if IsPlayerSpell(26297) and PQR_SpellAvailable(26297) then
		CastSpellByName(GetSpellInfo(26297),&amp;quot;player&amp;quot;)
	end
	if IsPlayerSpell(20572) and PQR_SpellAvailable(20572) then
		CastSpellByName(GetSpellInfo(20572),&amp;quot;player&amp;quot;)
	end 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Garrote</Name><Default>false</Default><SpellID>703</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )


if UnitBuffID( &amp;quot;player&amp;quot;, 1784 ) and not Rup then 
	return true
	end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>HealthStone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local PlayerHP = 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)
if not UnitAffectingCombat(&amp;quot;player&amp;quot;) then return false end

if PQI_RipHeroic_HealthStone_enable
	and GetItemCount(5512,false,true) &amp;gt; 0
	and PlayerHP &amp;lt;= 9
	and PQR_SpellAvailable(5512)
	and UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and GetItemCooldown(5512) == 0
then
	print(&amp;quot;Healing with Healthstone (Current HP: &amp;quot; .. PlayerHP,1)
	UseItemByName(5512)
end
return false</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Poison PQI</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Lethal = PQI_RipHeroic_LethalPoison_value
local NonLethal = PQI_RipHeroic_NonLethalPoison_value

if PQI_RipHeroic_LethalPoison_enable then

-- LETHAL Wound
if Lethal == 8679
and not UnitBuffID(&amp;quot;player&amp;quot;, 8679)
and not IsMounted() then
CastSpellByName(GetSpellInfo(8679),&amp;quot;player&amp;quot;)
end

-- LETHAL Deadly
if Lethal == 2823
and not UnitBuffID(&amp;quot;player&amp;quot;, 2823)
and not IsMounted() then
CastSpellByName(GetSpellInfo(2823),&amp;quot;player&amp;quot;)
end

end

if PQI_RipHeroic_NonLethalPoison_enable then

-- NON-LETHAL Mind-Numbing
if NonLethal == 5761
and not UnitBuffID(&amp;quot;player&amp;quot;, 5761)
and not IsMounted() then
CastSpellByName(GetSpellInfo(5761),&amp;quot;player&amp;quot;)
end

-- NON-LETHAL Crippling
if NonLethal == 3408
and not UnitBuffID(&amp;quot;player&amp;quot;, 3408)
and not IsMounted() then
CastSpellByName(GetSpellInfo(3408),&amp;quot;player&amp;quot;)
end

-- NON-LETHAL Paralytic
if NonLethal == 108215
and not UnitBuffID(&amp;quot;player&amp;quot;, 108215)
and not IsMounted() then
CastSpellByName(GetSpellInfo(108215),&amp;quot;player&amp;quot;)
end

-- NON-LETHAL Leeching
if NonLethal == 108211
and not UnitBuffID(&amp;quot;player&amp;quot;, 108211)
and not IsMounted() then
CastSpellByName(GetSpellInfo(108211),&amp;quot;player&amp;quot;)
end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Shuriken Toss</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Shuriken Toss
if UnitExists(&amp;quot;target&amp;quot;)
	and PQR_SpellAvailable(114014)
	and PQI_RipHeroic_ShurikenToss_enable then
		CastSpellByName( GetSpellInfo(114014), nil )	
return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spec Swap</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local SpecSwap=PQI_RipHeroic_SpecSwap_value

if PQI_RipHeroic_SpecSwap_enable then

	if SpecSwap == 1 then
		PQR_SwapRotation(&amp;quot;Subtlety (RiPHeroic)&amp;quot;)
	elseif SpecSwap == 2 then
		PQR_SwapRotation(&amp;quot;Combat (RiPHeroic)&amp;quot;)
	elseif SpecSwap == 3 then
		PQR_SwapRotation(&amp;quot;Assassination (RiPHeroic)&amp;quot;)
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>PQI : RipHeroic</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if RIP_HEROIC then return false end

local config = {
	name	= &amp;quot;Heroic&amp;quot;,
	author	= &amp;quot;Rip&amp;quot;,
	abilities = {
		{	name	= &amp;quot;Spec Swap &amp;quot;,
			enable	= true,
			widget  = {type=&amp;quot;select&amp;quot;,
			tooltip = &amp;quot;This key is used for swap spec.&amp;quot;,
			value   = 4,
			values  = {[1] = &amp;quot;Subtlety&amp;quot;,[2] = &amp;quot;Combat&amp;quot;,[3] = &amp;quot;Assassination&amp;quot;,[4] = &amp;quot;No Swap&amp;quot;},
			width = 100 },
		},
		newSection = true,
			{	name	= &amp;quot;Lethal Poison &amp;quot;,
			enable	= true,
			tooltip	= &amp;quot;Enable if you want to override the default lethal poison.&amp;quot;,
			widget  = {type=&amp;quot;select&amp;quot;,
			tooltip = &amp;quot;Select a main hand poison.&amp;quot;,
			value   = 2823,
			values  = {[8679] = &amp;quot;Wound&amp;quot;,[2823] = &amp;quot;Deadly&amp;quot;},
			width = 100 },
			newSection = true,
		},
		{	name	= &amp;quot;Non Lethal Poison&amp;quot;,
			tooltip = &amp;quot;Enable if you want to override the default non lethal poison.&amp;quot;,
			enable  = true,
			widget  = {type=&amp;quot;select&amp;quot;,
			tooltip = &amp;quot;Select an off hand poison.&amp;quot;,
			value   = 5761,
			values  = {[5761] = &amp;quot;Mind-Numbing&amp;quot;,[3408] = &amp;quot;Crippling&amp;quot;,[108215] = &amp;quot;Paralytic&amp;quot;,[108211] = &amp;quot;Leeching&amp;quot;},
			width = 100 },
		},	
		{ 	name	= &amp;quot;Stealth&amp;quot;,
			enable	= false,
			tooltip	= &amp;quot;Toggle the use Stealth.&amp;quot;,
			newSection = true,
		},
		{ 	name	= &amp;quot;Shuriken Toss&amp;quot;,
			enable	= false,
			tooltip	= &amp;quot;Toggle the use of Shuriken Toss.&amp;quot;,
			newSection = true,
		},
		{	name	= &amp;quot;Expose Armor&amp;quot;,
			enable	= false,
			tooltip	= &amp;quot;This key is used for use (or not) the Expose Armor.&amp;quot;,
			newSection = true,
		},
		{ 	name	= &amp;quot;HealthStone&amp;quot;,
			enable	= true,
			tooltip	= &amp;quot;Toggle the use of HealthStone.&amp;quot;,
			newSection = true,
			
		},		
	},
}

RIP_HEROIC = PQI:AddRotation(config)</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tricks (Comb)</Name><Default>false</Default><SpellID>57934</SpellID><Actions></Actions><Lua>local start, duration, enabled = GetSpellCooldown(51713)


if UnitExists( &amp;quot;focus&amp;quot; ) and UnitInParty(&amp;quot;focus&amp;quot;) and not UnitIsDead(&amp;quot;focus&amp;quot;) and not PQR_IsOutOfSight( &amp;quot;focus&amp;quot;, 1 ) then
		
	return true
		
end</Lua><RecastDelay>0</RecastDelay><Target>Focus</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></ROGUE>