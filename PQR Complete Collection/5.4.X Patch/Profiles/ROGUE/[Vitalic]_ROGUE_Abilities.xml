<?xml version="1.0" encoding="utf-8" ?><ROGUE><Ability><Name>Combat : Start</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitIsDead(&amp;quot;target&amp;quot;)
or not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) 
or ( not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not UnitIsPlayer(&amp;quot;target&amp;quot;) )
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Cooldowns</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Cooldowns

if not nv_RightShift then nv_RightShift = 0 end

if IsRightShiftKeyDown() and GetTime() - nv_RightShift &amp;gt; 1 then
	nv_RightShift = GetTime()
	
	if nv_CDs then 

    	nv_CDs  = false 
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)

  	else 
    	
		nv_CDs  = true 
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)

  	end
end

if not nv_RightCTRL then nv_RightCTRL = 0 end

if IsRightControlKeyDown() and GetTime() - nv_RightCTRL &amp;gt; 1 then
	nv_RightCTRL = GetTime()
	
	if nv_multi then 

    	nv_multi  = false 
		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)

  	else 
    	
		nv_multi  = true 
		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)

  	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Init</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not PQR_LoadLua(&amp;quot;PQR_notvalid.lua&amp;quot;) then
	PQR_WriteToChat(&amp;quot;PQR_notvalid.lua is missing. Rotation has been stopped.&amp;quot;, &amp;quot;Error&amp;quot;)
  	PQR_StopRotation()
  	return true
end

if PQR_RotationStarted then

	nv_CDs 		= false
	nv_multi 	= false
	
	-- Global
	
	BGStack = 0
	
	-- Global

	if nv_CDs then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	if nv_multi then
		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Combat&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	
	PQR_RotationStarted = false
end

-- Maybe I&amp;apos;ll add slash commands later

if IsLeftShiftKeyDown() or IsMounted() then

	return true 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Slice and Dice</Name><Default>false</Default><SpellID>5171</SpellID><Actions></Actions><Lua>local SnD, SnDTimeLeft = Buff_Check( 5171, &amp;quot;player&amp;quot; )
local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

if SnD and CPs &amp;gt; 0 then

	if SnDTimeLeft &amp;lt; 2 or ( SnDTimeLeft &amp;lt;15 and BGStack == 3 and CPs &amp;gt;= 4 ) then
	
		return true
		
	end

elseif not SnD and CPs &amp;gt; 0 then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Shadow Blades</Name><Default>false</Default><SpellID>121471</SpellID><Actions></Actions><Lua>local AdrenalinRushUP = Buff_Check( 13750, &amp;quot;player&amp;quot; )

if nv_CDs and AdrenalinRushUP then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Killing Spree</Name><Default>false</Default><SpellID>51690</SpellID><Actions></Actions><Lua>local SnD, SnDTimeLeft 	= Buff_Check( 5171, &amp;quot;player&amp;quot; )
local ShadowBladesUP 	= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local AdrenalinRushUP 	= Buff_Check( 13750, &amp;quot;player&amp;quot; )
local DeepInsightUP		= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)

if not ( ShadowBladesUP or AdrenalinRushUP ) and DeepInsightUP and CurrentEnergy &amp;lt; 35 and nv_CDs then

	if SnD then
	
		if SnDTimeLeft &amp;gt; 4 then
	
			return true
			
		end

	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Adrenalin Rush</Name><Default>false</Default><SpellID>13750</SpellID><Actions></Actions><Lua>local ShadowBladesUP 	= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)

if ShadowBladesUP or CurrentEnergy &amp;lt; 35 and nv_CDs then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Rupture ( DI )</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP		= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local BladeFlurryUP		= Buff_Check( 13877, &amp;quot;player&amp;quot; )

if DeepInsightUP and Rup and CPs &amp;gt;= 5 and not BladeFlurryUP then

	if RupTimeLeft &amp;lt; 2 then
	
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Rupture</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP		= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local BladeFlurryUP		= Buff_Check( 13877, &amp;quot;player&amp;quot; )

if Rup and CPs &amp;gt;= 5 and not BladeFlurryUP then

	if RupTimeLeft &amp;lt; 2 then
	
		return true
		
	end

elseif not Rup and CPs &amp;gt;= 5 and not BladeFlurryUP then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Eviscerate</Name><Default>false</Default><SpellID>2098</SpellID><Actions></Actions><Lua>local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )


if ( CPs &amp;gt;= 5 and DeepInsightUP ) then

	return true
	
elseif Anti then

	if AntiCharges &amp;gt;= 4 and CPs &amp;gt; 4 then
	
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Revealing Strike</Name><Default>false</Default><SpellID>84617</SpellID><Actions></Actions><Lua>local RvS, RvSTimeLeft 		= Debuff_Check( 84617, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )

if not DeepInsightUP then

	if Anti then
	
		if AntiCharges &amp;lt; 5 then
		
			if RvS then
			
			
				if RvSTimeLeft &amp;lt; 2 then
				
					BGTrigger()
					return true
				
				end
			
			else
				
				BGTrigger()
				return true
				
			end
		
		elseif AntiCharges &amp;gt; 4 and CPs &amp;lt; 5 then
		
			if RvS then
			
			
				if RvSTimeLeft &amp;lt; 2 then
				
					BGTrigger()
					return true
				
				end
			
			else
				
				BGTrigger()
				return true
				
			end		
		
		end
		
	
	else
	
		if RvS then
			
			if RvSTimeLeft &amp;lt; 2 then
			
				BGTrigger()
				return true
				
			end
			
		else
		
			BGTrigger()
			return true
			
		end
	
	end

elseif DeepInsightUP and CPs &amp;lt; 5 then

	if RvS then
			
		if RvSTimeLeft &amp;lt; 2 then
			
			BGTrigger()
			return true
				
		end
			
	else
		
		BGTrigger()
		return true
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Sinister Strike</Name><Default>false</Default><SpellID>1752</SpellID><Actions></Actions><Lua>local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )

if DeepInsightUP then

	if CPs &amp;lt; 5 then
	
		BGTrigger()
		return true
		
	end
	
elseif not DeepInsightUP then

	if Anti then
	
		if AntiCharges &amp;lt; 5 or ( AntiCharges &amp;gt; 4 and CPs &amp;lt; 5 ) then
		
			BGTrigger()
			return true
			
		end
	 
	else
	
		BGTrigger()
		return true
		
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Arcane Torrent</Name><Default>false</Default><SpellID>25046</SpellID><Actions></Actions><Lua>local CurrentEnergy	= UnitPower(&amp;quot;player&amp;quot;)

if CurrentEnergy &amp;lt; 75 and nv_CDs then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions>/use 10</Actions><Lua>local slotId 					  = GetInventorySlotInfo(&amp;quot;HandsSlot&amp;quot;)
local itemId 					  = GetInventoryItemID(&amp;quot;player&amp;quot;, slotId)
local startTime, duration, enable = GetItemCooldown(itemId)

if enable == 1 and nv_CDs then

	if startTime == 0 then
	
		return true
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Vanish</Name><Default>false</Default><SpellID>1856</SpellID><Actions></Actions><Lua>local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local AdrenalinRushUP 		= Buff_Check( 13750, &amp;quot;player&amp;quot; )
local DeepInsightUP			= Buff_Check( 84747, &amp;quot;player&amp;quot; )
local CurrentEnergy			= UnitPower(&amp;quot;player&amp;quot;)

if nv_CDs and not PQR_UnitFacing(&amp;quot;target&amp;quot;, &amp;quot;player&amp;quot;) and CurrentEnergy &amp;lt; 20 then

	if not ShadowBladesUP and not AdrenalinRushUP and ( DeepInsightUP and CPs &amp;lt; 4 ) then
	
	
	elseif not ShadowBladesUP and not AdrenalinRushUP then
	
		if Anti then
		
			if AntiCharges &amp;lt; 4 or CPs &amp;lt; 4 or ( CPs == 4 and AntiCharges &amp;lt; 5 ) then
			
				return true
			
			end
				
		else
		
			return true
		
		end
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Combat : Ambush</Name><Default>false</Default><SpellID>8676</SpellID><Actions></Actions><Lua>return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>All : Preparation</Name><Default>false</Default><SpellID>14185</SpellID><Actions></Actions><Lua>local start, duration, enabled = GetSpellCooldown(1856)

if duration ~= 0 and (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and SafeToCastCD() and PQR_SpellAvailable(14185) then

	local vanishCD = duration + start - GetTime()
	if  vanishCD &amp;gt; 60 and vanishCD &amp;lt; 118 then
	
		return true
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Init</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not PQR_LoadLua(&amp;quot;PQR_notvalid.lua&amp;quot;) then
	PQR_WriteToChat(&amp;quot;PQR_notvalid.lua is missing. Rotation has been stopped.&amp;quot;, &amp;quot;Error&amp;quot;)
  	PQR_StopRotation()
  	return true
end

if PQR_RotationStarted then
	CD_Off = &amp;quot;Off&amp;quot;
	CD_BossOnly = &amp;quot;Boss&amp;quot;
	CD_On = &amp;quot;On&amp;quot;
	nv_CDs = CD_Off
	nv_multi = false
	nv_feint = false
	combopoints = 0
	restealth = false
	
	-- Keybind configuration 
	-- (options: LeftShift, LeftControl, LeftAlt, RightShift, RightControl, RightAlt, LeftMouseButton, RightMouseButton, MiddleMouseButton, MouseButton4, MouseButton5)
	local nv_binds = {
		pause     = &amp;quot;LeftShift&amp;quot;,
		cooldowns = &amp;quot;RightShift&amp;quot;,
		feint 	  = &amp;quot;LeftControl&amp;quot;,
		aoe 	  = &amp;quot;RightControl&amp;quot;,
		fok 	  = &amp;quot;LeftAlt&amp;quot;,
	}
	
	-- Register keybinds
	IsPauseBind = _G['Is'..nv_binds["pause"]..'KeyDown']
	IsCDsBind   = _G['Is'..nv_binds["cooldowns"]..'KeyDown']
	IsFeintBind = _G['Is'..nv_binds["feint"]..'KeyDown']
	IsAoEBind   = _G['Is'..nv_binds["aoe"]..'KeyDown']
	IsFoKBind   = _G['Is'..nv_binds["fok"]..'KeyDown']
	
	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Cooldowns: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	if nv_multi then
		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;AoE: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	if nv_feint then
		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Feint: Enabled&amp;quot;,nil,&amp;quot;00FF00&amp;quot;)
	else
		PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		PQR_Event(&amp;quot;PQR_Text&amp;quot;,&amp;quot;Feint: Disabled&amp;quot;,nil,&amp;quot;FF0000&amp;quot;)
	end
	
	
	-- Create our event handler function
	function EventHandler(self, event, ...)

		-- Keeping track of combo points
		if event == &amp;quot;UNIT_COMBO_POINTS&amp;quot; then
			combopoints = GetComboPoints(&amp;quot;player&amp;quot;)
		end

		-- Automatic restealth
		if event == &amp;quot;PLAYER_REGEN_ENABLED&amp;quot; then
			if UnitBuffID(&amp;quot;player&amp;quot;, 1856) then return end
			print(&amp;quot;\124cFF15E61CRe-stealthing&amp;quot;);
			restealth = GetTime()
		end

		if event == &amp;quot;PLAYER_TARGET_CHANGED&amp;quot; or event == &amp;quot;PLAYER_REGEN_ENABLED&amp;quot; then
			if UnitBuffID(&amp;quot;player&amp;quot;, 1856) then return end
			-- Recuperate / Slice and Dice
			--if not UnitAffectingCombat(&amp;quot;player&amp;quot;) then return end
			if UnitIsUnit(&amp;quot;target&amp;quot;, &amp;quot;focus&amp;quot;) then return end
			-- Recupe if not full health
			local s, _, _, _, _, _, sexpire = UnitBuffID(&amp;quot;player&amp;quot;, 73651)
			sexpire = (sexpire ~= nil) and sexpire or 0
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (sexpire - GetTime()) &amp;lt; 6 and (UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)) &amp;lt; 1 then
				CastSpellByID(73651)
				return
			end
			local r, _, _, _, _, _, rexpire = UnitBuffID(&amp;quot;player&amp;quot;, 5171)
			rexpire = (rexpire ~= nil) and rexpire or 0
			-- Only cast if we have less than 5 combo points or redirect is on cooldown
			--if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (12 + (combopoints * 6)) &amp;gt; (rexpire - GetTime()) then
			if combopoints &amp;gt; 0 and (redirect ~= 0 or combopoints &amp;lt; 5) and (rexpire - GetTime()) &lt; 3 then
				CastSpellByID(5171)
				return
			end
		end
	end
  
	if not OurFrame then

	-- Create our frame and bind combat log events
	frame = CreateFrame(&amp;quot;FRAME&amp;quot;, &amp;quot;OurFrame&amp;quot;)
	frame:RegisterEvent(&amp;quot;UNIT_COMBO_POINTS&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_REGEN_ENABLED&amp;quot;)
	frame:RegisterEvent(&amp;quot;PLAYER_TARGET_CHANGED&amp;quot;)
	frame:SetScript(&amp;quot;OnEvent&amp;quot;, EventHandler)

	print(&amp;quot;Loaded event handler&amp;quot;)

	end
	
	PQR_RotationStarted = false

end

-- Check for restealth
if UnitBuffID(&amp;quot;player&amp;quot;, 1784)
   or UnitBuffID(&amp;quot;player&amp;quot;, 11327)
   or UnitIsDeadOrGhost(&amp;quot;Player&amp;quot;)
   or UnitAffectingCombat(&amp;quot;player&amp;quot;)
   or IsMounted()
   or UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil
then 
	restealth = false
end

-- Target enemy
if UnitAffectingCombat(&amp;quot;player&amp;quot;) and not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) and not UnitExists("boss1") then
	TargetNearestEnemy()
end

--local targetswitch = &amp;quot;Sulik&amp;apos;shor&amp;quot;
--print(&amp;quot;searching for&amp;quot;, targetswitch)
--RunMacroText(&amp;quot;/target &amp;quot;..targetswitch)
--if UnitName(&amp;quot;target&amp;quot;) == targetswitch then
--	RunMacroText(&amp;quot;/startattack&amp;quot;)
--end

-- Maybe I&amp;apos;ll add slash commands later
if IsPauseBind() or IsMounted() then

	return true 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Cooldowns</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Cooldowns

if not nv_CDsKeyDown then nv_CDsKeyDown = 0 end

if IsCDsBind() and GetTime() - nv_CDsKeyDown &amp;gt; 0.2 then
	nv_CDsKeyDown = GetTime()
	
	if nv_CDs == CD_On then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Boss Only&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		nv_CDs = CD_BossOnly
	elseif nv_CDs == CD_BossOnly then
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		nv_CDs = CD_Off
	else
		PQR_WriteToChat(&amp;quot;Cooldowns: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)
		nv_CDs = CD_On
	end
end

if not nv_AoEKeyDown then nv_AoEKeyDown = 0 end

if IsAoEBind() and GetTime() - nv_AoEKeyDown &amp;gt; 0.2 then
	nv_AoEKeyDown = GetTime()
	
	if nv_multi then 

    	nv_multi  = false 
		PQR_WriteToChat(&amp;quot;AoE: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)

  	else 
    	
		nv_multi  = true 
		PQR_WriteToChat(&amp;quot;AoE: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)

  	end
end

if not nv_FeintKeyDown then nv_FeintKeyDown = 0 end
if IsFeintBind() and GetTime() - nv_FeintKeyDown &amp;gt; 0.2 then
	nv_FeintKeyDown = GetTime()
	
	if nv_feint then 

    	nv_feint  = false 
		PQR_WriteToChat(&amp;quot;Feint: |cFFFF0000Disabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)

  	else 
    	
		nv_feint  = true 
		PQR_WriteToChat(&amp;quot;Feint: |cFF00FF00Enabled&amp;quot;,&amp;quot;Rogue : Assassination&amp;quot;)

  	end
end

</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Start</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local Shadowstep 		= Buff_Check( 36554, &amp;quot;player&amp;quot; )
if UnitIsDead(&amp;quot;target&amp;quot;)
or not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)
or ( (not UnitAffectingCombat(&amp;quot;player&amp;quot;) and not Shadowstep) and not UnitIsPlayer(&amp;quot;target&amp;quot;) and not Buff_Check( 115193, &amp;quot;player&amp;quot; ))
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if SafeToCastCD() and not PQR_SpellAvailable(121471) and not PQR_SpellAvailable(79140) then
	UseItem(10)
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Arcane Torrent</Name><Default>false</Default><SpellID>25046</SpellID><Actions></Actions><Lua>local CurrentEnergy	= UnitPower(&amp;quot;player&amp;quot;)

if CurrentEnergy &amp;lt; 75 and (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and SafeToCastCD() then

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Racials</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>
if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and SafeToCastCD() then

	-- Troll: Berserking    
	if IsPlayerSpell(26297) and PQR_SpellAvailable(26297) then
		CastSpellByName(GetSpellInfo(26297),&amp;quot;player&amp;quot;)
	end
	-- Orc: Blood Fury
	if IsPlayerSpell(20572) and PQR_SpellAvailable(20572) then
		CastSpellByName(GetSpellInfo(20572),&amp;quot;player&amp;quot;)
	end 
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Vanish</Name><Default>false</Default><SpellID>1856</SpellID><Actions></Actions><Lua>local CPs 					= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local CurrentEnergy			= UnitPower(&amp;quot;player&amp;quot;)
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );

if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and SafeToCastCD() and not nv_multi and CPs &amp;lt; 5 and CurrentEnergy &amp;lt; 60 and not PQR_SpellAvailable(121471) and not Blindside and (not Env or EnvTimeLeft &amp;lt; 1) and Rup and RupTimeLeft &amp;gt; 2 then

	if not ShadowBladesUP  then

		return true
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Ambush</Name><Default>false</Default><SpellID>8676</SpellID><Actions></Actions><Lua>return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Shadow Blades</Name><Default>false</Default><SpellID>121471</SpellID><Actions></Actions><Lua>local CurrentEnergy = UnitPower(&amp;quot;player&amp;quot;)
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local VenStart, VenDuration = GetSpellCooldown(79140);
if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and (VenStart + VenDuration - GetTime()) &amp;lt; 119.1 and Rup and RupTimeLeft &amp;gt; 2 and SafeToCastCD() then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Slice and Dice</Name><Default>false</Default><SpellID>5171</SpellID><Actions></Actions><Lua>local SnD, SnDTimeLeft = Buff_Check( 5171, &amp;quot;player&amp;quot; )
local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

if SnD and CPs &amp;gt; 0 then

	if SnDTimeLeft &amp;lt; 2 then
	
		return true
		
	end

elseif not SnD and CPs &amp;gt; 0 then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Dispatch Energy</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CurHealth		 	= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))

if (CurHealth &amp;lt; 35 or Blindside) and not van then

	if CurrentEnergy &amp;gt; 110 then
	
		if Rup then
		
			if RupTimeLeft &amp;lt; 2 then
			
				CastSpellByName( GetSpellInfo(111240), nil )
				return true
			
			end
		
		else
		
			CastSpellByName( GetSpellInfo(111240), nil )
			return true
		
		end
	
	end
	
	-- 5cps with dispatch proc
	if Blindside and CPs &amp;gt; 4 and Rup and RupTimeLeft &amp;gt; 3 and Env and (not Anti or ((ShadowBladesUP and AntiCharges &amp;lt; 3) or (not ShadowBladesUP and AntiCharges &amp;lt; 4))) and (CurrentEnergy + (EnergyRegen * 1.5)) &amp;lt; 100 then
		CastSpellByName( GetSpellInfo(111240), nil )
		return true
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Mutilate Energy</Name><Default>false</Default><SpellID>1329</SpellID><Actions></Actions><Lua>local CurHealth		 	= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

if CurHealth &amp;gt; 35 then

	if CurrentEnergy &amp;gt; 110 then
	
		if Rup then
		
			if RupTimeLeft &amp;lt; 2 then
			
				return true
			
			end
		
		else
			return true
		
		end
	
	end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Rupture</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )

--if Rup and ttd() &amp;gt;= 25 then
if Rup then

	if CPs &amp;gt; 0 and RupTimeLeft &amp;lt; 2 then
	
		return true
		
	end
		
else

	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Feint</Name><Default>false</Default><SpellID>1966</SpellID><Actions></Actions><Lua>local FeintUP = Buff_Check( 1966, &amp;quot;player&amp;quot; )

if nv_feint and not FeintUP then

return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Vendetta</Name><Default>false</Default><SpellID>79140</SpellID><Actions></Actions><Lua>local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;) 
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
if (nv_CDs == CD_On or (nv_CDs == CD_BossOnly and SpecialUnit())) and SafeToCastCD() and Rup and RupTimeLeft &amp;gt; 2 then

	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Envenom</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Ven, VenTimeLeft 	= Debuff_Check( 79140, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local ShadowBladesUP, SBTimeLeft	= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local EnergyAfterEnvenom = CurrentEnergy + (EnergyRegen * 1.5)

--print(ttd())

-- Pooling
if CPs &amp;gt; 4 and Rup and not ShadowBladesUP and (not Anti or AntiCharges &amp;lt; 4) then

	if RupTimeLeft &amp;lt; 6 and RupTimeLeft &amp;gt; 3 and (CurrentEnergy + (EnergyRegen * (RupTimeLeft - 2)) + 25) &amp;lt; 110 then
		return
	end
	
	if RupTimeLeft &amp;lt; 3 or (RupTimeLeft &amp;gt; 3 and CurrentEnergy &amp;lt; 60 and not Ven) then
		return
	end
	
end

if CPs &amp;gt; 4 and (not Env or EnvTimeLeft &amp;lt; 1 or (EnergyAfterEnvenom &amp;gt; 100 and (Anti and AntiCharges &amp;gt; 2)) or (ShadowBladesUP and SBTimeLeft &amp;gt; 1 and (EnergyAfterEnvenom &amp;lt; 100 or (Anti and AntiCharges &amp;gt; 2))))  then
	CastSpellByName( GetSpellInfo(32645), nil )
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Envenom SnD</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local SnD, SnDTimeLeft = Buff_Check( 5171, &amp;quot;player&amp;quot; )

if CPs &amp;gt;= 2 and SnD and SnDTimeLeft &amp;lt; 3 then

	CastSpellByName( GetSpellInfo(32645), nil )
	return true
	
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Tricks of the Trade</Name><Default>false</Default><SpellID>57934</SpellID><Actions></Actions><Lua>local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
if UnitExists(&amp;quot;focus&amp;quot;) and UnitInParty(&amp;quot;focus&amp;quot;) and not UnitIsDead("focus") and not PQR_IsOutOfSight(&amp;quot;focus&amp;quot;, 1) and Rup and RupTimeLeft &amp;gt; 3 then

	PQR_CustomTarget = &amp;quot;focus&amp;quot;
	--PQR_WriteToChat(&amp;quot;Casted Tricks on: &amp;quot;..UnitName(&amp;quot;focus&amp;quot;),&amp;quot;Rogue : Assassination&amp;quot;)
	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Fan of Knives</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );

if (IsFoKBind() or nv_multi) and (CPs &amp;lt; 5 or (Env and EnvTimeLeft &amp;gt; 2 and (not Anti or AntiCharges &amp;lt; 5))) and not van and CheckInteractDistance("target", 3) then

	CastSpellByName( GetSpellInfo(51723), nil )
	return true

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Dispatch</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local CPs 				= GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local CurHealth		 	= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
local CurrentEnergy		= UnitPower(&amp;quot;player&amp;quot;)
local EnergyRegen = select(2, GetPowerRegen(&amp;quot;player&amp;quot;))
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )
local ShadowBladesUP 		= Buff_Check( 121471, &amp;quot;player&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )

if Blindside
	and not van
	and (CPs &amp;lt; 5
	or (Env
		and EnvTimeLeft &amp;gt; 2 
		and (not Anti
			or (ShadowBladesUP and AntiCharges &amp;lt; 3 and (CurrentEnergy + (EnergyRegen * 1.5)) &amp;lt; 100)
			or (not ShadowBladesUP and AntiCharges &amp;lt; 4)
			)
		)
	)
then

	CastSpellByName( GetSpellInfo(111240), nil )
	return true

elseif CurHealth &amp;lt; 35
	and not van
	and (CPs &amp;lt; 5 
	or (Env 
		and EnvTimeLeft &amp;gt; 2
		and (not Anti
			or (ShadowBladesUP and AntiCharges &amp;lt; 3)
			or (not ShadowBladesUP and AntiCharges &amp;lt; 4)
			)
		)
	)
then

	CastSpellByName( GetSpellInfo(111240), nil )
	return true

end
</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Mutilate</Name><Default>false</Default><SpellID>1329</SpellID><Actions></Actions><Lua>local CPs = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
local van = Buff_Check( 115193, &amp;quot;player&amp;quot; );
local vstart, vduration = GetSpellCooldown(1856);
local Anti, _, AntiCharges 	= Buff_Check( 115189, &amp;quot;player&amp;quot; )
local Env, EnvTimeLeft = Buff_Check( 32645, &amp;quot;player&amp;quot; )
local Rup, RupTimeLeft 	= Debuff_Check( 1943, &amp;quot;target&amp;quot;, &amp;quot;PLAYER&amp;quot; )
local Blindside 		= Buff_Check( 121153, &amp;quot;player&amp;quot; )

if van and (vstart + vduration - GetTime()) &amp;gt; 119.9 then return end

if CPs &amp;lt; 5 or (Env and EnvTimeLeft &amp;gt; 2 and (not Anti or AntiCharges &amp;lt; 3)) then return true end
</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Stealth</Name><Default>false</Default><SpellID>1784</SpellID><Actions></Actions><Lua>if restealth and (GetTime() - restealth) &amp;gt; 3 and 0 == GetNumLootItems() and PQR_SpellAvailable(1784) then
	--print(GetSpellCooldown(1784))
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Redirect</Name><Default>false</Default><SpellID>73981</SpellID><Actions></Actions><Lua>local cpstarget = GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
if combopoints &amp;gt; cpstarget
	and combopoints &gt;= 2
	and not IsStealthed()
	and UnitExists(&amp;quot;target&amp;quot;)
	and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
	and 1 == IsSpellInRange(GetSpellInfo(73981), "target")
then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assassination : Poisons</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil then return end
local DP = 1
local WP = 0
local LP = 1
local CP = 0
local MNP = 0
local PARP = 0

MHPOISON = nil
if ( DP ~= 1 and WP == 1 ) then
	MHPOISON = 8679
elseif ( DP == 1 and WP ~= 1 ) then
	MHPOISON = 2823
elseif ( DP == 1 and WP == 1 ) then
	return false
elseif ( DP ~= 1 and WP ~= 1 ) then
	return false
end

OHPOISON = nil
if ( LP == 1 and CP ~= 1 and MNP ~= 1 and PARP ~= 1 ) then
	OHPOISON = 108211
elseif ( LP ~= 1 and CP == 1 and MNP ~= 1 and PARP ~= 1 ) then
	OHPOISON = 3408
elseif ( LP ~= 1 and CP ~= 1 and MNP == 1 and PARP ~= 1 ) then
	OHPOISON = 5761
elseif ( LP ~= 1 and CP ~= 1 and MNP ~= 1 and PARP == 1 ) then
	OHPOISON = 108215
elseif ( ( LP == 1 and CP == 1 and MNP ~= 1 and PARP ~= 1 ) or
		 ( LP == 1 and CP ~= 1 and MNP == 1 and PARP ~= 1 ) or
		 ( LP == 1 and CP ~= 1 and MNP ~= 1 and PARP == 1 ) or
		 ( LP ~= 1 and CP == 1 and MNP == 1 and PARP ~= 1 ) or
		 ( LP ~= 1 and CP == 1 and MNP ~= 1 and PARP == 1 ) or
		 ( LP ~= 1 and CP ~= 1 and MNP == 1 and PARP == 1 ) or
		 ( LP ~= 1 and CP ~= 1 and MNP ~= 1 and PARP ~= 1 ) ) then
	return false
end

if not IsMounted() then
-- Check to Apply Main hand poison
if not UnitBuffID(&amp;quot;player&amp;quot;, MHPOISON) then
	CastSpellByName(GetSpellInfo(MHPOISON))
end
-- Check to Apply Leeching Poison
if not UnitBuffID(&amp;quot;player&amp;quot;, OHPOISON) then
	CastSpellByName(GetSpellInfo(OHPOISON))
end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></ROGUE>