function Buff_Check( SpellID, TargetID )

	if UnitBuffID(TargetID, SpellID) then
	
		local StackCount = select(4, UnitBuffID(TargetID, SpellID) )
		local Duration	 = select(7, UnitBuffID(TargetID, SpellID) )
		
		return true, Duration - GetTime(), StackCount
		
	else
	
		return false, nil, nil
		
	end

end

function Debuff_Check( SpellID, TargetID, Filter )

	if UnitDebuffID( TargetID, SpellID, Filter ) then
	
		local Duration = select(7, UnitDebuffID( TargetID, SpellID, Filter ) )
		
		return true, Duration - GetTime()
		
	else
	
		return false, nil, nil
		
	end

end

function BGTrigger()

	if Buff_Check( 84746, "player" ) then
	
		BGStack = BGStack + 1
		return true
	
	else
	
		if not ( BGStacks == 0 ) then
		
			BGStack = 0
			return true
		
		end
	
	end

end

function UseItem(slot)
	local _, Cooldown, Ready = GetInventoryItemCooldown("player", slot)
	if Cooldown == 0 and Ready == 1
	 and UnitChannelInfo("player") == nil
	 and UnitAffectingCombat("player") ~= nil
	 and not IsStealthed()
	then
		UseInventoryItem(slot)
		return true
	end
end

function SafeToCastCD()
	if not IsStealthed() and IsSpellInRange(GetSpellInfo(1329), "target") == 1 then
		return true
	else
		return false
	end
end

function IsLeftMouseButtonKeyDown()
	return IsMouseButtonDown(1)
end

function IsRightMouseButtonKeyDown()
	return IsMouseButtonDown(2)
end

function IsMiddleMouseButtonKeyDown()
	return IsMouseButtonDown(3)
end

function IsMouseButton4KeyDown()
	return IsMouseButtonDown(4)
end

function IsMouseButton5KeyDown()
	return IsMouseButtonDown(5)
end

--- Round
function round2(num, idp)
  mult = 10^(idp or 0)
  return math.floor(num * mult + 0.5) / mult
end

if currtar == nil then
	currtar = 0
end
if thpstart == nil then
	thpstart = 0
end
if timestart == nil then
	timestart = 0
end
if timeToDie == nil then
	timeToDie = 0
end

--- Time to Die
function ttd(unit)
	unit = unit or "target";
	if UnitExists(unit) and not UnitIsDeadOrGhost(unit) then
		if currtar ~= UnitGUID(unit) then
			currtar = UnitGUID(unit)
		end
		if thpstart==0 and timestart==0 then
			thpstart = UnitHealth(unit)
			timestart = GetTime()
		else
			thpcurr = UnitHealth(unit)
			timecurr = GetTime()
			if thpcurr >= thpstart then
				thpstart = thpcurr
				timeToDie = 999
			else
				timeToDie = round2(thpcurr/((thpstart - thpcurr) / (timecurr - timestart)),2)
			end
		end
	elseif not UnitExists(unit) or currtar ~= UnitGUID(unit) then
		currtar = 0 
		thpstart = 0
		timestart = 0
		timeToDie = 0
	end
	return timeToDie
end	

--------------------------------------------------
---------------SPECIAL UNIT TABLE-----------------
--------------------------------------------------
PQ_BossUnits = {
	-- Cataclysm Dungeons --
	-- Abyssal Maw: Throne of the Tides
	40586,		-- Lady Naz'jar
	40765,		-- Commander Ulthok
	40825,		-- Erunak Stonespeaker
	40788,		-- Mindbender Ghur'sha
	42172,		-- Ozumat
	-- Blackrock Caverns
	39665,		-- Rom'ogg Bonecrusher
	39679,		-- Corla, Herald of Twilight
	39698,		-- Karsh Steelbender
	39700,		-- Beauty
	39705,		-- Ascendant Lord Obsidius
	-- The Stonecore
	43438,		-- Corborus
	43214,		-- Slabhide
	42188,		-- Ozruk
	42333,		-- High Priestess Azil
	-- The Vortex Pinnacle
	43878,		-- Grand Vizier Ertan
	43873,		-- Altairus
	43875,		-- Asaad
	-- Grim Batol
	39625,		-- General Umbriss
	40177,		-- Forgemaster Throngus
	40319,		-- Drahga Shadowburner
	40484,		-- Erudax
	-- Halls of Origination
	39425,		-- Temple Guardian Anhuur
	39428,		-- Earthrager Ptah
	39788,		-- Anraphet
	39587,		-- Isiset
	39731,		-- Ammunae
	39732,		-- Setesh
	39378,		-- Rajh
	-- Lost City of the Tol'vir
	44577,		-- General Husam
	43612,		-- High Prophet Barim
	43614,		-- Lockmaw
	49045,		-- Augh
	44819,		-- Siamat
	-- Zul'Aman
	23574,		-- Akil'zon
	23576,		-- Nalorakk
	23578,		-- Jan'alai
	23577,		-- Halazzi
	24239,		-- Hex Lord Malacrass
	23863,		-- Daakara
	-- Zul'Gurub
	52155,		-- High Priest Venoxis
	52151,		-- Bloodlord Mandokir
	52271,		-- Edge of Madness
	52059,		-- High Priestess Kilnara
	52053,		-- Zanzil
	52148,		-- Jin'do the Godbreaker
	-- End Time
	54431,		-- Echo of Baine
	54445,		-- Echo of Jaina
	54123,		-- Echo of Sylvanas
	54544,		-- Echo of Tyrande
	54432,		-- Murozond
	-- Hour of Twilight
	54590,		-- Arcurion
	54968,		-- Asira Dawnslayer
	54938,		-- Archbishop Benedictus
	-- Well of Eternity
	55085,		-- Peroth'arn
	54853,		-- Queen Azshara
	54969,		-- Mannoroth
	55419,		-- Captain Varo'then
	
	-- Mists of Pandaria Dungeons --
	-- Scarlet Halls
	59303,		-- Houndmaster Braun
	58632,		-- Armsmaster Harlan
	59150,		-- Flameweaver Koegler
	-- Scarlet Monastery
	59789,		-- Thalnos the Soulrender
	59223,		-- Brother Korloff
	3977,		-- High Inquisitor Whitemane
	60040,		-- Commander Durand
	-- Scholomance
	58633,		-- Instructor Chillheart
	59184,		-- Jandice Barov
	59153,		-- Rattlegore
	58722,		-- Lilian Voss
	58791,		-- Lilian's Soul
	59080,		-- Darkmaster Gandling
	-- Stormstout Brewery
	56637,		-- Ook-Ook
	56717,		-- Hoptallus
	59479,		-- Yan-Zhu the Uncasked
	-- Tempe of the Jade Serpent
	56448,		-- Wise Mari
	56843,		-- Lorewalker Stonestep
	59051,		-- Strife
	59726,		-- Peril
	58826,		-- Zao Sunseeker
	56732,		-- Liu Flameheart
	56762,		-- Yu'lon
	56439,		-- Sha of Doubt
	-- Mogu'shan Palace
	61444,		-- Ming the Cunning
	61442,		-- Kuai the Brute
	61445,		-- Haiyan the Unstoppable
	61243,		-- Gekkan
	61398,		-- Xin the Weaponmaster
	-- Shado-Pan Monastery
	56747,		-- Gu Cloudstrike
	56541,		-- Master Snowdrift
	56719,		-- Sha of Violence
	56884,		-- Taran Zhu
	-- Gate of the Setting Sun
	56906,		-- Saboteur Kip'tilak
	56589,		-- Striker Ga'dok
	56636,		-- Commander Ri'mok
	56877,		-- Raigonn
	-- Siege of Niuzao Temple
	61567,		-- Vizier Jin'bak
	61634,		-- Commander Vo'jak
	61485,		-- General Pa'valak
	62205,		-- Wing Leader Ner'onok

	-- Training Dummies --
	46647,		-- Level 85 Training Dummy
	67127		-- Level 90 Training Dummy
}

SpecialUnit = nil
function SpecialUnit()
	local PQ_BossUnits = PQ_BossUnits
	
	if UnitExists("target") then
		local npcID = tonumber(UnitGUID("target"):sub(6,10), 16)
		
		-- Use Cooldowns on Opposing Faction members
		--if UnitIsPlayer("target") then
			--if UnitFactionGroup("player") ~= UnitFactionGroup("target") then return true end
		--end
		
		-- Dungeons & Raids
		if npcID == 69465 and not Buff_Check(138002, "player") then return false end
		if UnitLevel("target") == -1 then return true else
			for i=1,#PQ_BossUnits do
				if PQ_BossUnits[i] == npcID then return true end
			end
			return false
		end
	else return false end
end