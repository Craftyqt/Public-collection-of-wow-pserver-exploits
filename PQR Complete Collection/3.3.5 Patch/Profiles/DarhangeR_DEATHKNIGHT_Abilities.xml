<?xml version="1.0" encoding="utf-8" ?><DEATHKNIGHT><Ability><Name>B:Dancing Rune Weapon</Name><Default>false</Default><SpellID>49028</SpellID><Actions></Actions><Lua>local runic_power = UnitPower(&amp;quot;player&amp;quot;)

if runpow(49028)
and UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitExists(&amp;quot;target&amp;quot;)
and not CooldownRemains(49028)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Death and Decay</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsLeftShiftKeyDown() 
and not GetCurrentKeyBoardFocus() 
and not UnitChannelInfo(&amp;quot;player&amp;quot;) 
then
  CastSpellByID(49938)
  if SpellIsTargeting() then CameraOrSelectOrMoveStart() CameraOrSelectOrMoveStop() end  
  return true
end</Lua><RecastDelay>500</RecastDelay><Target>Click</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Howling Blast</Name><Default>false</Default><SpellID>51411</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
and UnitBuffID(&amp;quot;player&amp;quot;, 59052)
and not CooldownRemains(51411)
and IsSpellInRange(GetSpellInfo(51411), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Death Coil</Name><Default>false</Default><SpellID>49895</SpellID><Actions></Actions><Lua>local runic_power = UnitPower(&amp;quot;player&amp;quot;)

if runpow(49895)
and UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49895), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Death Coil (Max RP)</Name><Default>false</Default><SpellID>49895</SpellID><Actions></Actions><Lua>if UnitPowerMax(&amp;quot;player&amp;quot;) == UnitPower(&amp;quot;player&amp;quot;)
and UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49895), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Death Strike</Name><Default>false</Default><SpellID>49924</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
and UnitDebuffID(&amp;quot;target&amp;quot;, 55095, &amp;quot;player&amp;quot;) ~= nil
and UnitDebuffID(&amp;quot;target&amp;quot;, 55078, &amp;quot;player&amp;quot;) ~= nil
and IsSpellInRange(GetSpellInfo(49924), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Rune Strike</Name><Default>false</Default><SpellID>56815</SpellID><Actions></Actions><Lua>local runic_power = UnitPower(&amp;quot;player&amp;quot;)

if valid(&amp;quot;target&amp;quot;, 56815)
and runpow(56815)
and UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Heart Strike</Name><Default>false</Default><SpellID>55262</SpellID><Actions></Actions><Lua>local BR = select(2, BloodRuneCD())

if BR &amp;gt;= 1
and UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Hotkeys --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not leftkeydown then leftkeydown = 0 end

if IsLeftControlKeyDown()  and GetTime() - leftkeydown &amp;gt; 1 then
	leftkeydown = GetTime()
  	if StopRota  then
		StopRota  = false 
		PQR_WriteToChat(&amp;quot;Rotation \124cFF15E615reenabled!&amp;quot;)
  	else 
		StopRota  = true 
		PQR_WriteToChat(&amp;quot;Rotation \124cFFE61515stopped!&amp;quot;)
  	end
end

if modtime == nil then
	modtime = 0
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Start Fight --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if StopRota
or UnitIsDeadOrGhost(&amp;quot;player&amp;quot;)
or IsMounted()
or UnitChannelInfo(&amp;quot;player&amp;quot;) ~= nil
or UnitCastingInfo(&amp;quot;player&amp;quot;) ~= nil
or UnitBuff(&amp;quot;player&amp;quot;, &amp;quot;Drink&amp;quot;)
or UnitBuff(&amp;quot;player&amp;quot;, &amp;quot;Food&amp;quot;)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Deathchill</Name><Default>false</Default><SpellID>49796</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,51124) == nil 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Summon Gargoyle</Name><Default>false</Default><SpellID>49206</SpellID><Actions></Actions><Lua>local runic_power = UnitPower(&amp;quot;player&amp;quot;)

if runpow(49206)
and UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitExists(&amp;quot;target&amp;quot;)
and not CooldownRemains(49206)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Empower Rune Weapon</Name><Default>false</Default><SpellID>47568</SpellID><Actions></Actions><Lua>local _,_,R1 = GetRuneCooldown(1)
local _,_,R2 = GetRuneCooldown(2)
local _,_,R3 = GetRuneCooldown(3)
local _,_,R4 = GetRuneCooldown(4)
local _,_,R5 = GetRuneCooldown(5)
local _,_,R6 = GetRuneCooldown(6)
local levelCheck = UnitLevel(&amp;quot;target&amp;quot;)

if levelCheck ~= -1 then
	return false
else
	if  R1 == false and R2 == false and R3 == false and R4 == false and R5 == false and R6 == false then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Offensive Spells --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitAffectingCombat(&amp;quot;player&amp;quot;) == nil
or ( not UnitAffectingCombat(&amp;quot;target&amp;quot;) and not UnitIsPlayer(&amp;quot;target&amp;quot;) )
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Horn of Winter</Name><Default>false</Default><SpellID>57623</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,58646,65991,58643,31634,37223) == nil
and UnitBuffID(&amp;quot;player&amp;quot;,57623) ~= nil then return false else return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Use:Mouseover Skill</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitAffectingCombat(&amp;quot;player&amp;quot;) and IsMouseButtonDown()
	then RunMacroText(&amp;quot;/click &amp;quot;..GetMouseFocus():GetName()) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Frost Presence</Name><Default>false</Default><SpellID>48263</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,48263) ~= nil then return false else return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Howling Blast (AOE)</Name><Default>false</Default><SpellID>51411</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
and not CooldownRemains(51411)
and IsSpellInRange(GetSpellInfo(51411), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Horn of Winter (Tank)</Name><Default>false</Default><SpellID>57623</SpellID><Actions></Actions><Lua>local Horn, _, _, _, _, _, hwexpire = UnitBuffID(&amp;quot;player&amp;quot;, 57623)

if Horn ~= nill then
	hwexpire =(hwexpire - GetTime())
	if hwexpire &amp;lt; 5 then
		return true
	end
else
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Scourge Strike</Name><Default>false</Default><SpellID>55271</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
and UnitDebuffID(&amp;quot;target&amp;quot;, 55095, &amp;quot;player&amp;quot;) ~= nil
and UnitDebuffID(&amp;quot;target&amp;quot;, 55078, &amp;quot;player&amp;quot;) ~= nil
and IsSpellInRange(GetSpellInfo(55271), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Rune Tap</Name><Default>false</Default><SpellID>48982</SpellID><Actions>/use Blood Tap</Actions><Lua>local BR = select(2, BloodRuneCD())

if BR &amp;gt;= 1
and 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 80
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Raise Dead</Name><Default>false</Default><SpellID>46584</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;pet&amp;quot;) == nil
and PQR_IsCastingSpell(46584) == false
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Blood Boil</Name><Default>false</Default><SpellID>49941</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Blood Tap</Name><Default>false</Default><SpellID>45529</SpellID><Actions></Actions><Lua>local _,_,R1 = GetRuneCooldown(1)
local _,_,R2 = GetRuneCooldown(2)


if  R1 == false or R2 == false then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Blood Presence</Name><Default>false</Default><SpellID>48266</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,48266) ~= nil then return false else return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Blood Strike</Name><Default>false</Default><SpellID>49930</SpellID><Actions></Actions><Lua>local BR = select(2, BloodRuneCD())

if BR &amp;gt;= 1
and UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Hysteria</Name><Default>false</Default><SpellID>49016</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
and UnitLevel(&amp;quot;target&amp;quot;) == -1
and not CooldownRemains(49016) then
	if UnitExists(&amp;quot;focus&amp;quot;) == nil and not UnitBuffID(&amp;quot;player&amp;quot;, 49016) then
		CastSpellByID(49016, &amp;quot;player&amp;quot;) 
		return true	
	elseif UnitExists(&amp;quot;focus&amp;quot;) ~= nil and not UnitBuffID(&amp;quot;focus&amp;quot;, 49016) then
		CastSpellByID(49016, &amp;quot;focus&amp;quot;)
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Bone Shield</Name><Default>false</Default><SpellID>49222</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,49222) == nil
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Chains of Ice</Name><Default>false</Default><SpellID>45524</SpellID><Actions></Actions><Lua>if IsLeftAltKeyDown( ) and GetCurrentKeyBoardFocus() == nil then
	if UnitIsEnemy(&amp;quot;player&amp;quot;, &amp;quot;mouseover&amp;quot;) and UnitIsDead(&amp;quot;mouseover&amp;quot;) == nil then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Frost Strike</Name><Default>false</Default><SpellID>55268</SpellID><Actions></Actions><Lua>local runic_power = UnitPower(&amp;quot;player&amp;quot;)

if runpow(55268)
and UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Frost Strike (TM)</Name><Default>false</Default><SpellID>55268</SpellID><Actions></Actions><Lua>local runic_power = UnitPower(&amp;quot;player&amp;quot;)

if runpow(55268)
and UnitBuffID(&amp;quot;player&amp;quot;,51124)
and UnitExists(&amp;quot;target&amp;quot;)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Icebound Fortitude</Name><Default>false</Default><SpellID>48792</SpellID><Actions></Actions><Lua>local runic_power = UnitPower(&amp;quot;player&amp;quot;)

if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 40
and runpow(48792)
and not CooldownRemains(48792)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Icy Touch</Name><Default>false</Default><SpellID>49909</SpellID><Actions></Actions><Lua>local dbFrostFever, _, _, _, _, _, dbexpire = UnitDebuffID(&amp;quot;target&amp;quot;,55095, &amp;quot;player&amp;quot;)

if dbFrostFever ~= nil then		
	dbexpire =(dbexpire - GetTime())
	if dbexpire &amp;lt; 2 and IsSpellInRange(GetSpellInfo(49909), &amp;quot;target&amp;quot;) == 1 then
		RunMacroText(&amp;quot;/startattack&amp;quot;)
		return true
	end
else
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Mark of Blood</Name><Default>false</Default><SpellID>49005</SpellID><Actions>/use Blood Tap</Actions><Lua>local BR = select(2, BloodRuneCD())

if BR &amp;gt;= 1
and 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 50
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Obliterate</Name><Default>false</Default><SpellID>51425</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
and UnitDebuffID(&amp;quot;target&amp;quot;, 55095, &amp;quot;player&amp;quot;) ~= nil
and UnitDebuffID(&amp;quot;target&amp;quot;, 55078, &amp;quot;player&amp;quot;) ~= nil
and IsSpellInRange(GetSpellInfo(51425), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Pestilence</Name><Default>false</Default><SpellID>50842</SpellID><Actions></Actions><Lua>local dbFrostFever, _, _, _, _, _, FrostFeverExpire = UnitDebuffID(&amp;quot;target&amp;quot;,55095, &amp;quot;player&amp;quot;)
local dbBloodPlague, _, _, _, _, _, BloodPlagueExpire = UnitDebuffID(&amp;quot;target&amp;quot;,55078, &amp;quot;player&amp;quot;)
local dbFrostFeverO, _, _, _, _, _, FrostFeverExpireO = UnitDebuffID(&amp;quot;target&amp;quot;,55095)
local dbBloodPlagueO, _, _, _, _, _, BloodPlagueExpireO = UnitDebuffID(&amp;quot;target&amp;quot;,55078)

BloodPlagueExpire =(BloodPlagueExpire - GetTime())
FrostFeverExpire =(FrostFeverExpire - GetTime())

if dbFrostFever == nil and dbBloodPlague == nil and (dbFrostFeverO ~= nil or dbBloodPlagueO ~= nil)
then return false
elseif (BloodPlagueExpire &amp;lt; 5 or FrostFeverExpire &amp;lt; 5)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Pestilence (AOE)</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsLeftAltKeyDown() and not GetCurrentKeyBoardFocus() and GetUnitSpeed(&amp;quot;player&amp;quot;) == 0 
	then
		CastSpellByID(50842)
	if SpellIsTargeting() then 
		CameraOrSelectOrMoveStart()
		CameraOrSelectOrMoveStop()
	end
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Pestilence (Renew)</Name><Default>false</Default><SpellID>50842</SpellID><Actions></Actions><Lua>local dbFrostFever, _, _, _, _, _, FrostFeverExpire = UnitDebuffID(&amp;quot;target&amp;quot;,55095, &amp;quot;player&amp;quot;)
local dbBloodPlague, _, _, _, _, _, BloodPlagueExpire = UnitDebuffID(&amp;quot;target&amp;quot;,55078, &amp;quot;player&amp;quot;)
local dbFrostFeverO, _, _, _, _, _, FrostFeverExpireO = UnitDebuffID(&amp;quot;target&amp;quot;,55095)
local dbBloodPlagueO, _, _, _, _, _, BloodPlagueExpireO = UnitDebuffID(&amp;quot;target&amp;quot;,55078)

BloodPlagueExpire =(BloodPlagueExpire - GetTime())
FrostFeverExpire =(FrostFeverExpire - GetTime())

if BloodPlagueExpire &amp;lt; 7 or FrostFeverExpire &amp;lt; 7
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Pestilence (Copy)</Name><Default>false</Default><SpellID>50842</SpellID><Actions></Actions><Lua>if (UnitDebuffID(&amp;quot;target&amp;quot;,55095, &amp;quot;player&amp;quot;) == nil and UnitDebuffID(&amp;quot;target&amp;quot;,55095))
or (UnitDebuffID(&amp;quot;target&amp;quot;,55078, &amp;quot;player&amp;quot;) == nil and UnitDebuffID(&amp;quot;target&amp;quot;,55078))
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Pestilence (Tank)</Name><Default>false</Default><SpellID>50842</SpellID><Actions></Actions><Lua>if IsLeftShiftKeyDown() and GetCurrentKeyBoardFocus() == nil
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Unbreakable Armor</Name><Default>false</Default><SpellID>51271</SpellID><Actions>/use Blood Tap</Actions><Lua>if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitExists(&amp;quot;target&amp;quot;)
and not CooldownRemains(51271)
and IsSpellInRange(GetSpellInfo(49930), &amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>F:Unbreakable Armor (Tank)</Name><Default>false</Default><SpellID>51271</SpellID><Actions></Actions><Lua>if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 60
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>B:Vampiric Blood</Name><Default>false</Default><SpellID>55233</SpellID><Actions>/use Blood Tap</Actions><Lua>local BR = select(2, BloodRuneCD())

if BR &amp;gt;= 1
and 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 70
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Plague Strike</Name><Default>false</Default><SpellID>49921</SpellID><Actions></Actions><Lua>local dbBloodPlague, _, _, _, _, _, BloodPlagueExpire = UnitDebuffID(&amp;quot;target&amp;quot;,55078, &amp;quot;player&amp;quot;)

if  dbBloodPlague ~= nil then
	--cast if debuff has &amp;lt; 2 sec left
	BloodPlagueExpire =(BloodPlagueExpire - GetTime())
	if BloodPlagueExpire &amp;lt; 2 and IsSpellInRange(GetSpellInfo(49921), &amp;quot;target&amp;quot;) == 1 then
		return true
	end
else
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- DarhangeR --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- I&amp;apos;m the original developer of dat profiles. Any changes, copying or sharing without my knowledge direct copyright infringement. For more info: 
-- Discord official chanel: https://discord.gg/fX9frDY
-- VK: https://vk.com/darhanger
-- FB: https://fb.com/darhanger
-- E-mail: civayan@gmail.com</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>U:Unholy Presence</Name><Default>false</Default><SpellID>48265</SpellID><Actions></Actions><Lua>if UnitBuffID(&amp;quot;player&amp;quot;,48265) ~= nil then return false else return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Autotarget --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Autotarget script --
if UnitAffectingCombat(&amp;quot;player&amp;quot;) 
and UnitExists(&amp;quot;target&amp;quot;) == nil 
then TargetNearestEnemy() end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Interrupt Engine --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- New Interrupt Engine // Новый движок--
if xelperInterruptInit == nil then
		xelperInterruptInit = true
		function PQR_InterruptSpell()
			local _, playerClass = UnitClass(&amp;quot;player&amp;quot;)
		
			if playerClass == &amp;quot;DEATHKNIGHT&amp;quot; then
				return 47528
			elseif playerClass == &amp;quot;HUNTER&amp;quot; then
				return 34490
			elseif playerClass == &amp;quot;MAGE&amp;quot; then
				return 2139
			elseif playerClass == &amp;quot;PRIEST&amp;quot; then
				return 15487
			elseif playerClass == &amp;quot;ROGUE&amp;quot; then
				return 1766
			elseif playerClass == &amp;quot;SHAMAN&amp;quot; then
				return 57994
			elseif playerClass == &amp;quot;WARRIOR&amp;quot; then
				local BattleStance = UnitBuffID(&amp;quot;player&amp;quot;, 2457)
				if BattleStance ~= nil then
					return 57755
				else
				local DefensiveStance = UnitBuffID(&amp;quot;player&amp;quot;, 71)
				if DefensiveStance ~= nil then
					return 72
				else
				local BerserkerStance = UnitBuffID(&amp;quot;player&amp;quot;, 2458)
				if BerserkerStance ~= nil then
					return 6552
				else
					return 57755
					end	
				end
			end
		end
	end
end

-- Сore / Ядро -- 

local customTarget = &amp;quot;target&amp;quot;
local castName, _, _, _, castStartTime, castEndTime, _, _, castInterruptable = UnitCastingInfo(customTarget)
local channelName, _, _, _, channelStartTime, channelEndTime, _, channelInterruptable = UnitChannelInfo(customTarget)

if channelName ~= nil then
	--target is channeling a spell that is interruptable
	--load the channel variables into the cast variables to make logic a little easier.
	castName = channelName
	castStartTime = channelStartTime
	castEndTime = channelEndTime
	castInterruptable = channelInterruptable
end

--This is actually &amp;quot;Not Interruptable&amp;quot;... so lets swap it around to use in the positive.
if castInterruptable == false then
	castInterruptable = true
else
	castInterruptable = false
end

--we can&amp;apos;t attack the target.
if UnitCanAttack(&amp;quot;player&amp;quot;, customTarget) == nil then
	return false
end

if castInterruptable then
	--target is casting something that is interruptable.
	--the following 2 variables are named logically... value is in seconds.
	local timeSinceStart = (GetTime() * 1000 - castStartTime) / 1000
	local timeLeft = ((GetTime() * 1000 - castEndTime) * -1) / 1000
	local castTime = castEndTime - castStartTime
	local currentPercent = timeSinceStart / castTime * 100000
	
	--interrupt percentage check
	if currentPercent &amp;lt; PQR_InterruptPercent then
		return false
	end

	--minimum interrupt time.
	if timeSinceStart - PQR_InterruptDelay &amp;lt; 0 then
		return false
	end

	--make sure the interrupt spell is available
	local interruptSpell = PQR_InterruptSpell()
	if interruptSpell ~= 0 then
		
		local interruptName = GetSpellInfo(interruptSpell)
		if not PQR_SpellAvailable(interruptSpell) or not IsSpellInRange(interruptName, customTarget) then
			return false
		end
	else
		return false
	end

	--Finally, make sure the spell they are casting is on the interrupt list or interrupt all is checked
	--if PQR_IsInterruptAll() then
		PQR_Debug(&amp;quot;Casting interrupt on &amp;quot;..customTarget)
		CastSpellByID(interruptSpell, customTarget)
		return true
	--end
	
end

--PQR_InterruptStarted is a global flag to indicate that a new interrupt rotation has started.

if not PQR_InterruptStart then
	PQR_InterruptStart = true

	--Only interrupt these abilities:
	--PQR_AddInterrupt(&amp;quot;Holy Light&amp;quot;)
	--PQR_AddInterrupt(&amp;quot;Flash of Light&amp;quot;)
	--PQR_AddInterrupt(GetSpellInfo(16914)) --Hurricane

	--This is the delay before interrupting in seconds.
	PQR_InterruptDelay = 0.05
	
	--This is the percentage of the cast to wait before interrupting
	PQR_InterruptPercent = math.random(30,60)
end

if not spells then
	spells = {
		&amp;quot;Greater Heal&amp;quot;, --Priest Heal
		&amp;quot;Penance&amp;quot;, --Priest Direct channel heal
		&amp;quot;Flash Heal&amp;quot;, --Priest quick big heal&amp;quot;
		&amp;quot;Heal&amp;quot;, --Priest normal heal
		&amp;quot;Binding Heal&amp;quot;, --Priest heal for themself and another
		&amp;quot;Lesser Heal&amp;quot;, --Priest small heal
		&amp;quot;Prayer of Healing&amp;quot;, --Priest AoE heal
		&amp;quot;Chain Heal&amp;quot;, --Shaman AoE heal
		&amp;quot;Healing Wave&amp;quot;, --Shaman heal
		&amp;quot;Lesser Healing Wave&amp;quot;, --Shaman minor heal
		&amp;quot;Flash of Light&amp;quot;, --Paladin quick heal
		&amp;quot;Holy Light&amp;quot;, --Paladin small heal
		&amp;quot;Nourish&amp;quot;, --Druid heals
		&amp;quot;Healing Touch&amp;quot;, --Druid heal
		&amp;quot;Regrowth&amp;quot;, --Druid AoE
		&amp;quot;Rebirth&amp;quot;, --Druid brez
		&amp;quot;Tranquility&amp;quot;, --Druid AoE heal
		&amp;quot;Hex&amp;quot;, --Shaman CC
		&amp;quot;Cyclone&amp;quot;,
		&amp;quot;Polymorph&amp;quot;
		}
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>-- Function --</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not functionsloaded then

		-- Combat Check --
	function inCombat()
	if UnitAffectingCombat(&amp;quot;player&amp;quot;) ~= nil
		then
			return true
		end
	end
	
		-- Get HP simple --
	function getHp(unit)
	if UnitExists(unit) ~= nil
		then
			return 100 * UnitHealth(unit) / UnitHealthMax(unit)
		end
	end
	
		-- Calculate HP simple --
	function CalculateHP(t)
	local ActualWithIncoming = 100 * UnitHealth(t) / UnitHealthMax(t)
		if ActualWithIncoming then
			return ActualWithIncoming
		else
			return 100
		end
	end
		
		-- Spell Cooldown remaining check --
	CooldownRemains = nil
	function CooldownRemains(spell)
		local start, duration, enable = GetSpellCooldown(spell)
		if ( start &amp;gt; 0 and duration &amp;gt; 1.5 ) then
			return start + duration - GetTime()
		else
			return false
		end
	end

		-- Amount of Cooldown that remains --
	function cdRemains(spellid)
		if select(2,GetSpellCooldown(spellid)) + (select(1,GetSpellCooldown(spellid)) - GetTime()) &amp;gt; 0
			then return select(2,GetSpellCooldown(spellid)) + (select(1,GetSpellCooldown(spellid)) - GetTime())
		else return 0
		end
	end

		-- Item Cooldown remaining check --
	ItemCooldownRemains = nil
	function ItemCooldownRemains(item)
		local start, duration, enable = GetItemCooldown(item)
		if ( start &amp;gt; 0 and duration &amp;gt; 1.5 ) then
			return start + duration - GetTime()
		else
			return false
		end
	end
	
		-- Range Check Simple --
	function rangeCheck(spellid,unit)
	if IsSpellInRange(GetSpellInfo(spellid),unit) == 1
	then
		return true
		end
	end
	
		-- Threat --
	function threat(t)
	if UnitExists(t)
		and UnitThreatSituation(t) ~= nil then
			return UnitThreatSituation(t)
		else
			return 0
		end
	end
	
		-- Validator --
	valid = nil
	function valid(t, spellid)
		if UnitExists(t)
		 and not UnitIsDeadOrGhost(t)
		 and UnitCanAttack(&amp;quot;player&amp;quot;, t) == 1
		 and UnitDebuffID(&amp;quot;target&amp;quot;, 33786) == nil
		 and IsSpellInRange(GetSpellInfo(spellid), t) == 1
		 then
			return true
		else
			return false
		end
	end

		-- CastSpell --
	function _castSpell(spellid,tar)
		if UnitCastingInfo(&amp;quot;player&amp;quot;) == nil
		and UnitChannelInfo(&amp;quot;player&amp;quot;) == nil
		--and IsPlayerSpell(spellid) == true
		and cdRemains(spellid) == 0
		then
			if tar ~= nil
			and rangeCheck(spellid,tar) == nil
				then
				return false
			elseif tar ~= nil
			and rangeCheck(spellid,tar) == true
				then
				CastSpellByID(spellid, tar)
				return true
			elseif tar == nil
				then
				CastSpellByID(spellid)
				return true
			else
		return false
		end
	end
	end
	
		-- Tabled Cast Time Checking for When you Last Cast Something.
	CheckCastTime = {}
	Nova_CheckLastCast = nil
	function Nova_CheckLastCast(spellid, ytime) -- SpellID of Spell To Check, How long of a gap are you looking for?
		if ytime &amp;gt; 0 then
			if #CheckCastTime &amp;gt; 0 then
				for i=1, #CheckCastTime do
					if CheckCastTime[i].SpellID == spellid then
						if GetTime() - CheckCastTime[i].CastTime &amp;gt; ytime then
							CheckCastTime[i].CastTime = GetTime()
							return true
						else
							return false
						end
					end
				end
			end
			table.insert(CheckCastTime, { SpellID = spellid, CastTime = GetTime() } )
			return true
		elseif ytime &amp;lt;= 0 then
			return true
		end
		return false
	end
	
		-- DK Rune Engine --
		-- Death Runes --
	RuneCD = nil
	function RuneCD()
		local RunesOnCD = 0
		for i=1, 6 do
			if select(3, GetRuneCooldown(i)) == false then
			RunesOnCD = RunesOnCD + 1
			end
		end
	
		return RunesOnCD
	end

		-- Death Runes --
	DeathRuneCD = nil
	function DeathRuneCD()
		local DRunesOnCD = 0
		local DRunesOffCD = 0
		for i=1, 6 do
			if GetRuneType(i) == 4 and select(3, GetRuneCooldown(i)) == false then
				DRunesOnCD = DRunesOnCD + 1
			elseif GetRuneType(i) == 4 and select(3, GetRuneCooldown(i)) == true then
				DRunesOffCD = DRunesOffCD + 1
			end
		end
		
		return DRunesOnCD, DRunesOffCD
	end

		--Frost Runes --
	FrostRuneCD = nil
	function FrostRuneCD()
		local FRunesOnCD = 0
		local FRunesOffCD = 0
		for i=1, 6 do
			if GetRuneType(i) == 2 and select(3, GetRuneCooldown(i)) == false then
				FRunesOnCD = FRunesOnCD + 1
			elseif GetRuneType(i) == 2 and select(3, GetRuneCooldown(i)) == true then
				FRunesOffCD = FRunesOffCD + 1
			end
		end
		
		return FRunesOnCD, FRunesOffCD
	end

		-- Unholy Runes --
	UnholyRuneCD = nil
	function UnholyRuneCD()
		local URunesOnCD = 0
		local URunesOffCD = 0
		for i=1, 6 do
			if GetRuneType(i) == 3 and select(3, GetRuneCooldown(i)) == false then
				URunesOnCD = URunesOnCD + 1
			elseif GetRuneType(i) == 3 and select(3, GetRuneCooldown(i)) == true then
				URunesOffCD = URunesOffCD + 1
			end
		end
		
		return URunesOnCD, URunesOffCD
	end

		-- Blood Runes -- 
	BloodRuneCD = nil
	function BloodRuneCD()
		local BRunesOnCD = 0
		local BRunesOffCD = 0
		for i=1, 6 do
			if GetRuneType(i) == 1 and select(3, GetRuneCooldown(i)) == false then
				BRunesOnCD = BRunesOnCD + 1
			elseif GetRuneType(i) == 1 and select(3, GetRuneCooldown(i)) == true then
				BRunesOffCD = BRunesOffCD + 1
			end
		end
		
		return BRunesOnCD, BRunesOffCD
	end
			
		-- Runic Power Check --
	runpow = nil
	function runpow(spellid)
		local runic_power = UnitPower(&amp;quot;player&amp;quot;)
		if runic_power &amp;gt;= select(4, GetSpellInfo(spellid)) then
			return true
		else
			return false
		end 
	end

functionsloaded = true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>All:Racial</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>pvpdebuffCheck, _, _, _, _, _, expire = UnitDebuffID(&amp;quot;player&amp;quot;, 5782) --Fear

if pvpdebuffCheck == nil then
	pvpdebuffCheck, _, _, _, _, _, expire = UnitDebuffID(&amp;quot;player&amp;quot;, 8122) --Psychic scream
end
if pvpdebuffCheck == nil then
	pvpdebuffCheck, _, _, _, _, _, expire = UnitDebuffID(&amp;quot;player&amp;quot;, 5484) --Howl of Terror
end
if pvpdebuffCheck == nil then
	pvpdebuffCheck, _, _, _, _, _, expire = UnitDebuffID(&amp;quot;player&amp;quot;, 2637) --Hibernate
end
if pvpdebuffCheck == nil then
	pvpdebuffCheck, _, _, _, _, _, expire = UnitDebuffID(&amp;quot;player&amp;quot;, 5246) --Intimidating Shout
end
if pvpdebuffCheck == nil then
	pvpdebuffCheck, _, _, _, _, _, expire = UnitDebuffID(&amp;quot;player&amp;quot;, 6358) --Seduction
end
if pvpdebuffCheck ~= nil then
	if (expire - GetTime()) &amp;gt;= 4 then 
	if UnitRace(&amp;quot;player&amp;quot;) == &amp;quot;Undead&amp;quot; and IsSpellKnown(7744) and not CooldownRemains(7744) then
		CastSpellByID(7744)
		return true
		end
	end
end

if UnitLevel(&amp;quot;target&amp;quot;) == -1
and UnitExists(&amp;quot;target&amp;quot;)
then
	--Troll Berserking--
	if UnitRace(&amp;quot;player&amp;quot;) == &amp;quot;Troll&amp;quot; and IsSpellKnown(26297) and not CooldownRemains(26297) then
		CastSpellByID(26297)
		return true
	end
	--Orc Blood Fury 2--
	if UnitRace(&amp;quot;player&amp;quot;) == &amp;quot;Orc&amp;quot; and IsSpellKnown(20572) and not CooldownRemains(20572) then
		CastSpellByID(20572)
		return true
	end
	--Orc Blood Fury--
	if UnitRace(&amp;quot;player&amp;quot;) == &amp;quot;Orc&amp;quot; and IsSpellKnown(33697) and not CooldownRemains(33697) then 
		CastSpellByID(33697)
		return true
	end
end

if UnitExists(&amp;quot;target&amp;quot;)
then
	--Dwarf Stoneform--
	if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 40 
	and UnitRace(&amp;quot;player&amp;quot;) == &amp;quot;Dwarf&amp;quot; and IsSpellKnown(20594) and not CooldownRemains(20594) then
		CastSpellByID(20594)
		return true
	end
	--Draenei Stoneform--
	if 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 40 
	and UnitRace(&amp;quot;player&amp;quot;) == &amp;quot;Draenei&amp;quot; and IsSpellKnown(28880) and not CooldownRemains(28880) then
		CastSpellByID(28880)
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability></DEATHKNIGHT>