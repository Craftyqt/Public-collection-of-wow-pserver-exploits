<?xml version="1.0" encoding="utf-8" ?><PRIEST><Ability><Name>------ PvP: Defensive ------</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>Immune = false
FearImmune = false
local PQ_FearImmune	= {22812,6346,46924,18499,49039}
local PQ_Immune		= {642,31224,8177,23920,45438,48707,47585}
local PQ_Dispel		= {41450,498,11426,1044,6940,17,31884,6346}
local PQ_Targets	= {&amp;quot;target&amp;quot;,&amp;quot;focus&amp;quot;,&amp;quot;arena1&amp;quot;,&amp;quot;arena2&amp;quot;,&amp;quot;arena3&amp;quot;,&amp;quot;arena4&amp;quot;,&amp;quot;arena5&amp;quot;}
local PQ_Fear		= {49016,18499,2825,32182,51713,51271,33702,20572,33697,99740,1719,46924}
local PQ_Silence	= {8129,116,33786,5185,8936,118,12051,2948,51514,689,1120,5782,348,34914,82326,19750,635,8092}

for _,v in ipairs(PQ_Targets) do
	-- Polymorph Handler
	local spell,_,_,_,_,endtime = UnitCastingInfo(v)
	if spell == GetSpellInfo(118)
		and endtime - GetTime()*1000 &amp;lt; 400
		and not UnitIsDeadOrGhost(v)
		and not PQR_IsOutOfSight(v)
		and not UnitBuffID(&amp;quot;player&amp;quot;,17)
		and not UnitBuffID(&amp;quot;player&amp;quot;,76669)
		and not UnitBuffID(&amp;quot;player&amp;quot;,47515)
	then
		SpellStopCasting()
		CastSpellByID(32379,v)
	end
	
	-- Dispel loop
	for _,d in ipairs(PQ_Dispel) do
		if UnitBuffID(v,d) then
			SpellStopCasting()
			CastSpellByID(527,v)
		end
	end
	-- Silence loop
	for _,s in ipairs(PQ_Silence) do
		if spell == GetSpellInfo(s) then
			SpellStopCasting()
			CastSpellByID(v,15487)
		end
	end
	-- Fear Immunity loop
	for _,f in ipairs(PQ_FearImmune) do
		if UnitBuffID(v,f) then
			FearImmune = true
		end
	end
	-- Immunity Buffs
	for _,i in ipairs(PQ_Immune) do
		if UnitBuffID(v,i) then
			Immune = true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Power Word: Shield</Name><Default>false</Default><SpellID>17</SpellID><Actions></Actions><Lua>if UnitAffectingCombat(&amp;quot;player&amp;quot;)
	and not UnitDebuffID(&amp;quot;player&amp;quot;,6788)
then SpellStopCasting() return true end

if UnitExists(&amp;quot;mouseover&amp;quot;)
	and UnitIsFriend(&amp;quot;player&amp;quot;,&amp;quot;mouseover&amp;quot;)
	and not UnitDebuffID(&amp;quot;mouseover&amp;quot;,6788)
	and not PQR_IsOutOfSight(&amp;quot;mouseover&amp;quot;)
	and not UnitIsDeadOrGhost(&amp;quot;mouseover&amp;quot;)
	and IsSpellInRange(GetSpellInfo(17),&amp;quot;mouseover&amp;quot;) == 1
then SpellStopCasting() CastSpellByID(17,&amp;quot;mouseover&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Fade</Name><Default>false</Default><SpellID>586</SpellID><Actions></Actions><Lua>local PQ_MovementImpairing = {339,122,45524,16979,5116,2974,13809,116,120,11113,31589,15407,3408,26679,8056,2484,18223,1715,12323}
for _,v in ipairs(PQ_MovementImpairing) do
	if UnitDebuffID(&amp;quot;player&amp;quot;,v) and IsUsableSpell(GetSpellInfo(586))
	-- and UnitThreatSituation(&amp;quot;player&amp;quot;) &amp;gt;= 2
	then SpellStopCasting() return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Psychic Horror</Name><Default>false</Default><SpellID>64044</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;focus&amp;quot;)
	and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;focus&amp;quot;)
	and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;focus&amp;quot;)
	and not UnitIsDeadOrGhost(&amp;quot;focus&amp;quot;)
	and not PQR_IsOutOfSight(&amp;quot;focus&amp;quot;)
	and IsUsableSpell(GetSpellInfo(64044))
	and IsLeftControlKeyDown()
	-- and not Immune
	and not FearImmune
	and IsSpellInRange(GetSpellInfo(64044),&amp;quot;focus&amp;quot;) == 1
then SpellStopCasting() return true end

local PQ_Targets	= {&amp;quot;arena1&amp;quot;,&amp;quot;arena2&amp;quot;,&amp;quot;arena3&amp;quot;,&amp;quot;arena4&amp;quot;,&amp;quot;arena5&amp;quot;}
local PQ_Fear = {49016,18499,2825,32182,51713,51271,33702,20572,33697,99740,1719,46924}
for _,v in ipairs(PQ_Targets) do
	for _,f in ipairs(PQ_Fear) do
		if UnitBuffID(v,f)
			and not FearImmune
			and IsSpellInRange(GetSpellInfo(64044),v) == 1
			and IsUsableSpell(GetSpellInfo(64044))
		 then SpellStopCasting() CastSpellByID(64044,v) end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Focus</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>------ Functions ------</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)
	and UnitIsEnemy(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;)
	and not UnitIsDeadOrGhost(&amp;quot;target&amp;quot;)
	and not PQR_IsOutOfSight(&amp;quot;target&amp;quot;)
then
	PQ_ValidTarget = true
end

function PQ_GetTargetHP()
	hp,hpmax = UnitHealth(&amp;quot;target&amp;quot;),UnitHealthMax(&amp;quot;target&amp;quot;)
	if hp and hpmax then return hp / hpmax * 100 else return 0 end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Vampiric Touch</Name><Default>false</Default><SpellID>34914</SpellID><Actions></Actions><Lua>local VT,_,_,_,_,_,timer = UnitDebuffID(&amp;quot;target&amp;quot;,34914,&amp;quot;player&amp;quot;)
if UnitExists(&amp;quot;target&amp;quot;)
	and PQ_ValidTarget
	and not Immune
	and not PQR_IsMoving(0.3)
	and IsUsableSpell(GetSpellInfo(34914))
	and IsSpellInRange(GetSpellInfo(34914),&amp;quot;target&amp;quot;) == 1
	and PQ_GetTargetHP() &amp;gt; 30
then
	if VT then
		if timer - GetTime() &amp;lt; 3 then return true end
	else return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Shadow Word: Pain</Name><Default>false</Default><SpellID>589</SpellID><Actions></Actions><Lua>local SWP,_,_,_,_,_,timer = UnitDebuffID(&amp;quot;target&amp;quot;,589,&amp;quot;player&amp;quot;)
if UnitExists(&amp;quot;target&amp;quot;)
	and PQ_ValidTarget
	and not Immune
	and IsUsableSpell(GetSpellInfo(589))
	and IsSpellInRange(GetSpellInfo(589),&amp;quot;target&amp;quot;) == 1
	and PQ_GetTargetHP() &amp;gt; 30
then
	if SWP then
		if timer - GetTime() &amp;lt; 3 then return true end
	else return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Devouring Plague</Name><Default>false</Default><SpellID>2944</SpellID><Actions></Actions><Lua>local DP,_,_,_,_,_,timer = UnitDebuffID(&amp;quot;target&amp;quot;,2944,&amp;quot;player&amp;quot;)
if UnitExists(&amp;quot;target&amp;quot;)
	and PQ_ValidTarget
	and not Immune
	and IsUsableSpell(GetSpellInfo(2944))
	and IsSpellInRange(GetSpellInfo(2944),&amp;quot;target&amp;quot;) == 1
	and PQ_GetTargetHP() &amp;gt; 30
then
	if DP then
		if timer - GetTime() &amp;lt; 3 then return true end
	else return true end
	if PQR_IsMoving(0.3) then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Mind Blast</Name><Default>false</Default><SpellID>8092</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
	and PQ_ValidTarget
	and not Immune
	and not PQR_IsMoving(0.3)
	and IsUsableSpell(GetSpellInfo(8092))
	and IsSpellInRange(GetSpellInfo(8092),&amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Mind Flay</Name><Default>false</Default><SpellID>15407</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
	and PQ_ValidTarget
	and not Immune
	and not PQR_IsMoving(0.3)
	and IsUsableSpell(GetSpellInfo(15407))
	and IsSpellInRange(GetSpellInfo(15407),&amp;quot;target&amp;quot;) == 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Shadow Word: Death</Name><Default>false</Default><SpellID>32379</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
	and PQ_ValidTarget
	and not Immune
	and IsUsableSpell(GetSpellInfo(32379))
	and IsSpellInRange(GetSpellInfo(32379),&amp;quot;target&amp;quot;) == 1
	and PQ_GetTargetHP() &amp;lt; 30
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability><Ability><Name>Mind Spike</Name><Default>false</Default><SpellID>73510</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;)
	and PQ_ValidTarget
	and not Immune
	and IsUsableSpell(GetSpellInfo(73510))
	and IsSpellInRange(GetSpellInfo(73510),&amp;quot;target&amp;quot;) == 1
	and PQ_GetTargetHP() &amp;lt; 30
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><LuaBefore></LuaBefore><LuaAfter></LuaAfter></Ability></PRIEST>