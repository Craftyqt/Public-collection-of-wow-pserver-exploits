<?xml version="1.0" encoding="utf-8" ?><WARLOCK><Ability><Name>Buff - Fel Armor</Name><Default>false</Default><SpellID>28176</SpellID><Actions></Actions><Lua>if not IsMounted() and not UnitBuffID(&amp;quot;player&amp;quot;, 28176) then return true end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Buff - Soul Link</Name><Default>false</Default><SpellID>19028</SpellID><Actions></Actions><Lua>if PlayerPet and not IsMounted() then
	if not UnitBuffID(&amp;quot;player&amp;quot;, 19028) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Pet - Felhunter</Name><Default>false</Default><SpellID>691</SpellID><Actions></Actions><Lua>if not PlayerPet and not IsMounted() then return true end</Lua><RecastDelay>12000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Buff - Dark Intent</Name><Default>false</Default><SpellID>80398</SpellID><Actions></Actions><Lua>if rControl then return true end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Demon Soul</Name><Default>false</Default><SpellID>77801</SpellID><Actions>/cast Volcanic Potion</Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyLevel &amp;gt;= (PlayerLevel + 2) or EnemyLevel == -1 then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Soulburn</Name><Default>false</Default><SpellID>74434</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat and PQR_SpellAvailable(74434) then
	if EnemyLevel &amp;gt;= (PlayerLevel + 2) or EnemyLevel == -1 then
		if PlayerShards &amp;gt;= 1 then return true end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Corruption</Name><Default>false</Default><SpellID>172</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if not TimerCorrupt then 
		return true 
	else 
		if TimerCorrupt - GetTime() &amp;lt; 2 then
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Unstable Affliction</Name><Default>false</Default><SpellID>30108</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if not UnstableTimer then
		return true
	else
		if UnstableTimer - GetTime() &amp;lt; 3 and EnemyHP &amp;gt; 25 then
			return true
		end
	end
end</Lua><RecastDelay>200</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Bane of Doom</Name><Default>false</Default><SpellID>603</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyLevel &amp;gt;= (PlayerLevel + 2) or EnemyLevel == -1 then
		noDoom = nil
		if not BaneDoomTimer then
			return true
		else
			if BaneDoomTimer - GetTime() &amp;lt; 13 then
				return true
			end
		end
	else
		noDoom = 1
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Haunt</Name><Default>false</Default><SpellID>48181</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Doomguard</Name><Default>false</Default><SpellID>18540</SpellID><Actions></Actions><Lua>if lShift then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Filler - Drain Soul</Name><Default>false</Default><SpellID>1120</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyHP &amp;lt;= 25 and not isMoving then
		if STrance == nil then return true end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>AoE - Shadowflame</Name><Default>false</Default><SpellID>47897</SpellID><Actions></Actions><Lua>if EnemyExists then
	if InteractRange
	and GetCurrentMapZone ~= &amp;quot;Spine of Deathwing&amp;quot;
	or EnemyID == 55294 --Ultra
	then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Proc - Soul Fire</Name><Default>false</Default><SpellID>6353</SpellID><Actions></Actions><Lua>local SoulburnUP = UnitBuffID(&amp;quot;player&amp;quot;, 74434)

if EnemyExists and PlayerCombat then
	if SoulburnUP then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Life Tap</Name><Default>false</Default><SpellID>1454</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if PlayerMana &amp;lt;= 35
	or isMoving and PlayerMana &amp;lt; 80 and (PlayerMana &amp;lt; EnemyHP)
	then return true end
end</Lua><RecastDelay>2000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Filler - Shadow Bolt</Name><Default>false</Default><SpellID>686</SpellID><Actions></Actions><Lua>SFlame = select(7, UnitDebuffID( &amp;quot;target&amp;quot;, 17800 ) )

if EnemyExists and PlayerCombat then
	if EnemyHP &amp;gt; 25 then return true end
	if STrance then return true end
	if EnemyHP &amp;lt; 25 then 
		if SFlame == nil then return true end	
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Calcs--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Player Info
PlayerMana			= 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;)
PlayerHP			= 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
PlayerThreat		= UnitThreatSituation(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
PlayerShards		= UnitPower(&amp;quot;player&amp;quot;, 7)
PlayerLevel			= UnitLevel(&amp;quot;player&amp;quot;)
PlayerPet			= UnitExists(&amp;quot;pet&amp;quot;)

--PQR Functions
isMoving			= PQR_IsMoving()

--Key Mods
lShift				= IsLeftShiftKeyDown()
lControl			= IsLeftControlKeyDown()
lAlt				= IsLeftAltKeyDown()
rShift				= IsRightShiftKeyDown()
rControl			= IsRightControlKeyDown()
rAlt				= IsRightAltKeyDown()

local hasTarget		= UnitExists(&amp;quot;target&amp;quot;)

if hasTarget then
	--Target Info
	EnemyHP				= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
	EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
	EnemyExists			= UnitExists(&amp;quot;target&amp;quot;)
	InteractRange		= CheckInteractDistance(&amp;quot;target&amp;quot;, 3)
	EnemyID				= tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(-13, -9), 16)
	--Timers
	BaneAgonyTimer		= select(7, UnitDebuffID( &amp;quot;target&amp;quot;, 980, &amp;quot;PLAYER&amp;quot; ) )
	BaneDoomTimer		= select(7, UnitDebuffID( &amp;quot;target&amp;quot;, 603, &amp;quot;PLAYER&amp;quot; ) )
	TimerCorrupt		= select(7, UnitDebuffID( &amp;quot;target&amp;quot;, 172, &amp;quot;PLAYER&amp;quot; ) )
	UnstableTimer		= select(7, UnitDebuffID( &amp;quot;target&amp;quot;, 30108, &amp;quot;PLAYER&amp;quot; ) )
	SoulburnUP			= select(1, UnitBuffID( &amp;quot;player&amp;quot; , 74434 ) )
	STrance				= select(7, UnitBuffID( &amp;quot;player&amp;quot;, 17941) )
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Pause--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if lAlt
or IsMounted()
or SpellIsTargeting()
or UnitBuffID(&amp;quot;player&amp;quot;,80169)
or UnitInVehicle(&amp;quot;player&amp;quot;)
or UnitIsDead(&amp;quot;target&amp;quot;) 
or UnitIsDead(&amp;quot;player&amp;quot;)
or not PlayerCombat then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Fel Flame</Name><Default>false</Default><SpellID>77799</SpellID><Actions></Actions><Lua>if isMoving then return true end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>AoE - Seed of Corruption</Name><Default>false</Default><SpellID>27243</SpellID><Actions></Actions><Lua>if EnemyExists then
	if lControl then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Extra Action--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Avoid sudden death on Ultraxion
local fadingtime = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,110070))
if fadingtime and fadingtime - GetTime() &amp;lt; 1.3 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end 

-- Avoid Hour of Twilight on Ultraxion, Delete next 3 lines if you are working as tank
local channelSpell, _, _, _, _, endTime = UnitCastingInfo(&amp;quot;boss1&amp;quot;)
if channelSpell == GetSpellInfo(109417) and endTime/1000 - GetTime() &amp;lt; 1.3 
then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end

-- Avoid sudden death on Madness (kickmydog)
local tentacledeath = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,109597))
if tentacledeath and tentacledeath - GetTime() &amp;lt; 1 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Focus Mouseover--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if rAlt then FocusUnit(&amp;quot;mouseover&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Racial--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PlayerCombat and EnemyExists then

  -- Arcane Torrent (Blood Elf)(Pally, Priest, Mage, Warlock)
  if IsSpellKnown(28730) and GetSpellCooldown(28730) == 0 
  and PlayerMana &amp;lt; 80 
  then CastSpellByID(28730) return true end
  
  -- Berserking (Troll)(All Classes)
  if IsSpellKnown(26297) and GetSpellCooldown(26297) == 0 
  then CastSpellByID(26297) return true end

  -- Blood Fury (Orc) (Mage, Warlock)
  if IsSpellKnown(33702) and GetSpellCooldown(33702) == 0 
  then CastSpellByID(33702) return true end

  -- Will of the Forsaken (Undead)
  if not GotFear then
    function GotFear(t) 
      local debuff = { 10326, 8122, 2094, 5782, 5484, 6358, 5246 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(7744) and GetSpellCooldown(7744) == 0 and GotFear(&amp;quot;player&amp;quot;) 
  then CastSpellByID(7744) return true end

  -- Rocket Barrage (Goblin)
  if IsSpellKnown(69041) and GetSpellCooldown(69041) == 0 
  and IsSpellInRange(GetSpellInfo(69041),&amp;quot;target&amp;quot;) == 1 and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) 
  then CastSpellByID(69041) return true end

  -- Stoneform (Dwarf)
  if not GotPoison then
    function GotPoison(t)
      local i, debuff = 1, select(5,UnitDebuff(t, 1)) 
      while debuff do
        if debuff == &amp;quot;Poison&amp;quot; or debuff == &amp;quot;Disease&amp;quot; then return true end
        i = i + 1 debuff = select(5,UnitDebuff(t, i)) 
      end
    end
  end
  if IsSpellKnown(20594) and GetSpellCooldown(20594) == 0 and GotPoison(&amp;quot;player&amp;quot;) 
  then CastSpellByID(20594) return true end

  -- Escape Artist (Gnome)
  if not CantMove then
    function CantMove(t) 
      local debuff = { 122, 53754, 1715, 12323, 3775, 339, 48483, 8056, 2974, 45524 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(20589) and GetSpellCooldown(20589) == 0 and CantMove(&amp;quot;player&amp;quot;) 
  then CastSpellByID(20589) return true end

  -- Every Man for Himself (Human)
  if not LostControl then
    function LostControl(t) 
      local debuff = { 122, 10326, 8122, 2094, 5782, 5484, 6358, 5246, 408 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(59752) and GetSpellCooldown(59752) == 0 and LostControl(&amp;quot;player&amp;quot;) 
  then CastSpellByID(59752) return true end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>AoE - Soul Swap</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local PQ_DebuffsToCheck = { 172, 980, 30108 }
local PQ_NeedSoulSwap = false

if UnitExists(&amp;quot;focus&amp;quot;) 
 and IsSpellInRange(GetSpellInfo(172), &amp;quot;focus&amp;quot;) == 1 
 and IsSpellInRange(GetSpellInfo(172), &amp;quot;target&amp;quot;) == 1
 and not UnitIsUnit(&amp;quot;target&amp;quot;, &amp;quot;focus&amp;quot;)
 and UnitCanAttack(&amp;quot;player&amp;quot;, &amp;quot;focus&amp;quot;)
 and PQR_SpellAvailable(86121) then
	for i=1, #PQ_DebuffsToCheck do
		if UnitDebuffID(&amp;quot;focus&amp;quot;, PQ_DebuffsToCheck[i]) then
			if select(7, UnitDebuffID(&amp;quot;focus&amp;quot;, PQ_DebuffsToCheck[i])) - GetTime() &amp;lt;= 3 then
				PQ_NeedSoulSwap = true
				break
			end
		else
			PQ_NeedSoulSwap = true
			break
		end
	end
end

if PQ_NeedSoulSwap then
	if UnitBuffID(&amp;quot;player&amp;quot;, 86211) then
		CastSpellByName(GetSpellInfo(86213), &amp;quot;focus&amp;quot;)
		return true
	else	
		if UnitDebuffID(&amp;quot;target&amp;quot;, 30108)
	 	and UnitDebuffID(&amp;quot;target&amp;quot;, 172) then
			if UnitDebuffID(&amp;quot;target&amp;quot;, 980) then
				CastSpellByID(86121, &amp;quot;target&amp;quot;)
				return true
			else
				CastSpellByID(980, &amp;quot;target&amp;quot;)
				return true
			end
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Bane of Agony</Name><Default>false</Default><SpellID>980</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if noDoom ~= nil then
		if not BaneAgonyTimer then
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Curse - Elements</Name><Default>false</Default><SpellID>1490</SpellID><Actions></Actions><Lua>--Reorderd the list for better management
---60433, 65142, 93068, 34889, 24844, 86105, 85547, 1490
---60433 Earth and Moon
---65142 Ebon Plague
---93068 Master Poisoner
---34889 Fire Breath
---24844 Lighning Breath
---86105 Jinx: Curse of the Elements
---85547 Jinx: Curse of the Elements
---1490 curse of the elements

local debuffCurse = { 60433, 65142, 93068, 34889, 24844, 86105, 85547, 1490 }

if EnemyExists and PlayerCombat then
	if EnemyLevel &amp;gt;= (PlayerLevel + 2) or EnemyLevel == -1 then
		for i=1, #debuffCurse do
			if UnitDebuffID(&amp;quot;target&amp;quot;, debuffCurse[i]) == nil then
				return true
			else
				return false
			end
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Soulshatter</Name><Default>false</Default><SpellID>29858</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if PlayerThreat == 3 and PQR_SpellAvailable(29858) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Soul Harvest</Name><Default>false</Default><SpellID>79268</SpellID><Actions></Actions><Lua>if not PlayerCombat then
	if PlayerShards &amp;lt;= 1 and PQR_SpellAvailable(79268) and not isMoving then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Healthstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if UsedHealth == nil and PlayerHP &amp;lt; 30 then
		UseItemByName(5512, &amp;quot;player&amp;quot;)
		UsedHealth = 1
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Soulstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if rShift then
	if UnitIsDead(&amp;quot;mouseover&amp;quot;) then
		UseItemByName(5232, mouseover)
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,10) == 0 
and UnitAffectingCombat(&amp;quot;player&amp;quot;) ~= nil then UseInventoryItem(10) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Trinket 1</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13) == 0 then UseInventoryItem(13) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Trinket 2</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,cd,havecd = GetInventoryItemCooldown(&amp;quot;player&amp;quot;,14)

if cd == 0 and havecd == 1  
and not UnitChannelInfo(&amp;quot;player&amp;quot;) 
then 
  UseInventoryItem(14) 
  return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></WARLOCK>