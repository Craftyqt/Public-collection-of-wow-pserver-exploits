<?xml version="1.0" encoding="utf-8" ?><WARLOCK><Ability><Name>--Calcs/Functions--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Player Info
PlayerMana			= 100 * UnitPower(&amp;quot;player&amp;quot;) / UnitPowerMax(&amp;quot;player&amp;quot;)
PlayerHP			= 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
PlayerThreat		= UnitThreatSituation(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
PlayerShards		= UnitPower(&amp;quot;player&amp;quot;, 7)
PlayerLevel			= UnitLevel(&amp;quot;player&amp;quot;)
PlayerPet			= UnitExists(&amp;quot;pet&amp;quot;)

--PQR Functions
isMoving			= PQR_IsMoving()

--Key Mods
lShift				= IsLeftShiftKeyDown()
lCtrl				= IsLeftControlKeyDown()
lAlt				= IsLeftAltKeyDown()
rShift				= IsRightShiftKeyDown()
rCtrl				= IsRightControlKeyDown()
rAlt				= IsRightAltKeyDown()

local hasTarget		= UnitExists(&amp;quot;target&amp;quot;)

if hasTarget then
	--Target Info
	EnemyHP				= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
	EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
	EnemyExists			= UnitExists(&amp;quot;target&amp;quot;)
	InteractRange		= CheckInteractDistance(&amp;quot;target&amp;quot;, 3)
	EnemyID				= tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(-13, -9), 16)
	
	if EnemyLevel &amp;gt;= (PlayerLevel + 2) or EnemyLevel == -1 then
		IsBossLVL = 1
	else
		IsBossLVL = nil
	end
end

if ctInit == nil then
	ctInit = true
	-- Code provided by Sheuron
	function HaveBuff(UnitID,SpellID,TimeLeft,Filter) 
  		if not TimeLeft then TimeLeft = 0 end
  		if type(SpellID) == &amp;quot;number&amp;quot; then SpellID = { SpellID } end 
 		for i=1,#SpellID do 
    		local spell, rank = GetSpellInfo(SpellID[i])
    			if spell then
     				local buff = select(7,UnitBuff(UnitID,spell,rank,Filter)) 
      				if buff and ( buff == 0 or buff - GetTime() &amp;gt; TimeLeft ) then return true end
    			end
  		end
	end

	function HaveDebuff(UnitID,SpellID,TimeLeft,Filter) 
  		if not TimeLeft then TimeLeft = 0 end
  		if type(SpellID) == &amp;quot;number&amp;quot; then SpellID = { SpellID } end 
  		for i=1,#SpellID do 
    		local spell, rank = GetSpellInfo(SpellID[i])
    		if spell then
      			local debuff = select(7,UnitDebuff(UnitID,spell,rank,Filter)) 
     			if debuff and ( debuff == 0 or debuff - GetTime() &amp;gt; TimeLeft ) then return true end
   			 end
 		 end
	end
--end code by sheuron

function ParseGUID(guid)
   local first3 = tonumber(&amp;quot;0x&amp;quot;..strsub(guid, 3,5))
   local unitType = bit.band(first3,0x00f)

   if (unitType == 0x000) then
      print(&amp;quot;Player, ID #&amp;quot;, strsub(guid,6))
   elseif (unitType == 0x003) then
      local creatureID = tonumber(&amp;quot;0x&amp;quot;..strsub(guid,7,10))
      local spawnCounter = tonumber(&amp;quot;0x&amp;quot;..strsub(guid,11))
      print(&amp;quot;NPC, ID #&amp;quot;,creatureID,&amp;quot;spawn #&amp;quot;,spawnCounter)
   elseif (unitType == 0x004) then
      local petID = tonumber(&amp;quot;0x&amp;quot;..strsub(guid,7,10))
      local spawnCounter = tonumber(&amp;quot;0x&amp;quot;..strsub(guid,11))
      print(&amp;quot;Pet, ID #&amp;quot;,petID,&amp;quot;spawn #&amp;quot;,spawnCounter)
   elseif (unitType == 0x005) then
      local creatureID = tonumber(&amp;quot;0x&amp;quot;..strsub(guid,7,10))
      local spawnCounter = tonumber(&amp;quot;0x&amp;quot;..strsub(guid,11))
      print(&amp;quot;Vehicle, ID #&amp;quot;,creatureID,&amp;quot;spawn #&amp;quot;,spawnCounter)
   end
end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Extra Action--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Code provided by Sheuron
-- Avoid sudden death on Ultraxion
local fadingtime = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,110070))
if fadingtime and fadingtime - GetTime() &amp;lt; 1.3 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end 

-- Code provided by Kickmydog
-- Avoid Hour of Twilight on Ultraxion, deterrence to cancel use.
if not UnitBuffID(&amp;quot;player&amp;quot;, 6229) then
	local HourOfTwilight,_,_,_,_,endTime = UnitCastingInfo(&amp;quot;boss1&amp;quot;)
	if HourOfTwilight == GetSpellInfo(109417) and endTime/1000 - GetTime() &amp;lt;= 1.3 then
		RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;)
	end
end

-- Code provided by Kickmydog
-- Avoid Fragmentation on Madness
local tentacledeath = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,109597))
if tentacledeath and tentacledeath - GetTime() &amp;lt; 0.7 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Lightwell--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code provided by Xelper
local LightwellName = &amp;quot;Lightwell&amp;quot;
local sLightwell = UnitBuffID(&amp;quot;player&amp;quot;, 7001)
local sDeepCorruption = UnitDebuffID(&amp;quot;player&amp;quot;, 108220)
if PQR_LightwellTimeout == nil then
    PQR_LightwellTimeout = 0
end

if PlayerHP &amp;lt; 70 and sLightwell == nil then
    if PQR_LightwellTimeout &amp;lt; GetTime() then
        if sDeepCorruption == nil then
            PQR_LightwellTimeout = GetTime() + 1
            InteractUnit(LightwellName)
        end
    end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Pause--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if lAlt
or IsMounted()
or SpellIsTargeting()
or UnitBuffID(&amp;quot;player&amp;quot;,80169)
or UnitInVehicle(&amp;quot;player&amp;quot;)
or UnitIsDead(&amp;quot;target&amp;quot;) 
or UnitIsDead(&amp;quot;player&amp;quot;)
or not PlayerCombat then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Racial--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PlayerCombat and EnemyExists then

  -- Arcane Torrent (Blood Elf)(Pally, Priest, Mage, Warlock)
  if IsSpellKnown(28730) and GetSpellCooldown(28730) == 0 
  and PlayerMana &amp;lt; 80 
  then CastSpellByID(28730) return true end
  
  -- Berserking (Troll)(All Classes)
  if IsSpellKnown(26297) and GetSpellCooldown(26297) == 0 
  then CastSpellByID(26297) return true end

  -- Blood Fury (Orc) (Mage, Warlock)
  if IsSpellKnown(33702) and GetSpellCooldown(33702) == 0 
  then CastSpellByID(33702) return true end

  -- Will of the Forsaken (Undead)
  if not GotFear then
    function GotFear(t) 
      local debuff = { 10326, 8122, 2094, 5782, 5484, 6358, 5246 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(7744) and GetSpellCooldown(7744) == 0 and GotFear(&amp;quot;player&amp;quot;) 
  then CastSpellByID(7744) return true end

  -- Rocket Barrage (Goblin)
  if IsSpellKnown(69041) and GetSpellCooldown(69041) == 0 
  and IsSpellInRange(GetSpellInfo(69041),&amp;quot;target&amp;quot;) == 1 and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) 
  then CastSpellByID(69041) return true end

  -- Stoneform (Dwarf)
  if not GotPoison then
    function GotPoison(t)
      local i, debuff = 1, select(5,UnitDebuff(t, 1)) 
      while debuff do
        if debuff == &amp;quot;Poison&amp;quot; or debuff == &amp;quot;Disease&amp;quot; then return true end
        i = i + 1 debuff = select(5,UnitDebuff(t, i)) 
      end
    end
  end
  if IsSpellKnown(20594) and GetSpellCooldown(20594) == 0 and GotPoison(&amp;quot;player&amp;quot;) 
  then CastSpellByID(20594) return true end

  -- Escape Artist (Gnome)
  if not CantMove then
    function CantMove(t) 
      local debuff = { 122, 53754, 1715, 12323, 3775, 339, 48483, 8056, 2974, 45524 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(20589) and GetSpellCooldown(20589) == 0 and CantMove(&amp;quot;player&amp;quot;) 
  then CastSpellByID(20589) return true end

  -- Every Man for Himself (Human)
  if not LostControl then
    function LostControl(t) 
      local debuff = { 122, 10326, 8122, 2094, 5782, 5484, 6358, 5246, 408 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(59752) and GetSpellCooldown(59752) == 0 and LostControl(&amp;quot;player&amp;quot;) 
  then CastSpellByID(59752) return true end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Buff - Fel Armor</Name><Default>false</Default><SpellID>28176</SpellID><Actions></Actions><Lua>if not IsMounted() and not UnitBuffID(&amp;quot;player&amp;quot;, 28176) then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Buff - Dark Intent</Name><Default>false</Default><SpellID>80398</SpellID><Actions></Actions><Lua>if rCtrl then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Buff - Soul Link</Name><Default>false</Default><SpellID>19028</SpellID><Actions></Actions><Lua>if PlayerPet and not IsMounted() then
	if not HaveBuff(&amp;quot;player&amp;quot;, 19028) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Demon Soul</Name><Default>false</Default><SpellID>77801</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if IsBossLVL and PQR_SpellAvailable(77801) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Guardan - Doomguard</Name><Default>false</Default><SpellID>18540</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if IsBossLVL and lCtrl and PQR_SpellAvailable(18540) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spell - Fel Flame</Name><Default>false</Default><SpellID>77799</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if isMoving then
		return true
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,10) == 0 then
		UseInventoryItem(10)
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spell - Life Tap</Name><Default>false</Default><SpellID>1454</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if PlayerMana &amp;lt;= 35
	or isMoving and PlayerMana &amp;lt; 80 and (PlayerMana &amp;lt; EnemyHP)
	then return true end
end</Lua><RecastDelay>2000</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spell - Soul Harvest</Name><Default>false</Default><SpellID>79268</SpellID><Actions></Actions><Lua>if not PlayerCombat then
	if PlayerShards &amp;lt;= 1 and PQR_SpellAvailable(79268) and not isMoving then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Soulburn</Name><Default>false</Default><SpellID>74434</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if IsBossLVL and PQR_SpellAvailable(74434) then
		if PlayerShards &amp;gt;= 1 then return true end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - SoulShatter</Name><Default>false</Default><SpellID>29858</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if PlayerThreat == 3 and PQR_SpellAvailable(29858) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Curse - Elements</Name><Default>false</Default><SpellID>1490</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if IsBossLVL then
		if not HaveDebuff(&amp;quot;target&amp;quot;, {86105, 93068, 24844, 34889, 65142, 60433, 85547, 1490}) then
			return true
		end
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Healthstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if UsedHealth == nil and PlayerHP &amp;lt; 30 then
		UseItemByName(5512, &amp;quot;player&amp;quot;)
		UsedHealth = 1
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Soulstone</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if rShift then
	if UnitIsDead(&amp;quot;mouseover&amp;quot;) then
		UseItemByName(5232, mouseover)
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Trinket 1</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13) == 0 then UseInventoryItem(13) end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Trinket 2</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local _,cd,havecd = GetInventoryItemCooldown(&amp;quot;player&amp;quot;,14)

if EnemyExists and PlayerComabat then
	if cd == 0 and havecd == 1 and not UnitChannelInfo(&amp;quot;player&amp;quot;) then 
	  UseInventoryItem(14) 
 		 return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>AoE - Shadowflame</Name><Default>false</Default><SpellID>47897</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat and PQR_SpellAvailable(47897) then
	if InteractRange or EnemyID == 55294 then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spec - Metamorphosis</Name><Default>false</Default><SpellID>47241</SpellID><Actions>/cast Volcanic Potion</Actions><Lua>if EnemyExists and PlayerCombat and PQR_SpellAvailable(47241) then
	if not lShift and IsBossLVL then
		return true
	elseif lShift then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spell - Soul Fire</Name><Default>false</Default><SpellID>6353</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if HaveBuff(&amp;quot;player&amp;quot;, 63167) and EnemyHP &amp;lt; 25 then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Immolate</Name><Default>false</Default><SpellID>348</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if not HaveDebuff(&amp;quot;target&amp;quot;, 348, 2, &amp;quot;PLAYER&amp;quot;) then
		return true
	end
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Doom</Name><Default>false</Default><SpellID>603</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if IsBossLVL then
		noDoom = nil
		if not HaveDebuff(&amp;quot;target&amp;quot;, 603, 13, &amp;quot;PLAYER&amp;quot;) then
			return true
		end
	else
		noDoom = 1
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>True</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Agony</Name><Default>false</Default><SpellID>980</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if noDoom == 1 then
		if not HaveDebuff(&amp;quot;target&amp;quot;, 980, 0, &amp;quot;PLAYER&amp;quot;) then
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>DoT - Corruption</Name><Default>false</Default><SpellID>172</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if not HaveDebuff(&amp;quot;target&amp;quot;, 172, 2, &amp;quot;PLAYER&amp;quot;) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spec - Hand of Guldan</Name><Default>false</Default><SpellID>71521</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if PQR_SpellAvailable(71521) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Filler - Incinerate</Name><Default>false</Default><SpellID>29722</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyHP &amp;gt; 25 or HaveBuff(&amp;quot;player&amp;quot;, 71165) then return true end
end</Lua><RecastDelay>200</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Spell - Soul Fire/Proc</Name><Default>false</Default><SpellID>6353</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if HaveBuff(&amp;quot;player&amp;quot;, 74434) then return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Test</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if UnitExists(&amp;quot;target&amp;quot;) then
	ParseGUID(UnitGUID(&amp;quot;target&amp;quot;))
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></WARLOCK>