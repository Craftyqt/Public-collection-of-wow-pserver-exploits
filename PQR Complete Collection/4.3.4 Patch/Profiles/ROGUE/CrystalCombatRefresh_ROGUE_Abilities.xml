<?xml version="1.0" encoding="utf-8" ?><ROGUE><Ability><Name>--Calcs/Functions--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Player Info
PlayerEnergy		= UnitPower(&amp;quot;player&amp;quot;)
PlayerHP			= 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;)
PlayerCombat		= UnitAffectingCombat(&amp;quot;player&amp;quot;)
PlayerThreat		= UnitThreatSituation(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;)
PlayerLevel			= UnitLevel(&amp;quot;player&amp;quot;)

--PQR Functions
isMoving			= PQR_IsMoving()

--Key Mods
lShift				= IsLeftShiftKeyDown()
lCtrl				= IsLeftControlKeyDown()
lAlt				= IsLeftAltKeyDown()
rShift				= IsRightShiftKeyDown()
rCtrl				= IsRightControlKeyDown()
rAlt				= IsRightAltKeyDown()


--Target Info
local hasTarget		= UnitExists(&amp;quot;target&amp;quot;)

if hasTarget then
	EnemyHP				= 100 * UnitHealth(&amp;quot;target&amp;quot;) / UnitHealthMax(&amp;quot;target&amp;quot;)
	EnemyLevel			= UnitLevel(&amp;quot;target&amp;quot;)
	EnemyExists			= UnitExists(&amp;quot;target&amp;quot;)
	InteractRange		= CheckInteractDistance(&amp;quot;target&amp;quot;, 3)
	EnemyID				= tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(-13, -9), 16)
	EnemyCP			    = GetComboPoints( &amp;quot;player&amp;quot;, &amp;quot;target&amp;quot; )
	
	--Level Check	
	if EnemyLevel &amp;gt;= (PlayerLevel + 2) or EnemyLevel == -1 then
		IsBossLVL = 1 else IsBossLVL = nil
	end
	
	--Range Check
	if PQR_UnitDistance(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) &amp;gt; 11 then
		PlayerInRange = 1 else PlayerInRange = nil
	end
	
	--Is Player Behind Target Check
	if PQR_UnitFacing(&amp;quot;target&amp;quot;, &amp;quot;player&amp;quot;) then
		PlayerIsBehind = 1 else PlayerIsBehind = nil
	end
end
--End Target Info

--Code by Sheruon
function HaveBuff(UnitID,SpellID,TimeLeft,Filter) 
  if not TimeLeft then TimeLeft = 0 end
  if type(SpellID) == &amp;quot;number&amp;quot; then SpellID = { SpellID } end 
  for i=1,#SpellID do 
    local spell, rank = GetSpellInfo(SpellID[i])
    if spell then
      local buff = select(7,UnitBuff(UnitID,spell,rank,Filter)) 
      if buff and ( buff == 0 or buff - GetTime() &amp;gt; TimeLeft ) then return true end
    end
  end
end

function HaveDebuff(UnitID,SpellID,TimeLeft,Filter) 
  if not TimeLeft then TimeLeft = 0 end
  if type(SpellID) == &amp;quot;number&amp;quot; then SpellID = { SpellID } end 
  for i=1,#SpellID do 
    local spell, rank = GetSpellInfo(SpellID[i])
    if spell then
      local debuff = select(7,UnitDebuff(UnitID,spell,rank,Filter)) 
      if debuff and ( debuff == 0 or debuff - GetTime() &amp;gt; TimeLeft ) then return true end
    end
  end
end
--End Code by Sheruon</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Poisons--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code by Sheuron
--tweaked by Crystal_tech
----added code to prevent error if you don&amp;apos;t have the item in your bags

local instantcount = GetItemCount(6947)
local deadlycount = GetItemCount(2892)
local woundcount = GetItemCount(10918)

if instantcount &amp;gt;= 1 then
	iposion = 1 else ipoison = nil
end

if deadlycount &amp;gt;= 1 then
	dposion = 1 else dposion = nil
end

if woundcount &amp;gt;= 1 then
	wposion = 1 else wposion = nil
end

if not PlayerCombat and ( not applypoison or GetTime() - applypoison &amp;gt; 3 ) then
  applypoison = GetTime()
  local _,poisonMH,_,_,poisonOH,_,_,poisonTR = GetWeaponEnchantInfo()
  if not poisonMH and iposion then 
    UseItemByName(tostring(GetItemInfo(6947))) 
    if SpellIsTargeting() then PickupInventoryItem(16) end
  elseif not poisonOH and dposion then 
    UseItemByName(tostring(GetItemInfo(2892))) 
    if SpellIsTargeting() then PickupInventoryItem(17) end
  elseif not poisonTR and wposion then
    UseItemByName(tostring(GetItemInfo(10918))) 
    if SpellIsTargeting() then PickupInventoryItem(18) end
  end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Pot - Tolvir</Name><Default>false</Default><SpellID>0</SpellID><Actions>/cast Potion of the Tol&amp;apos;vir</Actions><Lua>if EnemyExists and PlayerCombat then
	if HaveBuff(&amp;quot;player&amp;quot;, {2825, 32182, 80353, 90355}) and GetItemCount(58145) &amp;gt;= 1 then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Player</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Gloves</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if PlayerInRange then
		if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,10) == 0 then UseInventoryItem(10) end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Racial--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PlayerCombat and EnemyExists then
  -- Arcane Torrent (Blood Elf)(Rogue)
  if IsSpellKnown(25046) and GetSpellCooldown(25046) == 0 
  and PlayerEnergy &amp;lt; 35 
  then CastSpellByID(25046) return true end
  
  -- Berserking (Troll)(All Classes)
  if IsSpellKnown(26297) and GetSpellCooldown(26297) == 0 
  then CastSpellByID(26297) return true end

  -- Blood Fury (Orc) (Warrior, Hunter, Rogue, Death Knight )
  if IsSpellKnown(20572) and GetSpellCooldown(20572) == 0 
  then CastSpellByID(20572) return true end

  -- Will of the Forsaken (Undead)
  if not GotFear then
    function GotFear(t) 
      local debuff = { 10326, 8122, 2094, 5782, 5484, 6358, 5246 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(7744) and GetSpellCooldown(7744) == 0 and GotFear(&amp;quot;player&amp;quot;) 
  then CastSpellByID(7744) return true end

  -- Rocket Barrage (Goblin)
  if IsSpellKnown(69041) and GetSpellCooldown(69041) == 0 
  and IsSpellInRange(GetSpellInfo(69041),&amp;quot;target&amp;quot;) == 1 and UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) 
  then CastSpellByID(69041) return true end

  -- Stoneform (Dwarf)
  if not GotPoison then
    function GotPoison(t)
      local i, debuff = 1, select(5,UnitDebuff(t, 1)) 
      while debuff do
        if debuff == &amp;quot;Poison&amp;quot; or debuff == &amp;quot;Disease&amp;quot; then return true end
        i = i + 1 debuff = select(5,UnitDebuff(t, i)) 
      end
    end
  end
  if IsSpellKnown(20594) and GetSpellCooldown(20594) == 0 and GotPoison(&amp;quot;player&amp;quot;) 
  then CastSpellByID(20594) return true end

  -- Escape Artist (Gnome)
  if not CantMove then
    function CantMove(t) 
      local debuff = { 122, 53754, 1715, 12323, 3775, 339, 48483, 8056, 2974, 45524 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(20589) and GetSpellCooldown(20589) == 0 and CantMove(&amp;quot;player&amp;quot;) 
  then CastSpellByID(20589) return true end

  -- Every Man for Himself (Human)
  if not LostControl then
    function LostControl(t) 
      local debuff = { 122, 10326, 8122, 2094, 5782, 5484, 6358, 5246, 408 }
      for i=1, #debuff do if UnitDebuffID(t,debuff[i]) then return true end end
    end
  end
  if IsSpellKnown(59752) and GetSpellCooldown(59752) == 0 and LostControl(&amp;quot;player&amp;quot;) 
  then CastSpellByID(59752) return true end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Set Focus--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if rShift then
	FocusUnit(&amp;quot;mouseover&amp;quot;)
end</Lua><RecastDelay>0</RecastDelay><Target>Mouseover</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Tricks of the Trade</Name><Default>false</Default><SpellID>57934</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if UnitExists(&amp;quot;focus&amp;quot;) and PQR_SpellAvailable(57934) then
		if not HaveBuff(&amp;quot;player&amp;quot;, 1784) then
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Focus</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CPS - Slice and Dice</Name><Default>false</Default><SpellID>5171</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if not HaveBuff(&amp;quot;player&amp;quot;, 5171, 2) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Killing Spree</Name><Default>false</Default><SpellID>51690</SpellID><Actions></Actions><Lua>local SnDTimer = select(7,UnitBuffID(&amp;quot;player&amp;quot;, 5171)
local Arush = select(3, GetSpellCooldown(13750)

if EnemyExists and PlayerCombat then
	if lShift and PQR_SpellAvailable(51690) then
		if PlayerEnergy &amp;lt; 35 and SnDTimer - GetTime() &amp;gt; 4 and Arush == 1 then
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Adrenaline Rush</Name><Default>false</Default><SpellID>13750</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if PQR_SpellAvailable(13750) then
		if PlayerEnergy &amp;lt; 35 then
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CPS - Eviscerate</Name><Default>false</Default><SpellID>2098</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyCP == 5 and UnitDebuffID(&amp;quot;target&amp;quot;, 84747, &amp;quot;PLAYER&amp;quot;) then
		return true
	elseif EnemyCP == 5 and UnitDebuffID(&amp;quot;target&amp;quot;, 1943, &amp;quot;PLAYER&amp;quot;) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CPS - Rupture</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyCP == 5 and not UnitDebuff(&amp;quot;target&amp;quot;, 1943, &amp;quot;PLAYER&amp;quot;) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CPG - Revealing Strike</Name><Default>false</Default><SpellID>84617</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyCP == 4 and not HaveBuff(&amp;quot;player&amp;quot;, 84617) then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CPG - Sinister Strike</Name><Default>false</Default><SpellID>1752</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyCP &amp;lt; 5 then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Extra Actions--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Code provided by Sheuron
-- Avoid sudden death on Ultraxion
local fadingtime = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,110070))
if fadingtime and fadingtime - GetTime() &amp;lt; 1.3 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end 

-- Code provided by Kickmydog
-- Avoid Hour of Twilight on Ultraxion, deterrence to cancel use.
if not UnitBuffID(&amp;quot;player&amp;quot;,31224) then
	local HourOfTwilight,_,_,_,_,endTime = UnitCastingInfo(&amp;quot;boss1&amp;quot;)
	if HourOfTwilight == GetSpellInfo(109417) and endTime/1000 - GetTime() &amp;lt;= 1.3 then
		RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;)
	end
end

-- Code provided by Kickmydog
-- Avoid Fragmentation on Madness
local tentacledeath = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,109597))
if tentacledeath and tentacledeath - GetTime() &amp;lt; 0.7 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Lightwell--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>--Code provided by Xelper
local LightwellName = &amp;quot;Lightwell&amp;quot;
local sLightwell = UnitBuffID(&amp;quot;player&amp;quot;, 7001)
local sDeepCorruption = UnitDebuffID(&amp;quot;player&amp;quot;, 108220)
if PQR_LightwellTimeout == nil then
    PQR_LightwellTimeout = 0
end

if PlayerHP &amp;lt; 70 and sLightwell == nil then
    if PQR_LightwellTimeout &amp;lt; GetTime() then
        if sDeepCorruption == nil then
            PQR_LightwellTimeout = GetTime() + 1
            InteractUnit(LightwellName)
        end
    end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--Pause--</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if lAlt
or IsMounted()
or SpellIsTargeting()
or UnitBuffID(&amp;quot;player&amp;quot;,80169)
or UnitBuffID(&amp;quot;player&amp;quot;,77769)
or UnitBuffID(&amp;quot;player&amp;quot;,5384)
or UnitInVehicle(&amp;quot;player&amp;quot;)
or UnitIsDead(&amp;quot;target&amp;quot;) 
or UnitIsDead(&amp;quot;player&amp;quot;)
or not PlayerCombat then
	return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>AoE - Fan of Knifes</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if PlayerCombat then
	if lCtrl then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CD - Vanish</Name><Default>false</Default><SpellID>1856</SpellID><Actions>/cleartarget|/stopattack</Actions><Lua>if PlayerCombat then
	if rAlt then
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>CPS - Recuperate</Name><Default>false</Default><SpellID>73651</SpellID><Actions></Actions><Lua>if EnemyExists and PlayerCombat then
	if EnemyCP &amp;gt; 2 and PlayerHP &amp;lt; 60 then
		if not HaveBuff(&amp;quot;player&amp;quot;, 73651) then
			return true
		end
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Trinket 1</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Code provided by Sheuron
if EnemyExists and PlayerCombat then
	if GetInventoryItemCooldown(&amp;quot;player&amp;quot;,13) == 0 and PlayerInRange and not HaveBuff(&amp;quot;player&amp;quot;, 1784) then
		UseInventoryItem(13)
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Item - Trinket 2</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Code provided by Sheuron
local _,cd,havecd = GetInventoryItemCooldown(&amp;quot;player&amp;quot;,14)
if EnemyExists and PlayerCombat then
	if cd == 0 and havecd == 1 and not UnitChannelInfo(&amp;quot;player&amp;quot;) and PlayerInRange and not HaveBuff(&amp;quot;player&amp;quot;, 1784) then 
		UseInventoryItem(14) 
		return true
	end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></ROGUE>