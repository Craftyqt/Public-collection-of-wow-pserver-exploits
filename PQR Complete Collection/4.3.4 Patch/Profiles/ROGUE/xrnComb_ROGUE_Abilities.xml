<?xml version="1.0" encoding="utf-8" ?><ROGUE><Ability><Name>Sinister Strike</Name><Default>false</Default><SpellID>1752</SpellID><Actions></Actions><Lua>if GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) &amp;lt; 4 then
   return true
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Eviscerate</Name><Default>false</Default><SpellID>2098</SpellID><Actions></Actions><Lua>if GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) == 5 
or UnitHealth(&amp;quot;target&amp;quot;) &amp;lt; UnitHealthMax(&amp;quot;player&amp;quot;)
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Revealing Strike</Name><Default>false</Default><SpellID>84617</SpellID><Actions></Actions><Lua>if GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) == 4 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Rupture</Name><Default>false</Default><SpellID>1943</SpellID><Actions></Actions><Lua>if not BleedDebuff then 
  function BleedDebuff(t)
    local buff = { 35290, 50271, 57386, 33878, 29859, 16511 }
    for _,v in ipairs(buff) do if UnitDebuffID(t,v) then return true end end
  end
end

if BleedDebuff(&amp;quot;target&amp;quot;)  
and not UnitDebuffID(&amp;quot;target&amp;quot;,1943) 
and not UnitBuffID(&amp;quot;player&amp;quot;,13877) 
and GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) &amp;gt; 3 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Shiv</Name><Default>false</Default><SpellID>5938</SpellID><Actions></Actions><Lua>local i = 1
local buff = UnitBuff(&amp;quot;target&amp;quot;, i)
while buff do
  if buff == &amp;quot;Enrage&amp;quot; then return true end
  i = i + 1;
  buff = UnitBuff(&amp;quot;target&amp;quot;, i) 
end</Lua><RecastDelay>500</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Slice and Dice</Name><Default>false</Default><SpellID>5171</SpellID><Actions></Actions><Lua>local sliceanddicetimer = select(7,UnitBuffID(&amp;quot;player&amp;quot;, 5171))

if not sliceanddicetimer or sliceanddicetimer - GetTime() &amp;lt; 2 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Apply Poisons</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not UnitAffectingCombat(&amp;quot;player&amp;quot;) and ( not applypoison or GetTime() - applypoison &amp;gt; 3 ) then
  applypoison = GetTime()
  local _,poisonMH,_,_,poisonOH,_,_,poisonTR = GetWeaponEnchantInfo()
  if not poisonMH then 
    UseItemByName(tostring(GetItemInfo(6947))) 
    if SpellIsTargeting() then PickupInventoryItem(16) end
  elseif not poisonOH then 
    UseItemByName(tostring(GetItemInfo(2892))) 
    if SpellIsTargeting() then PickupInventoryItem(17) end
  elseif not poisonTR then
    UseItemByName(tostring(GetItemInfo(10918))) 
    if SpellIsTargeting() then PickupInventoryItem(18) end
  end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Assist Tank</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if GetNumPartyMembers() &amp;gt; 0 and UnitInRaid(&amp;quot;player&amp;quot;) == nil then

local heisthetank = nil

for i = 1, GetNumPartyMembers(), 1 do
  if UnitGroupRolesAssigned(&amp;quot;party&amp;quot;..tostring(i)) == &amp;quot;TANK&amp;quot; then heisthetank = &amp;quot;party&amp;quot;..tostring(i) end
end

if heisthetank and UnitExists(&amp;quot;target&amp;quot;) == nil 
and UnitAffectingCombat(heisthetank) 
and UnitAffectingCombat(heisthetank..&amp;quot;target&amp;quot;) 
and UnitIsDead(heisthetank..&amp;quot;target&amp;quot;) == nil
and UnitCanAttack(&amp;quot;player&amp;quot;,heisthetank..&amp;quot;target&amp;quot;)
then TargetUnit(heisthetank..&amp;quot;target&amp;quot;) end

end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Killing Spree</Name><Default>false</Default><SpellID>51690</SpellID><Actions></Actions><Lua>if UnitPower(&amp;quot;player&amp;quot;) &amp;lt; 25 
and UnitBuffID(&amp;quot;player&amp;quot;,84747) 
and canAOE 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Tricks of the Trade</Name><Default>false</Default><SpellID>57934</SpellID><Actions></Actions><Lua>if TricksTarget and CanHeal(TricksTarget) then
  PQR_CustomTarget = TricksTarget 
  return true
else
  local top = { 0, nil } 
  for i=1,#members do
    if UnitHealthMax(members[i].Unit) &amp;gt; top[1] and not UnitIsUnit(&amp;quot;player&amp;quot;,members[i].Unit) and UnitGroupRolesAssigned(members[i].Unit) ~= &amp;quot;HEALER&amp;quot; 
    then top = { UnitHealthMax(members[i].Unit), members[i].Unit } end
  end
  if top[2] then
    PQR_CustomTarget = top[2] 
    return true
  end
end</Lua><RecastDelay>0</RecastDelay><Target>Custom</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Fan of Knives</Name><Default>false</Default><SpellID>51723</SpellID><Actions></Actions><Lua>if IsLeftShiftKeyDown() 
and not GetCurrentKeyBoardFocus() 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Ambush</Name><Default>false</Default><SpellID>8676</SpellID><Actions></Actions><Lua>return true</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Adrenaline Rush</Name><Default>false</Default><SpellID>13750</SpellID><Actions></Actions><Lua>if UnitPower(&amp;quot;player&amp;quot;) &amp;lt; 25 
and ( UnitBuffID(&amp;quot;player&amp;quot;,13877) or UnitHealth(&amp;quot;target&amp;quot;) &amp;gt; UnitHealthMax(&amp;quot;player&amp;quot;)*10 )
and not HoldCooldown(3) 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Recuperate</Name><Default>false</Default><SpellID>73651</SpellID><Actions></Actions><Lua>if GetNumPartyMembers() == 0 
and not UnitBuffID(&amp;quot;player&amp;quot;,73651) 
and 100 * UnitHealth(&amp;quot;player&amp;quot;) / UnitHealthMax(&amp;quot;player&amp;quot;) &amp;lt; 80
and GetComboPoints(&amp;quot;player&amp;quot;, &amp;quot;target&amp;quot;) &amp;gt; 1
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>Pick Lock</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>local name,_,_,_,_,enchant = GetTradeTargetItemInfo(7)

if name and string.find(name,&amp;quot;Lockbox&amp;quot;) then
  if enchant then
    AcceptTrade()
  else
    CastSpellByID(1804)
    ClickTargetTradeButton(7)
  end
end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--- initialize ---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if not PQR_LoadLua(&amp;quot;PQR_xrn.lua&amp;quot;) then
  PQR_WriteToChat(&amp;quot;PQR_xrn.lua is missing. Rotation has been stopped.&amp;quot;, &amp;quot;Error&amp;quot;)
  PQR_StopRotation()
  return true
end

CastClick() 
HealEngine() 
ModSwitch(&amp;quot;Killing Spree: \124cFFE61515Disabled&amp;quot;,&amp;quot;Killing Spree: \124cFF15E61CEnabled&amp;quot;) 

if IsLeftAltKeyDown() 
or IsMounted()
or SpellIsTargeting()
or UnitBuffID(&amp;quot;player&amp;quot;,80169)
or UnitBuffID(&amp;quot;player&amp;quot;,87959)
or UnitChannelInfo(&amp;quot;player&amp;quot;) 
or UnitIsDeadOrGhost(&amp;quot;player&amp;quot;) 
or UnitIsDeadOrGhost(&amp;quot;target&amp;quot;) 
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--- special events ---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>-- Avoid sudden death on Ultraxion
local fadingtime = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,110070))
if fadingtime and fadingtime - GetTime() &amp;lt; 1.5 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end 

-- Avoid Hour of Twilight on Ultraxion, Delete next 3 lines if you are working as tank
local channelSpell, _, _, _, _, endTime = UnitCastingInfo(&amp;quot;boss1&amp;quot;)
if channelSpell == GetSpellInfo(109417) and endTime/1000 - GetTime() &amp;lt; 1.1 
then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end 

-- Avoid sudden death on Madness 
local tentacledeath = select(7,UnitDebuffID(&amp;quot;player&amp;quot;,109597))
if tentacledeath and tentacledeath - GetTime() &amp;lt; 1 then RunMacroText(&amp;quot;/click ExtraActionButton1&amp;quot;) end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability><Ability><Name>--- offensive spells ---</Name><Default>false</Default><SpellID>0</SpellID><Actions></Actions><Lua>if IsMouseButtonDown(3) and ( not middlebuttondown or GetTime() - middlebuttondown &amp;gt; 0.3 ) then 
  middlebuttondown = GetTime() 
  TricksTarget = CanHeal(&amp;quot;mouseover&amp;quot;) and GetMouseFocus() ~= WorldFrame and not UnitIsUnit(&amp;quot;mouseover&amp;quot;,&amp;quot;player&amp;quot;) and UnitName(&amp;quot;mouseover&amp;quot;) or false 
  if TricksTarget then 
    local colors = RAID_CLASS_COLORS[select(2,UnitClass(&amp;quot;mouseover&amp;quot;))] 
    PQR_WriteToChat(&amp;quot;Tricks of the Trade is focus on: &amp;quot;..string.format(&amp;quot;|cff%02x%02x%02x&amp;quot;, colors.r*255, colors.g*255, colors.b*255)..TricksTarget) 
  else
    PQR_WriteToChat(&amp;quot;Tricks of the Trade will target player with hightest HP&amp;quot;) 
  end
end 

if UnitIsDead(&amp;quot;target&amp;quot;) 
or ImmuneTarget(&amp;quot;target&amp;quot;) 
or not UnitCanAttack(&amp;quot;player&amp;quot;,&amp;quot;target&amp;quot;) 
or tonumber(UnitGUID(&amp;quot;target&amp;quot;):sub(5,5),16) == 4
or ( not UnitAffectingCombat(&amp;quot;target&amp;quot;) and not SpecialAggro(&amp;quot;target&amp;quot;) and not UnitIsPlayer(&amp;quot;target&amp;quot;) )
or ( GetNumPartyMembers() &amp;gt; 0 and UnitPower(&amp;quot;player&amp;quot;) &amp;lt; 70 and select(2,GetSpellCooldown(57934)) &amp;lt; 2 )
then return true end</Lua><RecastDelay>0</RecastDelay><Target>Target</Target><CancelChannel>False</CancelChannel><SkipUnknown>True</SkipUnknown></Ability></ROGUE>