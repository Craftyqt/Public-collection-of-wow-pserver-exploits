DIM $ACCTDL , $ACCTDIR , $CHECKVAL , $REASON
#RequireAdmin
#region includes
GLOBAL $SHISON = 0
GLOBAL CONST $BS_GROUPBOX = 7
GLOBAL CONST $BS_BOTTOM = 2048
GLOBAL CONST $BS_CENTER = 768
GLOBAL CONST $BS_DEFPUSHBUTTON = 1
GLOBAL CONST $BS_LEFT = 256
GLOBAL CONST $BS_MULTILINE = 8192
GLOBAL CONST $BS_PUSHBOX = 10
GLOBAL CONST $BS_PUSHLIKE = 4096
GLOBAL CONST $BS_RIGHT = 512
GLOBAL CONST $BS_RIGHTBUTTON = 32
GLOBAL CONST $BS_TOP = 1024
GLOBAL CONST $BS_VCENTER = 3072
GLOBAL CONST $BS_FLAT = 32768
GLOBAL CONST $BS_ICON = 64
GLOBAL CONST $BS_BITMAP = 128
GLOBAL CONST $BS_NOTIFY = 16384
GLOBAL CONST $BS_SPLITBUTTON = 12
GLOBAL CONST $BS_DEFSPLITBUTTON = 13
GLOBAL CONST $BS_COMMANDLINK = 14
GLOBAL CONST $BS_DEFCOMMANDLINK = 15
GLOBAL CONST $BCSIF_GLYPH = 1
GLOBAL CONST $BCSIF_IMAGE = 2
GLOBAL CONST $BCSIF_STYLE = 4
GLOBAL CONST $BCSIF_SIZE = 8
GLOBAL CONST $BCSS_NOSPLIT = 1
GLOBAL CONST $BCSS_STRETCH = 2
GLOBAL CONST $BCSS_ALIGNLEFT = 4
GLOBAL CONST $BCSS_IMAGE = 8
GLOBAL CONST $BUTTON_IMAGELIST_ALIGN_LEFT = 0
GLOBAL CONST $BUTTON_IMAGELIST_ALIGN_RIGHT = 1
GLOBAL CONST $BUTTON_IMAGELIST_ALIGN_TOP = 2
GLOBAL CONST $BUTTON_IMAGELIST_ALIGN_BOTTOM = 3
GLOBAL CONST $BUTTON_IMAGELIST_ALIGN_CENTER = 4
GLOBAL CONST $BS_3STATE = 5
GLOBAL CONST $BS_AUTO3STATE = 6
GLOBAL CONST $BS_AUTOCHECKBOX = 3
GLOBAL CONST $BS_CHECKBOX = 2
GLOBAL CONST $BS_RADIOBUTTON = 4
GLOBAL CONST $BS_AUTORADIOBUTTON = 9
GLOBAL CONST $BS_OWNERDRAW = 11
GLOBAL CONST $GUI_SS_DEFAULT_BUTTON = 0
GLOBAL CONST $GUI_SS_DEFAULT_CHECKBOX = 0
GLOBAL CONST $GUI_SS_DEFAULT_GROUP = 0
GLOBAL CONST $GUI_SS_DEFAULT_RADIO = 0
GLOBAL CONST $BCM_FIRST = 5632
GLOBAL CONST $BCM_GETIDEALSIZE = ( $BCM_FIRST + 1 )
GLOBAL CONST $BCM_GETIMAGELIST = ( $BCM_FIRST + 3 )
GLOBAL CONST $BCM_GETNOTE = ( $BCM_FIRST + 10 )
GLOBAL CONST $BCM_GETNOTELENGTH = ( $BCM_FIRST + 11 )
GLOBAL CONST $BCM_GETSPLITINFO = ( $BCM_FIRST + 8 )
GLOBAL CONST $BCM_GETTEXTMARGIN = ( $BCM_FIRST + 5 )
GLOBAL CONST $BCM_SETDROPDOWNSTATE = ( $BCM_FIRST + 6 )
GLOBAL CONST $BCM_SETIMAGELIST = ( $BCM_FIRST + 2 )
GLOBAL CONST $BCM_SETNOTE = ( $BCM_FIRST + 9 )
GLOBAL CONST $BCM_SETSHIELD = ( $BCM_FIRST + 12 )
GLOBAL CONST $BCM_SETSPLITINFO = ( $BCM_FIRST + 7 )
GLOBAL CONST $BCM_SETTEXTMARGIN = ( $BCM_FIRST + 4 )
GLOBAL CONST $BM_CLICK = 245
GLOBAL CONST $BM_GETCHECK = 240
GLOBAL CONST $BM_GETIMAGE = 246
GLOBAL CONST $BM_GETSTATE = 242
GLOBAL CONST $BM_SETCHECK = 241
GLOBAL CONST $BM_SETDONTCLICK = 248
GLOBAL CONST $BM_SETIMAGE = 247
GLOBAL CONST $BM_SETSTATE = 243
GLOBAL CONST $BM_SETSTYLE = 244
GLOBAL CONST $BCN_FIRST = - 1250
GLOBAL CONST $BCN_DROPDOWN = ( $BCN_FIRST + 2 )
GLOBAL CONST $BCN_HOTITEMCHANGE = ( $BCN_FIRST + 1 )
GLOBAL CONST $BN_CLICKED = 0
GLOBAL CONST $BN_PAINT = 1
GLOBAL CONST $BN_HILITE = 2
GLOBAL CONST $BN_UNHILITE = 3
GLOBAL CONST $BN_DISABLE = 4
GLOBAL CONST $BN_DOUBLECLICKED = 5
GLOBAL CONST $BN_SETFOCUS = 6
GLOBAL CONST $BN_KILLFOCUS = 7
GLOBAL CONST $BN_PUSHED = $BN_HILITE
GLOBAL CONST $BN_UNPUSHED = $BN_UNHILITE
GLOBAL CONST $BN_DBLCLK = $BN_DOUBLECLICKED
GLOBAL CONST $BST_CHECKED = 1
GLOBAL CONST $BST_INDETERMINATE = 2
GLOBAL CONST $BST_UNCHECKED = 0
GLOBAL CONST $BST_FOCUS = 8
GLOBAL CONST $BST_PUSHED = 4
GLOBAL CONST $BST_DONTCLICK = 128
GLOBAL CONST $ES_LEFT = 0
GLOBAL CONST $ES_CENTER = 1
GLOBAL CONST $ES_RIGHT = 2
GLOBAL CONST $ES_MULTILINE = 4
GLOBAL CONST $ES_UPPERCASE = 8
GLOBAL CONST $ES_LOWERCASE = 16
GLOBAL CONST $ES_PASSWORD = 32
GLOBAL CONST $ES_AUTOVSCROLL = 64
GLOBAL CONST $ES_AUTOHSCROLL = 128
GLOBAL CONST $ES_NOHIDESEL = 256
GLOBAL CONST $ES_OEMCONVERT = 1024
GLOBAL CONST $ES_READONLY = 2048
GLOBAL CONST $ES_WANTRETURN = 4096
GLOBAL CONST $ES_NUMBER = 8192
GLOBAL CONST $EC_ERR = - 1
GLOBAL CONST $ECM_FIRST = 5376
GLOBAL CONST $EM_CANUNDO = 198
GLOBAL CONST $EM_CHARFROMPOS = 215
GLOBAL CONST $EM_EMPTYUNDOBUFFER = 205
GLOBAL CONST $EM_FMTLINES = 200
GLOBAL CONST $EM_GETCUEBANNER = ( $ECM_FIRST + 2 )
GLOBAL CONST $EM_GETFIRSTVISIBLELINE = 206
GLOBAL CONST $EM_GETHANDLE = 189
GLOBAL CONST $EM_GETIMESTATUS = 217
GLOBAL CONST $EM_GETLIMITTEXT = 213
GLOBAL CONST $EM_GETLINE = 196
GLOBAL CONST $EM_GETLINECOUNT = 186
GLOBAL CONST $EM_GETMARGINS = 212
GLOBAL CONST $EM_GETMODIFY = 184
GLOBAL CONST $EM_GETPASSWORDCHAR = 210
GLOBAL CONST $EM_GETRECT = 178
GLOBAL CONST $EM_GETSEL = 176
GLOBAL CONST $EM_GETTHUMB = 190
GLOBAL CONST $EM_GETWORDBREAKPROC = 209
GLOBAL CONST $EM_HIDEBALLOONTIP = ( $ECM_FIRST + 4 )
GLOBAL CONST $EM_LIMITTEXT = 197
GLOBAL CONST $EM_LINEFROMCHAR = 201
GLOBAL CONST $EM_LINEINDEX = 187
GLOBAL CONST $EM_LINELENGTH = 193
GLOBAL CONST $EM_LINESCROLL = 182
GLOBAL CONST $EM_POSFROMCHAR = 214
GLOBAL CONST $EM_REPLACESEL = 194
GLOBAL CONST $EM_SCROLL = 181
GLOBAL CONST $EM_SCROLLCARET = 183
GLOBAL CONST $EM_SETCUEBANNER = ( $ECM_FIRST + 1 )
GLOBAL CONST $EM_SETHANDLE = 188
GLOBAL CONST $EM_SETIMESTATUS = 216
GLOBAL CONST $EM_SETLIMITTEXT = $EM_LIMITTEXT
GLOBAL CONST $EM_SETMARGINS = 211
GLOBAL CONST $EM_SETMODIFY = 185
GLOBAL CONST $EM_SETPASSWORDCHAR = 204
GLOBAL CONST $EM_SETREADONLY = 207
GLOBAL CONST $EM_SETRECT = 179
GLOBAL CONST $EM_SETRECTNP = 180
GLOBAL CONST $EM_SETSEL = 177
GLOBAL CONST $EM_SETTABSTOPS = 203
GLOBAL CONST $EM_SETWORDBREAKPROC = 208
GLOBAL CONST $EM_SHOWBALLOONTIP = ( $ECM_FIRST + 3 )
GLOBAL CONST $EM_UNDO = 199
GLOBAL CONST $EC_LEFTMARGIN = 1
GLOBAL CONST $EC_RIGHTMARGIN = 2
GLOBAL CONST $EC_USEFONTINFO = 65535
GLOBAL CONST $EMSIS_COMPOSITIONSTRING = 1
GLOBAL CONST $EIMES_GETCOMPSTRATONCE = 1
GLOBAL CONST $EIMES_CANCELCOMPSTRINFOCUS = 2
GLOBAL CONST $EIMES_COMPLETECOMPSTRKILLFOCUS = 4
GLOBAL CONST $EN_ALIGN_LTR_EC = 1792
GLOBAL CONST $EN_ALIGN_RTL_EC = 1793
GLOBAL CONST $EN_CHANGE = 768
GLOBAL CONST $EN_ERRSPACE = 1280
GLOBAL CONST $EN_HSCROLL = 1537
GLOBAL CONST $EN_KILLFOCUS = 512
GLOBAL CONST $EN_MAXTEXT = 1281
GLOBAL CONST $EN_SETFOCUS = 256
GLOBAL CONST $EN_UPDATE = 1024
GLOBAL CONST $EN_VSCROLL = 1538
GLOBAL CONST $TTI_NONE = 0
GLOBAL CONST $TTI_INFO = 1
GLOBAL CONST $TTI_WARNING = 2
GLOBAL CONST $TTI_ERROR = 3
GLOBAL CONST $TTI_INFO_LARGE = 4
GLOBAL CONST $TTI_WARNING_LARGE = 5
GLOBAL CONST $TTI_ERROR_LARGE = 6
GLOBAL CONST $__EDITCONSTANT_WS_VSCROLL = 2097152
GLOBAL CONST $__EDITCONSTANT_WS_HSCROLL = 1048576
GLOBAL CONST $GUI_SS_DEFAULT_EDIT = BITOR ( $ES_WANTRETURN , $__EDITCONSTANT_WS_VSCROLL , $__EDITCONSTANT_WS_HSCROLL , $ES_AUTOVSCROLL , $ES_AUTOHSCROLL )
GLOBAL CONST $GUI_SS_DEFAULT_INPUT = BITOR ( $ES_LEFT , $ES_AUTOHSCROLL )
GLOBAL CONST $GUI_EVENT_CLOSE = - 3
GLOBAL CONST $GUI_EVENT_MINIMIZE = - 4
GLOBAL CONST $GUI_EVENT_RESTORE = - 5
GLOBAL CONST $GUI_EVENT_MAXIMIZE = - 6
GLOBAL CONST $GUI_EVENT_PRIMARYDOWN = - 7
GLOBAL CONST $GUI_EVENT_PRIMARYUP = - 8
GLOBAL CONST $GUI_EVENT_SECONDARYDOWN = - 9
GLOBAL CONST $GUI_EVENT_SECONDARYUP = - 10
GLOBAL CONST $GUI_EVENT_MOUSEMOVE = - 11
GLOBAL CONST $GUI_EVENT_RESIZED = - 12
GLOBAL CONST $GUI_EVENT_DROPPED = - 13
GLOBAL CONST $GUI_RUNDEFMSG = "GUI_RUNDEFMSG"
GLOBAL CONST $GUI_AVISTOP = 0
GLOBAL CONST $GUI_AVISTART = 1
GLOBAL CONST $GUI_AVICLOSE = 2
GLOBAL CONST $GUI_CHECKED = 1
GLOBAL CONST $GUI_INDETERMINATE = 2
GLOBAL CONST $GUI_UNCHECKED = 4
GLOBAL CONST $GUI_DROPACCEPTED = 8
GLOBAL CONST $GUI_NODROPACCEPTED = 4096
GLOBAL CONST $GUI_ACCEPTFILES = $GUI_DROPACCEPTED
GLOBAL CONST $GUI_SHOW = 16
GLOBAL CONST $GUI_HIDE = 32
GLOBAL CONST $GUI_ENABLE = 64
GLOBAL CONST $GUI_DISABLE = 128
GLOBAL CONST $GUI_FOCUS = 256
GLOBAL CONST $GUI_NOFOCUS = 8192
GLOBAL CONST $GUI_DEFBUTTON = 512
GLOBAL CONST $GUI_EXPAND = 1024
GLOBAL CONST $GUI_ONTOP = 2048
GLOBAL CONST $GUI_FONTITALIC = 2
GLOBAL CONST $GUI_FONTUNDER = 4
GLOBAL CONST $GUI_FONTSTRIKE = 8
GLOBAL CONST $GUI_DOCKAUTO = 1
GLOBAL CONST $GUI_DOCKLEFT = 2
GLOBAL CONST $GUI_DOCKRIGHT = 4
GLOBAL CONST $GUI_DOCKHCENTER = 8
GLOBAL CONST $GUI_DOCKTOP = 32
GLOBAL CONST $GUI_DOCKBOTTOM = 64
GLOBAL CONST $GUI_DOCKVCENTER = 128
GLOBAL CONST $GUI_DOCKWIDTH = 256
GLOBAL CONST $GUI_DOCKHEIGHT = 512
GLOBAL CONST $GUI_DOCKSIZE = 768
GLOBAL CONST $GUI_DOCKMENUBAR = 544
GLOBAL CONST $GUI_DOCKSTATEBAR = 576
GLOBAL CONST $GUI_DOCKALL = 802
GLOBAL CONST $GUI_DOCKBORDERS = 102
GLOBAL CONST $GUI_GR_CLOSE = 1
GLOBAL CONST $GUI_GR_LINE = 2
GLOBAL CONST $GUI_GR_BEZIER = 4
GLOBAL CONST $GUI_GR_MOVE = 6
GLOBAL CONST $GUI_GR_COLOR = 8
GLOBAL CONST $GUI_GR_RECT = 10
GLOBAL CONST $GUI_GR_ELLIPSE = 12
GLOBAL CONST $GUI_GR_PIE = 14
GLOBAL CONST $GUI_GR_DOT = 16
GLOBAL CONST $GUI_GR_PIXEL = 18
GLOBAL CONST $GUI_GR_HINT = 20
GLOBAL CONST $GUI_GR_REFRESH = 22
GLOBAL CONST $GUI_GR_PENSIZE = 24
GLOBAL CONST $GUI_GR_NOBKCOLOR = - 2
GLOBAL CONST $GUI_BKCOLOR_DEFAULT = - 1
GLOBAL CONST $GUI_BKCOLOR_TRANSPARENT = - 2
GLOBAL CONST $GUI_BKCOLOR_LV_ALTERNATE = -33554432
GLOBAL CONST $GUI_WS_EX_PARENTDRAG = 1048576
GLOBAL CONST $SS_LEFT = 0
GLOBAL CONST $SS_CENTER = 1
GLOBAL CONST $SS_RIGHT = 2
GLOBAL CONST $SS_ICON = 3
GLOBAL CONST $SS_BLACKRECT = 4
GLOBAL CONST $SS_GRAYRECT = 5
GLOBAL CONST $SS_WHITERECT = 6
GLOBAL CONST $SS_BLACKFRAME = 7
GLOBAL CONST $SS_GRAYFRAME = 8
GLOBAL CONST $SS_WHITEFRAME = 9
GLOBAL CONST $SS_SIMPLE = 11
GLOBAL CONST $SS_LEFTNOWORDWRAP = 12
GLOBAL CONST $SS_BITMAP = 14
GLOBAL CONST $SS_ETCHEDHORZ = 16
GLOBAL CONST $SS_ETCHEDVERT = 17
GLOBAL CONST $SS_ETCHEDFRAME = 18
GLOBAL CONST $SS_NOPREFIX = 128
GLOBAL CONST $SS_NOTIFY = 256
GLOBAL CONST $SS_CENTERIMAGE = 512
GLOBAL CONST $SS_RIGHTJUST = 1024
GLOBAL CONST $SS_SUNKEN = 4096
GLOBAL CONST $GUI_SS_DEFAULT_LABEL = 0
GLOBAL CONST $GUI_SS_DEFAULT_GRAPHIC = 0
GLOBAL CONST $GUI_SS_DEFAULT_ICON = $SS_NOTIFY
GLOBAL CONST $GUI_SS_DEFAULT_PIC = $SS_NOTIFY
GLOBAL CONST $WS_TILED = 0
GLOBAL CONST $WS_OVERLAPPED = 0
GLOBAL CONST $WS_MAXIMIZEBOX = 65536
GLOBAL CONST $WS_MINIMIZEBOX = 131072
GLOBAL CONST $WS_TABSTOP = 65536
GLOBAL CONST $WS_GROUP = 131072
GLOBAL CONST $WS_SIZEBOX = 262144
GLOBAL CONST $WS_THICKFRAME = 262144
GLOBAL CONST $WS_SYSMENU = 524288
GLOBAL CONST $WS_HSCROLL = 1048576
GLOBAL CONST $WS_VSCROLL = 2097152
GLOBAL CONST $WS_DLGFRAME = 4194304
GLOBAL CONST $WS_BORDER = 8388608
GLOBAL CONST $WS_CAPTION = 12582912
GLOBAL CONST $WS_OVERLAPPEDWINDOW = 13565952
GLOBAL CONST $WS_TILEDWINDOW = 13565952
GLOBAL CONST $WS_MAXIMIZE = 16777216
GLOBAL CONST $WS_CLIPCHILDREN = 33554432
GLOBAL CONST $WS_CLIPSIBLINGS = 67108864
GLOBAL CONST $WS_DISABLED = 134217728
GLOBAL CONST $WS_VISIBLE = 268435456
GLOBAL CONST $WS_MINIMIZE = 536870912
GLOBAL CONST $WS_CHILD = 1073741824
GLOBAL CONST $WS_POPUP = -2147483648
GLOBAL CONST $WS_POPUPWINDOW = -2138570752
GLOBAL CONST $DS_MODALFRAME = 128
GLOBAL CONST $DS_SETFOREGROUND = 512
GLOBAL CONST $DS_CONTEXTHELP = 8192
GLOBAL CONST $WS_EX_ACCEPTFILES = 16
GLOBAL CONST $WS_EX_MDICHILD = 64
GLOBAL CONST $WS_EX_APPWINDOW = 262144
GLOBAL CONST $WS_EX_COMPOSITED = 33554432
GLOBAL CONST $WS_EX_CLIENTEDGE = 512
GLOBAL CONST $WS_EX_CONTEXTHELP = 1024
GLOBAL CONST $WS_EX_DLGMODALFRAME = 1
GLOBAL CONST $WS_EX_LEFTSCROLLBAR = 16384
GLOBAL CONST $WS_EX_OVERLAPPEDWINDOW = 768
GLOBAL CONST $WS_EX_RIGHT = 4096
GLOBAL CONST $WS_EX_STATICEDGE = 131072
GLOBAL CONST $WS_EX_TOOLWINDOW = 128
GLOBAL CONST $WS_EX_TOPMOST = 8
GLOBAL CONST $WS_EX_TRANSPARENT = 32
GLOBAL CONST $WS_EX_WINDOWEDGE = 256
GLOBAL CONST $WS_EX_LAYERED = 524288
GLOBAL CONST $WS_EX_CONTROLPARENT = 65536
GLOBAL CONST $WS_EX_LAYOUTRTL = 4194304
GLOBAL CONST $WS_EX_RTLREADING = 8192
GLOBAL CONST $WM_GETTEXTLENGTH = 14
GLOBAL CONST $WM_GETTEXT = 13
GLOBAL CONST $WM_SIZE = 5
GLOBAL CONST $WM_SIZING = 532
GLOBAL CONST $WM_USER = 1024
GLOBAL CONST $WM_CREATE = 1
GLOBAL CONST $WM_DESTROY = 2
GLOBAL CONST $WM_MOVE = 3
GLOBAL CONST $WM_ACTIVATE = 6
GLOBAL CONST $WM_SETFOCUS = 7
GLOBAL CONST $WM_KILLFOCUS = 8
GLOBAL CONST $WM_ENABLE = 10
GLOBAL CONST $WM_SETREDRAW = 11
GLOBAL CONST $WM_SETTEXT = 12
GLOBAL CONST $WM_PAINT = 15
GLOBAL CONST $WM_CLOSE = 16
GLOBAL CONST $WM_QUERYENDSESSION = 17
GLOBAL CONST $WM_QUIT = 18
GLOBAL CONST $WM_ERASEBKGND = 20
GLOBAL CONST $WM_QUERYOPEN = 19
GLOBAL CONST $WM_SYSCOLORCHANGE = 21
GLOBAL CONST $WM_ENDSESSION = 22
GLOBAL CONST $WM_SHOWWINDOW = 24
GLOBAL CONST $WM_SETTINGCHANGE = 26
GLOBAL CONST $WM_WININICHANGE = 26
GLOBAL CONST $WM_DEVMODECHANGE = 27
GLOBAL CONST $WM_ACTIVATEAPP = 28
GLOBAL CONST $WM_FONTCHANGE = 29
GLOBAL CONST $WM_TIMECHANGE = 30
GLOBAL CONST $WM_CANCELMODE = 31
GLOBAL CONST $WM_IME_STARTCOMPOSITION = 269
GLOBAL CONST $WM_IME_ENDCOMPOSITION = 270
GLOBAL CONST $WM_IME_COMPOSITION = 271
GLOBAL CONST $WM_IME_KEYLAST = 271
GLOBAL CONST $WM_SETCURSOR = 32
GLOBAL CONST $WM_MOUSEACTIVATE = 33
GLOBAL CONST $WM_CHILDACTIVATE = 34
GLOBAL CONST $WM_QUEUESYNC = 35
GLOBAL CONST $WM_GETMINMAXINFO = 36
GLOBAL CONST $WM_PAINTICON = 38
GLOBAL CONST $WM_ICONERASEBKGND = 39
GLOBAL CONST $WM_NEXTDLGCTL = 40
GLOBAL CONST $WM_SPOOLERSTATUS = 42
GLOBAL CONST $WM_DRAWITEM = 43
GLOBAL CONST $WM_MEASUREITEM = 44
GLOBAL CONST $WM_DELETEITEM = 45
GLOBAL CONST $WM_VKEYTOITEM = 46
GLOBAL CONST $WM_CHARTOITEM = 47
GLOBAL CONST $WM_SETFONT = 48
GLOBAL CONST $WM_GETFONT = 49
GLOBAL CONST $WM_SETHOTKEY = 50
GLOBAL CONST $WM_GETHOTKEY = 51
GLOBAL CONST $WM_QUERYDRAGICON = 55
GLOBAL CONST $WM_COMPAREITEM = 57
GLOBAL CONST $WM_GETOBJECT = 61
GLOBAL CONST $WM_COMPACTING = 65
GLOBAL CONST $WM_COMMNOTIFY = 68
GLOBAL CONST $WM_WINDOWPOSCHANGING = 70
GLOBAL CONST $WM_WINDOWPOSCHANGED = 71
GLOBAL CONST $WM_POWER = 72
GLOBAL CONST $WM_NOTIFY = 78
GLOBAL CONST $WM_COPYDATA = 74
GLOBAL CONST $WM_CANCELJOURNAL = 75
GLOBAL CONST $WM_INPUTLANGCHANGEREQUEST = 80
GLOBAL CONST $WM_INPUTLANGCHANGE = 81
GLOBAL CONST $WM_TCARD = 82
GLOBAL CONST $WM_HELP = 83
GLOBAL CONST $WM_USERCHANGED = 84
GLOBAL CONST $WM_NOTIFYFORMAT = 85
GLOBAL CONST $WM_PARENTNOTIFY = 528
GLOBAL CONST $WM_ENTERMENULOOP = 529
GLOBAL CONST $WM_EXITMENULOOP = 530
GLOBAL CONST $WM_NEXTMENU = 531
GLOBAL CONST $WM_CAPTURECHANGED = 533
GLOBAL CONST $WM_MOVING = 534
GLOBAL CONST $WM_POWERBROADCAST = 536
GLOBAL CONST $WM_DEVICECHANGE = 537
GLOBAL CONST $WM_MDICREATE = 544
GLOBAL CONST $WM_MDIDESTROY = 545
GLOBAL CONST $WM_MDIACTIVATE = 546
GLOBAL CONST $WM_MDIRESTORE = 547
GLOBAL CONST $WM_MDINEXT = 548
GLOBAL CONST $WM_MDIMAXIMIZE = 549
GLOBAL CONST $WM_MDITILE = 550
GLOBAL CONST $WM_MDICASCADE = 551
GLOBAL CONST $WM_MDIICONARRANGE = 552
GLOBAL CONST $WM_MDIGETACTIVE = 553
GLOBAL CONST $WM_MDISETMENU = 560
GLOBAL CONST $WM_ENTERSIZEMOVE = 561
GLOBAL CONST $WM_EXITSIZEMOVE = 562
GLOBAL CONST $WM_DROPFILES = 563
GLOBAL CONST $WM_MDIREFRESHMENU = 564
GLOBAL CONST $WM_IME_SETCONTEXT = 641
GLOBAL CONST $WM_IME_NOTIFY = 642
GLOBAL CONST $WM_IME_CONTROL = 643
GLOBAL CONST $WM_IME_COMPOSITIONFULL = 644
GLOBAL CONST $WM_IME_SELECT = 645
GLOBAL CONST $WM_IME_CHAR = 646
GLOBAL CONST $WM_IME_REQUEST = 648
GLOBAL CONST $WM_IME_KEYDOWN = 656
GLOBAL CONST $WM_IME_KEYUP = 657
GLOBAL CONST $WM_NCMOUSEHOVER = 672
GLOBAL CONST $WM_MOUSEHOVER = 673
GLOBAL CONST $WM_NCMOUSELEAVE = 674
GLOBAL CONST $WM_MOUSELEAVE = 675
GLOBAL CONST $WM_WTSSESSION_CHANGE = 689
GLOBAL CONST $WM_TABLET_FIRST = 704
GLOBAL CONST $WM_TABLET_LAST = 735
GLOBAL CONST $WM_CUT = 768
GLOBAL CONST $WM_COPY = 769
GLOBAL CONST $WM_PASTE = 770
GLOBAL CONST $WM_CLEAR = 771
GLOBAL CONST $WM_UNDO = 772
GLOBAL CONST $WM_PALETTEISCHANGING = 784
GLOBAL CONST $WM_HOTKEY = 786
GLOBAL CONST $WM_PALETTECHANGED = 785
GLOBAL CONST $WM_PRINT = 791
GLOBAL CONST $WM_PRINTCLIENT = 792
GLOBAL CONST $WM_APPCOMMAND = 793
GLOBAL CONST $WM_QUERYNEWPALETTE = 783
GLOBAL CONST $WM_THEMECHANGED = 794
GLOBAL CONST $WM_HANDHELDFIRST = 856
GLOBAL CONST $WM_HANDHELDLAST = 863
GLOBAL CONST $WM_AFXFIRST = 864
GLOBAL CONST $WM_AFXLAST = 895
GLOBAL CONST $WM_PENWINFIRST = 896
GLOBAL CONST $WM_PENWINLAST = 911
GLOBAL CONST $WM_CONTEXTMENU = 123
GLOBAL CONST $WM_STYLECHANGING = 124
GLOBAL CONST $WM_STYLECHANGED = 125
GLOBAL CONST $WM_DISPLAYCHANGE = 126
GLOBAL CONST $WM_GETICON = 127
GLOBAL CONST $WM_SETICON = 128
GLOBAL CONST $WM_NCCREATE = 129
GLOBAL CONST $WM_NCDESTROY = 130
GLOBAL CONST $WM_NCCALCSIZE = 131
GLOBAL CONST $WM_NCHITTEST = 132
GLOBAL CONST $WM_NCPAINT = 133
GLOBAL CONST $WM_NCACTIVATE = 134
GLOBAL CONST $WM_GETDLGCODE = 135
GLOBAL CONST $WM_SYNCPAINT = 136
GLOBAL CONST $WM_NCMOUSEMOVE = 160
GLOBAL CONST $WM_NCLBUTTONDOWN = 161
GLOBAL CONST $WM_NCLBUTTONUP = 162
GLOBAL CONST $WM_NCLBUTTONDBLCLK = 163
GLOBAL CONST $WM_NCRBUTTONDOWN = 164
GLOBAL CONST $WM_NCRBUTTONUP = 165
GLOBAL CONST $WM_NCRBUTTONDBLCLK = 166
GLOBAL CONST $WM_NCMBUTTONDOWN = 167
GLOBAL CONST $WM_NCMBUTTONUP = 168
GLOBAL CONST $WM_NCMBUTTONDBLCLK = 169
GLOBAL CONST $WM_NCXBUTTONDOWN = 171
GLOBAL CONST $WM_NCXBUTTONUP = 172
GLOBAL CONST $WM_NCXBUTTONDBLCLK = 173
GLOBAL CONST $WM_KEYDOWN = 256
GLOBAL CONST $WM_KEYFIRST = 256
GLOBAL CONST $WM_KEYUP = 257
GLOBAL CONST $WM_CHAR = 258
GLOBAL CONST $WM_DEADCHAR = 259
GLOBAL CONST $WM_SYSKEYDOWN = 260
GLOBAL CONST $WM_SYSKEYUP = 261
GLOBAL CONST $WM_SYSCHAR = 262
GLOBAL CONST $WM_SYSDEADCHAR = 263
GLOBAL CONST $WM_KEYLAST = 265
GLOBAL CONST $WM_UNICHAR = 265
GLOBAL CONST $WM_INITDIALOG = 272
GLOBAL CONST $WM_COMMAND = 273
GLOBAL CONST $WM_SYSCOMMAND = 274
GLOBAL CONST $WM_TIMER = 275
GLOBAL CONST $WM_HSCROLL = 276
GLOBAL CONST $WM_VSCROLL = 277
GLOBAL CONST $WM_INITMENU = 278
GLOBAL CONST $WM_INITMENUPOPUP = 279
GLOBAL CONST $WM_MENUSELECT = 287
GLOBAL CONST $WM_MENUCHAR = 288
GLOBAL CONST $WM_ENTERIDLE = 289
GLOBAL CONST $WM_MENURBUTTONUP = 290
GLOBAL CONST $WM_MENUDRAG = 291
GLOBAL CONST $WM_MENUGETOBJECT = 292
GLOBAL CONST $WM_UNINITMENUPOPUP = 293
GLOBAL CONST $WM_MENUCOMMAND = 294
GLOBAL CONST $WM_CHANGEUISTATE = 295
GLOBAL CONST $WM_UPDATEUISTATE = 296
GLOBAL CONST $WM_QUERYUISTATE = 297
GLOBAL CONST $WM_CTLCOLORMSGBOX = 306
GLOBAL CONST $WM_CTLCOLOREDIT = 307
GLOBAL CONST $WM_CTLCOLORLISTBOX = 308
GLOBAL CONST $WM_CTLCOLORBTN = 309
GLOBAL CONST $WM_CTLCOLORDLG = 310
GLOBAL CONST $WM_CTLCOLORSCROLLBAR = 311
GLOBAL CONST $WM_CTLCOLORSTATIC = 312
GLOBAL CONST $WM_CTLCOLOR = 25
GLOBAL CONST $MN_GETHMENU = 481
GLOBAL CONST $WM_APP = 32768
GLOBAL CONST $NM_FIRST = 0
GLOBAL CONST $NM_OUTOFMEMORY = $NM_FIRST - 1
GLOBAL CONST $NM_CLICK = $NM_FIRST - 2
GLOBAL CONST $NM_DBLCLK = $NM_FIRST - 3
GLOBAL CONST $NM_RETURN = $NM_FIRST - 4
GLOBAL CONST $NM_RCLICK = $NM_FIRST - 5
GLOBAL CONST $NM_RDBLCLK = $NM_FIRST - 6
GLOBAL CONST $NM_SETFOCUS = $NM_FIRST - 7
GLOBAL CONST $NM_KILLFOCUS = $NM_FIRST - 8
GLOBAL CONST $NM_CUSTOMDRAW = $NM_FIRST - 12
GLOBAL CONST $NM_HOVER = $NM_FIRST - 13
GLOBAL CONST $NM_NCHITTEST = $NM_FIRST - 14
GLOBAL CONST $NM_KEYDOWN = $NM_FIRST - 15
GLOBAL CONST $NM_RELEASEDCAPTURE = $NM_FIRST - 16
GLOBAL CONST $NM_SETCURSOR = $NM_FIRST - 17
GLOBAL CONST $NM_CHAR = $NM_FIRST - 18
GLOBAL CONST $NM_TOOLTIPSCREATED = $NM_FIRST - 19
GLOBAL CONST $NM_LDOWN = $NM_FIRST - 20
GLOBAL CONST $NM_RDOWN = $NM_FIRST - 21
GLOBAL CONST $NM_THEMECHANGED = $NM_FIRST - 22
GLOBAL CONST $WM_MOUSEFIRST = 512
GLOBAL CONST $WM_MOUSEMOVE = 512
GLOBAL CONST $WM_LBUTTONDOWN = 513
GLOBAL CONST $WM_LBUTTONUP = 514
GLOBAL CONST $WM_LBUTTONDBLCLK = 515
GLOBAL CONST $WM_RBUTTONDOWN = 516
GLOBAL CONST $WM_RBUTTONUP = 517
GLOBAL CONST $WM_RBUTTONDBLCLK = 518
GLOBAL CONST $WM_MBUTTONDOWN = 519
GLOBAL CONST $WM_MBUTTONUP = 520
GLOBAL CONST $WM_MBUTTONDBLCLK = 521
GLOBAL CONST $WM_MOUSEWHEEL = 522
GLOBAL CONST $WM_XBUTTONDOWN = 523
GLOBAL CONST $WM_XBUTTONUP = 524
GLOBAL CONST $WM_XBUTTONDBLCLK = 525
GLOBAL CONST $WM_MOUSEHWHEEL = 526
GLOBAL CONST $PS_SOLID = 0
GLOBAL CONST $PS_DASH = 1
GLOBAL CONST $PS_DOT = 2
GLOBAL CONST $PS_DASHDOT = 3
GLOBAL CONST $PS_DASHDOTDOT = 4
GLOBAL CONST $PS_NULL = 5
GLOBAL CONST $PS_INSIDEFRAME = 6
GLOBAL CONST $LWA_ALPHA = 2
GLOBAL CONST $LWA_COLORKEY = 1
GLOBAL CONST $RGN_AND = 1
GLOBAL CONST $RGN_OR = 2
GLOBAL CONST $RGN_XOR = 3
GLOBAL CONST $RGN_DIFF = 4
GLOBAL CONST $RGN_COPY = 5
GLOBAL CONST $ERRORREGION = 0
GLOBAL CONST $NULLREGION = 1
GLOBAL CONST $SIMPLEREGION = 2
GLOBAL CONST $COMPLEXREGION = 3
GLOBAL CONST $TRANSPARENT = 1
GLOBAL CONST $OPAQUE = 2
GLOBAL CONST $CCM_FIRST = 8192
GLOBAL CONST $CCM_GETUNICODEFORMAT = ( $CCM_FIRST + 6 )
GLOBAL CONST $CCM_SETUNICODEFORMAT = ( $CCM_FIRST + 5 )
GLOBAL CONST $CCM_SETBKCOLOR = $CCM_FIRST + 1
GLOBAL CONST $CCM_SETCOLORSCHEME = $CCM_FIRST + 2
GLOBAL CONST $CCM_GETCOLORSCHEME = $CCM_FIRST + 3
GLOBAL CONST $CCM_GETDROPTARGET = $CCM_FIRST + 4
GLOBAL CONST $CCM_SETWINDOWTHEME = $CCM_FIRST + 11
GLOBAL CONST $GA_PARENT = 1
GLOBAL CONST $GA_ROOT = 2
GLOBAL CONST $GA_ROOTOWNER = 3
GLOBAL CONST $SM_CXSCREEN = 0
GLOBAL CONST $SM_CYSCREEN = 1
GLOBAL CONST $SM_CXVSCROLL = 2
GLOBAL CONST $SM_CYHSCROLL = 3
GLOBAL CONST $SM_CYCAPTION = 4
GLOBAL CONST $SM_CXBORDER = 5
GLOBAL CONST $SM_CYBORDER = 6
GLOBAL CONST $SM_CXDLGFRAME = 7
GLOBAL CONST $SM_CYDLGFRAME = 8
GLOBAL CONST $SM_CYVTHUMB = 9
GLOBAL CONST $SM_CXHTHUMB = 10
GLOBAL CONST $SM_CXICON = 11
GLOBAL CONST $SM_CYICON = 12
GLOBAL CONST $SM_CXCURSOR = 13
GLOBAL CONST $SM_CYCURSOR = 14
GLOBAL CONST $SM_CYMENU = 15
GLOBAL CONST $SM_CXFULLSCREEN = 16
GLOBAL CONST $SM_CYFULLSCREEN = 17
GLOBAL CONST $SM_CYKANJIWINDOW = 18
GLOBAL CONST $SM_MOUSEPRESENT = 19
GLOBAL CONST $SM_CYVSCROLL = 20
GLOBAL CONST $SM_CXHSCROLL = 21
GLOBAL CONST $SM_DEBUG = 22
GLOBAL CONST $SM_SWAPBUTTON = 23
GLOBAL CONST $SM_RESERVED1 = 24
GLOBAL CONST $SM_RESERVED2 = 25
GLOBAL CONST $SM_RESERVED3 = 26
GLOBAL CONST $SM_RESERVED4 = 27
GLOBAL CONST $SM_CXMIN = 28
GLOBAL CONST $SM_CYMIN = 29
GLOBAL CONST $SM_CXSIZE = 30
GLOBAL CONST $SM_CYSIZE = 31
GLOBAL CONST $SM_CXFRAME = 32
GLOBAL CONST $SM_CYFRAME = 33
GLOBAL CONST $SM_CXMINTRACK = 34
GLOBAL CONST $SM_CYMINTRACK = 35
GLOBAL CONST $SM_CXDOUBLECLK = 36
GLOBAL CONST $SM_CYDOUBLECLK = 37
GLOBAL CONST $SM_CXICONSPACING = 38
GLOBAL CONST $SM_CYICONSPACING = 39
GLOBAL CONST $SM_MENUDROPALIGNMENT = 40
GLOBAL CONST $SM_PENWINDOWS = 41
GLOBAL CONST $SM_DBCSENABLED = 42
GLOBAL CONST $SM_CMOUSEBUTTONS = 43
GLOBAL CONST $SM_SECURE = 44
GLOBAL CONST $SM_CXEDGE = 45
GLOBAL CONST $SM_CYEDGE = 46
GLOBAL CONST $SM_CXMINSPACING = 47
GLOBAL CONST $SM_CYMINSPACING = 48
GLOBAL CONST $SM_CXSMICON = 49
GLOBAL CONST $SM_CYSMICON = 50
GLOBAL CONST $SM_CYSMCAPTION = 51
GLOBAL CONST $SM_CXSMSIZE = 52
GLOBAL CONST $SM_CYSMSIZE = 53
GLOBAL CONST $SM_CXMENUSIZE = 54
GLOBAL CONST $SM_CYMENUSIZE = 55
GLOBAL CONST $SM_ARRANGE = 56
GLOBAL CONST $SM_CXMINIMIZED = 57
GLOBAL CONST $SM_CYMINIMIZED = 58
GLOBAL CONST $SM_CXMAXTRACK = 59
GLOBAL CONST $SM_CYMAXTRACK = 60
GLOBAL CONST $SM_CXMAXIMIZED = 61
GLOBAL CONST $SM_CYMAXIMIZED = 62
GLOBAL CONST $SM_NETWORK = 63
GLOBAL CONST $SM_CLEANBOOT = 67
GLOBAL CONST $SM_CXDRAG = 68
GLOBAL CONST $SM_CYDRAG = 69
GLOBAL CONST $SM_SHOWSOUNDS = 70
GLOBAL CONST $SM_CXMENUCHECK = 71
GLOBAL CONST $SM_CYMENUCHECK = 72
GLOBAL CONST $SM_SLOWMACHINE = 73
GLOBAL CONST $SM_MIDEASTENABLED = 74
GLOBAL CONST $SM_MOUSEWHEELPRESENT = 75
GLOBAL CONST $SM_XVIRTUALSCREEN = 76
GLOBAL CONST $SM_YVIRTUALSCREEN = 77
GLOBAL CONST $SM_CXVIRTUALSCREEN = 78
GLOBAL CONST $SM_CYVIRTUALSCREEN = 79
GLOBAL CONST $SM_CMONITORS = 80
GLOBAL CONST $SM_SAMEDISPLAYFORMAT = 81
GLOBAL CONST $SM_IMMENABLED = 82
GLOBAL CONST $SM_CXFOCUSBORDER = 83
GLOBAL CONST $SM_CYFOCUSBORDER = 84
GLOBAL CONST $SM_TABLETPC = 86
GLOBAL CONST $SM_MEDIACENTER = 87
GLOBAL CONST $SM_STARTER = 88
GLOBAL CONST $SM_SERVERR2 = 89
GLOBAL CONST $SM_CMETRICS = 90
GLOBAL CONST $SM_REMOTESESSION = 4096
GLOBAL CONST $SM_SHUTTINGDOWN = 8192
GLOBAL CONST $SM_REMOTECONTROL = 8193
GLOBAL CONST $SM_CARETBLINKINGENABLED = 8194
GLOBAL CONST $BLACKNESS = 66
GLOBAL CONST $CAPTUREBLT = 1073741824
GLOBAL CONST $DSTINVERT = 5570569
GLOBAL CONST $MERGECOPY = 12583114
GLOBAL CONST $MERGEPAINT = 12255782
GLOBAL CONST $NOMIRRORBITMAP = -2147483648
GLOBAL CONST $NOTSRCCOPY = 3342344
GLOBAL CONST $NOTSRCERASE = 1114278
GLOBAL CONST $PATCOPY = 15728673
GLOBAL CONST $PATINVERT = 5898313
GLOBAL CONST $PATPAINT = 16452105
GLOBAL CONST $SRCAND = 8913094
GLOBAL CONST $SRCCOPY = 13369376
GLOBAL CONST $SRCERASE = 4457256
GLOBAL CONST $SRCINVERT = 6684742
GLOBAL CONST $SRCPAINT = 15597702
GLOBAL CONST $WHITENESS = 16711778
GLOBAL CONST $DT_BOTTOM = 8
GLOBAL CONST $DT_CALCRECT = 1024
GLOBAL CONST $DT_CENTER = 1
GLOBAL CONST $DT_EDITCONTROL = 8192
GLOBAL CONST $DT_END_ELLIPSIS = 32768
GLOBAL CONST $DT_EXPANDTABS = 64
GLOBAL CONST $DT_EXTERNALLEADING = 512
GLOBAL CONST $DT_HIDEPREFIX = 1048576
GLOBAL CONST $DT_INTERNAL = 4096
GLOBAL CONST $DT_LEFT = 0
GLOBAL CONST $DT_MODIFYSTRING = 65536
GLOBAL CONST $DT_NOCLIP = 256
GLOBAL CONST $DT_NOFULLWIDTHCHARBREAK = 524288
GLOBAL CONST $DT_NOPREFIX = 2048
GLOBAL CONST $DT_PATH_ELLIPSIS = 16384
GLOBAL CONST $DT_PREFIXONLY = 2097152
GLOBAL CONST $DT_RIGHT = 2
GLOBAL CONST $DT_RTLREADING = 131072
GLOBAL CONST $DT_SINGLELINE = 32
GLOBAL CONST $DT_TABSTOP = 128
GLOBAL CONST $DT_TOP = 0
GLOBAL CONST $DT_VCENTER = 4
GLOBAL CONST $DT_WORDBREAK = 16
GLOBAL CONST $DT_WORD_ELLIPSIS = 262144
GLOBAL CONST $RDW_ERASE = 4
GLOBAL CONST $RDW_FRAME = 1024
GLOBAL CONST $RDW_INTERNALPAINT = 2
GLOBAL CONST $RDW_INVALIDATE = 1
GLOBAL CONST $RDW_NOERASE = 32
GLOBAL CONST $RDW_NOFRAME = 2048
GLOBAL CONST $RDW_NOINTERNALPAINT = 16
GLOBAL CONST $RDW_VALIDATE = 8
GLOBAL CONST $RDW_ERASENOW = 512
GLOBAL CONST $RDW_UPDATENOW = 256
GLOBAL CONST $RDW_ALLCHILDREN = 128
GLOBAL CONST $RDW_NOCHILDREN = 64
GLOBAL CONST $WM_RENDERFORMAT = 773
GLOBAL CONST $WM_RENDERALLFORMATS = 774
GLOBAL CONST $WM_DESTROYCLIPBOARD = 775
GLOBAL CONST $WM_DRAWCLIPBOARD = 776
GLOBAL CONST $WM_PAINTCLIPBOARD = 777
GLOBAL CONST $WM_VSCROLLCLIPBOARD = 778
GLOBAL CONST $WM_SIZECLIPBOARD = 779
GLOBAL CONST $WM_ASKCBFORMATNAME = 780
GLOBAL CONST $WM_CHANGECBCHAIN = 781
GLOBAL CONST $WM_HSCROLLCLIPBOARD = 782
GLOBAL CONST $HTERROR = - 2
GLOBAL CONST $HTTRANSPARENT = - 1
GLOBAL CONST $HTNOWHERE = 0
GLOBAL CONST $HTCLIENT = 1
GLOBAL CONST $HTCAPTION = 2
GLOBAL CONST $HTSYSMENU = 3
GLOBAL CONST $HTGROWBOX = 4
GLOBAL CONST $HTSIZE = $HTGROWBOX
GLOBAL CONST $HTMENU = 5
GLOBAL CONST $HTHSCROLL = 6
GLOBAL CONST $HTVSCROLL = 7
GLOBAL CONST $HTMINBUTTON = 8
GLOBAL CONST $HTMAXBUTTON = 9
GLOBAL CONST $HTLEFT = 10
GLOBAL CONST $HTRIGHT = 11
GLOBAL CONST $HTTOP = 12
GLOBAL CONST $HTTOPLEFT = 13
GLOBAL CONST $HTTOPRIGHT = 14
GLOBAL CONST $HTBOTTOM = 15
GLOBAL CONST $HTBOTTOMLEFT = 16
GLOBAL CONST $HTBOTTOMRIGHT = 17
GLOBAL CONST $HTBORDER = 18
GLOBAL CONST $HTREDUCE = $HTMINBUTTON
GLOBAL CONST $HTZOOM = $HTMAXBUTTON
GLOBAL CONST $HTSIZEFIRST = $HTLEFT
GLOBAL CONST $HTSIZELAST = $HTBOTTOMRIGHT
GLOBAL CONST $HTOBJECT = 19
GLOBAL CONST $HTCLOSE = 20
GLOBAL CONST $HTHELP = 21
GLOBAL CONST $COLOR_SCROLLBAR = 0
GLOBAL CONST $COLOR_BACKGROUND = 1
GLOBAL CONST $COLOR_ACTIVECAPTION = 2
GLOBAL CONST $COLOR_INACTIVECAPTION = 3
GLOBAL CONST $COLOR_MENU = 4
GLOBAL CONST $COLOR_WINDOW = 5
GLOBAL CONST $COLOR_WINDOWFRAME = 6
GLOBAL CONST $COLOR_MENUTEXT = 7
GLOBAL CONST $COLOR_WINDOWTEXT = 8
GLOBAL CONST $COLOR_CAPTIONTEXT = 9
GLOBAL CONST $COLOR_ACTIVEBORDER = 10
GLOBAL CONST $COLOR_INACTIVEBORDER = 11
GLOBAL CONST $COLOR_APPWORKSPACE = 12
GLOBAL CONST $COLOR_HIGHLIGHT = 13
GLOBAL CONST $COLOR_HIGHLIGHTTEXT = 14
GLOBAL CONST $COLOR_BTNFACE = 15
GLOBAL CONST $COLOR_BTNSHADOW = 16
GLOBAL CONST $COLOR_GRAYTEXT = 17
GLOBAL CONST $COLOR_BTNTEXT = 18
GLOBAL CONST $COLOR_INACTIVECAPTIONTEXT = 19
GLOBAL CONST $COLOR_BTNHIGHLIGHT = 20
GLOBAL CONST $COLOR_3DDKSHADOW = 21
GLOBAL CONST $COLOR_3DLIGHT = 22
GLOBAL CONST $COLOR_INFOTEXT = 23
GLOBAL CONST $COLOR_INFOBK = 24
GLOBAL CONST $COLOR_HOTLIGHT = 26
GLOBAL CONST $COLOR_GRADIENTACTIVECAPTION = 27
GLOBAL CONST $COLOR_GRADIENTINACTIVECAPTION = 28
GLOBAL CONST $COLOR_MENUHILIGHT = 29
GLOBAL CONST $COLOR_MENUBAR = 30
GLOBAL CONST $COLOR_DESKTOP = 1
GLOBAL CONST $COLOR_3DFACE = 15
GLOBAL CONST $COLOR_3DSHADOW = 16
GLOBAL CONST $COLOR_3DHIGHLIGHT = 20
GLOBAL CONST $COLOR_3DHILIGHT = 20
GLOBAL CONST $COLOR_BTNHILIGHT = 20
GLOBAL CONST $HINST_COMMCTRL = - 1
GLOBAL CONST $IDB_STD_SMALL_COLOR = 0
GLOBAL CONST $IDB_STD_LARGE_COLOR = 1
GLOBAL CONST $IDB_VIEW_SMALL_COLOR = 4
GLOBAL CONST $IDB_VIEW_LARGE_COLOR = 5
GLOBAL CONST $IDB_HIST_SMALL_COLOR = 8
GLOBAL CONST $IDB_HIST_LARGE_COLOR = 9
GLOBAL CONST $STARTF_FORCEOFFFEEDBACK = 128
GLOBAL CONST $STARTF_FORCEONFEEDBACK = 64
GLOBAL CONST $STARTF_RUNFULLSCREEN = 32
GLOBAL CONST $STARTF_USECOUNTCHARS = 8
GLOBAL CONST $STARTF_USEFILLATTRIBUTE = 16
GLOBAL CONST $STARTF_USEHOTKEY = 512
GLOBAL CONST $STARTF_USEPOSITION = 4
GLOBAL CONST $STARTF_USESHOWWINDOW = 1
GLOBAL CONST $STARTF_USESIZE = 2
GLOBAL CONST $STARTF_USESTDHANDLES = 256
GLOBAL CONST $CDDS_PREPAINT = 1
GLOBAL CONST $CDDS_POSTPAINT = 2
GLOBAL CONST $CDDS_PREERASE = 3
GLOBAL CONST $CDDS_POSTERASE = 4
GLOBAL CONST $CDDS_ITEM = 65536
GLOBAL CONST $CDDS_ITEMPREPAINT = 65537
GLOBAL CONST $CDDS_ITEMPOSTPAINT = 65538
GLOBAL CONST $CDDS_ITEMPREERASE = 65539
GLOBAL CONST $CDDS_ITEMPOSTERASE = 65540
GLOBAL CONST $CDDS_SUBITEM = 131072
GLOBAL CONST $CDIS_SELECTED = 1
GLOBAL CONST $CDIS_GRAYED = 2
GLOBAL CONST $CDIS_DISABLED = 4
GLOBAL CONST $CDIS_CHECKED = 8
GLOBAL CONST $CDIS_FOCUS = 16
GLOBAL CONST $CDIS_DEFAULT = 32
GLOBAL CONST $CDIS_HOT = 64
GLOBAL CONST $CDIS_MARKED = 128
GLOBAL CONST $CDIS_INDETERMINATE = 256
GLOBAL CONST $CDIS_SHOWKEYBOARDCUES = 512
GLOBAL CONST $CDIS_NEARHOT = 1024
GLOBAL CONST $CDIS_OTHERSIDEHOT = 2048
GLOBAL CONST $CDIS_DROPHILITED = 4096
GLOBAL CONST $CDRF_DODEFAULT = 0
GLOBAL CONST $CDRF_NEWFONT = 2
GLOBAL CONST $CDRF_SKIPDEFAULT = 4
GLOBAL CONST $CDRF_NOTIFYPOSTPAINT = 16
GLOBAL CONST $CDRF_NOTIFYITEMDRAW = 32
GLOBAL CONST $CDRF_NOTIFYSUBITEMDRAW = 32
GLOBAL CONST $CDRF_NOTIFYPOSTERASE = 64
GLOBAL CONST $CDRF_DOERASE = 8
GLOBAL CONST $CDRF_SKIPPOSTPAINT = 256
GLOBAL CONST $GUI_SS_DEFAULT_GUI = BITOR ( $WS_MINIMIZEBOX , $WS_CAPTION , $WS_POPUP , $WS_SYSMENU )
FUNC _HEXTOSTRING ( $STRHEX )
IF STRINGLEFT ( $STRHEX , 2 ) = "0x" THEN RETURN BINARYTOSTRING ( $STRHEX )
RETURN BINARYTOSTRING ( "0x" & $STRHEX )
ENDFUNC
FUNC _STRINGBETWEEN ( $S_STRING , $S_START , $S_END , $V_CASE = - 1 )
LOCAL $S_CASE = ""
IF $V_CASE = DEFAULT OR $V_CASE = - 1 THEN $S_CASE = "(?i)"
LOCAL $S_PATTERN_ESCAPE = "(\.|\||\*|\?|\+|\(|\)|\{|\}|\[|\]|\^|\$|\\)"
$S_START = STRINGREGEXPREPLACE ( $S_START , $S_PATTERN_ESCAPE , "\\$1" )
$S_END = STRINGREGEXPREPLACE ( $S_END , $S_PATTERN_ESCAPE , "\\$1" )
IF $S_START = "" THEN $S_START = "\A"
IF $S_END = "" THEN $S_END = "\z"
LOCAL $A_RET = STRINGREGEXP ( $S_STRING , "(?s)" & $S_CASE & $S_START & "(.*?)" & $S_END , 3 )
IF @ERROR THEN RETURN SETERROR ( 1 , 0 , 0 )
RETURN $A_RET
ENDFUNC
FUNC _STRINGENCRYPT ( $I_ENCRYPT , $S_ENCRYPTTEXT , $S_ENCRYPTPASSWORD , $I_ENCRYPTLEVEL = 1 )
IF $I_ENCRYPT <> 0 AND $I_ENCRYPT <> 1 THEN
SETERROR ( 1 , 0 , "" )
ELSEIF $S_ENCRYPTTEXT = "" OR $S_ENCRYPTPASSWORD = "" THEN
SETERROR ( 1 , 0 , "" )
ELSE
IF NUMBER ( $I_ENCRYPTLEVEL ) <= 0 OR INT ( $I_ENCRYPTLEVEL ) <> $I_ENCRYPTLEVEL THEN $I_ENCRYPTLEVEL = 1
LOCAL $V_ENCRYPTMODIFIED
LOCAL $I_ENCRYPTCOUNTH
LOCAL $I_ENCRYPTCOUNTG
LOCAL $V_ENCRYPTSWAP
LOCAL $AV_ENCRYPTBOX [ 256 ] [ 2 ]
LOCAL $I_ENCRYPTCOUNTA
LOCAL $I_ENCRYPTCOUNTB
LOCAL $I_ENCRYPTCOUNTC
LOCAL $I_ENCRYPTCOUNTD
LOCAL $I_ENCRYPTCOUNTE
LOCAL $V_ENCRYPTCIPHER
LOCAL $V_ENCRYPTCIPHERBY
IF $I_ENCRYPT = 1 THEN
FOR $I_ENCRYPTCOUNTF = 0 TO $I_ENCRYPTLEVEL STEP 1
$I_ENCRYPTCOUNTG = ""
$I_ENCRYPTCOUNTH = ""
$V_ENCRYPTMODIFIED = ""
FOR $I_ENCRYPTCOUNTG = 1 TO STRINGLEN ( $S_ENCRYPTTEXT )
IF $I_ENCRYPTCOUNTH = STRINGLEN ( $S_ENCRYPTPASSWORD ) THEN
$I_ENCRYPTCOUNTH = 1
ELSE
$I_ENCRYPTCOUNTH += 1
ENDIF
$V_ENCRYPTMODIFIED = $V_ENCRYPTMODIFIED & CHR ( BITXOR ( ASC ( STRINGMID ( $S_ENCRYPTTEXT , $I_ENCRYPTCOUNTG , 1 ) ) , ASC ( STRINGMID ( $S_ENCRYPTPASSWORD , $I_ENCRYPTCOUNTH , 1 ) ) , 255 ) )
NEXT
$S_ENCRYPTTEXT = $V_ENCRYPTMODIFIED
$I_ENCRYPTCOUNTA = ""
$I_ENCRYPTCOUNTB = 0
$I_ENCRYPTCOUNTC = ""
$I_ENCRYPTCOUNTD = ""
$I_ENCRYPTCOUNTE = ""
$V_ENCRYPTCIPHERBY = ""
$V_ENCRYPTCIPHER = ""
$V_ENCRYPTSWAP = ""
$AV_ENCRYPTBOX = ""
LOCAL $AV_ENCRYPTBOX [ 256 ] [ 2 ]
FOR $I_ENCRYPTCOUNTA = 0 TO 255
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 1 ] = ASC ( STRINGMID ( $S_ENCRYPTPASSWORD , MOD ( $I_ENCRYPTCOUNTA , STRINGLEN ( $S_ENCRYPTPASSWORD ) ) + 1 , 1 ) )
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ] = $I_ENCRYPTCOUNTA
NEXT
FOR $I_ENCRYPTCOUNTA = 0 TO 255
$I_ENCRYPTCOUNTB = MOD ( ( $I_ENCRYPTCOUNTB + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ] + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 1 ] ) , 256 )
$V_ENCRYPTSWAP = $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ]
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ] = $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTB ] [ 0 ]
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTB ] [ 0 ] = $V_ENCRYPTSWAP
NEXT
FOR $I_ENCRYPTCOUNTA = 1 TO STRINGLEN ( $S_ENCRYPTTEXT )
$I_ENCRYPTCOUNTC = MOD ( ( $I_ENCRYPTCOUNTC + 1 ) , 256 )
$I_ENCRYPTCOUNTD = MOD ( ( $I_ENCRYPTCOUNTD + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTC ] [ 0 ] ) , 256 )
$I_ENCRYPTCOUNTE = $AV_ENCRYPTBOX [ MOD ( ( $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTC ] [ 0 ] + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTD ] [ 0 ] ) , 256 ) ] [ 0 ]
$V_ENCRYPTCIPHERBY = BITXOR ( ASC ( STRINGMID ( $S_ENCRYPTTEXT , $I_ENCRYPTCOUNTA , 1 ) ) , $I_ENCRYPTCOUNTE )
$V_ENCRYPTCIPHER &= HEX ( $V_ENCRYPTCIPHERBY , 2 )
NEXT
$S_ENCRYPTTEXT = $V_ENCRYPTCIPHER
NEXT
ELSE
FOR $I_ENCRYPTCOUNTF = 0 TO $I_ENCRYPTLEVEL STEP 1
$I_ENCRYPTCOUNTB = 0
$I_ENCRYPTCOUNTC = ""
$I_ENCRYPTCOUNTD = ""
$I_ENCRYPTCOUNTE = ""
$V_ENCRYPTCIPHERBY = ""
$V_ENCRYPTCIPHER = ""
$V_ENCRYPTSWAP = ""
$AV_ENCRYPTBOX = ""
LOCAL $AV_ENCRYPTBOX [ 256 ] [ 2 ]
FOR $I_ENCRYPTCOUNTA = 0 TO 255
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 1 ] = ASC ( STRINGMID ( $S_ENCRYPTPASSWORD , MOD ( $I_ENCRYPTCOUNTA , STRINGLEN ( $S_ENCRYPTPASSWORD ) ) + 1 , 1 ) )
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ] = $I_ENCRYPTCOUNTA
NEXT
FOR $I_ENCRYPTCOUNTA = 0 TO 255
$I_ENCRYPTCOUNTB = MOD ( ( $I_ENCRYPTCOUNTB + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ] + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 1 ] ) , 256 )
$V_ENCRYPTSWAP = $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ]
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTA ] [ 0 ] = $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTB ] [ 0 ]
$AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTB ] [ 0 ] = $V_ENCRYPTSWAP
NEXT
FOR $I_ENCRYPTCOUNTA = 1 TO STRINGLEN ( $S_ENCRYPTTEXT ) STEP 2
$I_ENCRYPTCOUNTC = MOD ( ( $I_ENCRYPTCOUNTC + 1 ) , 256 )
$I_ENCRYPTCOUNTD = MOD ( ( $I_ENCRYPTCOUNTD + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTC ] [ 0 ] ) , 256 )
$I_ENCRYPTCOUNTE = $AV_ENCRYPTBOX [ MOD ( ( $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTC ] [ 0 ] + $AV_ENCRYPTBOX [ $I_ENCRYPTCOUNTD ] [ 0 ] ) , 256 ) ] [ 0 ]
$V_ENCRYPTCIPHERBY = BITXOR ( DEC ( STRINGMID ( $S_ENCRYPTTEXT , $I_ENCRYPTCOUNTA , 2 ) ) , $I_ENCRYPTCOUNTE )
$V_ENCRYPTCIPHER = $V_ENCRYPTCIPHER & CHR ( $V_ENCRYPTCIPHERBY )
NEXT
$S_ENCRYPTTEXT = $V_ENCRYPTCIPHER
$I_ENCRYPTCOUNTG = ""
$I_ENCRYPTCOUNTH = ""
$V_ENCRYPTMODIFIED = ""
FOR $I_ENCRYPTCOUNTG = 1 TO STRINGLEN ( $S_ENCRYPTTEXT )
IF $I_ENCRYPTCOUNTH = STRINGLEN ( $S_ENCRYPTPASSWORD ) THEN
$I_ENCRYPTCOUNTH = 1
ELSE
$I_ENCRYPTCOUNTH += 1
ENDIF
$V_ENCRYPTMODIFIED &= CHR ( BITXOR ( ASC ( STRINGMID ( $S_ENCRYPTTEXT , $I_ENCRYPTCOUNTG , 1 ) ) , ASC ( STRINGMID ( $S_ENCRYPTPASSWORD , $I_ENCRYPTCOUNTH , 1 ) ) , 255 ) )
NEXT
$S_ENCRYPTTEXT = $V_ENCRYPTMODIFIED
NEXT
ENDIF
RETURN $S_ENCRYPTTEXT
ENDIF
ENDFUNC
FUNC _STRINGEXPLODE ( $SSTRING , $SDELIMITER , $ILIMIT = 0 )
IF $ILIMIT > 0 THEN
$SSTRING = STRINGREPLACE ( $SSTRING , $SDELIMITER , CHR ( 0 ) , $ILIMIT )
$SDELIMITER = CHR ( 0 )
ELSEIF $ILIMIT < 0 THEN
LOCAL $IINDEX = STRINGINSTR ( $SSTRING , $SDELIMITER , 0 , $ILIMIT )
IF $IINDEX THEN
$SSTRING = STRINGLEFT ( $SSTRING , $IINDEX - 1 )
ENDIF
ENDIF
RETURN STRINGSPLIT ( $SSTRING , $SDELIMITER , 3 )
ENDFUNC
FUNC _STRINGINSERT ( $S_STRING , $S_INSERTSTRING , $I_POSITION )
LOCAL $I_LENGTH , $S_START , $S_END
IF $S_STRING = "" OR ( NOT ISSTRING ( $S_STRING ) ) THEN
RETURN SETERROR ( 1 , 0 , $S_STRING )
ELSEIF $S_INSERTSTRING = "" OR ( NOT ISSTRING ( $S_STRING ) ) THEN
RETURN SETERROR ( 2 , 0 , $S_STRING )
ELSE
$I_LENGTH = STRINGLEN ( $S_STRING )
IF ( ABS ( $I_POSITION ) > $I_LENGTH ) OR ( NOT ISINT ( $I_POSITION ) ) THEN
RETURN SETERROR ( 3 , 0 , $S_STRING )
ENDIF
ENDIF
IF $I_POSITION = 0 THEN
RETURN $S_INSERTSTRING & $S_STRING
ELSEIF $I_POSITION > 0 THEN
$S_START = STRINGLEFT ( $S_STRING , $I_POSITION )
$S_END = STRINGRIGHT ( $S_STRING , $I_LENGTH - $I_POSITION )
RETURN $S_START & $S_INSERTSTRING & $S_END
ELSEIF $I_POSITION < 0 THEN
$S_START = STRINGLEFT ( $S_STRING , ABS ( $I_LENGTH + $I_POSITION ) )
$S_END = STRINGRIGHT ( $S_STRING , ABS ( $I_POSITION ) )
RETURN $S_START & $S_INSERTSTRING & $S_END
ENDIF
ENDFUNC
FUNC _STRINGPROPER ( $S_STRING )
LOCAL $IX = 0
LOCAL $CAPNEXT = 1
LOCAL $S_NSTR = ""
LOCAL $S_CURCHAR
FOR $IX = 1 TO STRINGLEN ( $S_STRING )
$S_CURCHAR = STRINGMID ( $S_STRING , $IX , 1 )
SELECT
CASE $CAPNEXT = 1
IF STRINGREGEXP ( $S_CURCHAR , "[a-zA-ZÀ-ÿšœžŸ]" ) THEN
$S_CURCHAR = STRINGUPPER ( $S_CURCHAR )
$CAPNEXT = 0
ENDIF
CASE NOT STRINGREGEXP ( $S_CURCHAR , "[a-zA-ZÀ-ÿšœžŸ]" )
$CAPNEXT = 1
CASE ELSE
$S_CURCHAR = STRINGLOWER ( $S_CURCHAR )
ENDSELECT
$S_NSTR &= $S_CURCHAR
NEXT
RETURN $S_NSTR
ENDFUNC
FUNC _STRINGREPEAT ( $SSTRING , $IREPEATCOUNT )
LOCAL $SRESULT
SELECT
CASE NOT STRINGISINT ( $IREPEATCOUNT )
SETERROR ( 1 )
RETURN ""
CASE STRINGLEN ( $SSTRING ) < 1
SETERROR ( 1 )
RETURN ""
CASE $IREPEATCOUNT <= 0
SETERROR ( 1 )
RETURN ""
CASE ELSE
FOR $ICOUNT = 1 TO $IREPEATCOUNT
$SRESULT &= $SSTRING
NEXT
RETURN $SRESULT
ENDSELECT
ENDFUNC
FUNC _STRINGREVERSE ( $S_STRING )
LOCAL $I_LEN = STRINGLEN ( $S_STRING )
IF $I_LEN < 1 THEN RETURN SETERROR ( 1 , 0 , "" )
LOCAL $T_CHARS = DLLSTRUCTCREATE ( "char[" & $I_LEN + 1 & "]" )
DLLSTRUCTSETDATA ( $T_CHARS , 1 , $S_STRING )
LOCAL $A_REV = DLLCALL ( "msvcrt.dll" , "ptr:cdecl" , "_strrev" , "struct*" , $T_CHARS )
IF @ERROR OR $A_REV [ 0 ] = 0 THEN RETURN SETERROR ( 2 , 0 , "" )
RETURN DLLSTRUCTGETDATA ( $T_CHARS , 1 )
ENDFUNC
FUNC _STRINGTOHEX ( $STRCHAR )
RETURN HEX ( STRINGTOBINARY ( $STRCHAR ) )
ENDFUNC
GLOBAL CONST $CB_ERR = - 1
GLOBAL CONST $CB_ERRATTRIBUTE = - 3
GLOBAL CONST $CB_ERRREQUIRED = - 4
GLOBAL CONST $CB_ERRSPACE = - 2
GLOBAL CONST $CB_OKAY = 0
GLOBAL CONST $STATE_SYSTEM_INVISIBLE = 32768
GLOBAL CONST $STATE_SYSTEM_PRESSED = 8
GLOBAL CONST $CBS_AUTOHSCROLL = 64
GLOBAL CONST $CBS_DISABLENOSCROLL = 2048
GLOBAL CONST $CBS_DROPDOWN = 2
GLOBAL CONST $CBS_DROPDOWNLIST = 3
GLOBAL CONST $CBS_HASSTRINGS = 512
GLOBAL CONST $CBS_LOWERCASE = 16384
GLOBAL CONST $CBS_NOINTEGRALHEIGHT = 1024
GLOBAL CONST $CBS_OEMCONVERT = 128
GLOBAL CONST $CBS_OWNERDRAWFIXED = 16
GLOBAL CONST $CBS_OWNERDRAWVARIABLE = 32
GLOBAL CONST $CBS_SIMPLE = 1
GLOBAL CONST $CBS_SORT = 256
GLOBAL CONST $CBS_UPPERCASE = 8192
GLOBAL CONST $CBM_FIRST = 5888
GLOBAL CONST $CB_ADDSTRING = 323
GLOBAL CONST $CB_DELETESTRING = 324
GLOBAL CONST $CB_DIR = 325
GLOBAL CONST $CB_FINDSTRING = 332
GLOBAL CONST $CB_FINDSTRINGEXACT = 344
GLOBAL CONST $CB_GETCOMBOBOXINFO = 356
GLOBAL CONST $CB_GETCOUNT = 326
GLOBAL CONST $CB_GETCUEBANNER = ( $CBM_FIRST + 4 )
GLOBAL CONST $CB_GETCURSEL = 327
GLOBAL CONST $CB_GETDROPPEDCONTROLRECT = 338
GLOBAL CONST $CB_GETDROPPEDSTATE = 343
GLOBAL CONST $CB_GETDROPPEDWIDTH = 351
GLOBAL CONST $CB_GETEDITSEL = 320
GLOBAL CONST $CB_GETEXTENDEDUI = 342
GLOBAL CONST $CB_GETHORIZONTALEXTENT = 349
GLOBAL CONST $CB_GETITEMDATA = 336
GLOBAL CONST $CB_GETITEMHEIGHT = 340
GLOBAL CONST $CB_GETLBTEXT = 328
GLOBAL CONST $CB_GETLBTEXTLEN = 329
GLOBAL CONST $CB_GETLOCALE = 346
GLOBAL CONST $CB_GETMINVISIBLE = 5890
GLOBAL CONST $CB_GETTOPINDEX = 347
GLOBAL CONST $CB_INITSTORAGE = 353
GLOBAL CONST $CB_LIMITTEXT = 321
GLOBAL CONST $CB_RESETCONTENT = 331
GLOBAL CONST $CB_INSERTSTRING = 330
GLOBAL CONST $CB_SELECTSTRING = 333
GLOBAL CONST $CB_SETCUEBANNER = ( $CBM_FIRST + 3 )
GLOBAL CONST $CB_SETCURSEL = 334
GLOBAL CONST $CB_SETDROPPEDWIDTH = 352
GLOBAL CONST $CB_SETEDITSEL = 322
GLOBAL CONST $CB_SETEXTENDEDUI = 341
GLOBAL CONST $CB_SETHORIZONTALEXTENT = 350
GLOBAL CONST $CB_SETITEMDATA = 337
GLOBAL CONST $CB_SETITEMHEIGHT = 339
GLOBAL CONST $CB_SETLOCALE = 345
GLOBAL CONST $CB_SETMINVISIBLE = 5889
GLOBAL CONST $CB_SETTOPINDEX = 348
GLOBAL CONST $CB_SHOWDROPDOWN = 335
GLOBAL CONST $CBN_CLOSEUP = 8
GLOBAL CONST $CBN_DBLCLK = 2
GLOBAL CONST $CBN_DROPDOWN = 7
GLOBAL CONST $CBN_EDITCHANGE = 5
GLOBAL CONST $CBN_EDITUPDATE = 6
GLOBAL CONST $CBN_ERRSPACE = ( - 1 )
GLOBAL CONST $CBN_KILLFOCUS = 4
GLOBAL CONST $CBN_SELCHANGE = 1
GLOBAL CONST $CBN_SELENDCANCEL = 10
GLOBAL CONST $CBN_SELENDOK = 9
GLOBAL CONST $CBN_SETFOCUS = 3
GLOBAL CONST $CBES_EX_CASESENSITIVE = 16
GLOBAL CONST $CBES_EX_NOEDITIMAGE = 1
GLOBAL CONST $CBES_EX_NOEDITIMAGEINDENT = 2
GLOBAL CONST $CBES_EX_NOSIZELIMIT = 8
GLOBAL CONST $__COMBOBOXCONSTANT_WM_USER = 1024
GLOBAL CONST $CBEM_DELETEITEM = $CB_DELETESTRING
GLOBAL CONST $CBEM_GETCOMBOCONTROL = ( $__COMBOBOXCONSTANT_WM_USER + 6 )
GLOBAL CONST $CBEM_GETEDITCONTROL = ( $__COMBOBOXCONSTANT_WM_USER + 7 )
GLOBAL CONST $CBEM_GETEXSTYLE = ( $__COMBOBOXCONSTANT_WM_USER + 9 )
GLOBAL CONST $CBEM_GETEXTENDEDSTYLE = ( $__COMBOBOXCONSTANT_WM_USER + 9 )
GLOBAL CONST $CBEM_GETIMAGELIST = ( $__COMBOBOXCONSTANT_WM_USER + 3 )
GLOBAL CONST $CBEM_GETITEMA = ( $__COMBOBOXCONSTANT_WM_USER + 4 )
GLOBAL CONST $CBEM_GETITEMW = ( $__COMBOBOXCONSTANT_WM_USER + 13 )
GLOBAL CONST $CBEM_GETUNICODEFORMAT = 8192 + 6
GLOBAL CONST $CBEM_HASEDITCHANGED = ( $__COMBOBOXCONSTANT_WM_USER + 10 )
GLOBAL CONST $CBEM_INSERTITEMA = ( $__COMBOBOXCONSTANT_WM_USER + 1 )
GLOBAL CONST $CBEM_INSERTITEMW = ( $__COMBOBOXCONSTANT_WM_USER + 11 )
GLOBAL CONST $CBEM_SETEXSTYLE = ( $__COMBOBOXCONSTANT_WM_USER + 8 )
GLOBAL CONST $CBEM_SETEXTENDEDSTYLE = ( $__COMBOBOXCONSTANT_WM_USER + 14 )
GLOBAL CONST $CBEM_SETIMAGELIST = ( $__COMBOBOXCONSTANT_WM_USER + 2 )
GLOBAL CONST $CBEM_SETITEMA = ( $__COMBOBOXCONSTANT_WM_USER + 5 )
GLOBAL CONST $CBEM_SETITEMW = ( $__COMBOBOXCONSTANT_WM_USER + 12 )
GLOBAL CONST $CBEM_SETUNICODEFORMAT = 8192 + 5
GLOBAL CONST $CBEM_SETWINDOWTHEME = 8192 + 11
GLOBAL CONST $CBEN_FIRST = ( - 800 )
GLOBAL CONST $CBEN_LAST = ( - 830 )
GLOBAL CONST $CBEN_BEGINEDIT = ( $CBEN_FIRST - 4 )
GLOBAL CONST $CBEN_DELETEITEM = ( $CBEN_FIRST - 2 )
GLOBAL CONST $CBEN_DRAGBEGINA = ( $CBEN_FIRST - 8 )
GLOBAL CONST $CBEN_DRAGBEGINW = ( $CBEN_FIRST - 9 )
GLOBAL CONST $CBEN_ENDEDITA = ( $CBEN_FIRST - 5 )
GLOBAL CONST $CBEN_ENDEDITW = ( $CBEN_FIRST - 6 )
GLOBAL CONST $CBEN_GETDISPINFO = ( $CBEN_FIRST - 0 )
GLOBAL CONST $CBEN_GETDISPINFOA = ( $CBEN_FIRST - 0 )
GLOBAL CONST $CBEN_GETDISPINFOW = ( $CBEN_FIRST - 7 )
GLOBAL CONST $CBEN_INSERTITEM = ( $CBEN_FIRST - 1 )
GLOBAL CONST $CBEIF_DI_SETITEM = 268435456
GLOBAL CONST $CBEIF_IMAGE = 2
GLOBAL CONST $CBEIF_INDENT = 16
GLOBAL CONST $CBEIF_LPARAM = 32
GLOBAL CONST $CBEIF_OVERLAY = 8
GLOBAL CONST $CBEIF_SELECTEDIMAGE = 4
GLOBAL CONST $CBEIF_TEXT = 1
GLOBAL CONST $__COMBOBOXCONSTANT_WS_VSCROLL = 2097152
GLOBAL CONST $GUI_SS_DEFAULT_COMBO = BITOR ( $CBS_DROPDOWN , $CBS_AUTOHSCROLL , $__COMBOBOXCONSTANT_WS_VSCROLL )
GLOBAL CONST $TCS_BOTTOM = 2
GLOBAL CONST $TCS_BUTTONS = 256
GLOBAL CONST $TCS_FIXEDWIDTH = 1024
GLOBAL CONST $TCS_FLATBUTTONS = 8
GLOBAL CONST $TCS_FOCUSNEVER = 32768
GLOBAL CONST $TCS_FOCUSONBUTTONDOWN = 4096
GLOBAL CONST $TCS_FORCEICONLEFT = 16
GLOBAL CONST $TCS_FORCELABELLEFT = 32
GLOBAL CONST $TCS_HOTTRACK = 64
GLOBAL CONST $TCS_MULTILINE = 512
GLOBAL CONST $TCS_MULTISELECT = 4
GLOBAL CONST $TCS_OWNERDRAWFIXED = 8192
GLOBAL CONST $TCS_RAGGEDRIGHT = 2048
GLOBAL CONST $TCS_RIGHT = 2
GLOBAL CONST $TCS_RIGHTJUSTIFY = 0
GLOBAL CONST $TCS_SCROLLOPPOSITE = 1
GLOBAL CONST $TCS_SINGLELINE = 0
GLOBAL CONST $TCS_TABS = 0
GLOBAL CONST $TCS_TOOLTIPS = 16384
GLOBAL CONST $TCS_VERTICAL = 128
GLOBAL CONST $TCS_EX_FLATSEPARATORS = 1
GLOBAL CONST $TCS_EX_REGISTERDROP = 2
GLOBAL CONST $TCHT_NOWHERE = 1
GLOBAL CONST $TCHT_ONITEMICON = 2
GLOBAL CONST $TCHT_ONITEMLABEL = 4
GLOBAL CONST $TCHT_ONITEM = 6
GLOBAL CONST $TCIF_TEXT = 1
GLOBAL CONST $TCIF_IMAGE = 2
GLOBAL CONST $TCIF_RTLREADING = 4
GLOBAL CONST $TCIF_PARAM = 8
GLOBAL CONST $TCIF_STATE = 16
GLOBAL CONST $TCIF_ALLDATA = 27
GLOBAL CONST $TCIS_BUTTONPRESSED = 1
GLOBAL CONST $TCIS_HIGHLIGHTED = 2
GLOBAL CONST $TC_ERR = - 1
GLOBAL CONST $GUI_SS_DEFAULT_TAB = 0
GLOBAL CONST $TCM_FIRST = 4864
GLOBAL CONST $TCCM_FIRST = 8192
GLOBAL CONST $TCM_ADJUSTRECT = ( $TCM_FIRST + 40 )
GLOBAL CONST $TCM_DELETEALLITEMS = ( $TCM_FIRST + 9 )
GLOBAL CONST $TCM_DELETEITEM = ( $TCM_FIRST + 8 )
GLOBAL CONST $TCM_DESELECTALL = ( $TCM_FIRST + 50 )
GLOBAL CONST $TCM_GETCURFOCUS = ( $TCM_FIRST + 47 )
GLOBAL CONST $TCM_GETCURSEL = ( $TCM_FIRST + 11 )
GLOBAL CONST $TCM_GETEXTENDEDSTYLE = ( $TCM_FIRST + 53 )
GLOBAL CONST $TCM_GETIMAGELIST = ( $TCM_FIRST + 2 )
GLOBAL CONST $TCM_GETITEMA = ( $TCM_FIRST + 5 )
GLOBAL CONST $TCM_GETITEMW = ( $TCM_FIRST + 60 )
GLOBAL CONST $TCM_GETITEMCOUNT = ( $TCM_FIRST + 4 )
GLOBAL CONST $TCM_GETITEMRECT = ( $TCM_FIRST + 10 )
GLOBAL CONST $TCM_GETROWCOUNT = ( $TCM_FIRST + 44 )
GLOBAL CONST $TCM_GETTOOLTIPS = ( $TCM_FIRST + 45 )
GLOBAL CONST $TCCM_GETUNICODEFORMAT = ( $TCCM_FIRST + 6 )
GLOBAL CONST $TCM_GETUNICODEFORMAT = $TCCM_GETUNICODEFORMAT
GLOBAL CONST $TCM_HIGHLIGHTITEM = ( $TCM_FIRST + 51 )
GLOBAL CONST $TCM_HITTEST = ( $TCM_FIRST + 13 )
GLOBAL CONST $TCM_INSERTITEMA = ( $TCM_FIRST + 7 )
GLOBAL CONST $TCM_INSERTITEMW = ( $TCM_FIRST + 62 )
GLOBAL CONST $TCM_REMOVEIMAGE = ( $TCM_FIRST + 42 )
GLOBAL CONST $TCM_SETITEMA = ( $TCM_FIRST + 6 )
GLOBAL CONST $TCM_SETITEMW = ( $TCM_FIRST + 61 )
GLOBAL CONST $TCM_SETITEMEXTRA = ( $TCM_FIRST + 14 )
GLOBAL CONST $TCM_SETITEMSIZE = $TCM_FIRST + 41
GLOBAL CONST $TCM_SETCURFOCUS = ( $TCM_FIRST + 48 )
GLOBAL CONST $TCM_SETCURSEL = ( $TCM_FIRST + 12 )
GLOBAL CONST $TCM_SETEXTENDEDSTYLE = ( $TCM_FIRST + 52 )
GLOBAL CONST $TCM_SETIMAGELIST = $TCM_FIRST + 3
GLOBAL CONST $TCM_SETMINTABWIDTH = ( $TCM_FIRST + 49 )
GLOBAL CONST $TCM_SETPADDING = ( $TCM_FIRST + 43 )
GLOBAL CONST $TCM_SETTOOLTIPS = ( $TCM_FIRST + 46 )
GLOBAL CONST $TCCM_SETUNICODEFORMAT = ( $TCCM_FIRST + 5 )
GLOBAL CONST $TCM_SETUNICODEFORMAT = $TCCM_SETUNICODEFORMAT
GLOBAL CONST $TCN_FIRST = - 550
GLOBAL CONST $TCN_FOCUSCHANGE = ( $TCN_FIRST - 4 )
GLOBAL CONST $TCN_GETOBJECT = ( $TCN_FIRST - 3 )
GLOBAL CONST $TCN_KEYDOWN = ( $TCN_FIRST - 0 )
GLOBAL CONST $TCN_SELCHANGE = ( $TCN_FIRST - 1 )
GLOBAL CONST $TCN_SELCHANGING = ( $TCN_FIRST - 2 )
#endregion
#region Main
GLOBAL $TOOLTIPX , $TOOLTIPY
FUNC TT ( $MESSAGE )
TOOLTIP ( $MESSAGE , $TOOLTIPX , $TOOLTIPY )
ENDFUNC
GLOBAL CONST $PROCESS_TERMINATE = 1
GLOBAL CONST $PROCESS_CREATE_THREAD = 2
GLOBAL CONST $PROCESS_SET_SESSIONID = 4
GLOBAL CONST $PROCESS_VM_OPERATION = 8
GLOBAL CONST $PROCESS_VM_READ = 16
GLOBAL CONST $PROCESS_VM_WRITE = 32
GLOBAL CONST $PROCESS_DUP_HANDLE = 64
GLOBAL CONST $PROCESS_CREATE_PROCESS = 128
GLOBAL CONST $PROCESS_SET_QUOTA = 256
GLOBAL CONST $PROCESS_SET_INFORMATION = 512
GLOBAL CONST $PROCESS_QUERY_INFORMATION = 1024
GLOBAL CONST $PROCESS_SUSPEND_RESUME = 2048
GLOBAL CONST $PROCESS_ALL_ACCESS = 2035711
FUNC _PROCESSGETNAME ( $I_PID )
IF NOT PROCESSEXISTS ( $I_PID ) THEN RETURN SETERROR ( 1 , 0 , "" )
IF NOT @ERROR THEN
LOCAL $A_PROCESSES = PROCESSLIST ( )
FOR $I = 1 TO $A_PROCESSES [ 0 ] [ 0 ]
IF $A_PROCESSES [ $I ] [ 1 ] = $I_PID THEN RETURN $A_PROCESSES [ $I ] [ 0 ]
NEXT
ENDIF
RETURN SETERROR ( 1 , 0 , "" )
ENDFUNC
FUNC _PROCESSGETPRIORITY ( $VPROCESS )
LOCAL $IERROR , $IEXTENDED , $IRETURN = - 1
LOCAL $I_PID = PROCESSEXISTS ( $VPROCESS )
IF NOT $I_PID THEN RETURN SETERROR ( 1 , 0 , - 1 )
LOCAL $HDLL = DLLOPEN ( "kernel32.dll" )
DO
LOCAL $APROCESSHANDLE = DLLCALL ( $HDLL , "handle" , "OpenProcess" , "dword" , $PROCESS_QUERY_INFORMATION , "bool" , FALSE , "dword" , $I_PID )
IF @ERROR THEN
$IERROR = @ERROR
$IEXTENDED = @EXTENDED
EXITLOOP
ENDIF
IF NOT $APROCESSHANDLE [ 0 ] THEN EXITLOOP
LOCAL $APRIORITY = DLLCALL ( $HDLL , "dword" , "GetPriorityClass" , "handle" , $APROCESSHANDLE [ 0 ] )
IF @ERROR THEN
$IERROR = @ERROR
$IEXTENDED = @EXTENDED
ENDIF
DLLCALL ( $HDLL , "bool" , "CloseHandle" , "handle" , $APROCESSHANDLE [ 0 ] )
IF $IERROR THEN EXITLOOP
SWITCH $APRIORITY [ 0 ]
CASE 64
$IRETURN = 0
CASE 16384
$IRETURN = 1
CASE 32
$IRETURN = 2
CASE 32768
$IRETURN = 3
CASE 128
$IRETURN = 4
CASE 256
$IRETURN = 5
CASE ELSE
$IERROR = 1
$IEXTENDED = $APRIORITY [ 0 ]
$IRETURN = - 1
ENDSWITCH
UNTIL TRUE
DLLCLOSE ( $HDLL )
RETURN SETERROR ( $IERROR , $IEXTENDED , $IRETURN )
ENDFUNC
FUNC _RUNDOS ( $SCOMMAND )
LOCAL $NRESULT = RUNWAIT ( @COMSPEC & " /C " & $SCOMMAND , "" , @SW_HIDE )
RETURN SETERROR ( @ERROR , @EXTENDED , $NRESULT )
ENDFUNC
FUNC _MEMORYOPEN ( $IV_PID , $IV_DESIREDACCESS = 2035711 , $IV_INHERITHANDLE = 1 )
IF NOT PROCESSEXISTS ( $IV_PID ) THEN
SETERROR ( 1 )
RETURN 0
ENDIF
LOCAL $AH_HANDLE [ 2 ] = [ DLLOPEN ( "kernel32.dll" ) ]
IF @ERROR THEN
SETERROR ( 2 )
RETURN 0
ENDIF
LOCAL $AV_OPENPROCESS = DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "OpenProcess" , "int" , $IV_DESIREDACCESS , "int" , $IV_INHERITHANDLE , "int" , $IV_PID )
IF @ERROR THEN
DLLCLOSE ( $AH_HANDLE [ 0 ] )
SETERROR ( 3 )
RETURN 0
ENDIF
$AH_HANDLE [ 1 ] = $AV_OPENPROCESS [ 0 ]
RETURN $AH_HANDLE
ENDFUNC
FUNC _MEMORYWRITE ( $AHHANDLE , $IVADDRESS , $VDATA , $STYPE = "dword" )
IF NOT ISARRAY ( $AHHANDLE ) THEN
SETERROR ( 1 , 0 , FALSE )
ENDIF
LOCAL $VWRITEDATA = DLLSTRUCTCREATE ( $STYPE )
LOCAL $VNUMBEROFBYTESWRITTEN = DLLSTRUCTCREATE ( "ulong_ptr lpNumberOfBytesWritten" )
DLLSTRUCTSETDATA ( $VWRITEDATA , 1 , $VDATA )
LOCAL $AHCALL = DLLCALL ( $AHHANDLE [ 0 ] , "bool" , "WriteProcessMemory" , "handle" , $AHHANDLE [ 1 ] , "dword_ptr" , $IVADDRESS , "ptr" , DLLSTRUCTGETPTR ( $VWRITEDATA ) , "ulong_ptr" , DLLSTRUCTGETSIZE ( $VWRITEDATA ) , "ptr" , DLLSTRUCTGETPTR ( $VNUMBEROFBYTESWRITTEN ) )
RETURN ( $AHCALL [ 0 ] AND ( DLLSTRUCTGETDATA ( $VNUMBEROFBYTESWRITTEN , "lpNumberOfBytesWritten" ) = DLLSTRUCTGETSIZE ( $VWRITEDATA ) ) )
ENDFUNC
FUNC _MEMORYREAD ( $IV_ADDRESS , $AH_HANDLE , $SV_TYPE = "dword" )
IF NOT ISARRAY ( $AH_HANDLE ) THEN
SETERROR ( 1 )
RETURN 0
ENDIF
LOCAL $V_BUFFER = DLLSTRUCTCREATE ( $SV_TYPE )
IF @ERROR THEN
SETERROR ( @ERROR + 1 )
RETURN 0
ENDIF
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "ReadProcessMemory" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) , "int" , "" )
IF NOT @ERROR THEN
LOCAL $V_VALUE = DLLSTRUCTGETDATA ( $V_BUFFER , 1 )
RETURN $V_VALUE
ELSE
SETERROR ( 6 )
RETURN 0
ENDIF
ENDFUNC
FUNC _MEMORYCLOSE ( $AH_HANDLE )
IF NOT ISARRAY ( $AH_HANDLE ) THEN
SETERROR ( 1 )
RETURN 0
ENDIF
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "CloseHandle" , "int" , $AH_HANDLE [ 1 ] )
IF NOT @ERROR THEN
DLLCLOSE ( $AH_HANDLE [ 0 ] )
RETURN 1
ELSE
DLLCLOSE ( $AH_HANDLE [ 0 ] )
SETERROR ( 2 )
RETURN 0
ENDIF
ENDFUNC
FUNC SETPRIVILEGE ( $PRIVILEGE , $BENABLE )
CONST $TOKEN_ADJUST_PRIVILEGES = 32
CONST $TOKEN_QUERY = 8
CONST $SE_PRIVILEGE_ENABLED = 2
LOCAL $HTOKEN , $SP_AUXRET , $SP_RET , $HCURRPROCESS , $NTOKENS , $NTOKENINDEX , $PRIV
$NTOKENS = 1
$LUID = DLLSTRUCTCREATE ( "dword;int" )
IF ISARRAY ( $PRIVILEGE ) THEN $NTOKENS = UBOUND ( $PRIVILEGE )
$TOKEN_PRIVILEGES = DLLSTRUCTCREATE ( "dword;dword[" & ( 3 * $NTOKENS ) & "]" )
$NEWTOKEN_PRIVILEGES = DLLSTRUCTCREATE ( "dword;dword[" & ( 3 * $NTOKENS ) & "]" )
$HCURRPROCESS = DLLCALL ( "kernel32.dll" , "hwnd" , "GetCurrentProcess" )
$SP_AUXRET = DLLCALL ( "advapi32.dll" , "int" , "OpenProcessToken" , "hwnd" , $HCURRPROCESS [ 0 ] , "int" , BITOR ( $TOKEN_ADJUST_PRIVILEGES , $TOKEN_QUERY ) , "int_ptr" , 0 )
IF $SP_AUXRET [ 0 ] THEN
$HTOKEN = $SP_AUXRET [ 3 ]
DLLSTRUCTSETDATA ( $TOKEN_PRIVILEGES , 1 , 1 )
$NTOKENINDEX = 1
WHILE $NTOKENINDEX <= $NTOKENS
IF ISARRAY ( $PRIVILEGE ) THEN
$PRIV = $PRIVILEGE [ $NTOKENINDEX - 1 ]
ELSE
$PRIV = $PRIVILEGE
ENDIF
$RET = DLLCALL ( "advapi32.dll" , "int" , "LookupPrivilegeValue" , "str" , "" , "str" , $PRIV , "ptr" , DLLSTRUCTGETPTR ( $LUID ) )
IF $RET [ 0 ] THEN
IF $BENABLE THEN
DLLSTRUCTSETDATA ( $TOKEN_PRIVILEGES , 2 , $SE_PRIVILEGE_ENABLED , ( 3 * $NTOKENINDEX ) )
ELSE
DLLSTRUCTSETDATA ( $TOKEN_PRIVILEGES , 2 , 0 , ( 3 * $NTOKENINDEX ) )
ENDIF
DLLSTRUCTSETDATA ( $TOKEN_PRIVILEGES , 2 , DLLSTRUCTGETDATA ( $LUID , 1 ) , ( 3 * ( $NTOKENINDEX - 1 ) ) + 1 )
DLLSTRUCTSETDATA ( $TOKEN_PRIVILEGES , 2 , DLLSTRUCTGETDATA ( $LUID , 2 ) , ( 3 * ( $NTOKENINDEX - 1 ) ) + 2 )
DLLSTRUCTSETDATA ( $LUID , 1 , 0 )
DLLSTRUCTSETDATA ( $LUID , 2 , 0 )
ENDIF
$NTOKENINDEX += 1
WEND
$RET = DLLCALL ( "advapi32.dll" , "int" , "AdjustTokenPrivileges" , "hwnd" , $HTOKEN , "int" , 0 , "ptr" , DLLSTRUCTGETPTR ( $TOKEN_PRIVILEGES ) , "int" , DLLSTRUCTGETSIZE ( $NEWTOKEN_PRIVILEGES ) , "ptr" , DLLSTRUCTGETPTR ( $NEWTOKEN_PRIVILEGES ) , "int_ptr" , 0 )
$F = DLLCALL ( "kernel32.dll" , "int" , "GetLastError" )
ENDIF
$NEWTOKEN_PRIVILEGES = 0
$TOKEN_PRIVILEGES = 0
$LUID = 0
IF $SP_AUXRET [ 0 ] = 0 THEN RETURN 0
$SP_AUXRET = DLLCALL ( "kernel32.dll" , "int" , "CloseHandle" , "hwnd" , $HTOKEN )
IF NOT $RET [ 0 ] AND NOT $SP_AUXRET [ 0 ] THEN RETURN 0
RETURN $RET [ 0 ]
ENDFUNC
FUNC _MEMORYPOINTERREAD ( $IV_ADDRESS , $AH_HANDLE , $AV_OFFSET , $SV_TYPE = "dword" )
IF ISARRAY ( $AV_OFFSET ) THEN
IF ISARRAY ( $AH_HANDLE ) THEN
LOCAL $IV_POINTERCOUNT = UBOUND ( $AV_OFFSET ) - 1
ELSE
SETERROR ( 2 )
RETURN 0
ENDIF
ELSE
SETERROR ( 1 )
RETURN 0
ENDIF
LOCAL $IV_DATA [ 2 ] , $I
LOCAL $V_BUFFER = DLLSTRUCTCREATE ( "dword" )
FOR $I = 0 TO $IV_POINTERCOUNT
IF $I = $IV_POINTERCOUNT THEN
$V_BUFFER = DLLSTRUCTCREATE ( $SV_TYPE )
IF @ERROR THEN
SETERROR ( @ERROR + 2 )
RETURN 0
ENDIF
$IV_ADDRESS = "0x" & HEX ( $IV_DATA [ 1 ] + $AV_OFFSET [ $I ] )
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "ReadProcessMemory" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) , "int" , "" )
IF @ERROR THEN
SETERROR ( 7 )
RETURN 0
ENDIF
$IV_DATA [ 1 ] = DLLSTRUCTGETDATA ( $V_BUFFER , 1 )
ELSEIF $I = 0 THEN
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "ReadProcessMemory" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) , "int" , "" )
IF @ERROR THEN
SETERROR ( 7 )
RETURN 0
ENDIF
$IV_DATA [ 1 ] = DLLSTRUCTGETDATA ( $V_BUFFER , 1 )
ELSE
$IV_ADDRESS = "0x" & HEX ( $IV_DATA [ 1 ] + $AV_OFFSET [ $I ] )
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "ReadProcessMemory" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) , "int" , "" )
IF @ERROR THEN
SETERROR ( 7 )
RETURN 0
ENDIF
$IV_DATA [ 1 ] = DLLSTRUCTGETDATA ( $V_BUFFER , 1 )
ENDIF
NEXT
$IV_DATA [ 0 ] = $IV_ADDRESS
RETURN $IV_DATA
ENDFUNC
FUNC _MEMORYGETBASEADDRESS ( $AH_HANDLE , $IHEXDEC = 0 , $IV_ADDRESS = 1048576 )
LOCAL $V_BUFFER = DLLSTRUCTCREATE ( "dword;dword;dword;dword;dword;dword;dword" )
LOCAL $VDATA
LOCAL $VTYPE
IF NOT ISARRAY ( $AH_HANDLE ) THEN
SETERROR ( 1 )
RETURN 0
ENDIF
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "VirtualQueryEx" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) )
IF NOT @ERROR THEN
$VDATA = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 2 ) )
$VTYPE = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 3 ) )
WHILE $VTYPE <> "00000080"
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "VirtualQueryEx" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) )
$VDATA = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 2 ) )
$VTYPE = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 3 ) )
IF HEX ( $IV_ADDRESS ) = "90000000" THEN EXITLOOP
$IV_ADDRESS += 65536
WEND
IF $VTYPE = "00000080" THEN
SETERROR ( 0 )
IF $IHEXDEC = 1 THEN
RETURN DEC ( $VDATA )
ELSE
RETURN $VDATA
ENDIF
ELSE
SETERROR ( 2 )
RETURN 0
ENDIF
ELSE
SETERROR ( 3 )
RETURN 0
ENDIF
ENDFUNC
FUNC _MEMORYMODULEGETBASEADDRESS ( $IPID , $SMODULE )
IF NOT PROCESSEXISTS ( $IPID ) THEN RETURN SETERROR ( 1 , 0 , 0 )
IF NOT ISSTRING ( $SMODULE ) THEN RETURN SETERROR ( 2 , 0 , 0 )
LOCAL $PSAPI = DLLOPEN ( "psapi.dll" )
LOCAL $HPROCESS
LOCAL $PERMISSION = BITOR ( 2 , 1024 , 8 , 16 , 32 )
IF $IPID > 0 THEN
LOCAL $HPROCESS = DLLCALL ( "kernel32.dll" , "ptr" , "OpenProcess" , "dword" , $PERMISSION , "int" , 0 , "dword" , $IPID )
IF $HPROCESS [ 0 ] THEN
$HPROCESS = $HPROCESS [ 0 ]
ENDIF
ENDIF
LOCAL $MODULES = DLLSTRUCTCREATE ( "ptr[1024]" )
LOCAL $ACALL = DLLCALL ( $PSAPI , "int" , "EnumProcessModules" , "ptr" , $HPROCESS , "ptr" , DLLSTRUCTGETPTR ( $MODULES ) , "dword" , DLLSTRUCTGETSIZE ( $MODULES ) , "dword*" , 0 )
IF $ACALL [ 4 ] > 0 THEN
LOCAL $IMODNUM = $ACALL [ 4 ] / 4
LOCAL $ATEMP
FOR $I = 1 TO $IMODNUM
$ATEMP = DLLCALL ( $PSAPI , "dword" , "GetModuleBaseNameW" , "ptr" , $HPROCESS , "ptr" , PTR ( DLLSTRUCTGETDATA ( $MODULES , 1 , $I ) ) , "wstr" , "" , "dword" , 260 )
IF $ATEMP [ 3 ] = $SMODULE THEN
DLLCLOSE ( $PSAPI )
RETURN PTR ( DLLSTRUCTGETDATA ( $MODULES , 1 , $I ) )
ENDIF
NEXT
ENDIF
DLLCLOSE ( $PSAPI )
RETURN SETERROR ( - 1 , 0 , 0 )
ENDFUNC
FUNC MEMORYGETBASEADDRESS ( $AH_HANDLE , $IHEXDEC = 0 )
LOCAL $IV_ADDRESS = 1048576
LOCAL $V_BUFFER = DLLSTRUCTCREATE ( "dword;dword;dword;dword;dword;dword;dword" )
LOCAL $VDATA
LOCAL $VTYPE
IF NOT ISARRAY ( $AH_HANDLE ) THEN
SETERROR ( 1 )
RETURN 0
ENDIF
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "VirtualQueryEx" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) )
IF NOT @ERROR THEN
$VDATA = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 2 ) )
$VTYPE = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 3 ) )
WHILE $VTYPE <> "00000080"
DLLCALL ( $AH_HANDLE [ 0 ] , "int" , "VirtualQueryEx" , "int" , $AH_HANDLE [ 1 ] , "int" , $IV_ADDRESS , "ptr" , DLLSTRUCTGETPTR ( $V_BUFFER ) , "int" , DLLSTRUCTGETSIZE ( $V_BUFFER ) )
$VDATA = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 2 ) )
$VTYPE = HEX ( DLLSTRUCTGETDATA ( $V_BUFFER , 3 ) )
IF HEX ( $IV_ADDRESS ) = "01000000" THEN EXITLOOP
$IV_ADDRESS += 65536
WEND
IF $VTYPE = "00000080" THEN
SETERROR ( 0 )
IF $IHEXDEC = 1 THEN
RETURN DEC ( $VDATA )
ELSE
RETURN $VDATA
ENDIF
ELSE
SETERROR ( 2 )
RETURN 0
ENDIF
ELSE
SETERROR ( 3 )
RETURN 0
ENDIF
ENDFUNC
#endregion
#region Memory Variable Declarations/Other Variable Declarations
GLOBAL $TELEYOFFSET = DEC ( "00A70C50" )
GLOBAL $TARGETXOFFSET = DEC ( "00A42788" )
GLOBAL $SPEEDOFFSET = DEC ( "00A70C50" )
Global $FLYSPEEDOFFSET = Dec ( "00A42788" )
GLOBAL $TARGETXIRONFORGEOFFSET = DEC ( "008A837C" )
GLOBAL $MESSAGEOFFSET = DEC ( "009D39FC" )
GLOBAL $RADIUS = 10
GLOBAL $NUMBEROFGAMES = 1
DIM $PID [ 50 ]
DIM $OPENMEM [ 50 ]
DIM $BASEADDR [ 50 ]
DIM $XDISPLACEMENT [ 50 ]
DIM $YDISPLACEMENT [ 50 ]
DIM $CTMADDR [ 50 ]
DIM $CTMXADDR [ 50 ]
DIM $CTMYADDR [ 50 ]
DIM $CTMZADDR [ 50 ]
GLOBAL $SYNCING = 0
GLOBAL $CURWINDOW
GLOBAL $X = 0
GLOBAL $EVEN = - 1
GLOBAL $NUMBEROFSECTIONS = 1
GLOBAL $CHECKEVEN
GLOBAL $CHAR_Z , $CHAR_X , $CHAR_Y , $XTEST , $ZWRITE , $XWRITE , $YWRITE , $XTELELOC , $YTELELOC , $ZTELELOC , $TCHECK = "4" , $TARGETX , $TARGETY , $TARGETZ , $TARGXTEST , $TARGYTEST , $TARGZTEST , $TARGXREAD , $TARGYREAD , $TARGZREAD , $TARGXCHANGE = 0 , $TARGYCHANGE = 0 , $TARGZCHANGE = 0 , $SPEEDHACKVAR = "off" , $SETSPEED = 14
GLOBAL $TARGETXVAR , $TARGETYVAR , $TARGETZVAR , $PREVX , $PREVTARGETX , $CTCHECK , $CHECKMOVING , $XTELETO , $YTELETO , $ZTELETO , $TTARGET , $SAVEWPNAME , $TELEWPNAME , $READXTELE , $READYTELE , $READZTELE , $PREVMESSAGE , $CURRENTMESSAGE , $CHATCHECKTELE , $HMODE = 0 , $CHATCHECKTELE2 , $CHATCHECKSAVE , $CHATCHECKSAVE2
GLOBAL $ON = 0
DIM $CHATGOTOTELE [ 10 ]
DIM $OTHERCHATGOTOTELE [ 10 ]
#EndRegion includes
#region INILoad
GLOBAL $TELEPORTTOTARGETKB = INIREAD ( @SCRIPTDIR & "\Setup.ini" , "Keybinds" , "TeleportToTarget" , "+z" )
GLOBAL $TOGGLESPEEDHACKKB = INIREAD ( @SCRIPTDIR & "\Setup.ini" , "Keybinds" , "ToggleSpeedHack" , "+a" )
GLOBAL $CHATTELEBEGSTR = INIREAD ( @SCRIPTDIR & "\Setup.ini" , "ChatTeleport" , "BeginString" , "\g" )
GLOBAL $CHATTELEENDSTR = INIREAD ( @SCRIPTDIR & "\Setup.ini" , "ChatTeleport" , "EndString" , "\w" )
GLOBAL $SAVEWPBEGSTR = INIREAD ( @SCRIPTDIR & "\Setup.ini" , "ChatSaveWP" , "BeginString" , "\s" )
GLOBAL $SAVEWPENDSTR = INIREAD ( @SCRIPTDIR & "\Setup.ini" , "ChatSaveWP" , "EndString" , "\w" )
HOTKEYSET ( $TELEPORTTOTARGETKB , "TeleportToTarget" )
HOTKEYSET ( $TOGGLESPEEDHACKKB , "TOGGLESPEEDHACK" )
GLOBAL $TELEPORTBEGINSTRING = $CHATTELEBEGSTR , $TELEPORTENDSTRING = $CHATTELEENDSTR , $SAVEBEGINSTRING = $SAVEWPBEGSTR , $SAVEENDSTRING = $SAVEWPENDSTR
#EndRegion INILoad
#region Functions
HOTKEYSET ( "{F8}" , "AddSyncedGame" )
FUNC STARTHARASS ( )
$HMODE = 1
ENDFUNC
FUNC STOPHARASS ( )
$HMODE = 0
ENDFUNC
FUNC DISPCOORDS ( )
LOCAL $LOCALVAR
$LOCALVAR = INPUTBOX ( "Coords" , "X/Y/Z" , $CHAR_X & "," & $CHAR_Y & "," & $CHAR_Z )
ENDFUNC
FUNC TOGGLESPEEDHACK ( )
IF $SPEEDHACKVAR = "on" THEN
$SPEEDHACKVAR = "off"
GUICTRLSETDATA ( $SPEEDHACKSTATUS_LABEL , "Status:OFF" )
ELSE
$SPEEDHACKVAR = "on"
GUICTRLSETDATA ( $SPEEDHACKSTATUS_LABEL , "Status:ON" )
ENDIF
ENDFUNC
FUNC FOLLOWON ( )
$ON = 1
ENDFUNC
FUNC FOLLOWOFF ( )
$ON = 0
ENDFUNC
FUNC HARASS ( )
IF $HMODE = "1" THEN
IF $TARGETXVAR < - 1.000000e-001 OR $TARGETXVAR > 1.000000e-001 OR $TARGETYVAR < - 1.000000e-001 OR $TARGETYVAR > 1.000000e-001 OR $TARGETZVAR < - 1.000000e-001 OR $TARGETZVAR > 1.000000e-001 THEN
IF $TARGETXVAR < 50000 AND $TARGETYVAR < 50000 AND $TARGETZVAR < 50000 AND $TARGETXVAR > - 50000 AND $TARGETYVAR > - 50000 AND $TARGETZVAR > - 50000 THEN
TELEPORT ( $TARGETXVAR + RANDOM ( - 3 , 3 ) , $TARGETYVAR + RANDOM ( - 3 , 3 ) , $TARGETZVAR , 1 )
ENDIF
ENDIF
ENDIF
ENDFUNC
FUNC TELEPORTTOTARGET ( )
IF $TTARGET = "1" THEN
IF $TARGETXVAR < - 1.000000e-001 OR $TARGETXVAR > 1.000000e-001 OR $TARGETYVAR < - 1.000000e-001 OR $TARGETYVAR > 1.000000e-001 OR $TARGETZVAR < - 1.000000e-001 OR $TARGETZVAR > 1.000000e-001 THEN
IF $TARGETXVAR < 50000 AND $TARGETYVAR < 50000 AND $TARGETZVAR < 50000 AND $TARGETXVAR > - 50000 AND $TARGETYVAR > - 50000 AND $TARGETZVAR > - 50000 THEN
TELEPORT ( $TARGETXVAR , $TARGETYVAR , $TARGETZVAR , 1 )
ENDIF
ENDIF
ENDIF
ENDFUNC
FUNC ADDSYNCEDGAME ( )
IF $SYNCING = 1 THEN
IF $X < $NUMBEROFGAMES THEN
$X = ( $X + 1 )
TT ( "Please set window #" & ( $X + 1 ) )
$CURWINDOW = WINGETTITLE ( "" )
$PID [ $X ] = WINGETPROCESS ( $CURWINDOW )
WINSETTITLE ( $CURWINDOW , "" , $X )
$OPENMEM [ $X ] = _MEMORYOPEN ( $PID [ $X ] )
$BASEADDR [ $X ] = _MEMORYMODULEGETBASEADDRESS ( $PID [ $X ] , "WoW.exe" )
$CTMADDR [ $X ] = "0x" & HEX ( $BASEADDR [ $X ] + DEC ( "9D61D4" ) )
$CTMXADDR [ $X ] = "0x" & HEX ( $BASEADDR [ $X ] + DEC ( "9D6248" ) )
$CTMYADDR [ $X ] = "0x" & HEX ( $BASEADDR [ $X ] + DEC ( "9D6244" ) )
$CTMZADDR [ $X ] = "0x" & HEX ( $BASEADDR [ $X ] + DEC ( "9D624C" ) )
IF $X = $NUMBEROFGAMES THEN
TT ( "" )
$X = 0
$SYNCING = 0
EVENORODD ( )
ENDIF
ELSE
TT ( "" )
$X = 0
$SYNCING = 0
EVENORODD ( )
ENDIF
ENDIF
ENDFUNC
FUNC EVENORODD ( )
$EVEN = 1
DETERMINEDISPLACEMENT ( )
ENDFUNC
FUNC CHECKCHAT ( )
$CURRENTMESSAGE = _MEMORYREAD ( "0x" & HEX ( $BASEADDR [ 1 ] + $MESSAGEOFFSET ) , $OPENMEM [ 1 ] , "int" )
$CURRENTMESSAGE = _MEMORYREAD ( $CURRENTMESSAGE + DEC ( "170" ) , $OPENMEM [ 1 ] , "int" )
$CURRENTMESSAGE = _MEMORYREAD ( $CURRENTMESSAGE + DEC ( "c8" ) , $OPENMEM [ 1 ] , "int" )
$CURRENTMESSAGE = _MEMORYREAD ( $CURRENTMESSAGE + DEC ( "0" ) , $OPENMEM [ 1 ] , "int" )
$CURRENTMESSAGE = _MEMORYREAD ( $CURRENTMESSAGE + DEC ( "24" ) , $OPENMEM [ 1 ] , "int" )
$CURRENTMESSAGE = _MEMORYREAD ( $CURRENTMESSAGE + DEC ( "0" ) , $OPENMEM [ 1 ] , "char[999]" )
$CHATCHECKTELE = STRINGINSTR ( $CURRENTMESSAGE , $TELEPORTBEGINSTRING )
$CHATCHECKTELE2 = STRINGINSTR ( $CURRENTMESSAGE , $TELEPORTENDSTRING )
$CHATCHECKSAVE = STRINGINSTR ( $CURRENTMESSAGE , $SAVEBEGINSTRING )
$CHATCHECKSAVE2 = STRINGINSTR ( $CURRENTMESSAGE , $SAVEENDSTRING )
IF $CHATCHECKTELE > 0 AND $CHATCHECKTELE2 > 0 THEN
IF NOT @ERROR THEN
$CHATGOTOTELE = STRINGSPLIT ( $CURRENTMESSAGE , " " )
$OTHERCHATGOTOTELE = STRINGSPLIT ( $CHATGOTOTELE [ 2 ] , $TELEPORTENDSTRING )
$READXTELE = INIREAD ( @SCRIPTDIR & "\CustomWaypoints.ini" , $OTHERCHATGOTOTELE [ 1 ] , "x" , "" )
IF NOT @ERROR THEN
$READYTELE = INIREAD ( @SCRIPTDIR & "\CustomWaypoints.ini" , $OTHERCHATGOTOTELE [ 1 ] , "y" , "" )
IF NOT @ERROR THEN
$READZTELE = INIREAD ( @SCRIPTDIR & "\CustomWaypoints.ini" , $OTHERCHATGOTOTELE [ 1 ] , "z" , "" )
IF NOT @ERROR THEN
ENDIF
ENDIF
ENDIF
IF $READXTELE = "" AND $READYTELE = "" AND $READZTELE = "" THEN
ELSE
SEND ( "^a" & "{BS}" & "{ENTER}" )
TELEPORT ( $READXTELE , $READYTELE , $READZTELE , 1 )
ENDIF
ENDIF
ENDIF
IF $CHATCHECKSAVE > 0 AND $CHATCHECKSAVE2 > 0 THEN
$CHATGOTOTELE = STRINGSPLIT ( $CURRENTMESSAGE , " " )
$OTHERCHATGOTOTELE = STRINGSPLIT ( $CHATGOTOTELE [ 2 ] , $SAVEENDSTRING )
INIWRITE ( @SCRIPTDIR & "\CustomWaypoints.ini" , $CHATGOTOTELE [ 2 ] , "X" , $CHAR_X )
INIWRITE ( @SCRIPTDIR & "\CustomWaypoints.ini" , $CHATGOTOTELE [ 2 ] , "Y" , $CHAR_Y )
INIWRITE ( @SCRIPTDIR & "\CustomWaypoints.ini" , $CHATGOTOTELE [ 2 ] , "Z" , $CHAR_Z )
SEND ( "^a" & "{BS}" & "{ENTER}" )
SOUNDPLAY ( @SCRIPTDIR & "\SavedWaypoint_MP3.mp3" , 0 )
ENDIF
ENDFUNC
FUNC DETERMINEDISPLACEMENT ( )
FOR $I = 2 TO ( $NUMBEROFGAMES )
$XDISPLACEMENT [ $I ] = RANDOM ( - $RADIUS , $RADIUS )
$YDISPLACEMENT [ $I ] = RANDOM ( - $RADIUS , $RADIUS )
NEXT
MSGBOX ( 0 , "Displacement" , "Determined" )
ENDFUNC
FUNC TELEPORT ( $1 , $2 , $3 , $4 )
LOCAL $ZTEST , $YTEST , $READTEST , $XTEST , $XCHANGE , $YCHANGE , $ZCHANGE
CALLPOS ( )
$XCHANGE = $1
$YCHANGE = $2
$ZCHANGE = $3
IF $4 = 0 THEN
$XCHANGE = $CHAR_X + $XCHANGE
$YCHANGE = $CHAR_Y + $YCHANGE
$ZCHANGE = $CHAR_Z + $ZCHANGE
ENDIF
FOR $I = 1 TO $NUMBEROFGAMES
$XTEST = _MEMORYREAD ( "0x" & HEX ( $BASEADDR [ $I ] + $TELEYOFFSET ) , $OPENMEM [ $I ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "38" ) , $OPENMEM [ $I ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "24" ) , $OPENMEM [ $I ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "1c8" ) , $OPENMEM [ $I ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "210" ) , $OPENMEM [ $I ] , "int" )
$ZWRITE = $XTEST + DEC ( "3c0" )
$YWRITE = $XTEST + DEC ( "3B8" )
$XWRITE = $XTEST + DEC ( "3BC" )
_MEMORYWRITE ( $OPENMEM [ $I ] , $XWRITE , ( $XCHANGE ) , "float" )
_MEMORYWRITE ( $OPENMEM [ $I ] , $YWRITE , ( $YCHANGE ) , "float" )
_MEMORYWRITE ( $OPENMEM [ $I ] , $ZWRITE , ( $ZCHANGE ) , "float" )
NEXT
ENDFUNC
FUNC CALLPOS ( )
$XTEST = _MEMORYREAD ( "0x" & HEX ( $BASEADDR [ 1 ] + $TELEYOFFSET ) , $OPENMEM [ 1 ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "38" ) , $OPENMEM [ 1 ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "24" ) , $OPENMEM [ 1 ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "1c8" ) , $OPENMEM [ 1 ] , "int" )
$XTEST = _MEMORYREAD ( $XTEST + DEC ( "210" ) , $OPENMEM [ 1 ] , "int" )
$ZWRITE = $XTEST + DEC ( "3c0" )
$YWRITE = $XTEST + DEC ( "3B8" )
$XWRITE = $XTEST + DEC ( "3BC" )
GLOBAL $CHAR_X = _MEMORYREAD ( $XWRITE , $OPENMEM [ 1 ] , "float" )
GLOBAL $CHAR_Y = _MEMORYREAD ( $YWRITE , $OPENMEM [ 1 ] , "float" )
GLOBAL $CHAR_Z = _MEMORYREAD ( $ZWRITE , $OPENMEM [ 1 ] , "float" )
$TARGXTEST = _MEMORYREAD ( "0x" & HEX ( $BASEADDR [ 1 ] + $TARGETXOFFSET ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "100" ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "140" ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "7d0" ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "1cc" ) , $OPENMEM [ 1 ] , "int" )
$TARGYREAD = $TARGXTEST + DEC ( "10" )
$TARGZREAD = $TARGXTEST + DEC ( "18" )
$TARGXREAD = $TARGXTEST + DEC ( "14" )
$TARGETX = _MEMORYREAD ( $TARGXREAD , $OPENMEM [ 1 ] , "float" )
$TARGETY = _MEMORYREAD ( $TARGYREAD , $OPENMEM [ 1 ] , "float" )
$TARGETZ = _MEMORYREAD ( $TARGZREAD , $OPENMEM [ 1 ] , "float" )
IF $TARGETX = "0" THEN
IF $TARGETY = "0" THEN
IF $TARGETZ = "0" THEN
$TARGXTEST = _MEMORYREAD ( "0x" & HEX ( $BASEADDR [ 1 ] + $TARGETXIRONFORGEOFFSET ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "488" ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "784" ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "69c" ) , $OPENMEM [ 1 ] , "int" )
$TARGXTEST = _MEMORYREAD ( $TARGXTEST + DEC ( "18c" ) , $OPENMEM [ 1 ] , "int" )
$TARGYREAD = $TARGXTEST + DEC ( "694" )
$TARGZREAD = $TARGXTEST + DEC ( "69C" )
$TARGXREAD = $TARGXTEST + DEC ( "698" )
$TARGETX = _MEMORYREAD ( $TARGXREAD , $OPENMEM [ 1 ] , "float" )
$TARGETY = _MEMORYREAD ( $TARGYREAD , $OPENMEM [ 1 ] , "float" )
$TARGETZ = _MEMORYREAD ( $TARGZREAD , $OPENMEM [ 1 ] , "float" )
ENDIF
ENDIF
ENDIF
$TARGETXVAR = $TARGETX + $TARGXCHANGE
$TARGETYVAR = $TARGETY + $TARGYCHANGE
$TARGETZVAR = $TARGETZ + $TARGZCHANGE
ENDFUNC
FUNC CALLGUI ( )
GUICTRLSETDATA ( $X_LABEL , "X:" & $CHAR_X )
GUICTRLSETDATA ( $Y_LABEL , "Y:" & $CHAR_Y )
GUICTRLSETDATA ( $Z_LABEL , "Z:" & $CHAR_Z )
GUICTRLSETDATA ( $TARGETX_LABEL , "Target X:" & $TARGETXVAR )
GUICTRLSETDATA ( $TARGETY_LABEL , "Target Y:" & $TARGETYVAR )
GUICTRLSETDATA ( $TARGETZ_LABEL , "Target Z:" & $TARGETZVAR )
ENDFUNC
FUNC TELEPORTCLICKTOMOVE ( )
$CHECKMOVING = _MEMORYREAD ( $CTMADDR [ 1 ] , $OPENMEM [ 1 ] , "float" )
IF $CHECKMOVING < 5.605194e-045 THEN
IF $CHECKMOVING > 5.605194e-045 THEN
$XTELETO = _MEMORYREAD ( $CTMXADDR [ 1 ] , $OPENMEM [ 1 ] , "float" )
$YTELETO = _MEMORYREAD ( $CTMYADDR [ 1 ] , $OPENMEM [ 1 ] , "float" )
$ZTELETO = _MEMORYREAD ( $CTMZADDR [ 1 ] , $OPENMEM [ 1 ] , "float" )
TELEPORT ( $XTELETO , $YTELETO , $ZTELETO , 1 )
ENDIF
ENDIF
ENDFUNC
FUNC RUNSPEEDHACK ($r)
FOR $I = 1 TO $NUMBEROFGAMES
$FLYSPEEDADDRESS = _MEMORYREAD ( "0x" & HEX ( $BASEADDR [ $I ] + $FLYSPEEDOFFSET ), $OPENMEM [ $I ] , "int" )
$FLYSPEEDADDRESS = _MEMORYREAD ( $FLYSPEEDADDRESS + Dec("75C"), $OPENMEM [ $I ] , "int" )
$FLYSPEEDADDRESS = _MEMORYREAD ( $FLYSPEEDADDRESS + Dec("0"), $OPENMEM [ $I ] , "int" )
$FLYSPEEDADDRESS = _MEMORYREAD ( $FLYSPEEDADDRESS + Dec("0"), $OPENMEM [ $I ] , "int" )
$FLYSPEEDADDRESS = _MEMORYREAD ( $FLYSPEEDADDRESS + Dec("0"), $OPENMEM [ $I ] , "int" )
$FLYSPEEDADDRESS = $FLYSPEEDADDRESS + DEC ( "BC" )


$SPEEDADDRESS = _MEMORYREAD ( "0x" & HEX ( $BASEADDR [ $I ] + $SPEEDOFFSET ) , $OPENMEM [ $I ] , "int" )
$SPEEDADDRESS = _MEMORYREAD ( $SPEEDADDRESS + DEC ( "38" ) , $OPENMEM [ $I ] , "int" )
$SPEEDADDRESS = _MEMORYREAD ( $SPEEDADDRESS + DEC ( "24" ) , $OPENMEM [ $I ] , "int" )
$SPEEDADDRESS = _MEMORYREAD ( $SPEEDADDRESS + DEC ( "75C" ) , $OPENMEM [ $I ] , "int" )
$SPEEDADDRESS = _MEMORYREAD ( $SPEEDADDRESS + DEC ( "0" ) , $OPENMEM [ $I ] , "int" )
$SPEEDADDRESS = _MEMORYREAD ( $SPEEDADDRESS + DEC ( "0" ) , $OPENMEM [ $I ] , "int" )
$SPEEDADDRESS = $SPEEDADDRESS + DEC ( "AC" )
if $r = 2 Then
	_MEMORYWRITE ( $OPENMEM [ $I ] , $SPEEDADDRESS , $SETSPEED , "float" )
	_MEMORYWRITE ( $OPENMEM [ $I ] , $FLYSPEEDADDRESS , $SETSPEED , "float" )
	$SHISON=5
Else
	_MEMORYWRITE ( $OPENMEM [ $I ] , $SPEEDADDRESS , 7.7 , "float" )
	_MEMORYWRITE ( $OPENMEM [ $I ] , $FLYSPEEDADDRESS , 21 , "float" )
	$SHISON=6
EndIf

NEXT
ENDFUNC
#endregion
#Region ### START Koda GUI section ### Form=c:\users\jacob\downloads\koda_1.7.3.0\forms\hunters 2.kxf
$FORM1_2 = GUICREATE ( "Hunters" , 265 , 278 , 311 , 294 )
$MENUITEM1 = GUICTRLCREATEMENU ( "&Teleport" )
$MENUITEM2 = GUICTRLCREATEMENU ( "Eastern Kingdoms" & @TAB & "" , $MENUITEM1 )
$MENUITEM4 = GUICTRLCREATEMENU ( "Elwynn Forest" & @TAB & "" , $MENUITEM2 )
$MENUITEM5 = GUICTRLCREATEMENU ( "Stormwind" & @TAB & "" , $MENUITEM4 )
$TELEPORTSTORMWINDPORTAL_BUTTON = GUICTRLCREATEMENUITEM ( "Portals" & @TAB & "" , $MENUITEM5 )
$TELEPORTEXPERIENCEDISABLER_BUTTON = GUICTRLCREATEMENUITEM ( "Experience Disabler" & @TAB & "" , $MENUITEM5 )
$TELEPORTDUELAREASTORMWIND_BUTTON = GUICTRLCREATEMENUITEM ( "Duel Area" , $MENUITEM4 )
$MENUITEM7 = GUICTRLCREATEMENU ( "Deadwind Pass" , $MENUITEM2 )
$TELEPORTKARAZAHN_BUTTON = GUICTRLCREATEMENUITEM ( "Karazahn Entrance" , $MENUITEM7 )
$MENUITEM14 = GUICTRLCREATEMENU ( "Eastern Plaguelands" , $MENUITEM2 )
$MENUITEM20 = GUICTRLCREATEMENU ( "Stratholme" , $MENUITEM14 )
$TELEPORTSTRATHOLMEENTRANCEOUTSIDE_BUTTON = GUICTRLCREATEMENUITEM ( "Entrance(Outside)" , $MENUITEM20 )
$TELEPORTSTRATHOLMEENTRANCEINSIDE_BUTTON = GUICTRLCREATEMENUITEM ( "Entrance(Inside)" , $MENUITEM20 )
$TELEPORTBARONRIVENDARE_BUTTON = GUICTRLCREATEMENUITEM ( "Baron Rivendare(Mount Drop)" , $MENUITEM20 )
$MENUITEM15 = GUICTRLCREATEMENU ( "Burning Steppes" , $MENUITEM2 )
$MENUITEM16 = GUICTRLCREATEMENU ( "Molten Core" , $MENUITEM15 )
$TELEPORTMOLTENCOREOUTSIDEENTRANCE_BUTTON = GUICTRLCREATEMENUITEM ( "Entrance(Outside)" , $MENUITEM16 )
$TELEPORTMOLTENCOREENTRANCEINSIDE_BUTTON = GUICTRLCREATEMENUITEM ( "Entrance(Inside)" , $MENUITEM16 )
$TELEPORTRAGNAROS_BUTTON = GUICTRLCREATEMENUITEM ( "Ragnaros(Gold Drop)" , $MENUITEM16 )
$MENUITEM3 = GUICTRLCREATEMENU ( "Kalimdor" & @TAB & "" , $MENUITEM1 )
$MENUITEM6 = GUICTRLCREATEMENU ( "Durotar" , $MENUITEM3 )
$TELEPORTORGDUELAREA_BUTTON = GUICTRLCREATEMENUITEM ( "Horde Duel Area" & @TAB & "" , $MENUITEM6 )
$TELEPORTORGPORTALS_BUTTON = GUICTRLCREATEMENUITEM ( "Org Portals" , $MENUITEM6 )
$MENUITEM8 = GUICTRLCREATEMENU ( "Darnassus" & @TAB & "" , $MENUITEM3 )
$TELEPORTDARNASSUSPORTALBUTTON = GUICTRLCREATEMENUITEM ( "Portals" , $MENUITEM8 )
$TELEPORTDARNASSUSREPAIRBUTTON = GUICTRLCREATEMENUITEM ( "Repair" , $MENUITEM8 )
$TELEPORTGMISLAND_BUTTON = GUICTRLCREATEMENUITEM ( "GM Island(Hidden Area)" , $MENUITEM3 )
$MENUITEM9 = GUICTRLCREATEMENU ( "Outland" , $MENUITEM1 )
$MENUITEM10 = GUICTRLCREATEMENU ( "Terokkar Forest" , $MENUITEM9 )
$MENUITEM11 = GUICTRLCREATEMENU ( "Sethekk Halls" , $MENUITEM10 )
$TELEPORTSETHEKKHALLENTRANCE_BUTTON = GUICTRLCREATEMENUITEM ( "Entrance(Outside)" , $MENUITEM11 )
$TELEPORTSETHEKKHALLINSIDE_BUTTON = GUICTRLCREATEMENUITEM ( "Entrance(Inside)" , $MENUITEM11 )
$TELEPORTANZU_BUTTON = GUICTRLCREATEMENUITEM ( "Anzu (Raven Mount)" , $MENUITEM11 )
$MENUITEM12 = GUICTRLCREATEMENU ( "Northrend" , $MENUITEM1 )
$MENUITEM13 = GUICTRLCREATEMENU ( "Howling Fjord" , $MENUITEM12 )
$TELEPORTUTGARDEENTRANCEOUTSIDE_BUTTON = GUICTRLCREATEMENUITEM ( "Utgarde Keep Entrance(Outside)" , $MENUITEM13 )
$TELEPORTUTGARDEENTRANCEINSIDE_BUTTON = GUICTRLCREATEMENUITEM ( "Utgarde Keep Entrance(Inside)" , $MENUITEM13 )
$TELEPORTUTGARDESKADI_BUTTON = GUICTRLCREATEMENUITEM ( "Skadi The Ruthless (Drake Mount)" , $MENUITEM13 )
$TAB1 = GUICTRLCREATETAB ( 8 , 8 , 265 , 241 )
$TABSHEET1 = GUICTRLCREATETABITEM ( "HunterSetup" )
$BUTTON_SYNC = GUICTRLCREATEBUTTON ( "Sync Games" , 17 , 71 , 113 , 25 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$INPUT_NUMBEROFGAMES = GUICTRLCREATEINPUT ( "1" , 201 , 71 , 33 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL1 = GUICTRLCREATELABEL ( "# of games:" , 137 , 73 , 60 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL2 = GUICTRLCREATELABEL ( "Radius from main:" , 17 , 39 , 88 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$INPUT_RADIUS = GUICTRLCREATEINPUT ( "10" , 113 , 39 , 25 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$BUTTON_RECONFIGURE = GUICTRLCREATEBUTTON ( "Reconfigure Displacement" , 20 , 103 , 131 , 25 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$PIC1 = GUICTRLCREATEPIC ( @SCRIPTDIR & "\OMGHAXLogo_JPEG.jpg" , 32 , 136 , 225 , 105 )
$TABSHEET2 = GUICTRLCREATETABITEM ( "Teleport" )
$CHECKBOX_COORDS = GUICTRLCREATECHECKBOX ( "Direct Coordinates" , 16 , 34 , 113 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$INPUT_X = GUICTRLCREATEINPUT ( "0" , 48 , 58 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$INPUT_Y = GUICTRLCREATEINPUT ( "0" , 48 , 82 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$INPUT_Z = GUICTRLCREATEINPUT ( "0" , 48 , 106 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$BUTTON_TELEPORT = GUICTRLCREATEBUTTON ( "Go" , 72 , 138 , 75 , 25 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$X = GUICTRLCREATELABEL ( "X" , 28 , 61 , 11 , 18 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL3 = GUICTRLCREATELABEL ( "Y" , 28 , 85 , 12 , 18 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL4 = GUICTRLCREATELABEL ( "Z" , 28 , 109 , 11 , 18 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$CLICKTOTELE_CHECKBOX = GUICTRLCREATECHECKBOX ( "Enable ClickToTeleport" , 24 , 168 , 137 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TELEPORTWAYPOINT_INPUT = GUICTRLCREATEINPUT ( "None" , 88 , 192 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TELEPORTWAYPOINT_BUTTON = GUICTRLCREATEBUTTON ( "Teleport to Waypoint" , 32 , 216 , 139 , 25 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL10 = GUICTRLCREATELABEL ( "Waypoint:" , 24 , 193 , 52 , 18 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TABSHEET3 = GUICTRLCREATETABITEM ( "Coordinates" )
$X_LABEL = GUICTRLCREATELABEL ( "X:0" , 12 , 50 , 196 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$Y_LABEL = GUICTRLCREATELABEL ( "Y:0" , 12 , 70 , 196 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$Z_LABEL = GUICTRLCREATELABEL ( "Z:0" , 12 , 90 , 196 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TARGETX_LABEL = GUICTRLCREATELABEL ( "Target X:" , 12 , 118 , 192 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TARGETY_LABEL = GUICTRLCREATELABEL ( "Target Y:" , 12 , 138 , 192 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TARGETZ_LABEL = GUICTRLCREATELABEL ( "Target Z:" , 12 , 158 , 192 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$SAVEWAYPOINT_INPUT = GUICTRLCREATEINPUT ( "None" , 112 , 191 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABELWHATEVER = GUICTRLCREATELABEL ( "Waypoint Name:" , 16 , 192 , 82 , 18 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$SAVEWP_BUTTON = GUICTRLCREATEBUTTON ( "Save Waypoint" , 80 , 216 , 99 , 25 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$SPEEDHACK = GUICTRLCREATETABITEM ( "Speedhack" )
$LABEL5 = GUICTRLCREATELABEL ( "Default speed=7" , 20 , 69 , 87 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$SPEED_INPUT = GUICTRLCREATEINPUT ( "7" , 116 , 68 , 89 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$SPEEDHACKSTATUS_LABEL = GUICTRLCREATELABEL ( "Status: Off" , 20 , 45 , 70 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TOGGLESPEEDHACK_BUTTON = GUICTRLCREATEBUTTON ( "Toggle Speedhack" , 52 , 165 , 113 , 25 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$SETSPEED_BUTTON = GUICTRLCREATEBUTTON ( "Set Speed" , 72 , 125 , 75 , 25 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TABSHEET4 = GUICTRLCREATETABITEM ( "Target Teleport Options" )
$LABEL6 = GUICTRLCREATELABEL ( "Enter displacement for target teleporting." , 28 , 37 , 194 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL7 = GUICTRLCREATELABEL ( "X" , 20 , 80 , 11 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL8 = GUICTRLCREATELABEL ( "Y" , 20 , 110 , 11 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$LABEL9 = GUICTRLCREATELABEL ( "Z" , 20 , 140 , 11 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$XDISPLACEMENT_INPUT = GUICTRLCREATEINPUT ( "0" , 36 , 77 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$YDISPLACEMENT_INPUT = GUICTRLCREATEINPUT ( "0" , 36 , 107 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$ZDISPLACEMENT_INPUT = GUICTRLCREATEINPUT ( "0" , 36 , 137 , 121 , 22 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TELEPORTTOTARGET_CHECKBOX = GUICTRLCREATECHECKBOX ( "Enable Teleport To Target" , 40 , 176 , 145 , 17 )
GUICTRLSETFONT ( - 1 , 8 , 400 , 0 , "Arial" )
$TABSHEET5 = GUICTRLCREATETABITEM ( "Keybinds" )
$LABEL11 = GUICTRLCREATELABEL ( "Teleport To Target:" , 16 , 48 , 96 , 17 )
$TELETOTARGETKEYBIND_INPUT = GUICTRLCREATEINPUT ( $TELEPORTTOTARGETKB , 120 , 48 , 33 , 21 )
$LABEL13 = GUICTRLCREATELABEL ( "Toggle Speedhack" , 16 , 88 , 95 , 17 )
$TOGGLESPEEDHACKKEYBIND_INPUT = GUICTRLCREATEINPUT ( $TOGGLESPEEDHACKKB , 120 , 88 , 33 , 21 )
$LABEL12 = GUICTRLCREATELABEL ( "For more information on setting these keybinds" , 16 , 192 , 222 , 17 )
$KEYBINDSINFO_BUTTON = GUICTRLCREATEBUTTON ( "Info" , 72 , 216 , 35 , 17 )
$LABEL14 = GUICTRLCREATELABEL ( "click 'Info'." , 16 , 216 , 54 , 17 )
$SAVEKEYBINDS_BUTTON = GUICTRLCREATEBUTTON ( "Save New Keybinds" , 64 , 136 , 131 , 25 )
$TABSHEET6 = GUICTRLCREATETABITEM ( "Chat Teleport Options" )
$LABEL15 = GUICTRLCREATELABEL ( "Save WP Begin" , 24 , 40 , 80 , 17 )
$SAVEWPBEGIN_INPUT = GUICTRLCREATEINPUT ( $SAVEWPBEGSTR , 128 , 40 , 49 , 21 )
$LABEL16 = GUICTRLCREATELABEL ( "Save WP End" , 24 , 64 , 72 , 17 )
$SAVEWPEND_INPUT = GUICTRLCREATEINPUT ( $SAVEWPENDSTR , 128 , 64 , 49 , 21 )
$LABEL17 = GUICTRLCREATELABEL ( "Teleport WP Begin" , 24 , 88 , 94 , 17 )
$TELEPORTWPBEGIN_INPUT = GUICTRLCREATEINPUT ( $CHATTELEBEGSTR , 128 , 88 , 49 , 21 )
$LABEL18 = GUICTRLCREATELABEL ( "Teleport WP End" , 24 , 112 , 86 , 17 )
$TELEPORTWPEND_INPUT = GUICTRLCREATEINPUT ( $CHATTELEENDSTR , 128 , 112 , 49 , 21 )
$SAVECHATTELEPORTOPTIONS_BUTTON = GUICTRLCREATEBUTTON ( "Save Changes" , 24 , 136 , 91 , 25 )
$LABEL19 = GUICTRLCREATELABEL ( "For info on how the chat teleport options work," , 24 , 192 , 223 , 17 )
$LABEL20 = GUICTRLCREATELABEL ( "click the info button." , 24 , 216 , 100 , 17 )
$CHATTELEPORTOPTIONSINFO_BUTTON = GUICTRLCREATEBUTTON ( "Info" , 128 , 216 , 35 , 17 )
GUICTRLCREATETABITEM ( "" )
DIM $FORM1_2_ACCELTABLE [ 2 ] [ 2 ] = [ [ "!{PAUSE}" , $MENUITEM4 ] , [ "!8" , $TELEPORTORGDUELAREA_BUTTON ] ]
GUISETACCELERATORS ( $FORM1_2_ACCELTABLE )
GUISETSTATE ( @SW_SHOW )
#EndRegion ### END Koda GUI section ###
WHILE 1
$NMSG = GUIGETMSG ( )
SWITCH $NMSG
CASE $GUI_EVENT_CLOSE
EXIT
CASE $BUTTON_RECONFIGURE
DETERMINEDISPLACEMENT ( )
CASE $BUTTON_SYNC
$SYNCING = 1
$X = 0
CASE $SETSPEED_BUTTON
$SETSPEED = GUICTRLREAD ( $SPEED_INPUT )
CASE $TOGGLESPEEDHACK_BUTTON
TOGGLESPEEDHACK ( )
CASE $TELEPORTWAYPOINT_BUTTON
$TELEWPNAME = GUICTRLREAD ( $TELEPORTWAYPOINT_INPUT )
$READXTELE = INIREAD ( @SCRIPTDIR & "\CustomWaypoints.ini" , $TELEWPNAME , "x" , "" )
$READYTELE = INIREAD ( @SCRIPTDIR & "\CustomWaypoints.ini" , $TELEWPNAME , "y" , "" )
$READZTELE = INIREAD ( @SCRIPTDIR & "\CustomWaypoints.ini" , $TELEWPNAME , "z" , "" )
IF $READXTELE = "" AND $READYTELE = "" AND $READZTELE = "" THEN
MSGBOX ( 4096 , "Error" , "Error, Waypoint name incorrect or waypoint profile file missing." )
ELSE
TELEPORT ( $READXTELE , $READYTELE , $READZTELE , 1 )
ENDIF
CASE $SAVEWP_BUTTON
$SAVEWPNAME = GUICTRLREAD ( $SAVEWAYPOINT_INPUT )
INIWRITE ( @SCRIPTDIR & "\CustomWaypoints.ini" , $SAVEWPNAME , "X" , $CHAR_X )
INIWRITE ( @SCRIPTDIR & "\CustomWaypoints.ini" , $SAVEWPNAME , "Y" , $CHAR_Y )
INIWRITE ( @SCRIPTDIR & "\CustomWaypoints.ini" , $SAVEWPNAME , "Z" , $CHAR_Z )
MSGBOX ( 0 , "Saved." , "Saved WP "" & $SAVEWPNAME & ""." )
CASE $XDISPLACEMENT_INPUT
$TARGXCHANGE = GUICTRLREAD ( $XDISPLACEMENT_INPUT )
CASE $YDISPLACEMENT_INPUT
$TARGYCHANGE = GUICTRLREAD ( $YDISPLACEMENT_INPUT )
CASE $ZDISPLACEMENT_INPUT
$TARGZCHANGE = GUICTRLREAD ( $ZDISPLACEMENT_INPUT )
CASE $INPUT_NUMBEROFGAMES
$NUMBEROFGAMES = GUICTRLREAD ( $INPUT_NUMBEROFGAMES )
CASE $INPUT_RADIUS
$RADIUS = GUICTRLREAD ( $INPUT_RADIUS )
CASE $TELEPORTGMISLAND_BUTTON
TELEPORT ( 1.623880e+004 , 1.626246e+004 , 1.482752e+001 , 1 )
CASE $TELEPORTSTRATHOLMEENTRANCEOUTSIDE_BUTTON
TELEPORT ( - 4.050600e+003 , 3.235460e+003 , 1.084500e+002 , 1 )
CASE $TELEPORTSTRATHOLMEENTRANCEINSIDE_BUTTON
TELEPORT ( - 3.646094e+003 , 3.592567e+003 , 1.385001e+002 , 1 )
CASE $TELEPORTBARONRIVENDARE_BUTTON
TELEPORT ( - 3.368678e+003 , 4.033439e+003 , 1.150637e+002 , 1 )
CASE $TELEPORTMOLTENCOREOUTSIDEENTRANCE_BUTTON
TELEPORT ( - 1.039444e+003 , - 7.507526e+003 , 1.809116e+002 , 1 )
CASE $TELEPORTMOLTENCOREENTRANCEINSIDE_BUTTON
TELEPORT ( - 467 , 1096 , - 1.046000e+002 , 1 )
CASE $TELEPORTRAGNAROS_BUTTON
TELEPORT ( - 7.818282e+002 , 8.209279e+002 , - 2.259662e+002 , 1 )
CASE $TELEPORTORGPORTALS_BUTTON
TELEPORT ( - 4.427298e+003 , 1.505949e+003 , 2.430911e+001 , 1 )
CASE $TELEPORTUTGARDEENTRANCEOUTSIDE_BUTTON
TELEPORT ( - 4.859270e+003 , 1.237200e+003 , 2.182830e+002 , 1 )
CASE $TELEPORTUTGARDEENTRANCEINSIDE_BUTTON
TELEPORT ( - 3.277445e+002 , 5.807051e+002 , 1.101414e+002 , 1 )
CASE $TELEPORTUTGARDESKADI_BUTTON
TELEPORT ( - 5.107880e+002 , 3.199773e+002 , 1.044873e+002 , 1 )
CASE $TELEPORTSETHEKKHALLENTRANCE_BUTTON
TELEPORT ( 4.669346e+003 , - 3.361927e+003 , - 1.010476e+002 , 1 )
CASE $TELEPORTSETHEKKHALLINSIDE_BUTTON
TELEPORT ( 3.549199e-001 , - 6.027609e-001 , 6.213091e-003 , 1 )
CASE $TELEPORTANZU_BUTTON
TELEPORT ( 3.004489e+002 , - 5.449478e+001 , 2.664870e+001 , 1 )
CASE $TELEPORTKARAZAHN_BUTTON
TELEPORT ( - 2.012499e+003 , - 1.112130e+004 , 4.710426e+001 , 1 )
CASE $TELEPORTSTORMWINDPORTAL_BUTTON
TELEPORT ( 4.329000e+002 , - 8210 , 119 , 1 )
CASE $TELEPORTEXPERIENCEDISABLER_BUTTON
TELEPORT ( 2.015000e+002 , - 8412 , 156 , 1 )
CASE $TELEPORTDUELAREASTORMWIND_BUTTON
TELEPORT ( 368 , - 9122 , 94 , 1 )
CASE $TELEPORTDARNASSUSPORTALBUTTON
TELEPORT ( 2.339313e+003 , 9.951800e+003 , 1331 , 1 )
CASE $TELEPORTDARNASSUSREPAIRBUTTON
TELEPORT ( 2.313294e+003 , 9911 , 1332 , 1 )
CASE $TELEPORTORGDUELAREA_BUTTON
TELEPORT ( - 4478 , 1245 , 24 , 1 )
CASE $CHECKBOX_COORDS
$TCHECK = GUICTRLREAD ( $CHECKBOX_COORDS )
CASE $INPUT_X
$XTELELOC = GUICTRLREAD ( $INPUT_X )
CASE $INPUT_Y
$YTELELOC = GUICTRLREAD ( $INPUT_Y )
CASE $INPUT_Z
$ZTELELOC = GUICTRLREAD ( $INPUT_Z )
CASE $TELEPORTTOTARGET_CHECKBOX
$TTARGET = GUICTRLREAD ( $TELEPORTTOTARGET_CHECKBOX )
CASE $CLICKTOTELE_CHECKBOX
$CTCHECK = GUICTRLREAD ( $CLICKTOTELE_CHECKBOX )
CASE $SAVEKEYBINDS_BUTTON
LOCAL $S1 , $S2
$S1 = GUICTRLREAD ( $TELETOTARGETKEYBIND_INPUT )
$S2 = GUICTRLREAD ( $TOGGLESPEEDHACKKEYBIND_INPUT )
INIWRITE ( @SCRIPTDIR & "\Setup.ini" , "Keybinds" , "TeleportToTarget" , $S1 )
INIWRITE ( @SCRIPTDIR & "\Setup.ini" , "Keybinds" , "ToggleSpeedHack" , $S2 )
MSGBOX ( 0 , "Keybinds Saved" , "Keybinds saved, please restart the hack." )
EXIT
CASE $KEYBINDSINFO_BUTTON
RUN ( "notepad.exe " & @SCRIPTDIR & "\KEYBINDINFO_TXT.txt" )
CASE $SAVECHATTELEPORTOPTIONS_BUTTON
LOCAL $A1 , $A2 , $B1 , $B2
$A1 = GUICTRLREAD ( $SAVEWPBEGIN_INPUT )
$A2 = GUICTRLREAD ( $SAVEWPEND_INPUT )
$B1 = GUICTRLREAD ( $TELEPORTWPBEGIN_INPUT )
$B2 = GUICTRLREAD ( $TELEPORTWPEND_INPUT )
INIWRITE ( @SCRIPTDIR & "\Setup.ini" , "ChatTeleport" , "BeginString" , $B1 )
INIWRITE ( @SCRIPTDIR & "\Setup.ini" , "ChatTeleport" , "EndString" , $B2 )
INIWRITE ( @SCRIPTDIR & "\Setup.ini" , "ChatSaveWP" , "BeginString" , $A1 )
INIWRITE ( @SCRIPTDIR & "\Setup.ini" , "ChatSaveWP" , "EndString" , $A2 )
$TELEPORTBEGINSTRING = $B1
$TELEPORTENDSTRING = $B2
$SAVEBEGINSTRING = $A1
$SAVEENDSTRING = $A2
MSGBOX ( 0 , "Saved" , "New Chat options saved." )
CASE $CHATTELEPORTOPTIONSINFO_BUTTON
RUN ( "notepad.exe " & @SCRIPTDIR & "\CHATTELEPORTOPTIONS_TXT.txt" )
CASE $BUTTON_TELEPORT
IF $TCHECK = "1" THEN
TELEPORT ( ( $XTELELOC ) , ( $YTELELOC ) , ( $ZTELELOC ) , 1 )
ENDIF
IF $TCHECK = "4" THEN
TELEPORT ( ( $XTELELOC ) , ( $YTELELOC ) , ( $ZTELELOC ) , 0 )
ENDIF
ENDSWITCH
$PREVX = $CHAR_X
$PREVTARGETX = $TARGETX
CALLPOS ( )
IF $PREVX <> $CHAR_X OR $PREVTARGETX <> $TARGETX THEN
CALLGUI ( )
ENDIF
IF $CTCHECK = "1" THEN
TELEPORTCLICKTOMOVE ( )
ENDIF
IF $SPEEDHACKVAR = "on" THEN
RUNSPEEDHACK (2)
Else
	if $SHISON=5 Then
RUNSPEEDHACK (1)
EndIf
ENDIF
IF $EVEN <> - 1 THEN
CHECKCHAT ( )
HARASS ( )
IF $ON = 1 THEN
CALLPOS ( )
FOR $I = 2 TO $NUMBEROFGAMES
_MEMORYWRITE ( $OPENMEM [ $I ] , $CTMADDR [ $I ] , 5.605194e-045 , "float" )
_MEMORYWRITE ( $OPENMEM [ $I ] , $CTMXADDR [ $I ] , ( $CHAR_X + $XDISPLACEMENT [ $I ] ) , "float" )
_MEMORYWRITE ( $OPENMEM [ $I ] , $CTMYADDR [ $I ] , ( $CHAR_Y + $YDISPLACEMENT [ $I ] ) , "float" )
_MEMORYWRITE ( $OPENMEM [ $I ] , $CTMZADDR [ $I ] , ( $CHAR_Z ) , "float" )
NEXT
ELSE
FOR $I = 2 TO $NUMBEROFGAMES
_MEMORYWRITE ( $OPENMEM [ $I ] , $CTMADDR [ $I ] , 1.821688e-044 , "float" )
NEXT
ENDIF
ENDIF
WEND

